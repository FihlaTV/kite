!function(){if(!window.hasOwnProperty("_"))throw new Error("Underscore/Lodash not found: _");!function(){window.assertions=window.assertions||{},window.assertions.assertFunction=window.assertions.assertFunction||function(t,i){var n="function"==typeof t?t():t;if(!n){if(window.navigator&&"Microsoft Internet Explorer"===window.navigator.appName)try{throw new Error}catch(e){i=i+", stack=\n"+e.stack}throw new Error("Assertion failed: "+i)}},window.assert=window.assert||null,window.assertSlow=window.assertSlow||null,window.assertions.enableAssert=function(){window.assert=window.assertions.assertFunction,window.console&&window.console.log&&window.console.log("enabling assert")},window.assertions.disableAssert=function(){window.assert=null,window.console&&window.console.log&&window.console.log("disabling assert")},window.assertions.enableAssertSlow=function(){window.assertSlow=window.assertions.assertFunction,window.console&&window.console.log&&window.console.log("enabling assertSlow")},window.assertions.disableAssertSlow=function(){window.assertSlow=null,window.console&&window.console.log&&window.console.log("disabling assertSlow")}}();var t,i,n;!function(e){function s(t,i){return _.call(t,i)}function r(t,i){var n,e,s,r,o,h,u,a,m,c,l,f=i&&i.split("/"),d=v.map,g=d&&d["*"]||{};if(t&&"."===t.charAt(0))if(i){for(f=f.slice(0,f.length-1),t=t.split("/"),o=t.length-1,v.nodeIdCompat&&y.test(t[o])&&(t[o]=t[o].replace(y,"")),t=f.concat(t),m=0;m<t.length;m+=1)if(l=t[m],"."===l)t.splice(m,1),m-=1;else if(".."===l){if(1===m&&(".."===t[2]||".."===t[0]))break;m>0&&(t.splice(m-1,2),m-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((f||g)&&d){for(n=t.split("/"),m=n.length;m>0;m-=1){if(e=n.slice(0,m).join("/"),f)for(c=f.length;c>0;c-=1)if(s=d[f.slice(0,c).join("/")],s&&(s=s[e])){r=s,h=m;break}if(r)break;!u&&g&&g[e]&&(u=g[e],a=m)}!r&&u&&(r=u,h=a),r&&(n.splice(0,h,r),t=n.join("/"))}return t}function o(t,i){return function(){return f.apply(e,w.call(arguments,0).concat([t,i]))}}function h(t){return function(i){return r(i,t)}}function u(t){return function(i){x[t]=i}}function a(t){if(s(p,t)){var i=p[t];delete p[t],T[t]=!0,l.apply(e,i)}if(!s(x,t)&&!s(T,t))throw new Error("No "+t);return x[t]}function m(t){var i,n=t?t.indexOf("!"):-1;return n>-1&&(i=t.substring(0,n),t=t.substring(n+1,t.length)),[i,t]}function c(t){return function(){return v&&v.config&&v.config[t]||{}}}var l,f,d,g,x={},p={},v={},T={},_=Object.prototype.hasOwnProperty,w=[].slice,y=/\.js$/;d=function(t,i){var n,e=m(t),s=e[0];return t=e[1],s&&(s=r(s,i),n=a(s)),s?t=n&&n.normalize?n.normalize(t,h(i)):r(t,i):(t=r(t,i),e=m(t),s=e[0],t=e[1],s&&(n=a(s))),{f:s?s+"!"+t:t,n:t,pr:s,p:n}},g={require:function(t){return o(t)},exports:function(t){var i=x[t];return"undefined"!=typeof i?i:x[t]={}},module:function(t){return{id:t,uri:"",exports:x[t],config:c(t)}}},l=function(t,i,n,r){var h,m,c,l,f,v,_=[],w=typeof n;if(r=r||t,"undefined"===w||"function"===w){for(i=!i.length&&n.length?["require","exports","module"]:i,f=0;f<i.length;f+=1)if(l=d(i[f],r),m=l.f,"require"===m)_[f]=g.require(t);else if("exports"===m)_[f]=g.exports(t),v=!0;else if("module"===m)h=_[f]=g.module(t);else if(s(x,m)||s(p,m)||s(T,m))_[f]=a(m);else{if(!l.p)throw new Error(t+" missing "+m);l.p.load(l.n,o(r,!0),u(m),{}),_[f]=x[m]}c=n?n.apply(x[t],_):void 0,t&&(h&&h.exports!==e&&h.exports!==x[t]?x[t]=h.exports:c===e&&v||(x[t]=c))}else t&&(x[t]=n)},t=i=f=function(t,i,n,s,r){if("string"==typeof t)return g[t]?g[t](i):a(d(t,i).f);if(!t.splice){if(v=t,v.deps&&f(v.deps,v.callback),!i)return;i.splice?(t=i,i=n,n=null):t=e}return i=i||function(){},"function"==typeof n&&(n=s,s=r),s?l(e,t,i,n):setTimeout(function(){l(e,t,i,n)},4),f},f.config=function(t){return f(t)},t._defined=x,n=function(t,i,n){i.splice||(n=i,i=[]),s(x,t)||s(p,t)||(p[t]=[t,i,n])},n.amd={jQuery:!0}}(),n("almond",function(){}),n("PHET_CORE/core",["require"],function(){return{}}),n("PHET_CORE/phetAllocation",["require","PHET_CORE/core"],function(t){var i=t("PHET_CORE/core");return i.phetAllocation=function(t){if(window.alloc){var i;try{throw new Error}catch(n){i=n.stack}window.alloc[t]||(window.alloc[t]={count:0,stacks:{}});var e=window.alloc[t];e.count++,e.stacks[i]?e.stacks[i]+=1:e.stacks[i]=1,e.report=function(){var t=Object.keys(e.stacks);t=_.sortBy(t,function(t){return e.stacks[t]}),_.each(t,function(t){console.log(e.stacks[t]+": "+t)})}}},i.phetAllocation}),n("KITE/kite",["require","PHET_CORE/phetAllocation"],function(t){window.phetAllocation=t("PHET_CORE/phetAllocation");var i={svgNumber:function(t){return t.toFixed(20)}};return i}),n("DOT/dot",["require","PHET_CORE/phetAllocation"],function(t){window.phetAllocation=t("PHET_CORE/phetAllocation");var i=function n(){switch(arguments.length){case 2:return new n.Vector2(arguments[0],arguments[1]);case 3:return new n.Vector3(arguments[0],arguments[1],arguments[2]);case 4:return new n.Vector4(arguments[0],arguments[1],arguments[2],arguments[3]);default:throw new Error("dot takes 2-4 arguments")}};return i.FastArray=window.Float64Array?window.Float64Array:window.Array,i}),n("PHET_CORE/extend",["require","PHET_CORE/core"],function(t){var i=t("PHET_CORE/core");return i.extend=function(t){return _.each(Array.prototype.slice.call(arguments,1),function(i){if(i)for(var n in i)Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(i,n))}),t},i.extend}),n("PHET_CORE/inherit",["require","PHET_CORE/core","PHET_CORE/extend"],function(t){var i=t("PHET_CORE/core"),n=t("PHET_CORE/extend");return i.inherit=function(t,i,e,s){function r(){}return r.prototype=t.prototype,i.prototype=n(new r,{constructor:i},e),n(i,s),i},i.inherit}),n("PHET_CORE/PoolableMixin",["require","PHET_CORE/core","PHET_CORE/extend"],function(t){var i=t("PHET_CORE/core"),n=t("PHET_CORE/extend");return i.PoolableMixin=function(t,i){var e=t.prototype;i=n({maxPoolSize:50,initialSize:0},i);var s=t.pool=[];i.defaultFactory&&(t.dirtyFromPool=function(){return s.length?s.pop():i.defaultFactory()},t.fillPool=function(t){for(;s.length<t;)s.push(i.defaultFactory())},t.fillPool(i.initialSize)),i.constructorDuplicateFactory&&(t.createFromPool=i.constructorDuplicateFactory(s)),e.freeToPool=function(){s.length<i.maxPoolSize&&s.push(this)}},i.PoolableMixin}),n("DOT/Util",["require","DOT/dot"],function(t){var i=t("DOT/dot");i.Util={testAssert:function(){return"assert.dot: false"},clamp:function(t,i,n){return i>t?i:t>n?n:t},moduloBetweenDown:function(t,i,n){var e=n-i,s=(t-i)%e;return 0>s&&(s+=e),s+i},moduloBetweenUp:function(t,i,e){return-n.moduloBetweenDown(-t,-e,-i)},rangeInclusive:function(t,i){if(t>i)return[];for(var n=new Array(i-t+1),e=t;i>=e;e++)n[e-t]=e;return n},rangeExclusive:function(t,i){return n.rangeInclusive(t+1,i-1)},toRadians:function(t){return Math.PI*t/180},toDegrees:function(t){return 180*t/Math.PI},gcd:function(t,i){return 0===i?t:this.gcd(i,t%i)},lineLineIntersection:function(t,n,e,s){var r=t.x-n.x,o=e.x-s.x,h=t.y-n.y,u=e.y-s.y,a=r*u-h*o,m=t.x*n.y-t.y*n.x,c=e.x*s.y-e.y*s.x;return new i.Vector2((m*o-r*c)/a,(m*u-h*c)/a)},sphereRayIntersection:function(t,n,e){e=void 0===e?1e-5:e;var s=new i.Vector3,r=n.dir,o=n.pos,h=o.minus(s),u=r.dot(h),a=h.magnitudeSquared(),m=4*u*u-4*(a-t*t);if(e>m)return null;var c=r.dot(s)-r.dot(o),l=Math.sqrt(m)/2,f=c-l,d=c+l;if(e>d)return null;var g=n.pointAtDistance(d),x=g.minus(s).normalized();if(e>f)return{distance:d,hitPoint:g,normal:x.negated(),fromOutside:!1};var p=n.pointAtDistance(f),v=p.minus(s).normalized();return{distance:f,hitPoint:p,normal:v,fromOutside:!0}},solveQuadraticRootsReal:function(t,i,n){var e=1e7;if(0===t||Math.abs(i/t)>e||Math.abs(n/t)>e)return[-n/i];var s=i*i-4*t*n;if(0>s)return[];var r=Math.sqrt(s);return[(-i-r)/(2*t),(-i+r)/(2*t)]},solveCubicRootsReal:function(t,i,e,s){var r=1e7;if(0===t||Math.abs(i/t)>r||Math.abs(e/t)>r||Math.abs(s/t)>r)return n.solveQuadraticRootsReal(i,e,s);if(0===s||Math.abs(t/s)>r||Math.abs(i/s)>r||Math.abs(e/s)>r)return n.solveQuadraticRootsReal(t,i,e);i/=t,e/=t,s/=t;var o=(3*e-i*i)/9,h=(-(27*s)+i*(9*e-2*i*i))/54,u=o*o*o+h*h,a=i/3;if(u>0){var m=Math.sqrt(u);return[n.cubeRoot(h+m)+n.cubeRoot(h-m)-a]}if(0===u){var c=n.cubeRoot(h),l=a-c;return[-a+2*c,l,l]}var f=-o*o*o;f=Math.acos(h/Math.sqrt(f));var d=2*Math.sqrt(-o);return[-a+d*Math.cos(f/3),-a+d*Math.cos((f+2*Math.PI)/3),-a+d*Math.cos((f+4*Math.PI)/3)]},cubeRoot:function(t){return t>=0?Math.pow(t,1/3):-Math.pow(-t,1/3)},linear:function(t,i,n,e,s){return(e-n)/(i-t)*(s-t)+n},toFixed:function(t,i){var n=Math.pow(10,i),e=Math.round(t*n)/n;return e.toFixed(i)},toFixedNumber:function(t,i){return parseFloat(n.toFixed(t,i))},isInteger:function(t){return"number"==typeof t&&t%1===0},lineSegmentIntersection:function(t,n,e,s,r,o,h,u){var a=(h-r)*(n-o)-(u-o)*(t-r),m=(e-t)*(n-o)-(s-n)*(t-r),c=(u-o)*(e-t)-(h-r)*(s-n);if(0===c)return null;var l=a/c,f=m/c;if(l>=0&&1>=l&&f>=0&&1>=f){var d=t+l*(e-t),g=n+l*(s-n);return new i.Vector2(d,g)}return null},distToSegmentSquared:function(t,n,e){var s=n.distanceSquared(e);if(0===s)return t.distanceSquared(n);var r=((t.x-n.x)*(e.x-n.x)+(t.y-n.y)*(e.y-n.y))/s;return t.distanceSquared(0>r?n:r>1?e:new i.Vector2(n.x+r*(e.x-n.x),n.y+r*(e.y-n.y)))},distToSegment:function(t,i,n){return Math.sqrt(this.distToSegmentSquared(t,i,n))},arePointsCollinear:function(t,i,e,s){return void 0===s&&(s=0),n.triangleArea(t,i,e)<=s},triangleArea:function(t,i,e){return Math.abs(n.triangleAreaSigned(t,i,e))},triangleAreaSigned:function(t,i,n){return t.x*(i.y-n.y)+i.x*(n.y-t.y)+n.x*(t.y-i.y)},log10:function(t){return Math.log(t)/Math.LN10}};var n=i.Util;return i.testAssert=n.testAssert,i.clamp=n.clamp,i.moduloBetweenDown=n.moduloBetweenDown,i.moduloBetweenUp=n.moduloBetweenUp,i.rangeInclusive=n.rangeInclusive,i.rangeExclusive=n.rangeExclusive,i.toRadians=n.toRadians,i.toDegrees=n.toDegrees,i.lineLineIntersection=n.lineLineIntersection,i.sphereRayIntersection=n.sphereRayIntersection,i.solveQuadraticRootsReal=n.solveQuadraticRootsReal,i.solveCubicRootsReal=n.solveCubicRootsReal,i.cubeRoot=n.cubeRoot,i.linear=n.linear,n}),n("DOT/Vector2",["require","DOT/dot","PHET_CORE/inherit","PHET_CORE/PoolableMixin","DOT/Util"],function(t){var i=t("DOT/dot"),n=t("PHET_CORE/inherit"),e=t("PHET_CORE/PoolableMixin");t("DOT/Util"),i.Vector2=function(t,i){this.x=t||0,this.y=i||0};var s=i.Vector2;s.createPolar=function(t,i){return(new s).setPolar(t,i)},s.prototype={constructor:s,isVector2:!0,dimension:2,magnitude:function(){return Math.sqrt(this.magnitudeSquared())},magnitudeSquared:function(){return this.x*this.x+this.y*this.y},distance:function(t){return Math.sqrt(this.distanceSquared(t))},distanceXY:function(t,i){var n=this.x-t,e=this.y-i;return Math.sqrt(n*n+e*e)},distanceSquared:function(t){var i=this.x-t.x,n=this.y-t.y;return i*i+n*n},distanceSquaredXY:function(t,i){var n=this.x-t,e=this.y-i;return n*n+e*e},dot:function(t){return this.x*t.x+this.y*t.y},dotXY:function(t,i){return this.x*t+this.y*i},equals:function(t){return this.x===t.x&&this.y===t.y},equalsEpsilon:function(t,i){return i||(i=0),Math.max(Math.abs(this.x-t.x),Math.abs(this.y-t.y))<=i},isFinite:function(){return isFinite(this.x)&&isFinite(this.y)},copy:function(t){return t?t.set(this):new s(this.x,this.y)},crossScalar:function(t){return this.x*t.y-this.y*t.x},normalized:function(){var t=this.magnitude();if(0===t)throw new Error("Cannot normalize a zero-magnitude vector");return new s(this.x/t,this.y/t)},withMagnitude:function(t){return this.copy().setMagnitude(t)},timesScalar:function(t){return new s(this.x*t,this.y*t)},times:function(t){return this.timesScalar(t)},componentTimes:function(t){return new s(this.x*t.x,this.y*t.y)},plus:function(t){return new s(this.x+t.x,this.y+t.y)},plusXY:function(t,i){return new s(this.x+t,this.y+i)},plusScalar:function(t){return new s(this.x+t,this.y+t)},minus:function(t){return new s(this.x-t.x,this.y-t.y)},minusXY:function(t,i){return new s(this.x-t,this.y-i)},minusScalar:function(t){return new s(this.x-t,this.y-t)},dividedScalar:function(t){return new s(this.x/t,this.y/t)},negated:function(){return new s(-this.x,-this.y)},angle:function(){return Math.atan2(this.y,this.x)},perpendicular:function(){return new s(this.y,-this.x)},angleBetween:function(t){var n=this.magnitude(),e=t.magnitude();return Math.acos(i.clamp((this.x*t.x+this.y*t.y)/(n*e),-1,1))},rotated:function(t){var i=this.angle()+t,n=this.magnitude();return new s(n*Math.cos(i),n*Math.sin(i))},blend:function(t,i){return new s(this.x+(t.x-this.x)*i,this.y+(t.y-this.y)*i)},average:function(t){return this.blend(t,.5)},toString:function(){return"Vector2("+this.x+", "+this.y+")"},toVector3:function(){return new i.Vector3(this.x,this.y)},setXY:function(t,i){return this.x=t,this.y=i,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},set:function(t){return this.setXY(t.x,t.y)},setMagnitude:function(t){var i=t/this.magnitude();return this.multiplyScalar(i)},add:function(t){return this.setXY(this.x+t.x,this.y+t.y)},addXY:function(t,i){return this.setXY(this.x+t,this.y+i)},addScalar:function(t){return this.setXY(this.x+t,this.y+t)},subtract:function(t){return this.setXY(this.x-t.x,this.y-t.y)},subtractScalar:function(t){return this.setXY(this.x-t,this.y-t)},multiplyScalar:function(t){return this.setXY(this.x*t,this.y*t)},multiply:function(t){return this.multiplyScalar(t)},componentMultiply:function(t){return this.setXY(this.x*t.x,this.y*t.y)},divideScalar:function(t){return this.setXY(this.x/t,this.y/t)},negate:function(){return this.setXY(-this.x,-this.y)},normalize:function(){var t=this.magnitude();if(0===t)throw new Error("Cannot normalize a zero-magnitude vector");return this.divideScalar(t)},rotate:function(t){var i=this.angle()+t,n=this.magnitude();return this.setXY(n*Math.cos(i),n*Math.sin(i))},setPolar:function(t,i){return this.setXY(t*Math.cos(i),t*Math.sin(i))}},e(s,{defaultFactory:function(){return new s},constructorDuplicateFactory:function(t){return function(i,n){return t.length?t.pop().setXY(i,n):new s(i,n)}}}),s.Immutable=function(t,i){s.call(this,t,i)};var r=s.Immutable;return n(s,r),r.mutableOverrideHelper=function(t){r.prototype[t]=function(){throw new Error("Cannot call mutable method '"+t+"' on immutable Vector2")}},r.mutableOverrideHelper("setXY"),r.mutableOverrideHelper("setX"),r.mutableOverrideHelper("setY"),s.ZERO=new r(0,0),s.X_UNIT=new r(1,0),s.Y_UNIT=new r(0,1),s}),n("DOT/Bounds2",["require","DOT/dot","PHET_CORE/PoolableMixin","DOT/Vector2"],function(t){var i=t("DOT/dot"),n=t("PHET_CORE/PoolableMixin");t("DOT/Vector2");var e=new i.Vector2;i.Bounds2=function(t,i,n,e){this.minX=t,this.minY=i,this.maxX=n,this.maxY=e};var s=i.Bounds2;return s.prototype={constructor:s,isBounds:!0,dimension:2,getWidth:function(){return this.maxX-this.minX},get width(){return this.getWidth()},getHeight:function(){return this.maxY-this.minY},get height(){return this.getHeight()},getX:function(){return this.minX},get x(){return this.getX()},getY:function(){return this.minY},get y(){return this.getY()},getMinX:function(){return this.minX},get left(){return this.minX},getMinY:function(){return this.minY},get top(){return this.minY},getMaxX:function(){return this.maxX},get right(){return this.maxX},getMaxY:function(){return this.maxY},get bottom(){return this.maxY},getCenterX:function(){return(this.maxX+this.minX)/2},get centerX(){return this.getCenterX()},getCenterY:function(){return(this.maxY+this.minY)/2},get centerY(){return this.getCenterY()},getLeftTop:function(){return new i.Vector2(this.minX,this.minY)},get leftTop(){return this.getLeftTop()},getCenterTop:function(){return new i.Vector2(this.getCenterX(),this.minY)},get centerTop(){return this.getCenterTop()},getRightTop:function(){return new i.Vector2(this.maxX,this.minY)},get rightTop(){return this.getRightTop()},getLeftCenter:function(){return new i.Vector2(this.minX,this.getCenterY())},get leftCenter(){return this.getLeftCenter()},getCenter:function(){return new i.Vector2(this.getCenterX(),this.getCenterY())},get center(){return this.getCenter()},getRightCenter:function(){return new i.Vector2(this.maxX,this.getCenterY())},get rightCenter(){return this.getRightCenter()},getLeftBottom:function(){return new i.Vector2(this.minX,this.maxY)},get leftBottom(){return this.getLeftBottom()},getCenterBottom:function(){return new i.Vector2(this.getCenterX(),this.maxY)},get centerBottom(){return this.getCenterBottom()},getRightBottom:function(){return new i.Vector2(this.maxX,this.maxY)},get rightBottom(){return this.getRightBottom()},isEmpty:function(){return this.getWidth()<0||this.getHeight()<0},isFinite:function(){return isFinite(this.minX)&&isFinite(this.minY)&&isFinite(this.maxX)&&isFinite(this.maxY)},hasNonzeroArea:function(){return this.getWidth()>0&&this.getHeight()>0},isValid:function(){return!this.isEmpty()&&this.isFinite()},containsCoordinates:function(t,i){return this.minX<=t&&t<=this.maxX&&this.minY<=i&&i<=this.maxY},containsPoint:function(t){return this.containsCoordinates(t.x,t.y)},containsBounds:function(t){return this.minX<=t.minX&&this.maxX>=t.maxX&&this.minY<=t.minY&&this.maxY>=t.maxY},intersectsBounds:function(t){return!this.intersection(t).isEmpty()},minimumDistanceToPointSquared:function(t){var i,n=t.x<this.minX?this.minX:t.x>this.maxX?this.maxX:null,e=t.y<this.minY?this.minY:t.y>this.maxY?this.maxY:null;if(null===n&&null===e)return 0;if(null===n)return i=e-t.y,i*i;if(null===e)return i=n-t.x,i*i;var s=n-t.x,r=e-t.y;return s*s+r*r},maximumDistanceToPointSquared:function(t){var i=t.x>this.getCenterX()?this.minX:this.maxX,n=t.y>this.getCenterY()?this.minY:this.maxY;return i-=t.x,n-=t.y,i*i+n*n},toString:function(){return"[x:("+this.minX+","+this.maxX+"),y:("+this.minY+","+this.maxY+")]"},equals:function(t){return this.minX===t.minX&&this.minY===t.minY&&this.maxX===t.maxX&&this.maxY===t.maxY},equalsEpsilon:function(t,i){i=i||0;var n=this.isFinite(),e=t.isFinite();return n&&e?Math.abs(this.minX-t.minX)<i&&Math.abs(this.minY-t.minY)<i&&Math.abs(this.maxX-t.maxX)<i&&Math.abs(this.maxY-t.maxY)<i:n!==e?!1:this===t?!0:(isFinite(this.minX+t.minX)?Math.abs(this.minX-t.minX)<i:this.minX===t.minX)&&(isFinite(this.minY+t.minY)?Math.abs(this.minY-t.minY)<i:this.minY===t.minY)&&(isFinite(this.maxX+t.maxX)?Math.abs(this.maxX-t.maxX)<i:this.maxX===t.maxX)&&(isFinite(this.maxY+t.maxY)?Math.abs(this.maxY-t.maxY)<i:this.maxY===t.maxY)},copy:function(t){return t?t.set(this):new s(this.minX,this.minY,this.maxX,this.maxY)},union:function(t){return new s(Math.min(this.minX,t.minX),Math.min(this.minY,t.minY),Math.max(this.maxX,t.maxX),Math.max(this.maxY,t.maxY))},intersection:function(t){return new s(Math.max(this.minX,t.minX),Math.max(this.minY,t.minY),Math.min(this.maxX,t.maxX),Math.min(this.maxY,t.maxY))},withCoordinates:function(t,i){return new s(Math.min(this.minX,t),Math.min(this.minY,i),Math.max(this.maxX,t),Math.max(this.maxY,i))},withPoint:function(t){return this.withCoordinates(t.x,t.y)},withMinX:function(t){return new s(t,this.minY,this.maxX,this.maxY)},withMinY:function(t){return new s(this.minX,t,this.maxX,this.maxY)},withMaxX:function(t){return new s(this.minX,this.minY,t,this.maxY)},withMaxY:function(t){return new s(this.minX,this.minY,this.maxX,t)},roundedOut:function(){return new s(Math.floor(this.minX),Math.floor(this.minY),Math.ceil(this.maxX),Math.ceil(this.maxY))},roundedIn:function(){return new s(Math.ceil(this.minX),Math.ceil(this.minY),Math.floor(this.maxX),Math.floor(this.maxY))},transformed:function(t){return this.copy().transform(t)},dilated:function(t){return new s(this.minX-t,this.minY-t,this.maxX+t,this.maxY+t)},dilatedX:function(t){return new s(this.minX-t,this.minY,this.maxX+t,this.maxY)},dilatedY:function(t){return new s(this.minX,this.minY-t,this.maxX,this.maxY+t)},dilatedXY:function(t,i){return new s(this.minX-t,this.minY-i,this.maxX+t,this.maxY+i)},eroded:function(t){return this.dilated(-t)},erodedX:function(t){return this.dilatedX(-t)},erodedY:function(t){return this.dilatedY(-t)},erodedXY:function(t,i){return this.dilatedXY(-t,-i)},shiftedX:function(t){return new s(this.minX+t,this.minY,this.maxX+t,this.maxY)},shiftedY:function(t){return new s(this.minX,this.minY+t,this.maxX,this.maxY+t)},shifted:function(t,i){return new s(this.minX+t,this.minY+i,this.maxX+t,this.maxY+i)},setMinMax:function(t,i,n,e){return this.minX=t,this.minY=i,this.maxX=n,this.maxY=e,this},setMinX:function(t){return this.minX=t,this},setMinY:function(t){return this.minY=t,this},setMaxX:function(t){return this.maxX=t,this},setMaxY:function(t){return this.maxY=t,this},set:function(t){return this.setMinMax(t.minX,t.minY,t.maxX,t.maxY)},includeBounds:function(t){return this.setMinMax(Math.min(this.minX,t.minX),Math.min(this.minY,t.minY),Math.max(this.maxX,t.maxX),Math.max(this.maxY,t.maxY))},constrainBounds:function(t){return this.setMinMax(Math.max(this.minX,t.minX),Math.max(this.minY,t.minY),Math.min(this.maxX,t.maxX),Math.min(this.maxY,t.maxY))},addCoordinates:function(t,i){return this.setMinMax(Math.min(this.minX,t),Math.min(this.minY,i),Math.max(this.maxX,t),Math.max(this.maxY,i))},addPoint:function(t){return this.addCoordinates(t.x,t.y)},roundOut:function(){return this.setMinMax(Math.floor(this.minX),Math.floor(this.minY),Math.ceil(this.maxX),Math.ceil(this.maxY))},roundIn:function(){return this.setMinMax(Math.ceil(this.minX),Math.ceil(this.minY),Math.floor(this.maxX),Math.floor(this.maxY))},transform:function(t){if(this.isEmpty())return this;if(t.isIdentity())return this;var n=this.minX,s=this.minY,r=this.maxX,o=this.maxY;return this.set(i.Bounds2.NOTHING),this.addPoint(t.multiplyVector2(e.setXY(n,s))),this.addPoint(t.multiplyVector2(e.setXY(n,o))),this.addPoint(t.multiplyVector2(e.setXY(r,s))),this.addPoint(t.multiplyVector2(e.setXY(r,o))),this},dilate:function(t){return this.setMinMax(this.minX-t,this.minY-t,this.maxX+t,this.maxY+t)},dilateX:function(t){return this.setMinMax(this.minX-t,this.minY,this.maxX+t,this.maxY)},dilateY:function(t){return this.setMinMax(this.minX,this.minY-t,this.maxX,this.maxY+t)},dilateXY:function(t,i){return this.setMinMax(this.minX-t,this.minY-i,this.maxX+t,this.maxY+i)},erode:function(t){return this.dilate(-t)},erodeX:function(t){return this.dilateX(-t)},erodeY:function(t){return this.dilateY(-t)},erodeXY:function(t,i){return this.dilateXY(-t,-i)},shiftX:function(t){return this.setMinMax(this.minX+t,this.minY,this.maxX+t,this.maxY)},shiftY:function(t){return this.setMinMax(this.minX,this.minY+t,this.maxX,this.maxY+t)},shift:function(t,i){return this.setMinMax(this.minX+t,this.minY+i,this.maxX+t,this.maxY+i)},getClosestPoint:function(t,n,e){return e?e.setXY(t,n):e=new i.Vector2(t,n),e.x<this.minX&&(e.x=this.minX),e.x>this.maxX&&(e.x=this.maxX),e.y<this.minY&&(e.y=this.minY),e.y>this.maxY&&(e.y=this.maxY),e}},s.rect=function(t,i,n,e){return new s(t,i,t+n,i+e)},s.point=function(t,n){if(t instanceof i.Vector2){var e=t;return new s(e.x,e.y,e.x,e.y)}return new s(t,n,t,n)},n(s,{defaultFactory:function(){return s.NOTHING.copy()},constructorDuplicateFactory:function(t){return function(i,n,e,r){return t.length?t.pop().setMinMax(i,n,e,r):new s(i,n,e,r)}}}),s.EVERYTHING=new s(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),s.NOTHING=new s(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),s}),n("DOT/Ray2",["require","DOT/dot"],function(t){var i=t("DOT/dot");i.Ray2=function(t,i){this.pos=t,this.dir=i};var n=i.Ray2;return n.prototype={constructor:n,shifted:function(t){return new n(this.pointAtDistance(t),this.dir)},pointAtDistance:function(t){return this.pos.plus(this.dir.timesScalar(t))},toString:function(){return this.pos.toString()+" => "+this.dir.toString()}},n}),n("KITE/segments/Segment",["require","KITE/kite","DOT/Util","DOT/Bounds2"],function(t){var i=t("KITE/kite"),n=t("DOT/Util"),e=t("DOT/Bounds2");i.Segment=function(){};var s=i.Segment,r=function(t){return t};return s.prototype={constructor:s,getBoundsWithTransform:function(t){var i=this.transformed(t);return i.getBounds()},subdivisions:function(t){for(var i=this,e=[],s=0;s<t.length;s++){var r=t[s],o=i.subdivided(r);e.push(o[0]),i=o[1];for(var h=s+1;h<t.length;h++)t[h]=n.linear(r,1,0,1,t[h])}return e.push(i),e},subdividedIntoMonotone:function(){return this.subdivisions(this.getInteriorExtremaTs())},toPiecewiseLinearSegments:function(t,i,e,o,h,u){i=void 0===i?t.minLevels:i,e=void 0===e?t.maxLevels:e,o=o||[];var a=t.pointMap||r;h=h||a(this.start),u=u||a(this.end);var m=a(this.positionAt(.5)),c=0===e;if(!c&&0>=i&&(c=(null===t.curveEpsilon||n.distToSegmentSquared(m,h,u)/h.distanceSquared(u)<t.curveEpsilon)&&(null===t.distanceEpsilon||n.distToSegmentSquared(m,h,u)<t.distanceEpsilon)),c)o.push(new s.Line(h,u));else{var l=this.subdivided(.5);l[0].toPiecewiseLinearSegments(t,i-1,e-1,o,h,m),l[1].toPiecewiseLinearSegments(t,i-1,e-1,o,m,u)}return o}},s.closestToPoint=function(t,i,n){var s=n*n,r=[],o=[],h=Number.POSITIVE_INFINITY,u=!1;for(_.each(t,function(t){if(t.explicitClosestToPoint){var n=t.explicitClosestToPoint(i);_.each(n,function(t){t.distanceSquared<h?(o=[t],h=t.distanceSquared):t.distanceSquared===h&&o.push(t)})}else for(var s=[0].concat(t.getInteriorExtremaTs()).concat([1]),u=0;u<s.length-1;u++){var a=s[u],m=s[u+1],c=t.positionAt(a),l=t.positionAt(m),f=e.point(c).addPoint(l),d=f.minimumDistanceToPointSquared(i);if(h>=d){var g=f.maximumDistanceToPointSquared(i);h>g&&(h=g,o=[]),r.push({ta:a,tb:m,pa:c,pb:l,segment:t,bounds:f,min:d,max:g})}}});r.length&&!u;){var a=r;r=[],u=!0,_.each(a,function(t){if(!(t.minDistanceSquared>h)){u&&t.pa.distanceSquared(t.pb)>s&&(u=!1);var n=(t.ta+t.tb)/2,a=t.segment.positionAt(n),m=e.point(t.pa).addPoint(a),c=e.point(t.pb).addPoint(a),l=m.minimumDistanceToPointSquared(i),f=c.minimumDistanceToPointSquared(i);if(h>=l){var d=m.maximumDistanceToPointSquared(i);h>d&&(h=d,o=[]),r.push({ta:t.ta,tb:n,pa:t.pa,pb:a,segment:t.segment,bounds:m,min:l,max:d})}if(h>=f){var g=c.maximumDistanceToPointSquared(i);h>g&&(h=g,o=[]),r.push({ta:n,tb:t.tb,pa:a,pb:t.pb,segment:t.segment,bounds:c,min:f,max:g})}}})}return _.each(r,function(t){var n=(t.ta+t.tb)/2,e=t.segment.positionAt(n);o.push({segment:t.segment,t:n,closestPoint:e,distanceSquared:i.distanceSquared(e)})}),o},s}),n("KITE/segments/Line",["require","PHET_CORE/inherit","DOT/Bounds2","DOT/Vector2","DOT/Util","KITE/kite","KITE/segments/Segment"],function(t){var i=t("PHET_CORE/inherit"),n=t("DOT/Bounds2"),e=t("DOT/Vector2"),s=t("DOT/Util"),r=t("KITE/kite"),o=t("KITE/segments/Segment"),h=new e;return o.Line=function(t,i){this._start=t,this._end=i,this._tangent=void 0,this._bounds=void 0},i(o,o.Line,{getStart:function(){return this._start},get start(){return this._start},getEnd:function(){return this._end},get end(){return this._end},getStartTangent:function(){return void 0===this._tangent&&(this._tangent=this._end.minus(this._start).normalized()),this._tangent},get startTangent(){return this.getStartTangent()},getEndTangent:function(){return this.getStartTangent()},get endTangent(){return this.getEndTangent()},getBounds:function(){return void 0===this._bounds&&(this._bounds=n.NOTHING.copy().addPoint(this._start).addPoint(this._end)),this._bounds},get bounds(){return this.getBounds()},getBoundsWithTransform:function(t){var i=n.NOTHING.copy();return i.addPoint(t.multiplyVector2(h.set(this._start))),i.addPoint(t.multiplyVector2(h.set(this._end))),i},getNondegenerateSegments:function(){return this._start.equals(this._end)?[]:[this]},positionAt:function(t){return this._start.plus(this._end.minus(this._start).times(t))},tangentAt:function(){return this.getStartTangent()},curvatureAt:function(){return 0},getSVGPathFragment:function(){return"L "+r.svgNumber(this._end.x)+" "+r.svgNumber(this._end.y)},strokeLeft:function(t){var i=this.getEndTangent().perpendicular().negated().times(t/2);return[new o.Line(this._start.plus(i),this._end.plus(i))]},strokeRight:function(t){var i=this.getStartTangent().perpendicular().times(t/2);return[new o.Line(this._end.plus(i),this._start.plus(i))]},getInteriorExtremaTs:function(){return[]},subdivided:function(t){var i=this.positionAt(t);return[new o.Line(this._start,i),new o.Line(i,this._end)]},intersectsBounds:function(){throw new Error("Segment.Line.intersectsBounds unimplemented")},intersection:function(t){var i=[],n=this._start,e=this._end,s=e.minus(n);if(0===s.magnitudeSquared())return i;var r=t.dir.y*s.x-t.dir.x*s.y;if(0===r)return i;var o=(t.dir.x*(n.y-t.pos.y)-t.dir.y*(n.x-t.pos.x))/r;if(0>o||o>=1)return i;var h=(s.x*(n.y-t.pos.y)-s.y*(n.x-t.pos.x))/r;if(1e-6>h)return i;var u=s.perpendicular();return i.push({distance:h,point:n.plus(s.times(o)),normal:u.dot(t.dir)>0?u.negated():u,wind:t.dir.perpendicular().dot(s)<0?1:-1,segment:this}),i},windingIntersection:function(t){var i=this.intersection(t);return i.length?i[0].wind:0},writeToContext:function(t){t.lineTo(this._end.x,this._end.y)},transformed:function(t){return new o.Line(t.timesVector2(this._start),t.timesVector2(this._end))},explicitClosestToPoint:function(t){var i=this._end.minus(this._start),n=t.minus(this._start).dot(i)/i.magnitudeSquared();n=s.clamp(n,0,1);var e=this.positionAt(n);return[{segment:this,t:n,closestPoint:e,distanceSquared:t.distanceSquared(e)}]},reparameterized:function(t,i){return new o.Line(this.positionAt(i),this.positionAt(t+i))},polarToCartesian:function(t){return this._start.x===this._end.x?[new o.Line(e.createPolar(this._start.y,this._start.x),e.createPolar(this._end.y,this._end.x))]:this._start.y===this._end.y?[new o.Arc(e.ZERO,this._start.y,this._start.x,this._end.x,this._start.x>this._end.x)]:this.toPiecewiseLinearSegments(t)}}),o.Line}),n("KITE/segments/Arc",["require","PHET_CORE/inherit","DOT/Vector2","DOT/Bounds2","DOT/Util","KITE/kite","KITE/segments/Segment"],function(t){var i=t("PHET_CORE/inherit"),n=t("DOT/Vector2"),e=t("DOT/Bounds2"),s=t("DOT/Util"),r=t("KITE/kite"),o=t("KITE/segments/Segment");return o.Arc=function(t,i,n,e,s){0>i&&(i=-i,n+=Math.PI,e+=Math.PI),this._center=t,this._radius=i,this._startAngle=n,this._endAngle=e,this._anticlockwise=s,this._start=void 0,this._end=void 0,this._startTangent=void 0,this._endTangent=void 0,this._actualEndAngle=void 0,this._isFullPerimeter=void 0,this._angleDifference=void 0},i(o,o.Arc,{getCenter:function(){return this._center},get center(){return this.getCenter()},getRadius:function(){return this._radius},get radius(){return this.getRadius()},getStartAngle:function(){return this._startAngle},get startAngle(){return this.getStartAngle()},getEndAngle:function(){return this._endAngle},get endAngle(){return this.getEndAngle()},getAnticlockwise:function(){return this._anticlockwise},get anticlockwise(){return this.getAnticlockwise()},getStart:function(){return void 0===this._start&&(this._start=this.positionAtAngle(this._startAngle)),this._start},get start(){return this.getStart()},getEnd:function(){return void 0===this._end&&(this._end=this.positionAtAngle(this._endAngle)),this._end},get end(){return this.getEnd()},getStartTangent:function(){return void 0===this._startTangent&&(this._startTangent=this.tangentAtAngle(this._startAngle)),this._startTangent},get startTangent(){return this.getStartTangent()},getEndTangent:function(){return void 0===this._endTangent&&(this._endTangent=this.tangentAtAngle(this._endAngle)),this._endTangent},get endTangent(){return this.getEndTangent()},getActualEndAngle:function(){return void 0===this._actualEndAngle&&(this._actualEndAngle=this._anticlockwise?this._startAngle>this._endAngle?this._endAngle:this._startAngle<this._endAngle?this._endAngle-2*Math.PI:this._startAngle:this._startAngle<this._endAngle?this._endAngle:this._startAngle>this._endAngle?this._endAngle+2*Math.PI:this._startAngle),this._actualEndAngle},get actualEndAngle(){return this.getActualEndAngle()},getIsFullPerimeter:function(){return void 0===this._isFullPerimeter&&(this._isFullPerimeter=!this._anticlockwise&&this._endAngle-this._startAngle>=2*Math.PI||this._anticlockwise&&this._startAngle-this._endAngle>=2*Math.PI),this._isFullPerimeter},get isFullPerimeter(){return this.getIsFullPerimeter()},getAngleDifference:function(){return void 0===this._angleDifference&&(this._angleDifference=this._anticlockwise?this._startAngle-this._endAngle:this._endAngle-this._startAngle,this._angleDifference<0&&(this._angleDifference+=2*Math.PI)),this._angleDifference
},get angleDifference(){return this.getAngleDifference()},getBounds:function(){return void 0===this._bounds&&(this._bounds=e.NOTHING.copy().withPoint(this.getStart()).withPoint(this.getEnd()),this._startAngle!==this._endAngle&&(this.includeBoundsAtAngle(0),this.includeBoundsAtAngle(Math.PI/2),this.includeBoundsAtAngle(Math.PI),this.includeBoundsAtAngle(3*Math.PI/2))),this._bounds},get bounds(){return this.getBounds()},getNondegenerateSegments:function(){return this._radius<=0||this._startAngle===this._endAngle?[]:[this]},includeBoundsAtAngle:function(t){this.containsAngle(t)&&(this._bounds=this._bounds.withPoint(this._center.plus(n.createPolar(this._radius,t))))},mapAngle:function(t){return this._startAngle>this.getActualEndAngle()?s.moduloBetweenUp(t,this._startAngle-2*Math.PI,this._startAngle):s.moduloBetweenDown(t,this._startAngle,this._startAngle+2*Math.PI)},tAtAngle:function(t){return(this.mapAngle(t)-this._startAngle)/(this.getActualEndAngle()-this._startAngle)},angleAt:function(t){return this._startAngle+(this.getActualEndAngle()-this._startAngle)*t},positionAt:function(t){return this.positionAtAngle(this.angleAt(t))},tangentAt:function(t){return this.tangentAtAngle(this.angleAt(t))},curvatureAt:function(){return(this._anticlockwise?-1:1)/this._radius},positionAtAngle:function(t){return this._center.plus(n.createPolar(this._radius,t))},tangentAtAngle:function(t){var i=n.createPolar(1,t);return this._anticlockwise?i.perpendicular():i.perpendicular().negated()},containsAngle:function(t){var i=this._anticlockwise?t-this._endAngle:t-this._startAngle,n=s.moduloBetweenDown(i,0,2*Math.PI);return n<=this.angleDifference},getSVGPathFragment:function(){var t,i=.01,e=this._anticlockwise?"0":"1";if(this.angleDifference<2*Math.PI-i)return t=this.angleDifference<Math.PI?"0":"1","A "+r.svgNumber(this._radius)+" "+r.svgNumber(this._radius)+" 0 "+t+" "+e+" "+r.svgNumber(this.end.x)+" "+r.svgNumber(this.end.y);var s=(this._startAngle+this._endAngle)/2,o=this._center.plus(n.createPolar(this._radius,s));t="0";var h="A "+r.svgNumber(this._radius)+" "+r.svgNumber(this._radius)+" 0 "+t+" "+e+" "+r.svgNumber(o.x)+" "+r.svgNumber(o.y),u="A "+r.svgNumber(this._radius)+" "+r.svgNumber(this._radius)+" 0 "+t+" "+e+" "+r.svgNumber(this.end.x)+" "+r.svgNumber(this.end.y);return h+" "+u},strokeLeft:function(t){return[new o.Arc(this._center,this._radius+(this._anticlockwise?1:-1)*t/2,this._startAngle,this._endAngle,this._anticlockwise)]},strokeRight:function(t){return[new o.Arc(this._center,this._radius+(this._anticlockwise?-1:1)*t/2,this._endAngle,this._startAngle,!this._anticlockwise)]},getInteriorExtremaTs:function(){var t=this,i=[];return _.each([0,Math.PI/2,Math.PI,3*Math.PI/2],function(n){if(t.containsAngle(n)){var e=t.tAtAngle(n),s=1e-10;e>s&&1-s>e&&i.push(e)}}),i.sort()},subdivided:function(t){var i=this.angleAt(0),n=this.angleAt(t),e=this.angleAt(1);return[new o.Arc(this._center,this._radius,i,n,this._anticlockwise),new o.Arc(this._center,this._radius,n,e,this._anticlockwise)]},intersectsBounds:function(){throw new Error("Segment.intersectsBounds unimplemented!")},intersection:function(t){var i=[],n=0,e=t.pos.minus(this._center),s=t.dir.dot(e),r=e.magnitudeSquared(),o=4*s*s-4*(r-this._radius*this._radius);if(n>o)return i;var h=t.dir.dot(this._center)-t.dir.dot(t.pos),u=Math.sqrt(o)/2,a=h-u,m=h+u;if(n>m)return i;var c=t.pointAtDistance(m),l=c.minus(this._center).normalized();if(n>a)this.containsAngle(l.angle())&&i.push({distance:m,point:c,normal:l.negated(),wind:this._anticlockwise?-1:1});else{var f=t.pointAtDistance(a),d=f.minus(this._center).normalized();this.containsAngle(d.angle())&&i.push({distance:a,point:f,normal:d,wind:this._anticlockwise?1:-1}),this.containsAngle(l.angle())&&i.push({distance:m,point:c,normal:l.negated(),wind:this._anticlockwise?-1:1})}return i},windingIntersection:function(t){var i=0,n=this.intersection(t);return _.each(n,function(t){i+=t.wind}),i},writeToContext:function(t){t.arc(this._center.x,this._center.y,this._radius,this._startAngle,this._endAngle,this._anticlockwise)},transformed:function(t){var i=t.timesVector2(n.createPolar(1,this._startAngle)).minus(t.timesVector2(n.ZERO)).angle(),e=t.timesVector2(n.createPolar(1,this._endAngle)).minus(t.timesVector2(n.ZERO)).angle(),s=t.getDeterminant()>=0?this._anticlockwise:!this._anticlockwise;Math.abs(this._endAngle-this._startAngle)===2*Math.PI&&(e=s?i-2*Math.PI:i+2*Math.PI);var r=t.getScaleVector();if(r.x!==r.y){var h=r.x*this._radius,u=r.y*this._radius;return new o.EllipticalArc(t.timesVector2(this._center),h,u,0,i,e,s)}var a=r.x*this._radius;return new o.Arc(t.timesVector2(this._center),a,i,e,s)}}),o.Arc}),n("KITE/util/Subpath",["require","DOT/Bounds2","KITE/kite","KITE/segments/Line","KITE/segments/Arc"],function(t){var i=t("DOT/Bounds2"),n=t("KITE/kite");t("KITE/segments/Line"),t("KITE/segments/Arc"),n.Subpath=function(t,n,e){this.segments=t||[],this.points=n||(t&&t.length?_.map(t,function(t){return t.start}).concat(t[t.length-1].end):[]),this.closed=!!e,this._strokedSubpaths=null,this._strokedSubpathsComputed=!1,this._strokedStyles=null;var s=this.bounds=i.NOTHING.copy();_.each(this.segments,function(t){s.includeBounds(t.bounds)})};var e=n.Subpath;return e.prototype={copy:function(){return new e(this.segments.slice(0),this.points.slice(0),this.closed)},invalidate:function(){this._strokedSubpathsComputed=!1},addPoint:function(t){return this.points.push(t),this},addSegmentDirectly:function(t){return this.segments.push(t),this.invalidate(),this.bounds.includeBounds(t.getBounds()),this},addSegment:function(t){var i=this;return _.each(t.getNondegenerateSegments(),function(t){i.addSegmentDirectly(t)}),this},addClosingSegment:function(){if(this.hasClosingSegment()){var t=this.getClosingSegment();this.addSegmentDirectly(t),this.addPoint(this.getFirstPoint()),this.closed=!0}},close:function(){this.closed=!0},getLength:function(){return this.points.length},getFirstPoint:function(){return _.first(this.points)},getLastPoint:function(){return _.last(this.points)},getFirstSegment:function(){return _.first(this.segments)},getLastSegment:function(){return _.last(this.segments)},isDrawable:function(){return this.segments.length>0},isClosed:function(){return this.closed},hasClosingSegment:function(){return!this.getFirstPoint().equalsEpsilon(this.getLastPoint(),1e-9)},getClosingSegment:function(){return new n.Segment.Line(this.getLastPoint(),this.getFirstPoint())},writeToContext:function(t){if(this.isDrawable()){var i=this.getFirstSegment().start;t.moveTo(i.x,i.y);for(var n=this.segments.length,e=0;n>e;e++)this.segments[e].writeToContext(t);this.closed&&t.closePath()}},toPiecewiseLinear:function(t){return new e(_.flatten(_.map(this.segments,function(i){return i.toPiecewiseLinearSegments(t)})),null,this.closed)},transformed:function(t){return new e(_.map(this.segments,function(i){return i.transformed(t)}),_.map(this.points,function(i){return t.timesVector2(i)}),this.closed)},nonlinearTransformed:function(t){return this.closed&&this.hasClosingSegment()&&this.addClosingSegment(),new e(_.flatten(_.map(this.segments,function(i){return t.methodName&&i[t.methodName]?i[t.methodName](t):i.toPiecewiseLinearSegments(t)})),null,this.closed)},getBoundsWithTransform:function(t){for(var n=i.NOTHING.copy(),e=this.segments.length,s=0;e>s;s++)n.includeBounds(this.segments[s].getBoundsWithTransform(t));return n},offset:function(t){if(!this.isDrawable())return new e([],null,this.closed);if(0===t)return new e(this.segments.slice(),null,this.closed);var i,s=this.segments.slice();this.closed&&this.hasClosingSegment()&&s.push(this.getClosingSegment());var r=[];for(i=0;i<s.length;i++)r.push(s[i].strokeLeft(2*t));var o=[];for(i=0;i<s.length;i++){if(this.closed||i>0){var h=(i>0?i:s.length)-1,u=s[i].start,a=s[h].endTangent,m=s[i].startTangent,c=a.perpendicular().negated().times(t).angle(),l=m.perpendicular().negated().times(t).angle(),f=a.perpendicular().dot(m)>0;o.push(new n.Segment.Arc(u,Math.abs(t),c,l,f))}o=o.concat(r[i])}return new e(o,null,this.closed)},stroked:function(t){function i(t){h=h.concat(t)}function s(t){u=u.concat(t)}if(!this.isDrawable())return[];if(void 0===t&&(t=new n.LineStyles),this._strokedSubpathsComputed&&this._strokedStyles.equals(t))return this._strokedSubpaths;var r,o=t.lineWidth,h=[],u=[],a=this.getFirstSegment(),m=this.getLastSegment(),c=m.end.equals(a.start),l=c?null:new n.Segment.Line(this.segments[this.segments.length-1].end,this.segments[0].start);for(r=0;r<this.segments.length;r++)r>0&&i(t.leftJoin(this.segments[r].start,this.segments[r-1].endTangent,this.segments[r].startTangent)),i(this.segments[r].strokeLeft(o));for(r=this.segments.length-1;r>=0;r--)r<this.segments.length-1&&s(t.rightJoin(this.segments[r].end,this.segments[r].endTangent,this.segments[r+1].startTangent)),s(this.segments[r].strokeRight(o));var f;return this.closed?(c?(i(t.leftJoin(m.end,m.endTangent,a.startTangent)),s(t.rightJoin(m.end,m.endTangent,a.startTangent))):(i(t.leftJoin(l.start,m.endTangent,l.startTangent)),i(l.strokeLeft(o)),i(t.leftJoin(l.end,l.endTangent,a.startTangent)),s(t.rightJoin(l.end,l.endTangent,a.startTangent)),s(l.strokeRight(o)),s(t.rightJoin(l.start,m.endTangent,l.startTangent))),f=[new e(h,null,!0),new e(u,null,!0)]):f=[new e(h.concat(t.cap(m.end,m.endTangent)).concat(u).concat(t.cap(a.start,a.startTangent.negated())),null,!0)],this._strokedSubpaths=f,this._strokedSubpathsComputed=!0,this._strokedStyles=new n.LineStyles(t),f}},n.Subpath}),n("KITE/parser/svgPath",["require","KITE/kite"],function(t){function i(t){return'"'+t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E-\x1F\x80-\uFFFF]/g,escape)+'"'}var n=t("KITE/kite");n.svgPath={parse:function(t,n){function e(t){W>K||(K>W&&(W=K,J=[]),J.push(t))}function s(){var t,i,n,e,s,o;for(s=K,o=K,t=[],i=H();null!==i;)t.push(i),i=H();if(null!==t)if(i=r(),i=null!==i?i:"",null!==i){for(n=[],e=H();null!==e;)n.push(e),e=H();null!==n?t=[t,i,n]:(t=null,K=o)}else t=null,K=o;else t=null,K=o;return null!==t&&(t=function(t,i){return i?i:[]}(s,t[1])),null===t&&(K=s),t}function r(){var t,i,n,e,s;if(e=K,s=K,t=o(),null!==t){for(i=[],n=H();null!==n;)i.push(n),n=H();null!==i?(n=r(),null!==n?t=[t,i,n]:(t=null,K=s)):(t=null,K=s)}else t=null,K=s;return null!==t&&(t=function(t,i,n){return i.concat(n)}(e,t[0],t[2])),null===t&&(K=e),null===t&&(e=K,t=o(),null!==t&&(t=function(t,i){return i}(e,t)),null===t&&(K=e)),t}function o(){var t,i,n,e,s;if(e=K,s=K,t=a(),null!==t){for(i=[],n=H();null!==n;)i.push(n),n=H();null!==i?(n=h(),n=null!==n?n:"",null!==n?t=[t,i,n]:(t=null,K=s)):(t=null,K=s)}else t=null,K=s;return null!==t&&(t=function(t,i,n){return n.length?i.concat(n):i}(e,t[0],t[2])),null===t&&(K=e),t}function h(){var t,i,n,e,s;if(e=K,s=K,t=u(),null!==t){for(i=[],n=H();null!==n;)i.push(n),n=H();null!==i?(n=h(),null!==n?t=[t,i,n]:(t=null,K=s)):(t=null,K=s)}else t=null,K=s;return null!==t&&(t=function(t,i,n){return i.concat(n)}(e,t[0],t[2])),null===t&&(K=e),null===t&&(e=K,t=u(),null!==t&&(t=function(t,i){return i}(e,t)),null===t&&(K=e)),t}function u(){var t;return t=c(),null===t&&(t=l(),null===t&&(t=d(),null===t&&(t=x(),null===t&&(t=v(),null===t&&(t=w(),null===t&&(t=M(),null===t&&(t=A(),null===t&&(t=I())))))))),t}function a(){var i,n,s,r,o;if(r=K,o=K,77===t.charCodeAt(K)?(i="M",K++):(i=null,0===G&&e('"M"')),null!==i){for(n=[],s=H();null!==s;)n.push(s),s=H();null!==n?(s=m(),null!==s?i=[i,n,s]:(i=null,K=o)):(i=null,K=o)}else i=null,K=o;if(null!==i&&(i=function(t,i){return U(i,!1)}(r,i[2])),null===i&&(K=r),null===i){if(r=K,o=K,109===t.charCodeAt(K)?(i="m",K++):(i=null,0===G&&e('"m"')),null!==i){for(n=[],s=H();null!==s;)n.push(s),s=H();null!==n?(s=m(),null!==s?i=[i,n,s]:(i=null,K=o)):(i=null,K=o)}else i=null,K=o;null!==i&&(i=function(t,i){return U(i,!0)}(r,i[2])),null===i&&(K=r)}return i}function m(){var t,i,n,e,s;return e=K,s=K,t=D(),null!==t?(i=N(),i=null!==i?i:"",null!==i?(n=f(),null!==n?t=[t,i,n]:(t=null,K=s)):(t=null,K=s)):(t=null,K=s),null!==t&&(t=function(t,i,n){return[i].concat(n)}(e,t[0],t[2])),null===t&&(K=e),null===t&&(e=K,t=D(),null!==t&&(t=function(t,i){return[i]}(e,t)),null===t&&(K=e)),t}function c(){var i,n;return n=K,90===t.charCodeAt(K)?(i="Z",K++):(i=null,0===G&&e('"Z"')),null===i&&(122===t.charCodeAt(K)?(i="z",K++):(i=null,0===G&&e('"z"'))),null!==i&&(i=function(){return{cmd:"close"}}(n,i)),null===i&&(K=n),i}function l(){var i,n,s,r,o;if(r=K,o=K,76===t.charCodeAt(K)?(i="L",K++):(i=null,0===G&&e('"L"')),null!==i){for(n=[],s=H();null!==s;)n.push(s),s=H();null!==n?(s=f(),null!==s?i=[i,n,s]:(i=null,K=o)):(i=null,K=o)}else i=null,K=o;if(null!==i&&(i=function(t,i){return i.map(function(t){return{cmd:"lineTo",args:[t.x,t.y]}})}(r,i[2])),null===i&&(K=r),null===i){if(r=K,o=K,108===t.charCodeAt(K)?(i="l",K++):(i=null,0===G&&e('"l"')),null!==i){for(n=[],s=H();null!==s;)n.push(s),s=H();null!==n?(s=f(),null!==s?i=[i,n,s]:(i=null,K=o)):(i=null,K=o)}else i=null,K=o;null!==i&&(i=function(t,i){return i.map(function(t){return{cmd:"lineToRelative",args:[t.x,t.y]}})}(r,i[2])),null===i&&(K=r)}return i}function f(){var t,i,n,e,s;return e=K,s=K,t=D(),null!==t?(i=N(),i=null!==i?i:"",null!==i?(n=f(),null!==n?t=[t,i,n]:(t=null,K=s)):(t=null,K=s)):(t=null,K=s),null!==t&&(t=function(t,i,n){return[i].concat(n)}(e,t[0],t[2])),null===t&&(K=e),null===t&&(e=K,t=D(),null!==t&&(t=function(t,i){return[i]}(e,t)),null===t&&(K=e)),t}function d(){var i,n,s,r,o;if(r=K,o=K,72===t.charCodeAt(K)?(i="H",K++):(i=null,0===G&&e('"H"')),null!==i){for(n=[],s=H();null!==s;)n.push(s),s=H();null!==n?(s=g(),null!==s?i=[i,n,s]:(i=null,K=o)):(i=null,K=o)}else i=null,K=o;if(null!==i&&(i=function(t,i){return i.map(function(t){return{cmd:"horizontalLineTo",args:[t]}})}(r,i[2])),null===i&&(K=r),null===i){if(r=K,o=K,104===t.charCodeAt(K)?(i="h",K++):(i=null,0===G&&e('"h"')),null!==i){for(n=[],s=H();null!==s;)n.push(s),s=H();null!==n?(s=g(),null!==s?i=[i,n,s]:(i=null,K=o)):(i=null,K=o)}else i=null,K=o;null!==i&&(i=function(t,i){return i.map(function(t){return{cmd:"horizontalLineToRelative",args:[t]}})}(r,i[2])),null===i&&(K=r)}return i}function g(){var t,i,n,e,s;return e=K,s=K,t=X(),null!==t?(i=N(),i=null!==i?i:"",null!==i?(n=g(),null!==n?t=[t,i,n]:(t=null,K=s)):(t=null,K=s)):(t=null,K=s),null!==t&&(t=function(t,i,n){return[i].concat(n)}(e,t[0],t[2])),null===t&&(K=e),null===t&&(e=K,t=X(),null!==t&&(t=function(t,i){return[i]}(e,t)),null===t&&(K=e)),t}function x(){var i,n,s,r,o;if(r=K,o=K,86===t.charCodeAt(K)?(i="V",K++):(i=null,0===G&&e('"V"')),null!==i){for(n=[],s=H();null!==s;)n.push(s),s=H();null!==n?(s=p(),null!==s?i=[i,n,s]:(i=null,K=o)):(i=null,K=o)}else i=null,K=o;if(null!==i&&(i=function(t,i){return i.map(function(t){return{cmd:"verticalLineTo",args:[t]}})}(r,i[2])),null===i&&(K=r),null===i){if(r=K,o=K,118===t.charCodeAt(K)?(i="v",K++):(i=null,0===G&&e('"v"')),null!==i){for(n=[],s=H();null!==s;)n.push(s),s=H();null!==n?(s=p(),null!==s?i=[i,n,s]:(i=null,K=o)):(i=null,K=o)}else i=null,K=o;null!==i&&(i=function(t,i){return i.map(function(t){return{cmd:"verticalLineToRelative",args:[t]}})}(r,i[2])),null===i&&(K=r)}return i}function p(){var t,i,n,e,s;return e=K,s=K,t=X(),null!==t?(i=N(),i=null!==i?i:"",null!==i?(n=p(),null!==n?t=[t,i,n]:(t=null,K=s)):(t=null,K=s)):(t=null,K=s),null!==t&&(t=function(t,i,n){return[i].concat(n)}(e,t[0],t[2])),null===t&&(K=e),null===t&&(e=K,t=X(),null!==t&&(t=function(t,i){return[i]}(e,t)),null===t&&(K=e)),t}function v(){var i,n,s,r,o;if(r=K,o=K,67===t.charCodeAt(K)?(i="C",K++):(i=null,0===G&&e('"C"')),null!==i){for(n=[],s=H();null!==s;)n.push(s),s=H();null!==n?(s=T(),null!==s?i=[i,n,s]:(i=null,K=o)):(i=null,K=o)}else i=null,K=o;if(null!==i&&(i=function(t,i){return i.map(function(t){return{cmd:"cubicCurveTo",args:t}})}(r,i[2])),null===i&&(K=r),null===i){if(r=K,o=K,99===t.charCodeAt(K)?(i="c",K++):(i=null,0===G&&e('"c"')),null!==i){for(n=[],s=H();null!==s;)n.push(s),s=H();null!==n?(s=T(),null!==s?i=[i,n,s]:(i=null,K=o)):(i=null,K=o)}else i=null,K=o;null!==i&&(i=function(t,i){return i.map(function(t){return{cmd:"cubicCurveToRelative",args:t}})}(r,i[2])),null===i&&(K=r)}return i}function T(){var t,i,n,e,s;return e=K,s=K,t=_(),null!==t?(i=N(),i=null!==i?i:"",null!==i?(n=T(),null!==n?t=[t,i,n]:(t=null,K=s)):(t=null,K=s)):(t=null,K=s),null!==t&&(t=function(t,i,n){return[i].concat(n)}(e,t[0],t[2])),null===t&&(K=e),null===t&&(e=K,t=_(),null!==t&&(t=function(t,i){return[i]}(e,t)),null===t&&(K=e)),t}function _(){var t,i,n,e,s,r,o;return r=K,o=K,t=D(),null!==t?(i=N(),i=null!==i?i:"",null!==i?(n=D(),null!==n?(e=N(),e=null!==e?e:"",null!==e?(s=D(),null!==s?t=[t,i,n,e,s]:(t=null,K=o)):(t=null,K=o)):(t=null,K=o)):(t=null,K=o)):(t=null,K=o),null!==t&&(t=function(t,i,n,e){return[i.x,i.y,n.x,n.y,e.x,e.y]}(r,t[0],t[2],t[4])),null===t&&(K=r),t}function w(){var i,n,s,r,o;if(r=K,o=K,83===t.charCodeAt(K)?(i="S",K++):(i=null,0===G&&e('"S"')),null!==i){for(n=[],s=H();null!==s;)n.push(s),s=H();null!==n?(s=y(),null!==s?i=[i,n,s]:(i=null,K=o)):(i=null,K=o)}else i=null,K=o;if(null!==i&&(i=function(t,i){return i.map(function(t){return{cmd:"smoothCubicCurveTo",args:t}})}(r,i[2])),null===i&&(K=r),null===i){if(r=K,o=K,115===t.charCodeAt(K)?(i="s",K++):(i=null,0===G&&e('"s"')),null!==i){for(n=[],s=H();null!==s;)n.push(s),s=H();null!==n?(s=y(),null!==s?i=[i,n,s]:(i=null,K=o)):(i=null,K=o)}else i=null,K=o;null!==i&&(i=function(t,i){return i.map(function(t){return{cmd:"smoothCubicCurveToRelative",args:t}})}(r,i[2])),null===i&&(K=r)}return i}function y(){var t,i,n,e,s;return e=K,s=K,t=b(),null!==t?(i=N(),i=null!==i?i:"",null!==i?(n=y(),null!==n?t=[t,i,n]:(t=null,K=s)):(t=null,K=s)):(t=null,K=s),null!==t&&(t=function(t,i,n){return[i].concat(n)}(e,t[0],t[2])),null===t&&(K=e),null===t&&(e=K,t=b(),null!==t&&(t=function(t,i){return[i]}(e,t)),null===t&&(K=e)),t}function b(){var t,i,n,e,s;return e=K,s=K,t=D(),null!==t?(i=N(),i=null!==i?i:"",null!==i?(n=D(),null!==n?t=[t,i,n]:(t=null,K=s)):(t=null,K=s)):(t=null,K=s),null!==t&&(t=function(t,i,n){return[i.x,i.y,n.x,n.y]}(e,t[0],t[2])),null===t&&(K=e),t}function M(){var i,n,s,r,o;if(r=K,o=K,81===t.charCodeAt(K)?(i="Q",K++):(i=null,0===G&&e('"Q"')),null!==i){for(n=[],s=H();null!==s;)n.push(s),s=H();null!==n?(s=E(),null!==s?i=[i,n,s]:(i=null,K=o)):(i=null,K=o)}else i=null,K=o;if(null!==i&&(i=function(t,i){return i.map(function(t){return{cmd:"quadraticCurveTo",args:t}})}(r,i[2])),null===i&&(K=r),null===i){if(r=K,o=K,113===t.charCodeAt(K)?(i="q",K++):(i=null,0===G&&e('"q"')),null!==i){for(n=[],s=H();null!==s;)n.push(s),s=H();null!==n?(s=E(),null!==s?i=[i,n,s]:(i=null,K=o)):(i=null,K=o)}else i=null,K=o;null!==i&&(i=function(t,i){return i.map(function(t){return{cmd:"quadraticCurveToRelative",args:t}})}(r,i[2])),null===i&&(K=r)}return i}function E(){var t,i,n,e,s;return e=K,s=K,t=O(),null!==t?(i=N(),i=null!==i?i:"",null!==i?(n=E(),null!==n?t=[t,i,n]:(t=null,K=s)):(t=null,K=s)):(t=null,K=s),null!==t&&(t=function(t,i,n){return[i].concat(n)}(e,t[0],t[2])),null===t&&(K=e),null===t&&(e=K,t=O(),null!==t&&(t=function(t,i){return[i]}(e,t)),null===t&&(K=e)),t}function O(){var t,i,n,e,s;return e=K,s=K,t=D(),null!==t?(i=N(),i=null!==i?i:"",null!==i?(n=D(),null!==n?t=[t,i,n]:(t=null,K=s)):(t=null,K=s)):(t=null,K=s),null!==t&&(t=function(t,i,n){return[i.x,i.y,n.x,n.y]}(e,t[0],t[2])),null===t&&(K=e),t}function A(){var i,n,s,r,o;if(r=K,o=K,84===t.charCodeAt(K)?(i="T",K++):(i=null,0===G&&e('"T"')),null!==i){for(n=[],s=H();null!==s;)n.push(s),s=H();null!==n?(s=P(),null!==s?i=[i,n,s]:(i=null,K=o)):(i=null,K=o)}else i=null,K=o;if(null!==i&&(i=function(t,i){return i.map(function(t){return{cmd:"smoothQuadraticCurveTo",args:[t.x,t.y]}})}(r,i[2])),null===i&&(K=r),null===i){if(r=K,o=K,116===t.charCodeAt(K)?(i="t",K++):(i=null,0===G&&e('"t"')),null!==i){for(n=[],s=H();null!==s;)n.push(s),s=H();null!==n?(s=P(),null!==s?i=[i,n,s]:(i=null,K=o)):(i=null,K=o)}else i=null,K=o;null!==i&&(i=function(t,i){return i.map(function(t){return{cmd:"smoothQuadraticCurveToRelative",args:[t.x,t.y]}})}(r,i[2])),null===i&&(K=r)}return i}function P(){var t,i,n,e,s;return e=K,s=K,t=D(),null!==t?(i=N(),i=null!==i?i:"",null!==i?(n=P(),null!==n?t=[t,i,n]:(t=null,K=s)):(t=null,K=s)):(t=null,K=s),null!==t&&(t=function(t,i,n){return[i].concat(n)}(e,t[0],t[2])),null===t&&(K=e),null===t&&(e=K,t=D(),null!==t&&(t=function(t,i){return[i]}(e,t)),null===t&&(K=e)),t}function I(){var i,n,s,r,o;if(r=K,o=K,65===t.charCodeAt(K)?(i="A",K++):(i=null,0===G&&e('"A"')),null!==i){for(n=[],s=H();null!==s;)n.push(s),s=H();null!==n?(s=S(),null!==s?i=[i,n,s]:(i=null,K=o)):(i=null,K=o)}else i=null,K=o;if(null!==i&&(i=function(t,i){return i.map(function(t){return{cmd:"ellipticalArcTo",args:t}})}(r,i[2])),null===i&&(K=r),null===i){if(r=K,o=K,97===t.charCodeAt(K)?(i="a",K++):(i=null,0===G&&e('"a"')),null!==i){for(n=[],s=H();null!==s;)n.push(s),s=H();null!==n?(s=S(),null!==s?i=[i,n,s]:(i=null,K=o)):(i=null,K=o)}else i=null,K=o;null!==i&&(i=function(t,i){return i.map(function(t){return{cmd:"ellipticalArcToRelative",args:t}})}(r,i[2])),null===i&&(K=r)}return i}function S(){var t,i,n,e,s;return e=K,s=K,t=Y(),null!==t?(i=N(),i=null!==i?i:"",null!==i?(n=S(),null!==n?t=[t,i,n]:(t=null,K=s)):(t=null,K=s)):(t=null,K=s),null!==t&&(t=function(t,i,n){return[i].concat(n)}(e,t[0],t[2])),null===t&&(K=e),null===t&&(e=K,t=Y(),null!==t&&(t=function(t,i){return[i]}(e,t)),null===t&&(K=e)),t}function Y(){var t,i,n,e,s,r,o,h,u,a,m,c,l;return c=K,l=K,t=C(),null!==t?(i=N(),i=null!==i?i:"",null!==i?(n=C(),null!==n?(e=N(),e=null!==e?e:"",null!==e?(s=X(),null!==s?(r=N(),null!==r?(o=R(),null!==o?(h=N(),h=null!==h?h:"",null!==h?(u=R(),null!==u?(a=N(),a=null!==a?a:"",null!==a?(m=D(),null!==m?t=[t,i,n,e,s,r,o,h,u,a,m]:(t=null,K=l)):(t=null,K=l)):(t=null,K=l)):(t=null,K=l)):(t=null,K=l)):(t=null,K=l)):(t=null,K=l)):(t=null,K=l)):(t=null,K=l)):(t=null,K=l)):(t=null,K=l),null!==t&&(t=function(t,i,n,e,s,r,o){return[i,n,e,s,r,o.x,o.y]}(c,t[0],t[2],t[4],t[6],t[8],t[10])),null===t&&(K=c),t}function D(){var t,i,n,e,s;return e=K,s=K,t=X(),null!==t?(i=N(),i=null!==i?i:"",null!==i?(n=X(),null!==n?t=[t,i,n]:(t=null,K=s)):(t=null,K=s)):(t=null,K=s),null!==t&&(t=function(t,i,n){return{x:i,y:n}}(e,t[0],t[2])),null===t&&(K=e),t}function C(){var t,i;return i=K,t=j(),null!==t&&(t=function(t,i){return parseFloat(i,10)}(i,t)),null===t&&(K=i),null===t&&(i=K,t=L(),null!==t&&(t=function(t,i){return parseInt(i,10)}(i,t)),null===t&&(K=i)),t}function X(){var t,i,n,e;return n=K,e=K,t=q(),t=null!==t?t:"",null!==t?(i=j(),null!==i?t=[t,i]:(t=null,K=e)):(t=null,K=e),null!==t&&(t=function(t,i,n){return parseFloat(i+n,10)}(n,t[0],t[1])),null===t&&(K=n),null===t&&(n=K,e=K,t=q(),t=null!==t?t:"",null!==t?(i=L(),null!==i?t=[t,i]:(t=null,K=e)):(t=null,K=e),null!==t&&(t=function(t,i,n){return parseInt(i+n,10)}(n,t[0],t[1])),null===t&&(K=n)),t}function R(){var i,n;return n=K,48===t.charCodeAt(K)?(i="0",K++):(i=null,0===G&&e('"0"')),null!==i&&(i=function(){return!1}(n)),null===i&&(K=n),null===i&&(n=K,49===t.charCodeAt(K)?(i="1",K++):(i=null,0===G&&e('"1"')),null!==i&&(i=function(){return!0}(n)),null===i&&(K=n)),i}function N(){var t,i,n,e,s;if(s=K,i=H(),null!==i)for(t=[];null!==i;)t.push(i),i=H();else t=null;if(null!==t)if(i=V(),i=null!==i?i:"",null!==i){for(n=[],e=H();null!==e;)n.push(e),e=H();null!==n?t=[t,i,n]:(t=null,K=s)}else t=null,K=s;else t=null,K=s;if(null===t)if(s=K,t=V(),null!==t){for(i=[],n=H();null!==n;)i.push(n),n=H();null!==i?t=[t,i]:(t=null,K=s)}else t=null,K=s;return t}function V(){var i;return 44===t.charCodeAt(K)?(i=",",K++):(i=null,0===G&&e('","')),i}function j(){var t,i,n,e;return n=K,e=K,t=z(),null!==t?(i=F(),i=null!==i?i:"",null!==i?t=[t,i]:(t=null,K=e)):(t=null,K=e),null!==t&&(t=function(t,i,n){return i+n}(n,t[0],t[1])),null===t&&(K=n),null===t&&(n=K,e=K,t=L(),null!==t?(i=F(),null!==i?t=[t,i]:(t=null,K=e)):(t=null,K=e),null!==t&&(t=function(t,i,n){return i+n}(n,t[0],t[1])),null===t&&(K=n)),t}function z(){var i,n,s,r,o;return r=K,o=K,i=L(),i=null!==i?i:"",null!==i?(46===t.charCodeAt(K)?(n=".",K++):(n=null,0===G&&e('"."')),null!==n?(s=L(),null!==s?i=[i,n,s]:(i=null,K=o)):(i=null,K=o)):(i=null,K=o),null!==i&&(i=function(t,i,n){return i+"."+n}(r,i[0],i[2])),null===i&&(K=r),null===i&&(r=K,o=K,i=L(),null!==i?(46===t.charCodeAt(K)?(n=".",K++):(n=null,0===G&&e('"."')),null!==n?i=[i,n]:(i=null,K=o)):(i=null,K=o),null!==i&&(i=function(t,i){return i}(r,i[0])),null===i&&(K=r)),i}function F(){var i,n,s,r,o;return r=K,o=K,101===t.charCodeAt(K)?(i="e",K++):(i=null,0===G&&e('"e"')),null===i&&(69===t.charCodeAt(K)?(i="E",K++):(i=null,0===G&&e('"E"'))),null!==i?(n=q(),n=null!==n?n:"",null!==n?(s=L(),null!==s?i=[i,n,s]:(i=null,K=o)):(i=null,K=o)):(i=null,K=o),null!==i&&(i=function(t,i,n,e){return i+n+e}(r,i[0],i[1],i[2])),null===i&&(K=r),i}function q(){var i;return 43===t.charCodeAt(K)?(i="+",K++):(i=null,0===G&&e('"+"')),null===i&&(45===t.charCodeAt(K)?(i="-",K++):(i=null,0===G&&e('"-"'))),i}function L(){var t,i,n,e;return n=K,e=K,t=Z(),null!==t?(i=L(),null!==i?t=[t,i]:(t=null,K=e)):(t=null,K=e),null!==t&&(t=function(t,i,n){return i+n}(n,t[0],t[1])),null===t&&(K=n),null===t&&(t=Z()),t}function Z(){var i;return/^[0-9]/.test(t.charAt(K))?(i=t.charAt(K),K++):(i=null,0===G&&e("[0-9]")),i}function H(){var i;return 32===t.charCodeAt(K)?(i=" ",K++):(i=null,0===G&&e('" "')),null===i&&(9===t.charCodeAt(K)?(i="	",K++):(i=null,0===G&&e('"\\t"')),null===i&&(13===t.charCodeAt(K)?(i="\r",K++):(i=null,0===G&&e('"\\r"')),null===i&&(10===t.charCodeAt(K)?(i="\n",K++):(i=null,0===G&&e('"\\n"'))))),i}function k(t){t.sort();for(var i=null,n=[],e=0;e<t.length;e++)t[e]!==i&&(n.push(t[e]),i=t[e]);return n}function B(){for(var i=1,n=1,e=!1,s=0;s<Math.max(K,W);s++){var r=t.charAt(s);"\n"===r?(e||i++,n=1,e=!1):"\r"===r||"\u2028"===r||"\u2029"===r?(i++,n=1,e=!0):(n++,e=!1)}return{line:i,column:n}}function U(t,i){var n=[{cmd:i?"moveToRelative":"moveTo",args:[t[0].x,t[0].y]}];if(t.length>1)for(var e=1;e<t.length;e++)n.push({cmd:i?"lineToRelative":"lineTo",args:[t[e].x,t[e].y]});return n}var Q={svgPath:s,movetoDrawtoCommandGroups:r,movetoDrawtoCommandGroup:o,drawtoCommands:h,drawtoCommand:u,moveto:a,movetoArgumentSequence:m,closepath:c,lineto:l,linetoArgumentSequence:f,horizontalLineto:d,horizontalLinetoArgumentSequence:g,verticalLineto:x,verticalLinetoArgumentSequence:p,curveto:v,curvetoArgumentSequence:T,curvetoArgument:_,smoothCurveto:w,smoothCurvetoArgumentSequence:y,smoothCurvetoArgument:b,quadraticBezierCurveto:M,quadraticBezierCurvetoArgumentSequence:E,quadraticBezierCurvetoArgument:O,smoothQuadraticBezierCurveto:A,smoothQuadraticBezierCurvetoArgumentSequence:P,ellipticalArc:I,ellipticalArcArgumentSequence:S,ellipticalArcArgument:Y,coordinatePair:D,nonnegativeNumber:C,number:X,flag:R,commaWsp:N,comma:V,floatingPointConstant:j,fractionalConstant:z,exponent:F,sign:q,digitSequence:L,digit:Z,wsp:H};if(void 0!==n){if(void 0===Q[n])throw new Error("Invalid rule name: "+i(n)+".")}else n="svgPath";var K=0,G=0,W=0,J=[],$=Q[n]();if(null===$||K!==t.length){var ti=Math.max(K,W),ii=ti<t.length?t.charAt(ti):null,ni=B();throw new this.SyntaxError(k(J),ii,ti,ni.line,ni.column)}return $},toSource:function(){return this._source}};var e=n.svgPath;return e.SyntaxError=function(t,n,e,s,r){function o(t,n){var e,s;switch(t.length){case 0:e="end of input";break;case 1:e=t[0];break;default:e=t.slice(0,t.length-1).join(", ")+" or "+t[t.length-1]}return s=n?i(n):"end of input","Expected "+e+" but "+s+" found."}this.name="SyntaxError",this.expected=t,this.found=n,this.message=o(t,n),this.offset=e,this.line=s,this.column=r},e.SyntaxError.prototype=Error.prototype,e}),n("KITE/util/LineStyles",["require","KITE/kite","DOT/Util"],function(t){var i=t("KITE/kite"),n=t("DOT/Util").lineLineIntersection;i.LineStyles=function(t){void 0===t&&(t={}),this.lineWidth=void 0!==t.lineWidth?t.lineWidth:1,this.lineCap=void 0!==t.lineCap?t.lineCap:"butt",this.lineJoin=void 0!==t.lineJoin?t.lineJoin:"miter",this.lineDash=t.lineDash?t.lineDash:[],this.lineDashOffset=void 0!==t.lineDashOffset?t.lineDashOffset:0,this.miterLimit=void 0!==t.miterLimit?t.miterLimit:10};var e=i.LineStyles;return e.prototype={constructor:e,equals:function(t){var i=this.lineWidth===t.lineWidth&&this.lineCap===t.lineCap&&this.lineJoin===t.lineJoin&&this.miterLimit===t.miterLimit&&this.lineDashOffset===t.lineDashOffset;if(!i)return!1;if(this.lineDash.length!==t.lineDash.length)return!1;for(var n=0;n<this.lineDash.length;n++)if(this.lineDash[n]!==t.lineDash[n])return!1;return!0},leftJoin:function(t,e,s){var r=t.plus(e.perpendicular().negated().times(this.lineWidth/2)),o=t.plus(s.perpendicular().negated().times(this.lineWidth/2)),h=r.equals(o)?[]:[new i.Segment.Line(r,o)];if(!(e.perpendicular().dot(s)>0))return h;switch(this.lineJoin){case"round":var u=e.angle()+Math.PI/2,a=s.angle()+Math.PI/2;return[new i.Segment.Arc(t,this.lineWidth/2,u,a,!0)];case"miter":var m=e.angleBetween(s.negated());if(1/Math.sin(m/2)<=this.miterLimit&&m<Math.PI-1e-5){var c=n(r,r.plus(e),o,o.plus(s));return[new i.Segment.Line(r,c),new i.Segment.Line(c,o)]}return h;case"bevel":return h}},rightJoin:function(t,i,n){return this.leftJoin(t,n.negated(),i.negated())},cap:function(t,n){var e=t.plus(n.perpendicular().times(-this.lineWidth/2)),s=t.plus(n.perpendicular().times(this.lineWidth/2));switch(this.lineCap){case"butt":return[new i.Segment.Line(e,s)];case"round":var r=n.angle();return[new i.Segment.Arc(t,this.lineWidth/2,r+Math.PI/2,r-Math.PI/2,!0)];case"square":var o=n.perpendicular().negated().times(this.lineWidth/2),h=n.perpendicular().times(this.lineWidth/2),u=n.times(this.lineWidth/2),a=t.plus(o).plus(u),m=t.plus(h).plus(u);return[new i.Segment.Line(e,a),new i.Segment.Line(a,m),new i.Segment.Line(m,s)]}}},i.LineStyles}),n("DOT/Vector4",["require","DOT/dot","DOT/Util"],function(t){var i=t("DOT/dot");t("DOT/Util"),i.Vector4=function(t,i,n,e){this.x=t||0,this.y=i||0,this.z=n||0,this.w=void 0!==e?e:1};var n=i.Vector4;n.prototype={constructor:n,isVector4:!0,dimension:4,magnitude:function(){return Math.sqrt(this.magnitudeSquared())},magnitudeSquared:function(){this.dot(this)},distance:function(t){return this.minus(t).magnitude()},distanceSquared:function(t){return this.minus(t).magnitudeSquared()},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},isFinite:function(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.z)&&isFinite(this.w)},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w},equalsEpsilon:function(t,i){return i||(i=0),Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)+Math.abs(this.w-t.w)<=i},copy:function(t){return t?t.set(this):new n(this.x,this.y,this.z,this.w)},normalized:function(){var t=this.magnitude();if(0===t)throw new Error("Cannot normalize a zero-magnitude vector");return new n(this.x/t,this.y/t,this.z/t,this.w/t)},timesScalar:function(t){return new n(this.x*t,this.y*t,this.z*t,this.w*t)},times:function(t){return this.timesScalar(t)},componentTimes:function(t){return new n(this.x*t.x,this.y*t.y,this.z*t.z,this.w*t.w)},plus:function(t){return new n(this.x+t.x,this.y+t.y,this.z+t.z,this.w+t.w)},plusScalar:function(t){return new n(this.x+t,this.y+t,this.z+t,this.w+t)},minus:function(t){return new n(this.x-t.x,this.y-t.y,this.z-t.z,this.w-t.w)},minusScalar:function(t){return new n(this.x-t,this.y-t,this.z-t,this.w-t)},dividedScalar:function(t){return new n(this.x/t,this.y/t,this.z/t,this.w/t)},negated:function(){return new n(-this.x,-this.y,-this.z,-this.w)},angleBetween:function(t){return Math.acos(i.clamp(this.normalized().dot(t.normalized()),-1,1))},blend:function(t,i){return this.plus(t.minus(this).times(i))},average:function(t){return this.blend(t,.5)},toString:function(){return"Vector4("+this.x+", "+this.y+", "+this.z+", "+this.w+")"},toVector3:function(){return new i.Vector3(this.x,this.y,this.z)},setXYZW:function(t,i,n,e){return this.x=t,this.y=i,this.z=n,this.w=e,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this
},set:function(t){return this.setXYZW(t.x,t.y,t.z,t.w)},add:function(t){return this.setXYZW(this.x+t.x,this.y+t.y,this.z+t.z,this.w+t.w)},addScalar:function(t){return this.setXYZW(this.x+t,this.y+t,this.z+t,this.w+t)},subtract:function(t){return this.setXYZW(this.x-t.x,this.y-t.y,this.z-t.z,this.w-t.w)},subtractScalar:function(t){return this.setXYZW(this.x-t,this.y-t,this.z-t,this.w-t)},multiplyScalar:function(t){return this.setXYZW(this.x*t,this.y*t,this.z*t,this.w*t)},multiply:function(t){return this.multiplyScalar(t)},componentMultiply:function(t){return this.setXYZW(this.x*t.x,this.y*t.y,this.z*t.z,this.w*t.w)},divideScalar:function(t){return this.setXYZW(this.x/t,this.y/t,this.z/t,this.w/t)},negate:function(){return this.setXYZW(-this.x,-this.y,-this.z,-this.w)},normalize:function(){var t=this.magnitude();if(0===t)throw new Error("Cannot normalize a zero-magnitude vector");return this.divideScalar(t)}},n.Immutable=function(t,i,n,e){this.x=t||0,this.y=i||0,this.z=n||0,this.w=void 0!==e?e:1};var e=n.Immutable;return e.prototype=new n,e.prototype.constructor=e,e.mutableOverrideHelper=function(t){e.prototype[t]=function(){throw new Error("Cannot call mutable method '"+t+"' on immutable Vector4")}},e.mutableOverrideHelper("setXYZW"),e.mutableOverrideHelper("setX"),e.mutableOverrideHelper("setY"),e.mutableOverrideHelper("setZ"),e.mutableOverrideHelper("setW"),n.ZERO=new e(0,0,0,0),n.X_UNIT=new e(1,0,0,0),n.Y_UNIT=new e(0,1,0,0),n.Z_UNIT=new e(0,0,1,0),n.W_UNIT=new e(0,0,0,1),n}),n("DOT/Vector3",["require","DOT/dot","DOT/Util","DOT/Vector2","DOT/Vector4"],function(t){var i=t("DOT/dot");t("DOT/Util"),t("DOT/Vector2"),t("DOT/Vector4"),i.Vector3=function(t,i,n){this.x=t||0,this.y=i||0,this.z=n||0};var n=i.Vector3;n.prototype={constructor:n,isVector3:!0,dimension:3,magnitude:function(){return Math.sqrt(this.magnitudeSquared())},magnitudeSquared:function(){return this.dot(this)},distance:function(t){return Math.sqrt(this.distanceSquared(t))},distanceSquared:function(t){var i=this.x-t.x,n=this.y-t.y,e=this.z-t.z;return i*i+n*n+e*e},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},isFinite:function(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.z)},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z},equalsEpsilon:function(t,i){return i||(i=0),Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)<=i},copy:function(t){return t?t.set(this):new n(this.x,this.y,this.z)},cross:function(t){return new n(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)},normalized:function(){var t=this.magnitude();if(0===t)throw new Error("Cannot normalize a zero-magnitude vector");return new n(this.x/t,this.y/t,this.z/t)},withMagnitude:function(t){return this.copy().setMagnitude(t)},timesScalar:function(t){return new n(this.x*t,this.y*t,this.z*t)},times:function(t){return this.timesScalar(t)},componentTimes:function(t){return new n(this.x*t.x,this.y*t.y,this.z*t.z)},plus:function(t){return new n(this.x+t.x,this.y+t.y,this.z+t.z)},plusScalar:function(t){return new n(this.x+t,this.y+t,this.z+t)},minus:function(t){return new n(this.x-t.x,this.y-t.y,this.z-t.z)},minusScalar:function(t){return new n(this.x-t,this.y-t,this.z-t)},dividedScalar:function(t){return new n(this.x/t,this.y/t,this.z/t)},negated:function(){return new n(-this.x,-this.y,-this.z)},angleBetween:function(t){return Math.acos(i.clamp(this.normalized().dot(t.normalized()),-1,1))},blend:function(t,i){return this.plus(t.minus(this).times(i))},average:function(t){return this.blend(t,.5)},toString:function(){return"Vector3("+this.x+", "+this.y+", "+this.z+")"},toVector2:function(){return new i.Vector2(this.x,this.y)},toVector4:function(){return new i.Vector4(this.x,this.y,this.z)},setXYZ:function(t,i,n){return this.x=t,this.y=i,this.z=n,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},set:function(t){return this.setXYZ(t.x,t.y,t.z)},setMagnitude:function(t){var i=t/this.magnitude();return this.multiplyScalar(i)},add:function(t){return this.setXYZ(this.x+t.x,this.y+t.y,this.z+t.z)},addScalar:function(t){return this.setXYZ(this.x+t,this.y+t,this.z+t)},subtract:function(t){return this.setXYZ(this.x-t.x,this.y-t.y,this.z-t.z)},subtractScalar:function(t){return this.setXYZ(this.x-t,this.y-t,this.z-t)},multiplyScalar:function(t){return this.setXYZ(this.x*t,this.y*t,this.z*t)},multiply:function(t){return this.multiplyScalar(t)},componentMultiply:function(t){return this.setXYZ(this.x*t.x,this.y*t.y,this.z*t.z)},divideScalar:function(t){return this.setXYZ(this.x/t,this.y/t,this.z/t)},negate:function(){return this.setXYZ(-this.x,-this.y,-this.z)},normalize:function(){var t=this.magnitude();if(0===t)throw new Error("Cannot normalize a zero-magnitude vector");return this.divideScalar(t)}},n.slerp=function(t,n,e){return i.Quaternion.slerp(new i.Quaternion,i.Quaternion.getRotationQuaternion(t,n),e).timesVector3(t)},n.Immutable=function(t,i,n){this.x=t||0,this.y=i||0,this.z=n||0};var e=n.Immutable;return e.prototype=new n,e.prototype.constructor=e,e.mutableOverrideHelper=function(t){e.prototype[t]=function(){throw new Error("Cannot call mutable method '"+t+"' on immutable Vector3")}},e.mutableOverrideHelper("setXYZ"),e.mutableOverrideHelper("setX"),e.mutableOverrideHelper("setY"),e.mutableOverrideHelper("setZ"),n.ZERO=new e(0,0,0),n.X_UNIT=new e(1,0,0),n.Y_UNIT=new e(0,1,0),n.Z_UNIT=new e(0,0,1),n}),n("DOT/Matrix4",["require","DOT/dot","DOT/Vector3","DOT/Vector4"],function(t){var i=t("DOT/dot");t("DOT/Vector3"),t("DOT/Vector4");var n=window.Float32Array||Array;i.Matrix4=function(t,i,e,s,r,o,h,u,a,m,c,l,f,d,g,x,p){this.entries=new n(16),this.rowMajor(void 0===t?1:t,i||0,e||0,s||0,r||0,void 0===o?1:o,h||0,u||0,a||0,m||0,void 0===c?1:c,l||0,f||0,d||0,g||0,void 0===x?1:x,p)};var e=i.Matrix4;e.Types={OTHER:0,IDENTITY:1,TRANSLATION_3D:2,SCALING:3,AFFINE:4};var s=e.Types;return e.identity=function(){return new e(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,s.IDENTITY)},e.translation=function(t,i,n){return new e(1,0,0,t,0,1,0,i,0,0,1,n,0,0,0,1,s.TRANSLATION_3D)},e.translationFromVector=function(t){return e.translation(t.x,t.y,t.z)},e.scaling=function(t,i,n){return i=void 0===i?t:i,n=void 0===n?t:n,new e(t,0,0,0,0,i,0,0,0,0,n,0,0,0,0,1,s.SCALING)},e.rotationAxisAngle=function(t,i){var n=Math.cos(i),r=Math.sin(i),o=1-n;return new e(t.x*t.x*o+n,t.x*t.y*o-t.z*r,t.x*t.z*o+t.y*r,0,t.y*t.x*o+t.z*r,t.y*t.y*o+n,t.y*t.z*o-t.x*r,0,t.z*t.x*o-t.y*r,t.z*t.y*o+t.x*r,t.z*t.z*o+n,0,0,0,0,1,s.AFFINE)},e.rotationX=function(t){var i=Math.cos(t),n=Math.sin(t);return new e(1,0,0,0,0,i,-n,0,0,n,i,0,0,0,0,1,s.AFFINE)},e.rotationY=function(t){var i=Math.cos(t),n=Math.sin(t);return new e(i,0,n,0,0,1,0,0,-n,0,i,0,0,0,0,1,s.AFFINE)},e.rotationZ=function(t){var i=Math.cos(t),n=Math.sin(t);return new e(i,-n,0,0,n,i,0,0,0,0,1,0,0,0,0,1,s.AFFINE)},e.gluPerspective=function(t,i,n,s){var r=Math.cos(t)/Math.sin(t);return new e(r/i,0,0,0,0,r,0,0,0,0,(s+n)/(n-s),2*s*n/(n-s),0,0,-1,0)},e.prototype={constructor:e,rowMajor:function(t,i,n,e,r,o,h,u,a,m,c,l,f,d,g,x,p){return this.entries[0]=t,this.entries[1]=r,this.entries[2]=a,this.entries[3]=f,this.entries[4]=i,this.entries[5]=o,this.entries[6]=m,this.entries[7]=d,this.entries[8]=n,this.entries[9]=h,this.entries[10]=c,this.entries[11]=g,this.entries[12]=e,this.entries[13]=u,this.entries[14]=l,this.entries[15]=x,this.type=void 0===p?0===f&&0===d&&0===g&&1===x?s.AFFINE:s.OTHER:p,this},columnMajor:function(t,i,n,e,s,r,o,h,u,a,m,c,l,f,d,g,x){return this.rowMajor(t,s,u,l,i,r,a,f,n,o,m,d,e,h,c,g,x)},set:function(t){return this.rowMajor(t.m00(),t.m01(),t.m02(),t.m03(),t.m10(),t.m11(),t.m12(),t.m13(),t.m20(),t.m21(),t.m22(),t.m23(),t.m30(),t.m31(),t.m32(),t.m33(),t.type)},m00:function(){return this.entries[0]},m01:function(){return this.entries[4]},m02:function(){return this.entries[8]},m03:function(){return this.entries[12]},m10:function(){return this.entries[1]},m11:function(){return this.entries[5]},m12:function(){return this.entries[9]},m13:function(){return this.entries[13]},m20:function(){return this.entries[2]},m21:function(){return this.entries[6]},m22:function(){return this.entries[10]},m23:function(){return this.entries[14]},m30:function(){return this.entries[3]},m31:function(){return this.entries[7]},m32:function(){return this.entries[11]},m33:function(){return this.entries[15]},isFinite:function(){return isFinite(this.m00())&&isFinite(this.m01())&&isFinite(this.m02())&&isFinite(this.m03())&&isFinite(this.m10())&&isFinite(this.m11())&&isFinite(this.m12())&&isFinite(this.m13())&&isFinite(this.m20())&&isFinite(this.m21())&&isFinite(this.m22())&&isFinite(this.m23())&&isFinite(this.m30())&&isFinite(this.m31())&&isFinite(this.m32())&&isFinite(this.m33())},getTranslation:function(){return new i.Vector3(this.m03(),this.m13(),this.m23())},get translation(){return this.getTranslation()},getScaleVector:function(){var t=this.m00()+this.m03(),n=this.m10()+this.m13(),e=this.m20()+this.m23(),s=this.m30()+this.m33(),r=this.m01()+this.m03(),o=this.m11()+this.m13(),h=this.m21()+this.m23(),u=this.m31()+this.m33(),a=this.m02()+this.m03(),m=this.m12()+this.m13(),c=this.m22()+this.m23(),l=this.m32()+this.m33();return new i.Vector3(Math.sqrt(t*t+n*n+e*e+s*s),Math.sqrt(r*r+o*o+h*h+u*u),Math.sqrt(a*a+m*m+c*c+l*l))},get scaleVector(){return this.getScaleVector()},getCSSTransform:function(){return"matrix3d("+this.entries[0].toFixed(20)+","+this.entries[1].toFixed(20)+","+this.entries[2].toFixed(20)+","+this.entries[3].toFixed(20)+","+this.entries[4].toFixed(20)+","+this.entries[5].toFixed(20)+","+this.entries[6].toFixed(20)+","+this.entries[7].toFixed(20)+","+this.entries[8].toFixed(20)+","+this.entries[9].toFixed(20)+","+this.entries[10].toFixed(20)+","+this.entries[11].toFixed(20)+","+this.entries[12].toFixed(20)+","+this.entries[13].toFixed(20)+","+this.entries[14].toFixed(20)+","+this.entries[15].toFixed(20)+")"},get cssTransform(){return this.getCSSTransform()},equals:function(t){return this.m00()===t.m00()&&this.m01()===t.m01()&&this.m02()===t.m02()&&this.m03()===t.m03()&&this.m10()===t.m10()&&this.m11()===t.m11()&&this.m12()===t.m12()&&this.m13()===t.m13()&&this.m20()===t.m20()&&this.m21()===t.m21()&&this.m22()===t.m22()&&this.m23()===t.m23()&&this.m30()===t.m30()&&this.m31()===t.m31()&&this.m32()===t.m32()&&this.m33()===t.m33()},equalsEpsilon:function(t,i){return Math.abs(this.m00()-t.m00())<i&&Math.abs(this.m01()-t.m01())<i&&Math.abs(this.m02()-t.m02())<i&&Math.abs(this.m03()-t.m03())<i&&Math.abs(this.m10()-t.m10())<i&&Math.abs(this.m11()-t.m11())<i&&Math.abs(this.m12()-t.m12())<i&&Math.abs(this.m13()-t.m13())<i&&Math.abs(this.m20()-t.m20())<i&&Math.abs(this.m21()-t.m21())<i&&Math.abs(this.m22()-t.m22())<i&&Math.abs(this.m23()-t.m23())<i&&Math.abs(this.m30()-t.m30())<i&&Math.abs(this.m31()-t.m31())<i&&Math.abs(this.m32()-t.m32())<i&&Math.abs(this.m33()-t.m33())<i},copy:function(){return new e(this.m00(),this.m01(),this.m02(),this.m03(),this.m10(),this.m11(),this.m12(),this.m13(),this.m20(),this.m21(),this.m22(),this.m23(),this.m30(),this.m31(),this.m32(),this.m33(),this.type)},plus:function(t){return new e(this.m00()+t.m00(),this.m01()+t.m01(),this.m02()+t.m02(),this.m03()+t.m03(),this.m10()+t.m10(),this.m11()+t.m11(),this.m12()+t.m12(),this.m13()+t.m13(),this.m20()+t.m20(),this.m21()+t.m21(),this.m22()+t.m22(),this.m23()+t.m23(),this.m30()+t.m30(),this.m31()+t.m31(),this.m32()+t.m32(),this.m33()+t.m33())},minus:function(t){return new e(this.m00()-t.m00(),this.m01()-t.m01(),this.m02()-t.m02(),this.m03()-t.m03(),this.m10()-t.m10(),this.m11()-t.m11(),this.m12()-t.m12(),this.m13()-t.m13(),this.m20()-t.m20(),this.m21()-t.m21(),this.m22()-t.m22(),this.m23()-t.m23(),this.m30()-t.m30(),this.m31()-t.m31(),this.m32()-t.m32(),this.m33()-t.m33())},transposed:function(){return new e(this.m00(),this.m10(),this.m20(),this.m30(),this.m01(),this.m11(),this.m21(),this.m31(),this.m02(),this.m12(),this.m22(),this.m32(),this.m03(),this.m13(),this.m23(),this.m33())},negated:function(){return new e(-this.m00(),-this.m01(),-this.m02(),-this.m03(),-this.m10(),-this.m11(),-this.m12(),-this.m13(),-this.m20(),-this.m21(),-this.m22(),-this.m23(),-this.m30(),-this.m31(),-this.m32(),-this.m33())},inverted:function(){switch(this.type){case s.IDENTITY:return this;case s.TRANSLATION_3D:return new e(1,0,0,-this.m03(),0,1,0,-this.m13(),0,0,1,-this.m23(),0,0,0,1,s.TRANSLATION_3D);case s.SCALING:return new e(1/this.m00(),0,0,0,0,1/this.m11(),0,0,0,0,1/this.m22(),0,0,0,0,1/this.m33(),s.SCALING);case s.AFFINE:case s.OTHER:var t=this.getDeterminant();if(0!==t)return new e((-this.m31()*this.m22()*this.m13()+this.m21()*this.m32()*this.m13()+this.m31()*this.m12()*this.m23()-this.m11()*this.m32()*this.m23()-this.m21()*this.m12()*this.m33()+this.m11()*this.m22()*this.m33())/t,(this.m31()*this.m22()*this.m03()-this.m21()*this.m32()*this.m03()-this.m31()*this.m02()*this.m23()+this.m01()*this.m32()*this.m23()+this.m21()*this.m02()*this.m33()-this.m01()*this.m22()*this.m33())/t,(-this.m31()*this.m12()*this.m03()+this.m11()*this.m32()*this.m03()+this.m31()*this.m02()*this.m13()-this.m01()*this.m32()*this.m13()-this.m11()*this.m02()*this.m33()+this.m01()*this.m12()*this.m33())/t,(this.m21()*this.m12()*this.m03()-this.m11()*this.m22()*this.m03()-this.m21()*this.m02()*this.m13()+this.m01()*this.m22()*this.m13()+this.m11()*this.m02()*this.m23()-this.m01()*this.m12()*this.m23())/t,(this.m30()*this.m22()*this.m13()-this.m20()*this.m32()*this.m13()-this.m30()*this.m12()*this.m23()+this.m10()*this.m32()*this.m23()+this.m20()*this.m12()*this.m33()-this.m10()*this.m22()*this.m33())/t,(-this.m30()*this.m22()*this.m03()+this.m20()*this.m32()*this.m03()+this.m30()*this.m02()*this.m23()-this.m00()*this.m32()*this.m23()-this.m20()*this.m02()*this.m33()+this.m00()*this.m22()*this.m33())/t,(this.m30()*this.m12()*this.m03()-this.m10()*this.m32()*this.m03()-this.m30()*this.m02()*this.m13()+this.m00()*this.m32()*this.m13()+this.m10()*this.m02()*this.m33()-this.m00()*this.m12()*this.m33())/t,(-this.m20()*this.m12()*this.m03()+this.m10()*this.m22()*this.m03()+this.m20()*this.m02()*this.m13()-this.m00()*this.m22()*this.m13()-this.m10()*this.m02()*this.m23()+this.m00()*this.m12()*this.m23())/t,(-this.m30()*this.m21()*this.m13()+this.m20()*this.m31()*this.m13()+this.m30()*this.m11()*this.m23()-this.m10()*this.m31()*this.m23()-this.m20()*this.m11()*this.m33()+this.m10()*this.m21()*this.m33())/t,(this.m30()*this.m21()*this.m03()-this.m20()*this.m31()*this.m03()-this.m30()*this.m01()*this.m23()+this.m00()*this.m31()*this.m23()+this.m20()*this.m01()*this.m33()-this.m00()*this.m21()*this.m33())/t,(-this.m30()*this.m11()*this.m03()+this.m10()*this.m31()*this.m03()+this.m30()*this.m01()*this.m13()-this.m00()*this.m31()*this.m13()-this.m10()*this.m01()*this.m33()+this.m00()*this.m11()*this.m33())/t,(this.m20()*this.m11()*this.m03()-this.m10()*this.m21()*this.m03()-this.m20()*this.m01()*this.m13()+this.m00()*this.m21()*this.m13()+this.m10()*this.m01()*this.m23()-this.m00()*this.m11()*this.m23())/t,(this.m30()*this.m21()*this.m12()-this.m20()*this.m31()*this.m12()-this.m30()*this.m11()*this.m22()+this.m10()*this.m31()*this.m22()+this.m20()*this.m11()*this.m32()-this.m10()*this.m21()*this.m32())/t,(-this.m30()*this.m21()*this.m02()+this.m20()*this.m31()*this.m02()+this.m30()*this.m01()*this.m22()-this.m00()*this.m31()*this.m22()-this.m20()*this.m01()*this.m32()+this.m00()*this.m21()*this.m32())/t,(this.m30()*this.m11()*this.m02()-this.m10()*this.m31()*this.m02()-this.m30()*this.m01()*this.m12()+this.m00()*this.m31()*this.m12()+this.m10()*this.m01()*this.m32()-this.m00()*this.m11()*this.m32())/t,(-this.m20()*this.m11()*this.m02()+this.m10()*this.m21()*this.m02()+this.m20()*this.m01()*this.m12()-this.m00()*this.m21()*this.m12()-this.m10()*this.m01()*this.m22()+this.m00()*this.m11()*this.m22())/t);throw new Error("Matrix could not be inverted, determinant === 0");default:throw new Error("Matrix3.inverted with unknown type: "+this.type)}},timesMatrix:function(t){if(this.type===s.IDENTITY||t.type===s.IDENTITY)return this.type===s.IDENTITY?t:this;if(this.type===t.type){if(this.type===s.TRANSLATION_3D)return new e(1,0,0,this.m03()+t.m02(),0,1,0,this.m13()+t.m12(),0,0,1,this.m23()+t.m23(),0,0,0,1,s.TRANSLATION_3D);if(this.type===s.SCALING)return new e(this.m00()*t.m00(),0,0,0,0,this.m11()*t.m11(),0,0,0,0,this.m22()*t.m22(),0,0,0,0,1,s.SCALING)}return this.type!==s.OTHER&&t.type!==s.OTHER?new e(this.m00()*t.m00()+this.m01()*t.m10()+this.m02()*t.m20(),this.m00()*t.m01()+this.m01()*t.m11()+this.m02()*t.m21(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02()*t.m22(),this.m00()*t.m03()+this.m01()*t.m13()+this.m02()*t.m23()+this.m03(),this.m10()*t.m00()+this.m11()*t.m10()+this.m12()*t.m20(),this.m10()*t.m01()+this.m11()*t.m11()+this.m12()*t.m21(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12()*t.m22(),this.m10()*t.m03()+this.m11()*t.m13()+this.m12()*t.m23()+this.m13(),this.m20()*t.m00()+this.m21()*t.m10()+this.m22()*t.m20(),this.m20()*t.m01()+this.m21()*t.m11()+this.m22()*t.m21(),this.m20()*t.m02()+this.m21()*t.m12()+this.m22()*t.m22(),this.m20()*t.m03()+this.m21()*t.m13()+this.m22()*t.m23()+this.m23(),0,0,0,1,s.AFFINE):new e(this.m00()*t.m00()+this.m01()*t.m10()+this.m02()*t.m20()+this.m03()*t.m30(),this.m00()*t.m01()+this.m01()*t.m11()+this.m02()*t.m21()+this.m03()*t.m31(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02()*t.m22()+this.m03()*t.m32(),this.m00()*t.m03()+this.m01()*t.m13()+this.m02()*t.m23()+this.m03()*t.m33(),this.m10()*t.m00()+this.m11()*t.m10()+this.m12()*t.m20()+this.m13()*t.m30(),this.m10()*t.m01()+this.m11()*t.m11()+this.m12()*t.m21()+this.m13()*t.m31(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12()*t.m22()+this.m13()*t.m32(),this.m10()*t.m03()+this.m11()*t.m13()+this.m12()*t.m23()+this.m13()*t.m33(),this.m20()*t.m00()+this.m21()*t.m10()+this.m22()*t.m20()+this.m23()*t.m30(),this.m20()*t.m01()+this.m21()*t.m11()+this.m22()*t.m21()+this.m23()*t.m31(),this.m20()*t.m02()+this.m21()*t.m12()+this.m22()*t.m22()+this.m23()*t.m32(),this.m20()*t.m03()+this.m21()*t.m13()+this.m22()*t.m23()+this.m23()*t.m33(),this.m30()*t.m00()+this.m31()*t.m10()+this.m32()*t.m20()+this.m33()*t.m30(),this.m30()*t.m01()+this.m31()*t.m11()+this.m32()*t.m21()+this.m33()*t.m31(),this.m30()*t.m02()+this.m31()*t.m12()+this.m32()*t.m22()+this.m33()*t.m32(),this.m30()*t.m03()+this.m31()*t.m13()+this.m32()*t.m23()+this.m33()*t.m33())},timesVector4:function(t){var n=this.m00()*t.x+this.m01()*t.y+this.m02()*t.z+this.m03()*t.w,e=this.m10()*t.x+this.m11()*t.y+this.m12()*t.z+this.m13()*t.w,s=this.m20()*t.x+this.m21()*t.y+this.m22()*t.z+this.m23()*t.w,r=this.m30()*t.x+this.m31()*t.y+this.m32()*t.z+this.m33()*t.w;return new i.Vector4(n,e,s,r)},timesVector3:function(t){return this.timesVector4(t.toVector4()).toVector3()},timesTransposeVector4:function(t){var n=this.m00()*t.x+this.m10()*t.y+this.m20()*t.z+this.m30()*t.w,e=this.m01()*t.x+this.m11()*t.y+this.m21()*t.z+this.m31()*t.w,s=this.m02()*t.x+this.m12()*t.y+this.m22()*t.z+this.m32()*t.w,r=this.m03()*t.x+this.m13()*t.y+this.m23()*t.z+this.m33()*t.w;return new i.Vector4(n,e,s,r)},timesTransposeVector3:function(t){return this.timesTransposeVector4(t.toVector4()).toVector3()},timesRelativeVector3:function(t){var n=this.m00()*t.x+this.m10()*t.y+this.m20()*t.z,e=this.m01()*t.y+this.m11()*t.y+this.m21()*t.z,s=this.m02()*t.z+this.m12()*t.y+this.m22()*t.z;return new i.Vector3(n,e,s)},getDeterminant:function(){return this.m03()*this.m12()*this.m21()*this.m30()-this.m02()*this.m13()*this.m21()*this.m30()-this.m03()*this.m11()*this.m22()*this.m30()+this.m01()*this.m13()*this.m22()*this.m30()+this.m02()*this.m11()*this.m23()*this.m30()-this.m01()*this.m12()*this.m23()*this.m30()-this.m03()*this.m12()*this.m20()*this.m31()+this.m02()*this.m13()*this.m20()*this.m31()+this.m03()*this.m10()*this.m22()*this.m31()-this.m00()*this.m13()*this.m22()*this.m31()-this.m02()*this.m10()*this.m23()*this.m31()+this.m00()*this.m12()*this.m23()*this.m31()+this.m03()*this.m11()*this.m20()*this.m32()-this.m01()*this.m13()*this.m20()*this.m32()-this.m03()*this.m10()*this.m21()*this.m32()+this.m00()*this.m13()*this.m21()*this.m32()+this.m01()*this.m10()*this.m23()*this.m32()-this.m00()*this.m11()*this.m23()*this.m32()-this.m02()*this.m11()*this.m20()*this.m33()+this.m01()*this.m12()*this.m20()*this.m33()+this.m02()*this.m10()*this.m21()*this.m33()-this.m00()*this.m12()*this.m21()*this.m33()-this.m01()*this.m10()*this.m22()*this.m33()+this.m00()*this.m11()*this.m22()*this.m33()},get determinant(){return this.getDeterminant()},toString:function(){return this.m00()+" "+this.m01()+" "+this.m02()+" "+this.m03()+"\n"+this.m10()+" "+this.m11()+" "+this.m12()+" "+this.m13()+"\n"+this.m20()+" "+this.m21()+" "+this.m22()+" "+this.m23()+"\n"+this.m30()+" "+this.m31()+" "+this.m32()+" "+this.m33()},makeImmutable:function(){this.rowMajor=function(){throw new Error("Cannot modify immutable matrix")}}},e.IDENTITY=new e,e.IDENTITY.makeImmutable(),e}),n("DOT/Matrix3",["require","DOT/dot","PHET_CORE/PoolableMixin","DOT/Vector2","DOT/Vector3","DOT/Matrix4"],function(t){var i=t("DOT/dot"),n=t("PHET_CORE/PoolableMixin"),e=i.FastArray;t("DOT/Vector2"),t("DOT/Vector3"),t("DOT/Matrix4");var s=new e(9);s[0]=1,s[4]=1,s[8]=1;var r=e===Array?function(){return[1,0,0,0,1,0,0,0,1]}:function(){return new e(s)};i.Matrix3=function(){this.entries=r(),this.type=h.IDENTITY};var o=i.Matrix3;o.Types={OTHER:0,IDENTITY:1,TRANSLATION_2D:2,SCALING:3,AFFINE:4};var h=o.Types;return o.identity=function(){return o.dirtyFromPool().setToIdentity()},o.translation=function(t,i){return o.dirtyFromPool().setToTranslation(t,i)},o.translationFromVector=function(t){return o.translation(t.x,t.y)},o.scaling=function(t,i){return o.dirtyFromPool().setToScale(t,i)},o.scale=o.scaling,o.affine=function(t,i,n,e,s,r){return o.dirtyFromPool().setToAffine(t,n,s,i,e,r)},o.rowMajor=function(t,i,n,e,s,r,h,u,a,m){return o.dirtyFromPool().rowMajor(t,i,n,e,s,r,h,u,a,m)},o.rotationAxisAngle=function(t,i){return o.dirtyFromPool().setToRotationAxisAngle(t,i)},o.rotationX=function(t){return o.dirtyFromPool().setToRotationX(t)},o.rotationY=function(t){return o.dirtyFromPool().setToRotationY(t)},o.rotationZ=function(t){return o.dirtyFromPool().setToRotationZ(t)},o.rotation2=o.rotationZ,o.rotationAround=function(t,i,n){return o.translation(i,n).timesMatrix(o.rotation2(t)).timesMatrix(o.translation(-i,-n))},o.rotationAroundPoint=function(t,i){return o.rotationAround(t,i.x,i.y)},o.fromSVGMatrix=function(t){return o.dirtyFromPool().setToSVGMatrix(t)},o.rotateAToB=function(t,i){return o.dirtyFromPool().setRotationAToB(t,i)},o.prototype={constructor:o,m00:function(){return this.entries[0]},m01:function(){return this.entries[3]},m02:function(){return this.entries[6]},m10:function(){return this.entries[1]},m11:function(){return this.entries[4]},m12:function(){return this.entries[7]},m20:function(){return this.entries[2]},m21:function(){return this.entries[5]},m22:function(){return this.entries[8]},isIdentity:function(){return this.type===h.IDENTITY||this.equals(o.IDENTITY)},isAffine:function(){return this.type===h.AFFINE||0===this.m20()&&0===this.m21()&&1===this.m22()},isAligned:function(){return this.isAffine()&&0===this.m01()&&0===this.m10()},isAxisAligned:function(){return this.isAffine()&&(0===this.m01()&&0===this.m10()||0===this.m00()&&0===this.m11())},isFinite:function(){return isFinite(this.m00())&&isFinite(this.m01())&&isFinite(this.m02())&&isFinite(this.m10())&&isFinite(this.m11())&&isFinite(this.m12())&&isFinite(this.m20())&&isFinite(this.m21())&&isFinite(this.m22())},getDeterminant:function(){return this.m00()*this.m11()*this.m22()+this.m01()*this.m12()*this.m20()+this.m02()*this.m10()*this.m21()-this.m02()*this.m11()*this.m20()-this.m01()*this.m10()*this.m22()-this.m00()*this.m12()*this.m21()},get determinant(){return this.getDeterminant()},getTranslation:function(){return new i.Vector2(this.m02(),this.m12())},get translation(){return this.getTranslation()},getScaleVector:function(){return new i.Vector2(Math.sqrt(this.m00()*this.m00()+this.m10()*this.m10()),Math.sqrt(this.m01()*this.m01()+this.m11()*this.m11()))},get scaleVector(){return this.getScaleVector()},getRotation:function(){var t=this.timesVector2(i.Vector2.X_UNIT).minus(this.timesVector2(i.Vector2.ZERO));return Math.atan2(t.y,t.x)},get rotation(){return this.getRotation()},toMatrix4:function(){return new i.Matrix4(this.m00(),this.m01(),this.m02(),0,this.m10(),this.m11(),this.m12(),0,this.m20(),this.m21(),this.m22(),0,0,0,0,1)},toAffineMatrix4:function(){return new i.Matrix4(this.m00(),this.m01(),0,this.m02(),this.m10(),this.m11(),0,this.m12(),0,0,1,0,0,0,0,1)},toString:function(){return this.m00()+" "+this.m01()+" "+this.m02()+"\n"+this.m10()+" "+this.m11()+" "+this.m12()+"\n"+this.m20()+" "+this.m21()+" "+this.m22()},toSVGMatrix:function(){var t=document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix();return t.a=this.m00(),t.b=this.m10(),t.c=this.m01(),t.d=this.m11(),t.e=this.m02(),t.f=this.m12(),t},getCSSTransform:function(){return"matrix("+this.entries[0].toFixed(20)+","+this.entries[1].toFixed(20)+","+this.entries[3].toFixed(20)+","+this.entries[4].toFixed(20)+","+this.entries[6].toFixed(20)+","+this.entries[7].toFixed(20)+")"},get cssTransform(){return this.getCSSTransform()},getSVGTransform:function(){function t(t){return t.toFixed(20)}switch(this.type){case h.IDENTITY:return"";case h.TRANSLATION_2D:return"translate("+t(this.entries[6])+","+t(this.entries[7])+")";case h.SCALING:return"scale("+t(this.entries[0])+(this.entries[0]===this.entries[4]?"":","+t(this.entries[4]))+")";default:return"matrix("+t(this.entries[0])+","+t(this.entries[1])+","+t(this.entries[3])+","+t(this.entries[4])+","+t(this.entries[6])+","+t(this.entries[7])+")"}},get svgTransform(){return this.getSVGTransform()},getCSSTransformStyles:function(){var t=this.getCSSTransform();return{"-webkit-perspective":1e3,"-webkit-backface-visibility":"hidden","-webkit-transform":t+" translateZ(0)","-moz-transform":t+" translateZ(0)","-ms-transform":t,"-o-transform":t,transform:t,"transform-origin":"top left","-ms-transform-origin":"top left"}},get cssTransformStyles(){return this.getCSSTransformStyles()},equals:function(t){return this.m00()===t.m00()&&this.m01()===t.m01()&&this.m02()===t.m02()&&this.m10()===t.m10()&&this.m11()===t.m11()&&this.m12()===t.m12()&&this.m20()===t.m20()&&this.m21()===t.m21()&&this.m22()===t.m22()},equalsEpsilon:function(t,i){return Math.abs(this.m00()-t.m00())<i&&Math.abs(this.m01()-t.m01())<i&&Math.abs(this.m02()-t.m02())<i&&Math.abs(this.m10()-t.m10())<i&&Math.abs(this.m11()-t.m11())<i&&Math.abs(this.m12()-t.m12())<i&&Math.abs(this.m20()-t.m20())<i&&Math.abs(this.m21()-t.m21())<i&&Math.abs(this.m22()-t.m22())<i},copy:function(){return o.createFromPool(this.m00(),this.m01(),this.m02(),this.m10(),this.m11(),this.m12(),this.m20(),this.m21(),this.m22(),this.type)},plus:function(t){return o.createFromPool(this.m00()+t.m00(),this.m01()+t.m01(),this.m02()+t.m02(),this.m10()+t.m10(),this.m11()+t.m11(),this.m12()+t.m12(),this.m20()+t.m20(),this.m21()+t.m21(),this.m22()+t.m22())},minus:function(t){return o.createFromPool(this.m00()-t.m00(),this.m01()-t.m01(),this.m02()-t.m02(),this.m10()-t.m10(),this.m11()-t.m11(),this.m12()-t.m12(),this.m20()-t.m20(),this.m21()-t.m21(),this.m22()-t.m22())},transposed:function(){return o.createFromPool(this.m00(),this.m10(),this.m20(),this.m01(),this.m11(),this.m21(),this.m02(),this.m12(),this.m22(),this.type===h.IDENTITY||this.type===h.SCALING?this.type:void 0)},negated:function(){return o.createFromPool(-this.m00(),-this.m01(),-this.m02(),-this.m10(),-this.m11(),-this.m12(),-this.m20(),-this.m21(),-this.m22())},inverted:function(){var t;switch(this.type){case h.IDENTITY:return this;case h.TRANSLATION_2D:return o.createFromPool(1,0,-this.m02(),0,1,-this.m12(),0,0,1,h.TRANSLATION_2D);case h.SCALING:return o.createFromPool(1/this.m00(),0,0,0,1/this.m11(),0,0,0,1/this.m22(),h.SCALING);case h.AFFINE:if(t=this.getDeterminant(),0!==t)return o.createFromPool((-this.m12()*this.m21()+this.m11()*this.m22())/t,(this.m02()*this.m21()-this.m01()*this.m22())/t,(-this.m02()*this.m11()+this.m01()*this.m12())/t,(this.m12()*this.m20()-this.m10()*this.m22())/t,(-this.m02()*this.m20()+this.m00()*this.m22())/t,(this.m02()*this.m10()-this.m00()*this.m12())/t,0,0,1,h.AFFINE);throw new Error("Matrix could not be inverted, determinant === 0");case h.OTHER:if(t=this.getDeterminant(),0!==t)return o.createFromPool((-this.m12()*this.m21()+this.m11()*this.m22())/t,(this.m02()*this.m21()-this.m01()*this.m22())/t,(-this.m02()*this.m11()+this.m01()*this.m12())/t,(this.m12()*this.m20()-this.m10()*this.m22())/t,(-this.m02()*this.m20()+this.m00()*this.m22())/t,(this.m02()*this.m10()-this.m00()*this.m12())/t,(-this.m11()*this.m20()+this.m10()*this.m21())/t,(this.m01()*this.m20()-this.m00()*this.m21())/t,(-this.m01()*this.m10()+this.m00()*this.m11())/t,h.OTHER);throw new Error("Matrix could not be inverted, determinant === 0");default:throw new Error("Matrix3.inverted with unknown type: "+this.type)}},timesMatrix:function(t){if(this.type===h.IDENTITY||t.type===h.IDENTITY)return this.type===h.IDENTITY?t:this;if(this.type===t.type){if(this.type===h.TRANSLATION_2D)return o.createFromPool(1,0,this.m02()+t.m02(),0,1,this.m12()+t.m12(),0,0,1,h.TRANSLATION_2D);if(this.type===h.SCALING)return o.createFromPool(this.m00()*t.m00(),0,0,0,this.m11()*t.m11(),0,0,0,1,h.SCALING)}return this.type!==h.OTHER&&t.type!==h.OTHER?o.createFromPool(this.m00()*t.m00()+this.m01()*t.m10(),this.m00()*t.m01()+this.m01()*t.m11(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02(),this.m10()*t.m00()+this.m11()*t.m10(),this.m10()*t.m01()+this.m11()*t.m11(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12(),0,0,1,h.AFFINE):o.createFromPool(this.m00()*t.m00()+this.m01()*t.m10()+this.m02()*t.m20(),this.m00()*t.m01()+this.m01()*t.m11()+this.m02()*t.m21(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02()*t.m22(),this.m10()*t.m00()+this.m11()*t.m10()+this.m12()*t.m20(),this.m10()*t.m01()+this.m11()*t.m11()+this.m12()*t.m21(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12()*t.m22(),this.m20()*t.m00()+this.m21()*t.m10()+this.m22()*t.m20(),this.m20()*t.m01()+this.m21()*t.m11()+this.m22()*t.m21(),this.m20()*t.m02()+this.m21()*t.m12()+this.m22()*t.m22())},timesVector2:function(t){var n=this.m00()*t.x+this.m01()*t.y+this.m02(),e=this.m10()*t.x+this.m11()*t.y+this.m12();return new i.Vector2(n,e)},timesVector3:function(t){var n=this.m00()*t.x+this.m01()*t.y+this.m02()*t.z,e=this.m10()*t.x+this.m11()*t.y+this.m12()*t.z,s=this.m20()*t.x+this.m21()*t.y+this.m22()*t.z;return new i.Vector3(n,e,s)},timesTransposeVector2:function(t){var n=this.m00()*t.x+this.m10()*t.y,e=this.m01()*t.x+this.m11()*t.y;return new i.Vector2(n,e)},timesRelativeVector2:function(t){var n=this.m00()*t.x+this.m01()*t.y,e=this.m10()*t.y+this.m11()*t.y;return new i.Vector2(n,e)},rowMajor:function(t,i,n,e,s,r,o,u,a,m){return this.entries[0]=t,this.entries[1]=e,this.entries[2]=o,this.entries[3]=i,this.entries[4]=s,this.entries[5]=u,this.entries[6]=n,this.entries[7]=r,this.entries[8]=a,this.type=void 0===m?0===o&&0===u&&1===a?h.AFFINE:h.OTHER:m,this},set:function(t){return this.rowMajor(t.m00(),t.m01(),t.m02(),t.m10(),t.m11(),t.m12(),t.m20(),t.m21(),t.m22(),t.type)},makeImmutable:function(){return this.rowMajor=function(){throw new Error("Cannot modify immutable matrix")},this},columnMajor:function(t,i,n,e,s,r,o,h,u,a){return this.rowMajor(t,e,o,i,s,h,n,r,u,a)},add:function(t){return this.rowMajor(this.m00()+t.m00(),this.m01()+t.m01(),this.m02()+t.m02(),this.m10()+t.m10(),this.m11()+t.m11(),this.m12()+t.m12(),this.m20()+t.m20(),this.m21()+t.m21(),this.m22()+t.m22())},subtract:function(t){return this.rowMajor(this.m00()-t.m00(),this.m01()-t.m01(),this.m02()-t.m02(),this.m10()-t.m10(),this.m11()-t.m11(),this.m12()-t.m12(),this.m20()-t.m20(),this.m21()-t.m21(),this.m22()-t.m22())},transpose:function(){return this.rowMajor(this.m00(),this.m10(),this.m20(),this.m01(),this.m11(),this.m21(),this.m02(),this.m12(),this.m22(),this.type===h.IDENTITY||this.type===h.SCALING?this.type:void 0)
},negate:function(){return this.rowMajor(-this.m00(),-this.m01(),-this.m02(),-this.m10(),-this.m11(),-this.m12(),-this.m20(),-this.m21(),-this.m22())},invert:function(){var t;switch(this.type){case h.IDENTITY:return this;case h.TRANSLATION_2D:return this.rowMajor(1,0,-this.m02(),0,1,-this.m12(),0,0,1,h.TRANSLATION_2D);case h.SCALING:return this.rowMajor(1/this.m00(),0,0,0,1/this.m11(),0,0,0,1/this.m22(),h.SCALING);case h.AFFINE:if(t=this.getDeterminant(),0!==t)return this.rowMajor((-this.m12()*this.m21()+this.m11()*this.m22())/t,(this.m02()*this.m21()-this.m01()*this.m22())/t,(-this.m02()*this.m11()+this.m01()*this.m12())/t,(this.m12()*this.m20()-this.m10()*this.m22())/t,(-this.m02()*this.m20()+this.m00()*this.m22())/t,(this.m02()*this.m10()-this.m00()*this.m12())/t,0,0,1,h.AFFINE);throw new Error("Matrix could not be inverted, determinant === 0");case h.OTHER:if(t=this.getDeterminant(),0!==t)return this.rowMajor((-this.m12()*this.m21()+this.m11()*this.m22())/t,(this.m02()*this.m21()-this.m01()*this.m22())/t,(-this.m02()*this.m11()+this.m01()*this.m12())/t,(this.m12()*this.m20()-this.m10()*this.m22())/t,(-this.m02()*this.m20()+this.m00()*this.m22())/t,(this.m02()*this.m10()-this.m00()*this.m12())/t,(-this.m11()*this.m20()+this.m10()*this.m21())/t,(this.m01()*this.m20()-this.m00()*this.m21())/t,(-this.m01()*this.m10()+this.m00()*this.m11())/t,h.OTHER);throw new Error("Matrix could not be inverted, determinant === 0");default:throw new Error("Matrix3.inverted with unknown type: "+this.type)}},multiplyMatrix:function(t){if(t.type===h.IDENTITY)return this;if(this.type===h.IDENTITY)return this.set(t);if(this.type===t.type){if(this.type===h.TRANSLATION_2D)return this.rowMajor(1,0,this.m02()+t.m02(),0,1,this.m12()+t.m12(),0,0,1,h.TRANSLATION_2D);if(this.type===h.SCALING)return this.rowMajor(this.m00()*t.m00(),0,0,0,this.m11()*t.m11(),0,0,0,1,h.SCALING)}return this.type!==h.OTHER&&t.type!==h.OTHER?this.rowMajor(this.m00()*t.m00()+this.m01()*t.m10(),this.m00()*t.m01()+this.m01()*t.m11(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02(),this.m10()*t.m00()+this.m11()*t.m10(),this.m10()*t.m01()+this.m11()*t.m11(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12(),0,0,1,h.AFFINE):this.rowMajor(this.m00()*t.m00()+this.m01()*t.m10()+this.m02()*t.m20(),this.m00()*t.m01()+this.m01()*t.m11()+this.m02()*t.m21(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02()*t.m22(),this.m10()*t.m00()+this.m11()*t.m10()+this.m12()*t.m20(),this.m10()*t.m01()+this.m11()*t.m11()+this.m12()*t.m21(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12()*t.m22(),this.m20()*t.m00()+this.m21()*t.m10()+this.m22()*t.m20(),this.m20()*t.m01()+this.m21()*t.m11()+this.m22()*t.m21(),this.m20()*t.m02()+this.m21()*t.m12()+this.m22()*t.m22())},setToIdentity:function(){return this.rowMajor(1,0,0,0,1,0,0,0,1,h.IDENTITY)},setToTranslation:function(t,i){return this.rowMajor(1,0,t,0,1,i,0,0,1,h.TRANSLATION_2D)},setToScale:function(t,i){return i=void 0===i?t:i,this.rowMajor(t,0,0,0,i,0,0,0,1,h.SCALING)},setToAffine:function(t,i,n,e,s,r){return this.rowMajor(t,i,n,e,s,r,0,0,1,h.AFFINE)},setToRotationAxisAngle:function(t,i){var n=Math.cos(i),e=Math.sin(i),s=1-n;return this.rowMajor(t.x*t.x*s+n,t.x*t.y*s-t.z*e,t.x*t.z*s+t.y*e,t.y*t.x*s+t.z*e,t.y*t.y*s+n,t.y*t.z*s-t.x*e,t.z*t.x*s-t.y*e,t.z*t.y*s+t.x*e,t.z*t.z*s+n,h.OTHER)},setToRotationX:function(t){var i=Math.cos(t),n=Math.sin(t);return this.rowMajor(1,0,0,0,i,-n,0,n,i,h.OTHER)},setToRotationY:function(t){var i=Math.cos(t),n=Math.sin(t);return this.rowMajor(i,0,n,0,1,0,-n,0,i,h.OTHER)},setToRotationZ:function(t){var i=Math.cos(t),n=Math.sin(t);return this.rowMajor(i,-n,0,n,i,0,0,0,1,h.AFFINE)},setToSVGMatrix:function(t){return this.rowMajor(t.a,t.c,t.e,t.b,t.d,t.f,0,0,1,h.AFFINE)},setRotationAToB:function(t,n){var e,s,r,o=t,h=n,u=1e-4,a=o.cross(h);if(e=o.dot(h),r=0>e?-e:e,r>1-u){var m,c,l,f=new i.Vector3(o.x>0?o.x:-o.x,o.y>0?o.y:-o.y,o.z>0?o.z:-o.z);f=f.x<f.y?f.x<f.z?i.Vector3.X_UNIT:i.Vector3.Z_UNIT:f.y<f.z?i.Vector3.Y_UNIT:i.Vector3.Z_UNIT;var d=f.minus(o);return a=f.minus(h),m=2/d.dot(d),c=2/a.dot(a),l=m*c*d.dot(a),this.rowMajor(-m*d.x*d.x-c*a.x*a.x+l*a.x*d.x+1,-m*d.x*d.y-c*a.x*a.y+l*a.x*d.y,-m*d.x*d.z-c*a.x*a.z+l*a.x*d.z,-m*d.y*d.x-c*a.y*a.x+l*a.y*d.x,-m*d.y*d.y-c*a.y*a.y+l*a.y*d.y+1,-m*d.y*d.z-c*a.y*a.z+l*a.y*d.z,-m*d.z*d.x-c*a.z*a.x+l*a.z*d.x,-m*d.z*d.y-c*a.z*a.y+l*a.z*d.y,-m*d.z*d.z-c*a.z*a.z+l*a.z*d.z+1)}var g,x,p,v,T;return s=1/(1+e),g=s*a.x,x=s*a.z,p=g*a.y,v=g*a.z,T=x*a.y,this.rowMajor(e+g*a.x,p-a.z,v+a.y,p+a.z,e+s*a.y*a.y,T-a.x,v-a.y,T+a.x,e+x*a.z)},multiplyVector2:function(t){return t.setXY(this.m00()*t.x+this.m01()*t.y+this.m02(),this.m10()*t.x+this.m11()*t.y+this.m12())},multiplyVector3:function(t){return t.setXYZ(this.m00()*t.x+this.m01()*t.y+this.m02()*t.z,this.m10()*t.x+this.m11()*t.y+this.m12()*t.z,this.m20()*t.x+this.m21()*t.y+this.m22()*t.z)},multiplyTransposeVector2:function(t){return t.setXY(this.m00()*t.x+this.m10()*t.y,this.m01()*t.x+this.m11()*t.y)},multiplyRelativeVector2:function(t){return t.setXY(this.m00()*t.x+this.m01()*t.y,this.m10()*t.y+this.m11()*t.y)},canvasSetTransform:function(t){t.setTransform(this.entries[0],this.entries[1],this.entries[3],this.entries[4],this.entries[6],this.entries[7])},canvasAppendTransform:function(t){this.type!==h.IDENTITY&&t.transform(this.entries[0],this.entries[1],this.entries[3],this.entries[4],this.entries[6],this.entries[7])}},n(o,{defaultFactory:function(){return new o},constructorDuplicateFactory:function(t){return function(i,n,e,s,r,h,u,a,m,c){var l=t.length?t.pop():new o;return l.rowMajor(i,n,e,s,r,h,u,a,m,c)}}}),o.IDENTITY=o.identity(),o.IDENTITY.makeImmutable(),o.X_REFLECTION=o.createFromPool(-1,0,0,0,1,0,0,0,1,h.AFFINE),o.X_REFLECTION.makeImmutable(),o.Y_REFLECTION=o.createFromPool(1,0,0,0,-1,0,0,0,1,h.AFFINE),o.Y_REFLECTION.makeImmutable(),o.translationTimesMatrix=function(t,i,n){var e;return n.type===h.IDENTITY||n.type===h.TRANSLATION_2D?o.createFromPool(1,0,n.m02()+t,0,1,n.m12()+i,0,0,1,h.TRANSLATION_2D):(e=n.type===h.OTHER?h.OTHER:h.AFFINE,o.createFromPool(n.m00(),n.m01(),n.m02()+t,n.m10(),n.m11(),n.m12()+i,n.m20(),n.m21(),n.m22(),e))},o.printer={print:function(t){console.log(t.toString())}},o}),n("KITE/segments/Quadratic",["require","PHET_CORE/inherit","DOT/Bounds2","DOT/Matrix3","DOT/Util","DOT/Util","KITE/kite","KITE/segments/Segment"],function(t){var i=t("PHET_CORE/inherit"),n=t("DOT/Bounds2"),e=t("DOT/Matrix3"),s=t("DOT/Util").solveQuadraticRootsReal,r=t("DOT/Util").arePointsCollinear,o=t("KITE/kite"),h=t("KITE/segments/Segment");return h.Quadratic=function(t,i,n){this._start=t,this._control=i,this._end=n,this._startTangent=void 0,this._endTangent=void 0,this._tCriticalX=void 0,this._tCriticalY=void 0,this._bounds=void 0},i(h,h.Quadratic,{degree:2,getStart:function(){return this._start},get start(){return this._start},getControl:function(){return this._control},get control(){return this._control},getEnd:function(){return this._end},get end(){return this._end},getStartTangent:function(){if(void 0===this._startTangent){var t=this._start.equals(this._control);this._startTangent=t?this._end.minus(this._start).normalized():this._control.minus(this._start).normalized()}return this._startTangent},get startTangent(){return this.getStartTangent()},getEndTangent:function(){if(void 0===this._endTangent){var t=this._end.equals(this._control);this._endTangent=t?this._end.minus(this._start).normalized():this._end.minus(this._control).normalized()}return this._endTangent},get endTangent(){return this.getEndTangent()},getTCriticalX:function(){return void 0===this._tCriticalX&&(this._tCriticalX=h.Quadratic.extremaT(this._start.x,this._control.x,this._end.x)),this._tCriticalX},get tCriticalX(){return this.getTCriticalX()},getTCriticalY:function(){return void 0===this._tCriticalY&&(this._tCriticalY=h.Quadratic.extremaT(this._start.y,this._control.y,this._end.y)),this._tCriticalY},get tCriticalY(){return this.getTCriticalY()},getNondegenerateSegments:function(){var t=this._start,i=this._control,n=this._end,e=t.equals(n),s=t.equals(i),o=t.equals(i);if(e&&s)return[];if(e){var u=this.positionAt(.5);return[new h.Line(t,u),new h.Line(u,n)]}if(r(t,i,n)){if(s||o)return[new h.Line(t,n)];var a=n.minus(t),m=i.minus(t).dot(a.normalized)/a.magnitude(),c=h.Quadratic.extremaT(0,m,1);if(null!==c&&c>0&&1>c){var l=this.positionAt(c);return _.flatten([new h.Line(t,l).getNondegenerateSegments(),new h.Line(l,n).getNondegenerateSegments()])}return[new h.Line(t,n)]}return[this]},getBounds:function(){if(void 0===this._bounds){this._bounds=new n(Math.min(this._start.x,this._end.x),Math.min(this._start.y,this._end.y),Math.max(this._start.x,this._end.x),Math.max(this._start.y,this._end.y));var t=this.getTCriticalX(),i=this.getTCriticalY();null!==t&&t>0&&1>t&&(this._bounds=this._bounds.withPoint(this.positionAt(t))),null!==i&&i>0&&1>i&&(this._bounds=this._bounds.withPoint(this.positionAt(i)))}return this._bounds},get bounds(){return this.getBounds()},positionAt:function(t){var i=1-t;return this._start.times(i*i).plus(this._control.times(2*i*t)).plus(this._end.times(t*t))},tangentAt:function(t){return this._control.minus(this._start).times(2*(1-t)).plus(this._end.minus(this._control).times(2*t))},curvatureAt:function(t){var i=1e-7;if(Math.abs(t-.5)>.5-i){var n=.5>t,e=n?this._start:this._end,s=this._control,r=n?this._end:this._start,o=s.minus(e),h=o.magnitude(),u=(n?-1:1)*o.perpendicular().normalized().dot(r.minus(s));return u*(this.degree-1)/(this.degree*h*h)}return this.subdivided(t,!0)[0].curvatureAt(1)},offsetTo:function(t,i){for(var n=[this],e=5,s=0;e>s;s++)n=_.flatten(_.map(n,function(t){return t.subdivided(.5,!0)}));var r=_.map(n,function(i){return i.approximateOffset(t)});return i&&(r.reverse(),r=_.map(r,function(t){return t.reversed(!0)})),r},subdivided:function(t){var i=this._start.blend(this._control,t),n=this._control.blend(this._end,t),e=i.blend(n,t);return[new h.Quadratic(this._start,i,e),new h.Quadratic(e,n,this._end)]},degreeElevated:function(){return new h.Cubic(this._start,this._start.plus(this._control.timesScalar(2)).dividedScalar(3),this._end.plus(this._control.timesScalar(2)).dividedScalar(3),this._end)},reversed:function(){return new h.Quadratic(this._end,this._control,this._start)},approximateOffset:function(t){return new h.Quadratic(this._start.plus((this._start.equals(this._control)?this._end.minus(this._start):this._control.minus(this._start)).perpendicular().normalized().times(t)),this._control.plus(this._end.minus(this._start).perpendicular().normalized().times(t)),this._end.plus(this._end.minus(this._end.equals(this._control)?this._start:this._control).perpendicular().normalized().times(t)))},getSVGPathFragment:function(){return"Q "+o.svgNumber(this._control.x)+" "+o.svgNumber(this._control.y)+" "+o.svgNumber(this._end.x)+" "+o.svgNumber(this._end.y)},strokeLeft:function(t){return this.offsetTo(-t/2,!1)},strokeRight:function(t){return this.offsetTo(t/2,!0)},getInteriorExtremaTs:function(){var t=[],i=1e-10;return void 0!==this.tCriticalX&&this.tCriticalX>i&&this.tCriticalX<1-i&&t.push(this.tCriticalX),void 0!==this.tCriticalY&&this.tCriticalY>i&&this.tCriticalY<1-i&&t.push(this.tCriticalY),t.sort()},intersectsBounds:function(){throw new Error("Segment.Quadratic.intersectsBounds unimplemented")},intersection:function(t){var i=this,n=[],r=e.rotation2(-t.dir.angle()).timesMatrix(e.translation(-t.pos.x,-t.pos.y)),o=r.timesVector2(this._start),h=r.timesVector2(this._control),u=r.timesVector2(this._end),a=o.y-2*h.y+u.y,m=-2*o.y+2*h.y,c=o.y,l=s(a,m,c);return _.each(l,function(e){if(e>=0&&1>=e){var s=i.positionAt(e),r=i.tangentAt(e).normalized(),o=r.perpendicular(),h=s.minus(t.pos);h.dot(t.dir)>0&&n.push({distance:h.magnitude(),point:s,normal:o.dot(t.dir)>0?o.negated():o,wind:t.dir.perpendicular().dot(r)<0?1:-1})}}),n},windingIntersection:function(t){var i=0,n=this.intersection(t);return _.each(n,function(t){i+=t.wind}),i},writeToContext:function(t){t.quadraticCurveTo(this._control.x,this._control.y,this._end.x,this._end.y)},transformed:function(t){return new h.Quadratic(t.timesVector2(this._start),t.timesVector2(this._control),t.timesVector2(this._end))},reparameterized:function(t,i){var n=this._start.plus(this._end.plus(this._control.timesScalar(-2))),e=this._control.minus(this._start).timesScalar(2),s=this._start,r=n.timesScalar(t*t),o=n.timesScalar(t*i).timesScalar(2).plus(e.timesScalar(t)),u=n.timesScalar(i*i).plus(e.timesScalar(i)).plus(s);return new h.Quadratic(u,o.timesScalar(.5).plus(u),r.plus(o).plus(u))}}),h.Quadratic.extremaT=function(t,i,n){var e=2*(n-2*i+t);return 0!==e?-2*(i-t)/e:null},h.Quadratic}),n("KITE/segments/Cubic",["require","PHET_CORE/inherit","DOT/Bounds2","DOT/Vector2","DOT/Matrix3","DOT/Util","DOT/Util","DOT/Util","KITE/kite","KITE/segments/Segment","KITE/segments/Quadratic"],function(t){var i=t("PHET_CORE/inherit"),n=t("DOT/Bounds2"),e=t("DOT/Vector2"),s=t("DOT/Matrix3"),r=t("DOT/Util").solveQuadraticRootsReal,o=t("DOT/Util").solveCubicRootsReal,h=t("DOT/Util").arePointsCollinear,u=t("KITE/kite"),a=t("KITE/segments/Segment");return t("KITE/segments/Quadratic"),a.Cubic=function(t,i,n,e){this._start=t,this._control1=i,this._control2=n,this._end=e,this._startTangent=void 0,this._endTangent=void 0,this._r=void 0,this._s=void 0,this._tCusp=void 0,this._tDeterminant=void 0,this._tInflection1=void 0,this._tInflection2=void 0,this._startQuadratic=void 0,this._endQuadratic=void 0,this._xExtremaT=void 0,this._yExtremaT=void 0,this._bounds=void 0},i(a,a.Cubic,{degree:3,getStart:function(){return this._start},get start(){return this._start},getControl1:function(){return this._control1},get control1(){return this._control1},getControl2:function(){return this._control2},get control2(){return this._control2},getEnd:function(){return this._end},get end(){return this._end},getStartTangent:function(){return void 0===this._startTangent&&(this._startTangent=this.tangentAt(0).normalized()),this._startTangent},get startTangent(){return this.getStartTangent()},getEndTangent:function(){return void 0===this._endTangent&&(this._endTangent=this.tangentAt(1).normalized()),this._endTangent},get endTangent(){return this.getEndTangent()},getR:function(){return void 0===this._r&&(this._r=this._control1.minus(this._start).normalized()),this._r},get r(){return this.getR()},getS:function(){return void 0===this._s&&(this._s=this.getR().perpendicular()),this._s},get s(){return this.getS()},getTCusp:function(){return void 0===this._tCusp&&this.computeCuspInfo(),this._tCusp},get tCusp(){return this.getTCusp()},getTDeterminant:function(){return void 0===this._tDeterminant&&this.computeCuspInfo(),this._tDeterminant},get tDeterminant(){return this.getTDeterminant()},getTInflection1:function(){return void 0===this._tInflection1&&this.computeCuspInfo(),this._tInflection1},get tInflection1(){return this.getTInflection1()},getTInflection2:function(){return void 0===this._tInflection2&&this.computeCuspInfo(),this._tInflection2},get tInflection2(){return this.getTInflection2()},getStartQuadratic:function(){return void 0===this._startQuadratic&&this.computeCuspSegments(),this._startQuadratic},get startQuadratic(){return this.getStartQuadratic()},getEndQuadratic:function(){return void 0===this._endQuadratic&&this.computeCuspSegments(),this._endQuadratic},get endQuadratic(){return this.getEndQuadratic()},getXExtremaT:function(){return void 0===this._xExtremaT&&(this._xExtremaT=a.Cubic.extremaT(this._start.x,this._control1.x,this._control2.x,this._end.x)),this._xExtremaT},get xExtremaT(){return this.getXExtremaT()},getYExtremaT:function(){return void 0===this._yExtremaT&&(this._yExtremaT=a.Cubic.extremaT(this._start.y,this._control1.y,this._control2.y,this._end.y)),this._yExtremaT},get yExtremaT(){return this.getYExtremaT()},getBounds:function(){if(void 0===this._bounds){this._bounds=n.NOTHING,this._bounds=this._bounds.withPoint(this._start),this._bounds=this._bounds.withPoint(this._end);var t=this;_.each(this.getXExtremaT(),function(i){i>=0&&1>=i&&(t._bounds=t._bounds.withPoint(t.positionAt(i)))}),_.each(this.getYExtremaT(),function(i){i>=0&&1>=i&&(t._bounds=t._bounds.withPoint(t.positionAt(i)))}),this.hasCusp()&&(this._bounds=this._bounds.withPoint(this.positionAt(this.getTCusp())))}return this._bounds},get bounds(){return this.getBounds()},computeCuspInfo:function(){var t=this._start.times(-1).plus(this._control1.times(3)).plus(this._control2.times(-3)).plus(this._end),i=this._start.times(3).plus(this._control1.times(-6)).plus(this._control2.times(3)),n=this._start.times(-3).plus(this._control1.times(3)),e=t.perpendicular(),s=i.perpendicular(),r=e.dot(i);if(this._tCusp=-.5*(e.dot(n)/r),this._tDeterminant=this._tCusp*this._tCusp-1/3*(s.dot(n)/r),this._tDeterminant>=0){var o=Math.sqrt(this._tDeterminant);this._tInflection1=this._tCusp-o,this._tInflection2=this._tCusp+o}else this._tInflection1=null,this._tInflection2=null},computeCuspSegments:function(){if(this.hasCusp()){var t=this.subdivided(this.getTCusp);this._startQuadratic=new a.Quadratic(t[0].start,t[0].control1,t[0].end,!1),this._endQuadratic=new a.Quadratic(t[1].start,t[1].control2,t[1].end,!1)}else this._startQuadratic=null,this._endQuadratic=null},getNondegenerateSegments:function(){var t=this._start,i=this._control1,n=this._control2,e=this._end,s=this.degreeReduced(1e-9);if(t.equals(e)&&t.equals(i)&&t.equals(n))return[];if(this.hasCusp())return _.flatten([this._startQuadratic.getNondegenerateSegments(),this._endQuadratic.getNondegenerateSegments()]);if(s)return s.getNondegenerateSegments();if(h(t,i,e)&&h(t,n,e))throw new Error("TODO, use extrema T funcs");return[this]},hasCusp:function(){var t=this.getTCusp(),i=1e-7;return this.tangentAt(t).magnitude()<i&&t>=0&&1>=t},positionAt:function(t){var i=1-t;return this._start.times(i*i*i).plus(this._control1.times(3*i*i*t)).plus(this._control2.times(3*i*t*t)).plus(this._end.times(t*t*t))},tangentAt:function(t){var i=1-t;return this._start.times(-3*i*i).plus(this._control1.times(3*i*i-6*i*t)).plus(this._control2.times(6*i*t-3*t*t)).plus(this._end.times(3*t*t))},curvatureAt:function(t){var i=1e-7;if(Math.abs(t-.5)>.5-i){var n=.5>t,e=n?this._start:this._end,s=n?this._control1:this._control2,r=n?this._control2:this._control1,o=s.minus(e),h=o.magnitude(),u=(n?-1:1)*o.perpendicular().normalized().dot(r.minus(s));return u*(this.degree-1)/(this.degree*h*h)}return this.subdivided(t)[0].curvatureAt(1)},toRS:function(t){var i=t.minus(this._start);return new e(i.dot(this.getR()),i.dot(this.getS()))},subdivided:function(t){var i=this._start.blend(this._control1,t),n=this._control2.blend(this._end,t),e=this._control1.blend(this._control2,t),s=i.blend(e,t),r=e.blend(n,t),o=s.blend(r,t);return[new a.Cubic(this._start,i,s,o),new a.Cubic(o,r,n,this._end)]},offsetTo:function(t,i){for(var n=32,e=[],s=[],r=0;n>r;r++){var o=r/(n-1);i&&(o=1-o),e.push(this.positionAt(o).plus(this.tangentAt(o).perpendicular().normalized().times(t))),r>0&&s.push(new a.Line(e[r-1],e[r]))}return s},getSVGPathFragment:function(){return"C "+u.svgNumber(this._control1.x)+" "+u.svgNumber(this._control1.y)+" "+u.svgNumber(this._control2.x)+" "+u.svgNumber(this._control2.y)+" "+u.svgNumber(this._end.x)+" "+u.svgNumber(this._end.y)},strokeLeft:function(t){return this.offsetTo(-t/2,!1)},strokeRight:function(t){return this.offsetTo(t/2,!0)},getInteriorExtremaTs:function(){var t=this.getXExtremaT().concat(this.getYExtremaT()),i=[];return _.each(t,function(t){var n=1e-10;t>n&&1-n>t&&_.every(i,function(i){return Math.abs(t-i)>n})&&i.push(t)}),i.sort()},intersectsBounds:function(){throw new Error("Segment.Cubic.intersectsBounds unimplemented")},intersection:function(t){var i=this,n=[],e=s.rotation2(-t.dir.angle()).timesMatrix(s.translation(-t.pos.x,-t.pos.y)),r=e.timesVector2(this._start),h=e.timesVector2(this._control1),u=e.timesVector2(this._control2),a=e.timesVector2(this._end),m=-r.y+3*h.y-3*u.y+a.y,c=3*r.y-6*h.y+3*u.y,l=-3*r.y+3*h.y,f=r.y,d=o(m,c,l,f);return _.each(d,function(e){if(e>=0&&1>=e){var s=i.positionAt(e),r=i.tangentAt(e).normalized(),o=r.perpendicular(),h=s.minus(t.pos);h.dot(t.dir)>0&&n.push({distance:h.magnitude(),point:s,normal:o.dot(t.dir)>0?o.negated():o,wind:t.dir.perpendicular().dot(r)<0?1:-1})}}),n},windingIntersection:function(t){var i=0,n=this.intersection(t);return _.each(n,function(t){i+=t.wind}),i},writeToContext:function(t){t.bezierCurveTo(this._control1.x,this._control1.y,this._control2.x,this._control2.y,this._end.x,this._end.y)},transformed:function(t){return new a.Cubic(t.timesVector2(this._start),t.timesVector2(this._control1),t.timesVector2(this._control2),t.timesVector2(this._end))},degreeReduced:function(t){t=t||0;var i=this._control1.timesScalar(3).minus(this._start).dividedScalar(2),n=this._control2.timesScalar(3).minus(this._end).dividedScalar(2);return i.minus(n).magnitude()<=t?new a.Quadratic(this._start,i.average(n),this._end):null}}),a.Cubic.extremaT=function(t,i,n,e){var s=-3*t+9*i-9*n+3*e,o=6*t-12*i+6*n,h=-3*t+3*i;return r(s,o,h)},a.Cubic}),n("DOT/Transform3",["require","DOT/dot","DOT/Matrix3","DOT/Vector2","DOT/Ray2"],function(t){var i=t("DOT/dot");t("DOT/Matrix3"),t("DOT/Vector2"),t("DOT/Ray2"),i.Transform3=function(t){this.listeners=[],this.setMatrix(void 0===t?i.Matrix3.IDENTITY:t)};var n=i.Transform3;return n.prototype={constructor:n,setMatrix:function(t){if(t.isFinite()){var i,n=this.matrix,e=this.listeners.length;for(i=0;e>i;i++)this.listeners[i].before(t,n);for(this.matrix=t,this.inverse=null,this.matrixTransposed=null,this.inverseTransposed=null,i=0;e>i;i++)this.listeners[i].after(t,n)}},prepend:function(t){this.setMatrix(t.timesMatrix(this.matrix))},prependTranslation:function(t,n){this.setMatrix(i.Matrix3.translationTimesMatrix(t,n,this.matrix))},append:function(t){this.setMatrix(this.matrix.timesMatrix(t))},prependTransform:function(t){this.prepend(t.matrix)},appendTransform:function(t){this.append(t.matrix)},applyToCanvasContext:function(t){t.setTransform(this.matrix.m00(),this.matrix.m10(),this.matrix.m01(),this.matrix.m11(),this.matrix.m02(),this.matrix.m12())},copy:function(){var t=new n(this.matrix);t.inverse=this.inverse,t.matrixTransposed=this.matrixTransposed,t.inverseTransposed=this.inverseTransposed},deepCopy:function(){var t=new n(this.matrix.copy());t.inverse=this.inverse?this.inverse.copy():null,t.matrixTransposed=this.matrixTransposed?this.matrixTransposed.copy():null,t.inverseTransposed=this.inverseTransposed?this.inverseTransposed.copy():null},getMatrix:function(){return this.matrix},getInverse:function(){return null===this.inverse&&(this.inverse=this.matrix.inverted()),this.inverse},getMatrixTransposed:function(){return null===this.matrixTransposed&&(this.matrixTransposed=this.matrix.transposed()),this.matrixTransposed},getInverseTransposed:function(){return null===this.inverseTransposed&&(this.inverseTransposed=this.getInverse().transposed()),this.inverseTransposed},isIdentity:function(){return this.matrix.type===i.Matrix3.Types.IDENTITY},isFinite:function(){return this.matrix.isFinite()},transformPosition2:function(t){return this.matrix.timesVector2(t)},transformDelta2:function(t){var n=this.getMatrix();return new i.Vector2(n.m00()*t.x+n.m01()*t.y,n.m10()*t.x+n.m11()*t.y)},transformNormal2:function(t){return this.getInverse().timesTransposeVector2(t)},transformX:function(t){var i=this.getMatrix();return i.m00()*t+i.m02()},transformY:function(t){var i=this.getMatrix();return i.m11()*t+i.m12()},transformDeltaX:function(t){var i=this.getMatrix();return i.m00()*t},transformDeltaY:function(t){var i=this.getMatrix();return i.m11()*t},transformBounds2:function(t){return t.transformed(this.matrix)},transformShape:function(t){return t.transformed(this.matrix)},transformRay2:function(t){return new i.Ray2(this.transformPosition2(t.pos),this.transformDelta2(t.dir).normalized())},inversePosition2:function(t){return this.getInverse().timesVector2(t)},inverseDelta2:function(t){var n=this.getInverse();return new i.Vector2(n.m00()*t.x+n.m01()*t.y,n.m10()*t.x+n.m11()*t.y)},inverseNormal2:function(t){return this.matrix.timesTransposeVector2(t)},inverseX:function(t){var i=this.getInverse();return i.m00()*t+i.m02()},inverseY:function(t){var i=this.getInverse();return i.m11()*t+i.m12()},inverseDeltaX:function(t){var i=this.getInverse();return i.m00()*t},inverseDeltaY:function(t){var i=this.getInverse();return i.m11()*t},inverseBounds2:function(t){return t.transformed(this.getInverse())},inverseShape:function(t){return t.transformed(this.getInverse())},inverseRay2:function(t){return new i.Ray2(this.inversePosition2(t.pos),this.inverseDelta2(t.dir).normalized())},addTransformListener:function(t){this.listeners.push(t)},prependTransformListener:function(t){this.listeners.unshift(t)},removeTransformListener:function(t){this.listeners.splice(_.indexOf(this.listeners,t),1)}},n}),n("KITE/segments/EllipticalArc",["require","PHET_CORE/inherit","DOT/Vector2","DOT/Bounds2","DOT/Matrix3","DOT/Transform3","DOT/Util","DOT/Util","KITE/kite","KITE/segments/Segment","KITE/util/Subpath"],function(t){var i=t("PHET_CORE/inherit"),n=t("DOT/Vector2"),e=t("DOT/Bounds2"),s=t("DOT/Matrix3"),r=t("DOT/Transform3"),o=t("DOT/Util").toDegrees,h=t("DOT/Util"),u=t("KITE/kite"),a=t("KITE/segments/Segment");return t("KITE/util/Subpath"),a.EllipticalArc=function(t,i,n,e,s,r,o){if(0>i&&(i=-i,s=Math.PI-s,r=Math.PI-r,o=!o),0>n&&(n=-n,s=-s,r=-r,o=!o),n>i){e+=Math.PI/2,s-=Math.PI/2,r-=Math.PI/2;var h=i;i=n,n=h}if(this._center=t,this._radiusX=i,this._radiusY=n,this._rotation=e,this._startAngle=s,this._endAngle=r,this._anticlockwise=o,this._unitTransform=void 0,this._start=void 0,this._end=void 0,this._startTangent=void 0,this._endTangent=void 0,this._actualEndAngle=void 0,this._isFullPerimeter=void 0,this._angleDifference=void 0,this._unitArcSegment=void 0,n>i)throw new Error("Not verified to work if radiusX < radiusY")},i(a,a.EllipticalArc,{getCenter:function(){return this._center},get center(){return this.getCenter()},getRadiusX:function(){return this._radiusX},get radiusX(){return this.getRadiusX()},getRadiusY:function(){return this._radiusY},get radiusY(){return this.getRadiusY()},getRotation:function(){return this._rotation},get rotation(){return this.getRotation()},getStartAngle:function(){return this._startAngle},get startAngle(){return this.getStartAngle()},getEndAngle:function(){return this._endAngle},get endAngle(){return this.getEndAngle()},getAnticlockwise:function(){return this._anticlockwise},get anticlockwise(){return this.getAnticlockwise()},getUnitTransform:function(){return void 0===this._unitTransform&&(this._unitTransform=a.EllipticalArc.computeUnitTransform(this._center,this._radiusX,this._radiusY,this._rotation)),this._unitTransform},get unitTransform(){return this.getUnitTransform()},getStart:function(){return void 0===this._start&&(this._start=this.positionAtAngle(this._startAngle)),this._start},get start(){return this.getStart()},getEnd:function(){return void 0===this._end&&(this._end=this.positionAtAngle(this._endAngle)),this._end},get end(){return this.getEnd()},getStartTangent:function(){return void 0===this._startTangent&&(this._startTangent=this.tangentAtAngle(this._startAngle)),this._startTangent},get startTangent(){return this.getStartTangent()},getEndTangent:function(){return void 0===this._endTangent&&(this._endTangent=this.tangentAtAngle(this._endAngle)),this._endTangent},get endTangent(){return this.getEndTangent()},getActualEndAngle:function(){return void 0===this._actualEndAngle&&(this._actualEndAngle=this._anticlockwise?this._startAngle>this._endAngle?this._endAngle:this._startAngle<this._endAngle?this._endAngle-2*Math.PI:this._startAngle:this._startAngle<this._endAngle?this._endAngle:this._startAngle>this._endAngle?this._endAngle+2*Math.PI:this._startAngle),this._actualEndAngle},get actualEndAngle(){return this.getActualEndAngle()},getIsFullPerimeter:function(){return void 0===this._isFullPerimeter&&(this._isFullPerimeter=!this._anticlockwise&&this._endAngle-this._startAngle>=2*Math.PI||this._anticlockwise&&this._startAngle-this._endAngle>=2*Math.PI),this._isFullPerimeter},get isFullPerimeter(){return this.getIsFullPerimeter()},getAngleDifference:function(){return void 0===this._angleDifference&&(this._angleDifference=this._anticlockwise?this._startAngle-this._endAngle:this._endAngle-this._startAngle,this._angleDifference<0&&(this._angleDifference+=2*Math.PI)),this._angleDifference},get angleDifference(){return this.getAngleDifference()},getUnitArcSegment:function(){return void 0===this._unitArcSegment&&(this._unitArcSegment=new a.Arc(n.ZERO,1,this._startAngle,this._endAngle,this._anticlockwise)),this._unitArcSegment},getBounds:function(){if(void 0===this._bounds&&(this._bounds=e.NOTHING.withPoint(this.getStart()).withPoint(this.getEnd()),this._startAngle!==this._endAngle)){var t=Math.atan(-(this._radiusY/this._radiusX)*Math.tan(this._rotation)),i=Math.atan(this._radiusY/this._radiusX/Math.tan(this._rotation));this.possibleExtremaAngles=[t,t+Math.PI,i,i+Math.PI],_.each(this.possibleExtremaAngles,this.includeBoundsAtAngle.bind(this))}return this._bounds},get bounds(){return this.getBounds()},getNondegenerateSegments:function(){if(this._radiusX<=0||this._radiusY<=0||this._startAngle===this._endAngle)return[];if(this._radiusX===this._radiusY){var t=this._startAngle-this._rotation,i=this._endAngle-this._rotation;return Math.abs(this._endAngle-this._startAngle)===2*Math.PI&&(i=this._anticlockwise?t-2*Math.PI:t+2*Math.PI),[new a.Arc(this._center,this._radiusX,t,i,this._anticlockwise)]}return[this]},includeBoundsAtAngle:function(t){this.containsAngle(t)&&(this._bounds=this._bounds.withPoint(this.positionAtAngle(t)))},mapAngle:function(t){return this._startAngle>this.getActualEndAngle()?h.moduloBetweenUp(t,this._startAngle-2*Math.PI,this._startAngle):h.moduloBetweenDown(t,this._startAngle,this._startAngle+2*Math.PI)},tAtAngle:function(t){return(this.mapAngle(t)-this._startAngle)/(this.getActualEndAngle()-this._startAngle)},angleAt:function(t){return this._startAngle+(this.getActualEndAngle()-this._startAngle)*t},positionAt:function(t){return this.positionAtAngle(this.angleAt(t))},tangentAt:function(t){return this.tangentAtAngle(this.angleAt(t))},curvatureAt:function(t){var i=this.angleAt(t),n=this._radiusX*Math.sin(i),e=this._radiusY*Math.cos(i),s=Math.pow(e*e+n*n,1.5);return(this._anticlockwise?-1:1)*this._radiusX*this._radiusY/s},positionAtAngle:function(t){return this.getUnitTransform().transformPosition2(n.createPolar(1,t))},tangentAtAngle:function(t){var i=this.getUnitTransform().transformNormal2(n.createPolar(1,t));return this._anticlockwise?i.perpendicular():i.perpendicular().negated()},containsAngle:function(t){var i=this._anticlockwise?t-this._endAngle:t-this._startAngle,n=i%(2*Math.PI);return 0>n&&(n+=2*Math.PI),n<=this.getAngleDifference()},offsetTo:function(t,i){for(var n=32,e=[],s=[],r=0;n>r;r++){var o=r/(n-1);i&&(o=1-o);var h=this.angleAt(o);e.push(this.positionAtAngle(h).plus(this.tangentAtAngle(h).perpendicular().normalized().times(t))),r>0&&s.push(new a.Line(e[r-1],e[r]))}return s},getSVGPathFragment:function(){var t,i=.01,n=this._anticlockwise?"0":"1",e=o(this._rotation);if(this.getAngleDifference()<2*Math.PI-i)return t=this.getAngleDifference()<Math.PI?"0":"1","A "+u.svgNumber(this._radiusX)+" "+u.svgNumber(this._radiusY)+" "+e+" "+t+" "+n+" "+u.svgNumber(this.getEnd().x)+" "+u.svgNumber(this.getEnd().y);var s=(this._startAngle+this._endAngle)/2,r=this.positionAtAngle(s);t="0";var h="A "+u.svgNumber(this._radiusX)+" "+u.svgNumber(this._radiusY)+" "+e+" "+t+" "+n+" "+u.svgNumber(r.x)+" "+u.svgNumber(r.y),a="A "+u.svgNumber(this._radiusX)+" "+u.svgNumber(this._radiusY)+" "+e+" "+t+" "+n+" "+u.svgNumber(this.getEnd().x)+" "+u.svgNumber(this.getEnd().y);return h+" "+a},strokeLeft:function(t){return this.offsetTo(-t/2,!1)},strokeRight:function(t){return this.offsetTo(t/2,!0)},getInteriorExtremaTs:function(){var t=this,i=[];return _.each(this.possibleExtremaAngles,function(n){if(t.containsAngle(n)){var e=t.tAtAngle(n),s=1e-10;e>s&&1-s>e&&i.push(e)}}),i.sort()},subdivided:function(t){var i=this.angleAt(0),n=this.angleAt(t),e=this.angleAt(1);
return[new a.EllipticalArc(this._center,this._radiusX,this._radiusY,this._rotation,i,n,this._anticlockwise),new a.EllipticalArc(this._center,this._radiusX,this._radiusY,this._rotation,n,e,this._anticlockwise)]},intersectsBounds:function(){throw new Error("Segment.EllipticalArc.intersectsBounds unimplemented")},intersection:function(t){var i=this.getUnitTransform(),n=i.inverseRay2(t),e=this.getUnitArcSegment().intersection(n);return _.map(e,function(n){var e=i.transformPosition2(n.point);return{distance:t.pos.distance(e),point:e,normal:i.inverseNormal2(n.normal),wind:n.wind}})},windingIntersection:function(t){var i=this.getUnitTransform().inverseRay2(t);return this.getUnitArcSegment().windingIntersection(i)},writeToContext:function(t){t.ellipse?t.ellipse(this._center.x,this._center.y,this._radiusX,this._radiusY,this._rotation,this._startAngle,this._endAngle,this._anticlockwise):(this.getUnitTransform().getMatrix().canvasAppendTransform(t),t.arc(0,0,1,this._startAngle,this._endAngle,this._anticlockwise),this.getUnitTransform().getInverse().canvasAppendTransform(t))},transformed:function(t){var i=t.timesVector2(n.createPolar(this._radiusX,this._rotation)).minus(t.timesVector2(n.ZERO)),e=t.timesVector2(n.createPolar(this._radiusY,this._rotation+Math.PI/2)).minus(t.timesVector2(n.ZERO)),s=i.angle(),r=i.magnitude(),o=e.magnitude(),h=t.getDeterminant()<0,u=h?!this._anticlockwise:this._anticlockwise,m=h?-this._startAngle:this._startAngle,c=h?-this._endAngle:this._endAngle;return Math.abs(this._endAngle-this._startAngle)===2*Math.PI&&(c=u?m-2*Math.PI:m+2*Math.PI),new a.EllipticalArc(t.timesVector2(this._center),r,o,s,m,c,u)}}),a.EllipticalArc.computeUnitTransform=function(t,i,n,e){return new r(s.translation(t.x,t.y).timesMatrix(s.rotation2(e)).timesMatrix(s.scaling(i,n)))},a.EllipticalArc}),n("KITE/Shape",["require","KITE/kite","DOT/Vector2","DOT/Bounds2","DOT/Ray2","KITE/util/Subpath","KITE/parser/svgPath","KITE/util/LineStyles","KITE/segments/Arc","KITE/segments/Cubic","KITE/segments/EllipticalArc","KITE/segments/Line","KITE/segments/Quadratic"],function(t){function i(t,i){return new s(t,i)}function n(t,i){return new s(t,i)}var e=t("KITE/kite"),s=t("DOT/Vector2"),r=t("DOT/Bounds2"),o=t("DOT/Ray2"),h=t("KITE/util/Subpath"),u=t("KITE/parser/svgPath");t("KITE/util/LineStyles"),t("KITE/segments/Arc"),t("KITE/segments/Cubic"),t("KITE/segments/EllipticalArc"),t("KITE/segments/Line"),t("KITE/segments/Quadratic"),e.Shape=function(t,i){this.subpaths="object"==typeof t?t:[],this.bounds=(i||r.NOTHING).copy();var n=this;t&&"object"!=typeof t&&_.each(u.parse(t),function(t){n[t.cmd].apply(n,t.args)}),this.resetControlPoints()};var a=e.Shape;return a.prototype={constructor:a,resetControlPoints:function(){this.lastQuadraticControlPoint=null,this.lastCubicControlPoint=null},setQuadraticControlPoint:function(t){this.lastQuadraticControlPoint=t,this.lastCubicControlPoint=null},setCubicControlPoint:function(t){this.lastQuadraticControlPoint=null,this.lastCubicControlPoint=t},moveTo:function(t,i){return this.moveToPoint(n(t,i))},moveToRelative:function(t,i){return this.moveToPointRelative(n(t,i))},moveToPointRelative:function(t){return this.moveToPoint(this.getRelativePoint().plus(t))},moveToPoint:function(t){return this.addSubpath((new e.Subpath).addPoint(t)),this.resetControlPoints(),this},lineTo:function(t,i){return this.lineToPoint(n(t,i))},lineToRelative:function(t,i){return this.lineToPointRelative(n(t,i))},lineToPointRelative:function(t){return this.lineToPoint(this.getRelativePoint().plus(t))},lineToPoint:function(t){if(this.hasSubpaths()){var i=this.getLastSubpath().getLastPoint(),n=t,s=new e.Segment.Line(i,n);this.getLastSubpath().addPoint(n),this.addSegmentAndBounds(s)}else this.ensure(t);return this.resetControlPoints(),this},horizontalLineTo:function(t){return this.lineTo(t,this.getRelativePoint().y)},horizontalLineToRelative:function(t){return this.lineToRelative(t,0)},verticalLineTo:function(t){return this.lineTo(this.getRelativePoint().x,t)},verticalLineToRelative:function(t){return this.lineToRelative(0,t)},quadraticCurveTo:function(t,i,e,s){return this.quadraticCurveToPoint(n(t,i),n(e,s))},quadraticCurveToRelative:function(t,i,e,s){return this.quadraticCurveToPointRelative(n(t,i),n(e,s))},quadraticCurveToPointRelative:function(t,i){var n=this.getRelativePoint();return this.quadraticCurveToPoint(n.plus(t),n.plus(i))},smoothQuadraticCurveTo:function(t,i){return this.quadraticCurveToPoint(this.getSmoothQuadraticControlPoint(),n(t,i))},smoothQuadraticCurveToRelative:function(t,i){return this.quadraticCurveToPoint(this.getSmoothQuadraticControlPoint(),n(t,i).plus(this.getRelativePoint()))},quadraticCurveToPoint:function(t,i){var n=this;this.ensure(t);var s=this.getLastSubpath().getLastPoint(),r=new e.Segment.Quadratic(s,t,i);this.getLastSubpath().addPoint(i);var o=r.getNondegenerateSegments();return _.each(o,function(t){n.addSegmentAndBounds(t)}),this.setQuadraticControlPoint(t),this},cubicCurveTo:function(t,i,e,s,r,o){return this.cubicCurveToPoint(n(t,i),n(e,s),n(r,o))},cubicCurveToRelative:function(t,i,e,s,r,o){return this.cubicCurveToPointRelative(n(t,i),n(e,s),n(r,o))},cubicCurveToPointRelative:function(t,i,n){var e=this.getRelativePoint();return this.cubicCurveToPoint(e.plus(t),e.plus(i),e.plus(n))},smoothCubicCurveTo:function(t,i,e,s){return this.cubicCurveToPoint(this.getSmoothCubicControlPoint(),n(t,i),n(e,s))},smoothCubicCurveToRelative:function(t,i,e,s){return this.cubicCurveToPoint(this.getSmoothCubicControlPoint(),n(t,i).plus(this.getRelativePoint()),n(e,s).plus(this.getRelativePoint()))},cubicCurveToPoint:function(t,i,n){var s=this;this.ensure(t);var r=this.getLastSubpath().getLastPoint(),o=new e.Segment.Cubic(r,t,i,n),h=o.getNondegenerateSegments();return _.each(h,function(t){s.addSegmentAndBounds(t)}),this.getLastSubpath().addPoint(n),this.setCubicControlPoint(i),this},arc:function(t,i,e,s,r,o){return this.arcPoint(n(t,i),e,s,r,o)},arcPoint:function(t,i,n,s,r){var o=new e.Segment.Arc(t,i,n,s,r),h=o.getStart(),u=o.getEnd();return this.hasSubpaths()&&this.getLastSubpath().getLength()>0&&!h.equals(this.getLastSubpath().getLastPoint(),0)&&this.addSegmentAndBounds(new e.Segment.Line(this.getLastSubpath().getLastPoint(),h)),this.hasSubpaths()||this.addSubpath(new e.Subpath),this.getLastSubpath().addPoint(h),this.getLastSubpath().addPoint(u),this.addSegmentAndBounds(o),this.resetControlPoints(),this},ellipticalArc:function(t,i,e,s,r,o,h,u){return this.ellipticalArcPoint(n(t,i),e,s,r,o,h,u)},ellipticalArcPoint:function(t,i,n,s,r,o,h){var u=new e.Segment.EllipticalArc(t,i,n,s,r,o,h),a=u.start,m=u.end;return this.hasSubpaths()&&this.getLastSubpath().getLength()>0&&!a.equals(this.getLastSubpath().getLastPoint(),0)&&this.addSegmentAndBounds(new e.Segment.Line(this.getLastSubpath().getLastPoint(),a)),this.hasSubpaths()||this.addSubpath(new e.Subpath),this.getLastSubpath().addPoint(a),this.getLastSubpath().addPoint(m),this.addSegmentAndBounds(u),this.resetControlPoints(),this},close:function(){if(this.hasSubpaths()){var t=this.getLastSubpath(),i=new e.Subpath;t.close(),this.addSubpath(i),i.addPoint(t.getFirstPoint())}return this.resetControlPoints(),this},ellipticalArcToRelative:function(t,i,n,e,s,r,o){var h=this.getRelativePoint();return this.ellipticalArcTo(t,i,n,e,s,r+h.x,o+h.y)},ellipticalArcTo:function(){throw new Error("ellipticalArcTo unimplemented")},circle:function(t,n,e){if("object"==typeof t){var s=t;return e=n,this.arcPoint(s,e,0,2*Math.PI,!1)}return this.arcPoint(i(t,n),e,0,2*Math.PI,!1)},ellipse:function(t,i,e,s,r){if("object"==typeof t){var o=t;return r=s,s=e,e=i,this.ellipticalArcPoint(o,e,s,r||0,0,2*Math.PI,!1)}return this.ellipticalArcPoint(n(t,i),e,s,r||0,0,2*Math.PI,!1)},rect:function(t,i,s,r){var o=new e.Subpath;return this.addSubpath(o),o.addPoint(n(t,i)),o.addPoint(n(t+s,i)),o.addPoint(n(t+s,i+r)),o.addPoint(n(t,i+r)),this.addSegmentAndBounds(new e.Segment.Line(o.points[0],o.points[1])),this.addSegmentAndBounds(new e.Segment.Line(o.points[1],o.points[2])),this.addSegmentAndBounds(new e.Segment.Line(o.points[2],o.points[3])),o.close(),this.addSubpath(new e.Subpath),this.getLastSubpath().addPoint(n(t,i)),this.resetControlPoints(),this},roundRect:function(t,i,n,e,s,r){var o=t+s,h=t+n-s,u=i+r,a=i+e-r;return s===r?this.arc(h,u,s,-Math.PI/2,0,!1).arc(h,a,s,0,Math.PI/2,!1).arc(o,a,s,Math.PI/2,Math.PI,!1).arc(o,u,s,Math.PI,3*Math.PI/2,!1).close():this.ellipticalArc(h,u,s,r,0,-Math.PI/2,0,!1).ellipticalArc(h,a,s,r,0,0,Math.PI/2,!1).ellipticalArc(o,a,s,r,0,Math.PI/2,Math.PI,!1).ellipticalArc(o,u,s,r,0,Math.PI,3*Math.PI/2,!1).close(),this},polygon:function(t){var i=t.length;if(i>0){this.moveToPoint(t[0]);for(var n=1;i>n;n++)this.lineToPoint(t[n])}return this.close()},copy:function(){return new a(_.map(this.subpaths,function(t){return t.copy()}),this.bounds)},writeToContext:function(t){for(var i=this.subpaths.length,n=0;i>n;n++)this.subpaths[n].writeToContext(t)},getSVGPath:function(){for(var t=[],i=this.subpaths.length,n=0;i>n;n++){var s=this.subpaths[n];if(s.isDrawable()){var r=s.getFirstSegment().start,o="M "+e.svgNumber(r.x)+" "+e.svgNumber(r.y)+" ";o+=_.map(s.segments,function(t){return t.getSVGPathFragment()}).join(" "),s.isClosed()&&(o+=" Z"),t.push(o)}}return t.join(" ")},transformed:function(t){var i=_.map(this.subpaths,function(i){return i.transformed(t)}),n=_.reduce(i,function(t,i){return t.union(i.bounds)},r.NOTHING);return new a(i,n)},nonlinearTransformed:function(t){t=_.extend({minLevels:0,maxLevels:7,distanceEpsilon:.16,curveEpsilon:t&&t.includeCurvature?.002:null},t);var i=_.map(this.subpaths,function(i){return i.nonlinearTransformed(t)}),n=_.reduce(i,function(t,i){return t.union(i.bounds)},r.NOTHING);return new a(i,n)},polarToCartesian:function(t){return this.nonlinearTransformed(_.extend({pointMap:function(t){return s.createPolar(t.y,t.x)},methodName:"polarToCartesian"},t))},toPiecewiseLinear:function(t){return this.nonlinearTransformed(t)},computeBounds:function(t){return t?this.bounds.union(this.getStrokedShape(t).bounds):this.bounds},getBoundsWithTransform:function(t,i){if(t.isAxisAligned())return this.computeBounds(i);for(var n=r.NOTHING.copy(),e=this.subpaths.length,s=0;e>s;s++){var o=this.subpaths[s];n.includeBounds(o.getBoundsWithTransform(t))}return i&&n.includeBounds(this.getStrokedShape(i).getBoundsWithTransform(t)),n},containsPoint:function(t){var i=new o(t,s.X_UNIT);return 0!==this.windingIntersection(i)},intersection:function(t){for(var i=[],n=this.subpaths.length,e=0;n>e;e++){var s=this.subpaths[e];if(s.isDrawable()){for(var r=s.segments.length,o=0;r>o;o++){var h=s.segments[o];i=i.concat(h.intersection(t))}s.hasClosingSegment()&&(i=i.concat(s.getClosingSegment().intersection(t)))}}return _.sortBy(i,function(t){return t.distance})},windingIntersection:function(t){for(var i=0,n=this.subpaths.length,e=0;n>e;e++){var s=this.subpaths[e];if(s.isDrawable()){for(var r=s.segments.length,o=0;r>o;o++)i+=s.segments[o].windingIntersection(t);s.hasClosingSegment()&&(i+=s.getClosingSegment().windingIntersection(t))}}return i},intersectsBounds:function(t){for(var i=this.subpaths.length,n=0;i>n;n++){var e=this.subpaths[n];if(e.isDrawable()){for(var s=e.segments.length,r=0;s>r;r++)if(e.segments[r].intersectsBounds(t))return!0;if(e.hasClosingSegment()&&e.getClosingSegment().intersectsBounds(t))return!0}}return!1},getStrokedShape:function(t){for(var i=[],n=r.NOTHING.copy(),e=this.subpaths.length,s=0;e>s;s++){var o=this.subpaths[s],h=o.stroked(t);i=i.concat(h)}for(e=i.length,s=0;e>s;s++)n.includeBounds(i[s].bounds);return new a(i,n)},getOffsetShape:function(t){for(var i=[],n=r.NOTHING.copy(),e=this.subpaths.length,s=0;e>s;s++)i.push(this.subpaths[s].offset(t));for(e=i.length,s=0;e>s;s++)n.includeBounds(i[s].bounds);return new a(i,n)},toString:function(){return"new kite.Shape( '"+this.getSVGPath()+"' )"},addSegmentAndBounds:function(t){this.getLastSubpath().addSegment(t),this.bounds=this.bounds.includeBounds(this.getLastSubpath().bounds)},ensure:function(t){this.hasSubpaths()||(this.addSubpath(new h),this.getLastSubpath().addPoint(t))},addSubpath:function(t){return this.subpaths.push(t),this},hasSubpaths:function(){return this.subpaths.length>0},getLastSubpath:function(){return _.last(this.subpaths)},getLastPoint:function(){return this.hasSubpaths()?this.getLastSubpath().getLastPoint():null},getLastSegment:function(){if(!this.hasSubpaths())return null;var t=this.getLastSubpath();return t.isDrawable()?t.getLastSegment():null},getSmoothQuadraticControlPoint:function(){var t=this.getLastPoint();return this.lastQuadraticControlPoint?t.plus(t.minus(this.lastQuadraticControlPoint)):t},getSmoothCubicControlPoint:function(){var t=this.getLastPoint();return this.lastCubicControlPoint?t.plus(t.minus(this.lastCubicControlPoint)):t},getRelativePoint:function(){var t=this.getLastPoint();return t?t:s.ZERO}},a.rectangle=function(t,i,n,e){return(new a).rect(t,i,n,e)},a.rect=a.rectangle,a.roundRect=function(t,i,n,e,s,r){return(new a).roundRect(t,i,n,e,s,r)},a.roundRectangle=a.roundRect,a.polygon=function(t){return(new a).polygon(t)},a.bounds=function(t){return(new a).rect(t.minX,t.minY,t.maxX-t.minX,t.maxY-t.minY)},a.lineSegment=function(t,i,n,e){return"number"==typeof t?(new a).moveTo(t,i).lineTo(n,e):(new a).moveToPoint(t).lineToPoint(i)},a.regularPolygon=function(t,i){var n=new a;return _.each(_.range(t),function(e){var r=s.createPolar(i,2*Math.PI*e/t);0===e?n.moveToPoint(r):n.lineToPoint(r)}),n.close()},a.circle=function(t,i,n){return void 0===i?(new a).circle(0,0,t):(new a).circle(t,i,n).close()},a.ellipse=function(t,i,n,e,s){return void 0===e?(new a).ellipse(0,0,t,i,n):(new a).ellipse(t,i,n,e,s).close()},a.arc=function(t,i,n,e,s,r){return(new a).arc(t,i,n,e,s,r)},a}),n("main",["KITE/kite","KITE/Shape","KITE/segments/Arc","KITE/segments/Cubic","KITE/segments/EllipticalArc","KITE/segments/Line","KITE/segments/Quadratic","KITE/segments/Segment","KITE/util/LineStyles","KITE/util/Subpath","KITE/parser/svgPath"],function(t){return t}),n("DOT/Bounds3",["require","DOT/dot","DOT/Vector3"],function(t){var i=t("DOT/dot");t("DOT/Vector3"),i.Bounds3=function(t,i,n,e,s,r){this.minX=t,this.minY=i,this.minZ=n,this.maxX=e,this.maxY=s,this.maxZ=r};var n=i.Bounds3;return n.prototype={constructor:n,isBounds:!0,dimension:3,getWidth:function(){return this.maxX-this.minX},get width(){return this.getWidth()},getHeight:function(){return this.maxY-this.minY},get height(){return this.getHeight()},getDepth:function(){return this.maxZ-this.minZ},get depth(){return this.getDepth()},getX:function(){return this.minX},get x(){return this.getX()},getY:function(){return this.minY},get y(){return this.getY()},getZ:function(){return this.minZ},get z(){return this.getZ()},getMinX:function(){return this.minX},get left(){return this.minX},getMinY:function(){return this.minY},get top(){return this.minY},getMinZ:function(){return this.minZ},get back(){return this.minZ},getMaxX:function(){return this.maxX},get right(){return this.maxX},getMaxY:function(){return this.maxY},get bottom(){return this.maxY},getMaxZ:function(){return this.maxZ},get front(){return this.maxZ},getCenterX:function(){return(this.maxX+this.minX)/2},get centerX(){return this.getCenterX()},getCenterY:function(){return(this.maxY+this.minY)/2},get centerY(){return this.getCenterY()},getCenterZ:function(){return(this.maxZ+this.minZ)/2},get centerZ(){return this.getCenterZ()},getCenter:function(){return new i.Vector3(this.getCenterX(),this.getCenterY(),this.getCenterZ())},get center(){return this.getCenter()},isEmpty:function(){return this.getWidth()<0||this.getHeight()<0||this.getDepth()<0},isFinite:function(){return isFinite(this.minX)&&isFinite(this.minY)&&isFinite(this.minZ)&&isFinite(this.maxX)&&isFinite(this.maxY)&&isFinite(this.maxZ)},isValid:function(){return!this.isEmpty()&&this.isFinite()},containsCoordinates:function(t,i,n){return this.minX<=t&&t<=this.maxX&&this.minY<=i&&i<=this.maxY&&this.minZ<=n&&n<=this.maxZ},containsPoint:function(t){return this.containsCoordinates(t.x,t.y,t.z)},containsBounds:function(t){return this.minX<=t.minX&&this.maxX>=t.maxX&&this.minY<=t.minY&&this.maxY>=t.maxY&&this.minZ<=t.minZ&&this.maxZ>=t.maxZ},intersectsBounds:function(t){return!this.intersection(t).isEmpty()},toString:function(){return"[x:("+this.minX+","+this.maxX+"),y:("+this.minY+","+this.maxY+"),z:("+this.minZ+","+this.maxZ+")]"},equals:function(t){return this.minX===t.minX&&this.minY===t.minY&&this.minZ===t.minZ&&this.maxX===t.maxX&&this.maxY===t.maxY&&this.maxZ===t.maxZ},equalsEpsilon:function(t,i){i=i||0;var n=this.isFinite(),e=t.isFinite();return n&&e?Math.abs(this.minX-t.minX)<i&&Math.abs(this.minY-t.minY)<i&&Math.abs(this.minZ-t.minZ)<i&&Math.abs(this.maxX-t.maxX)<i&&Math.abs(this.maxY-t.maxY)<i&&Math.abs(this.maxZ-t.maxZ)<i:n!==e?!1:this===t?!0:(isFinite(this.minX+t.minX)?Math.abs(this.minX-t.minX)<i:this.minX===t.minX)&&(isFinite(this.minY+t.minY)?Math.abs(this.minY-t.minY)<i:this.minY===t.minY)&&(isFinite(this.minZ+t.minZ)?Math.abs(this.minZ-t.minZ)<i:this.minZ===t.minZ)&&(isFinite(this.maxX+t.maxX)?Math.abs(this.maxX-t.maxX)<i:this.maxX===t.maxX)&&(isFinite(this.maxY+t.maxY)?Math.abs(this.maxY-t.maxY)<i:this.maxY===t.maxY)&&(isFinite(this.maxZ+t.maxZ)?Math.abs(this.maxZ-t.maxZ)<i:this.maxZ===t.maxZ)},copy:function(t){return t?t.set(this):new n(this.minX,this.minY,this.minZ,this.maxX,this.maxY,this.maxZ)},union:function(t){return new n(Math.min(this.minX,t.minX),Math.min(this.minY,t.minY),Math.min(this.minZ,t.minZ),Math.max(this.maxX,t.maxX),Math.max(this.maxY,t.maxY),Math.max(this.maxZ,t.maxZ))},intersection:function(t){return new n(Math.max(this.minX,t.minX),Math.max(this.minY,t.minY),Math.max(this.minZ,t.minZ),Math.min(this.maxX,t.maxX),Math.min(this.maxY,t.maxY),Math.min(this.maxZ,t.maxZ))},withCoordinates:function(t,i,e){return new n(Math.min(this.minX,t),Math.min(this.minY,i),Math.min(this.minZ,e),Math.max(this.maxX,t),Math.max(this.maxY,i),Math.max(this.maxZ,e))},withPoint:function(t){return this.withCoordinates(t.x,t.y,t.z)},withMinX:function(t){return new n(t,this.minY,this.minZ,this.maxX,this.maxY,this.maxZ)},withMinY:function(t){return new n(this.minX,t,this.minZ,this.maxX,this.maxY,this.maxZ)},withMinZ:function(t){return new n(this.minX,this.minY,t,this.maxX,this.maxY,this.maxZ)},withMaxX:function(t){return new n(this.minX,this.minY,this.minZ,t,this.maxY,this.maxZ)},withMaxY:function(t){return new n(this.minX,this.minY,this.minZ,this.maxX,t,this.maxZ)},withMaxZ:function(t){return new n(this.minX,this.minY,this.minZ,this.maxX,this.maxY,t)},roundedOut:function(){return new n(Math.floor(this.minX),Math.floor(this.minY),Math.floor(this.minZ),Math.ceil(this.maxX),Math.ceil(this.maxY),Math.ceil(this.maxZ))},roundedIn:function(){return new n(Math.ceil(this.minX),Math.ceil(this.minY),Math.ceil(this.minZ),Math.floor(this.maxX),Math.floor(this.maxY),Math.floor(this.maxZ))},transformed:function(t){return this.copy().transform(t)},dilated:function(t){return new n(this.minX-t,this.minY-t,this.minZ-t,this.maxX+t,this.maxY+t,this.maxZ+t)},dilatedX:function(t){return new n(this.minX-t,this.minY,this.minZ,this.maxX+t,this.maxY,this.maxZ)},dilatedY:function(t){return new n(this.minX,this.minY-t,this.minZ,this.maxX,this.maxY+t,this.maxZ)},dilatedZ:function(t){return new n(this.minX,this.minY,this.minZ-t,this.maxX,this.maxY,this.maxZ+t)},dilatedXYZ:function(t,i,e){return new n(this.minX-t,this.minY-i,this.minZ-e,this.maxX+t,this.maxY+i,this.maxZ+e)},eroded:function(t){return this.dilated(-t)},erodedX:function(t){return this.dilatedX(-t)},erodedY:function(t){return this.dilatedY(-t)},erodedZ:function(t){return this.dilatedZ(-t)},erodedXYZ:function(t,i,n){return this.dilatedXYZ(-t,-i,-n)},shiftedX:function(t){return new n(this.minX+t,this.minY,this.minZ,this.maxX+t,this.maxY,this.maxZ)},shiftedY:function(t){return new n(this.minX,this.minY+t,this.minZ,this.maxX,this.maxY+t,this.maxZ)},shiftedZ:function(t){return new n(this.minX,this.minY,this.minZ+t,this.maxX,this.maxY,this.maxZ+t)},shifted:function(t,i,e){return new n(this.minX+t,this.minY+i,this.minZ+e,this.maxX+t,this.maxY+i,this.maxZ+e)},setMinMax:function(t,i,n,e,s,r){return this.minX=t,this.minY=i,this.minZ=n,this.maxX=e,this.maxY=s,this.maxZ=r,this},setMinX:function(t){return this.minX=t,this},setMinY:function(t){return this.minY=t,this},setMinZ:function(t){return this.minZ=t,this},setMaxX:function(t){return this.maxX=t,this},setMaxY:function(t){return this.maxY=t,this},setMaxZ:function(t){return this.maxZ=t,this},set:function(t){return this.setMinMax(t.minX,t.minY,t.minZ,t.maxX,t.maxY,t.maxZ)},includeBounds:function(t){return this.setMinMax(Math.min(this.minX,t.minX),Math.min(this.minY,t.minY),Math.min(this.minZ,t.minZ),Math.max(this.maxX,t.maxX),Math.max(this.maxY,t.maxY),Math.max(this.maxZ,t.maxZ))},constrainBounds:function(t){return this.setMinMax(Math.max(this.minX,t.minX),Math.max(this.minY,t.minY),Math.max(this.minZ,t.minZ),Math.min(this.maxX,t.maxX),Math.min(this.maxY,t.maxY),Math.min(this.maxZ,t.maxZ))},addCoordinates:function(t,i,n){return this.setMinMax(Math.min(this.minX,t),Math.min(this.minY,i),Math.min(this.minZ,n),Math.max(this.maxX,t),Math.max(this.maxY,i),Math.max(this.maxZ,n))},addPoint:function(t){return this.addCoordinates(t.x,t.y,t.z)},roundOut:function(){return this.setMinMax(Math.floor(this.minX),Math.floor(this.minY),Math.floor(this.minZ),Math.ceil(this.maxX),Math.ceil(this.maxY),Math.ceil(this.maxZ))},roundIn:function(){return this.setMinMax(Math.ceil(this.minX),Math.ceil(this.minY),Math.ceil(this.minZ),Math.floor(this.maxX),Math.floor(this.maxY),Math.floor(this.maxZ))},transform:function(t){function n(t){e=Math.min(e,t.x),s=Math.min(s,t.y),r=Math.min(r,t.z),o=Math.max(o,t.x),h=Math.max(h,t.y),u=Math.max(u,t.z)}if(this.isEmpty())return this;if(t.isIdentity())return this;var e=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,h=Number.NEGATIVE_INFINITY,u=Number.NEGATIVE_INFINITY,a=new i.Vector3;return n(t.multiplyVector3(a.setXYZ(this.minX,this.minY,this.minZ))),n(t.multiplyVector3(a.setXYZ(this.minX,this.maxY,this.minZ))),n(t.multiplyVector3(a.setXYZ(this.maxX,this.minY,this.minZ))),n(t.multiplyVector3(a.setXYZ(this.maxX,this.maxY,this.minZ))),n(t.multiplyVector3(a.setXYZ(this.minX,this.minY,this.maxZ))),n(t.multiplyVector3(a.setXYZ(this.minX,this.maxY,this.maxZ))),n(t.multiplyVector3(a.setXYZ(this.maxX,this.minY,this.maxZ))),n(t.multiplyVector3(a.setXYZ(this.maxX,this.maxY,this.maxZ))),this.setMinMax(e,s,r,o,h,u)},dilate:function(t){return this.setMinMax(this.minX-t,this.minY-t,this.minZ-t,this.maxX+t,this.maxY+t,this.maxZ+t)},dilateX:function(t){return this.setMinMax(this.minX-t,this.minY,this.minZ,this.maxX+t,this.maxY,this.maxZ)},dilateY:function(t){return this.setMinMax(this.minX,this.minY-t,this.minZ,this.maxX,this.maxY+t,this.maxZ)},dilateZ:function(t){return this.setMinMax(this.minX,this.minY,this.minZ-t,this.maxX,this.maxY,this.maxZ+t)},dilateXYZ:function(t,i,n){return this.setMinMax(this.minX-t,this.minY-i,this.minZ-n,this.maxX+t,this.maxY+i,this.maxZ+n)},erode:function(t){return this.dilate(-t)},erodeX:function(t){return this.dilateX(-t)},erodeY:function(t){return this.dilateY(-t)},erodeZ:function(t){return this.dilateZ(-t)},erodeXYZ:function(t,i,n){return this.dilateXYZ(-t,-i,-n)},shiftX:function(t){return this.setMinMax(this.minX+t,this.minY,this.minZ,this.maxX+t,this.maxY,this.maxZ)},shiftY:function(t){return this.setMinMax(this.minX,this.minY+t,this.minZ,this.maxX,this.maxY+t,this.maxZ)},shiftZ:function(t){return this.setMinMax(this.minX,this.minY,this.minZ+t,this.maxX,this.maxY,this.maxZ+t)},shift:function(t,i,n){return this.setMinMax(this.minX+t,this.minY+i,this.minZ+n,this.maxX+t,this.maxY+i,this.maxZ+n)}},n.cuboid=function(t,i,e,s,r,o){return new n(t,i,e,t+s,i+r,e+o)},n.point=function(t,i,e){return new n(t,i,e,t,i,e)},n.EVERYTHING=new n(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),n.NOTHING=new n(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),n}),n("DOT/Complex",["require","DOT/dot","PHET_CORE/inherit","DOT/Vector2"],function(t){var i=t("DOT/dot"),n=t("PHET_CORE/inherit"),e=t("DOT/Vector2");i.Complex=function(t,i){e.call(this,t,i),this.real=t,this.imaginary=i};var s=i.Complex;return s.real=function(t){return new s(t,0)},s.imaginary=function(t){return new s(0,t)},s.createPolar=function(t,i){return new s(t*Math.cos(i),t*Math.sin(i))},n(e.Immutable,s,{phase:e.prototype.angle,times:function(t){return new s(this.real*t.real-this.imaginary*t.imaginary,this.real*t.imaginary+this.imaginary*t.real)},dividedBy:function(t){var i=t.magnitudeSquared();return new s((this.real*t.real+this.imaginary*t.imaginary)/i,(this.imaginary*t.real-this.real*t.imaginary)/i)},sqrt:function(){var t=this.magnitude();return new s(Math.sqrt((t+this.real)/2),(this.imaginary>=0?1:-1)*Math.sqrt((t-this.real)/2))},conjugate:function(){return new s(this.real,-this.imaginary)},exponentiated:function(){return s.createPolar(Math.exp(this.real),this.imaginary)},toString:function(){return"Complex("+this.x+", "+this.y+")"}}),s.ZERO=new s(0,0),s.ONE=new s(1,0),s.I=new s(0,1),s}),n("DOT/ConvexHull2",["require","DOT/dot"],function(t){function i(t,i,n){return i.minus(t).crossScalar(n.minus(t))}var n=t("DOT/dot");return n.ConvexHull2={grahamScan:function(t,n){if(t.length<=2)return t;var e=Number.POSITIVE_INFINITY,s=null;_.each(t,function(t){t.y<=e&&(t.y===e&&s?t.x<s.x&&(s=t):(e=t.y,s=t))}),t=_.sortBy(t,function(t){return t.minus(s).angle()}),t.splice(_.indexOf(t,s),1);var r=[s];return _.each(t,function(t){function e(){if(r.length<2)return!1;var e=i(r[r.length-2],r[r.length-1],t);return n?0>e:0>=e}if(s.x!==t.x||s.y!==t.y){for(;e();)r.pop();r.push(t)}}),r}},n.ConvexHull2}),n("DOT/Dimension2",["require","DOT/dot","DOT/Bounds2"],function(t){var i=t("DOT/dot");t("DOT/Bounds2"),i.Dimension2=function(t,i){this.width=t,this.height=i};var n=i.Dimension2;return n.prototype={constructor:n,toString:function(){return"["+this.width+"w, "+this.height+"h]"},set:function(t){return this.width=t.width,this.height=t.height,this},setWidth:function(t){return this.width=t,this},setHeight:function(t){return this.width=t,this},copy:function(t){return t?t.set(this):new n(this.width,this.height)},toBounds:function(t,n){return t=t||0,n=n||0,new i.Bounds2(t,n,this.width+t,this.height+n)},equals:function(t){return this.width===t.width&&this.height===t.height}},n}),n("DOT/EigenvalueDecomposition",["require","DOT/dot"],function(t){var i=t("DOT/dot"),n=window.Float32Array||Array;i.EigenvalueDecomposition=function(t){var i,e,s=t.entries;this.n=t.getColumnDimension();var r=this.n;for(this.V=new n(r*r),this.d=new n(r),this.e=new n(r),this.issymmetric=!0,e=0;r>e&&this.issymmetric;e++)for(i=0;r>i&&this.issymmetric;i++)this.issymmetric=s[i*this.n+e]===s[e*this.n+i];if(this.issymmetric){for(i=0;r>i;i++)for(e=0;r>e;e++)this.V[i*this.n+e]=s[i*this.n+e];this.tred2(),this.tql2()}else{for(this.H=new n(r*r),this.ort=new n(r),e=0;r>e;e++)for(i=0;r>i;i++)this.H[i*this.n+e]=s[i*this.n+e];this.orthes(),this.hqr2()}};var e=i.EigenvalueDecomposition;return e.prototype={constructor:e,getV:function(){return this.V.copy()},getRealEigenvalues:function(){return this.d},getImagEigenvalues:function(){return this.e},getD:function(){for(var t=this.n,n=this.d,e=this.e,s=new i.Matrix(t,t),r=s.entries,o=0;t>o;o++){for(var h=0;t>h;h++)r[o*this.n+h]=0;r[o*this.n+o]=n[o],e[o]>0?r[o*this.n+o+1]=e[o]:e[o]<0&&(r[o*this.n+o-1]=e[o])}return s},tred2:function(){var t,i,n,e,s,r,o=this.n,h=this.V,u=this.d,a=this.e;for(i=0;o>i;i++)u[i]=h[(o-1)*o+i];for(t=o-1;t>0;t--){var m=0;for(r=0,n=0;t>n;n++)m+=Math.abs(u[n]);if(0===m)for(a[t]=u[t-1],i=0;t>i;i++)u[i]=h[(t-1)*o+i],h[t*this.n+i]=0,h[i*this.n+t]=0;else{for(n=0;t>n;n++)u[n]/=m,r+=u[n]*u[n];for(e=u[t-1],s=Math.sqrt(r),e>0&&(s=-s),a[t]=m*s,r-=e*s,u[t-1]=e-s,i=0;t>i;i++)a[i]=0;for(i=0;t>i;i++){for(e=u[i],h[i*this.n+t]=e,s=a[i]+h[i*o+i]*e,n=i+1;t-1>=n;n++)s+=h[n*o+i]*u[n],a[n]+=h[n*o+i]*e;a[i]=s}for(e=0,i=0;t>i;i++)a[i]/=r,e+=a[i]*u[i];var c=e/(r+r);for(i=0;t>i;i++)a[i]-=c*u[i];for(i=0;t>i;i++){for(e=u[i],s=a[i],n=i;t-1>=n;n++)h[n*o+i]-=e*a[n]+s*u[n];u[i]=h[(t-1)*o+i],h[t*this.n+i]=0}}u[t]=r}for(t=0;o-1>t;t++){if(h[(o-1)*o+t]=h[t*o+t],h[t*o+t]=1,r=u[t+1],0!==r){for(n=0;t>=n;n++)u[n]=h[n*o+(t+1)]/r;for(i=0;t>=i;i++){for(s=0,n=0;t>=n;n++)s+=h[n*o+(t+1)]*h[n*o+i];for(n=0;t>=n;n++)h[n*o+i]-=s*u[n]}}for(n=0;t>=n;n++)h[n*o+(t+1)]=0}for(i=0;o>i;i++)u[i]=h[(o-1)*o+i],h[(o-1)*o+i]=0;h[(o-1)*o+(o-1)]=1,a[0]=0},tql2:function(){var t,n,e,s,r,o,h,u=this.n,a=this.V,m=this.d,c=this.e;for(t=1;u>t;t++)c[t-1]=c[t];c[u-1]=0;var l=0,f=0,d=Math.pow(2,-52);for(s=0;u>s;s++){f=Math.max(f,Math.abs(m[s])+Math.abs(c[s]));for(var g=s;u>g&&!(Math.abs(c[g])<=d*f);)g++;if(g>s){h=0;do{h+=1,r=m[s],o=(m[s+1]-r)/(2*c[s]);var x=i.Matrix.hypot(o,1);0>o&&(x=-x),m[s]=c[s]/(o+x),m[s+1]=c[s]*(o+x);var p=m[s+1],v=r-m[s];for(t=s+2;u>t;t++)m[t]-=v;l+=v,o=m[g];var T=1,_=T,w=T,y=c[s+1],b=0,M=0;for(t=g-1;t>=s;t--)for(w=_,_=T,M=b,r=T*c[t],v=T*o,x=i.Matrix.hypot(o,c[t]),c[t+1]=b*x,b=c[t]/x,T=o/x,o=T*m[t]-b*r,m[t+1]=v+b*(T*r+b*m[t]),e=0;u>e;e++)v=a[e*u+(t+1)],a[e*u+(t+1)]=b*a[e*u+t]+T*v,a[e*u+t]=T*a[e*u+t]-b*v;o=-b*M*w*y*c[s]/p,c[s]=b*o,m[s]=T*o}while(Math.abs(c[s])>d*f)}m[s]=m[s]+l,c[s]=0}for(t=0;u-1>t;t++){for(e=t,o=m[t],n=t+1;u>n;n++)m[n]<o&&(e=n,o=m[n]);if(e!==t)for(m[e]=m[t],m[t]=o,n=0;u>n;n++)o=a[n*this.n+t],a[n*this.n+t]=a[n*u+e],a[n*u+e]=o}},orthes:function(){var t,i,n,e,s,r=this.n,o=this.V,h=this.H,u=this.ort,a=0,m=r-1;for(n=a+1;m-1>=n;n++){var c=0;for(t=n;m>=t;t++)c+=Math.abs(h[t*r+(n-1)]);if(0!==c){var l=0;for(t=m;t>=n;t--)u[t]=h[t*r+(n-1)]/c,l+=u[t]*u[t];for(s=Math.sqrt(l),u[n]>0&&(s=-s),l-=u[n]*s,u[n]=u[n]-s,i=n;r>i;i++){for(e=0,t=m;t>=n;t--)e+=u[t]*h[t*this.n+i];for(e/=l,t=n;m>=t;t++)h[t*this.n+i]-=e*u[t]}for(t=0;m>=t;t++){for(e=0,i=m;i>=n;i--)e+=u[i]*h[t*this.n+i];for(e/=l,i=n;m>=i;i++)h[t*this.n+i]-=e*u[i]}u[n]=c*u[n],h[n*r+(n-1)]=c*s}}for(t=0;r>t;t++)for(i=0;r>i;i++)o[t*this.n+i]=t===i?1:0;for(n=m-1;n>=a+1;n--)if(0!==h[n*r+(n-1)]){for(t=n+1;m>=t;t++)u[t]=h[t*r+(n-1)];for(i=n;m>=i;i++){for(s=0,t=n;m>=t;t++)s+=u[t]*o[t*this.n+i];for(s=s/u[n]/h[n*r+(n-1)],t=n;m>=t;t++)o[t*this.n+i]+=s*u[t]}}},cdiv:function(t,i,n,e){var s,r;Math.abs(n)>Math.abs(e)?(s=e/n,r=n+s*e,this.cdivr=(t+s*i)/r,this.cdivi=(i-s*t)/r):(s=n/e,r=e+s*n,this.cdivr=(s*t+i)/r,this.cdivi=(s*i-t)/r)},hqr2:function(){var t,i,n,e,s,r,o,h=this.V,u=this.d,a=this.e,m=this.H,c=this.n;t=c-1;var l,f,d,g,x=0,p=c-1,v=Math.pow(2,-52),T=0,_=0,w=0,y=0,b=0,M=0,E=0;for(i=0;c>i;i++)for((x>i||i>p)&&(u[i]=m[i*t+i],a[i]=0),n=Math.max(i-1,0);c>n;n++)E+=Math.abs(m[i*this.n+n]);for(o=0;t>=x;){for(s=t;s>x&&(b=Math.abs(m[(s-1)*t+(s-1)])+Math.abs(m[s*t+s]),0===b&&(b=E),!(Math.abs(m[s*t+(s-1)])<v*b));)s--;if(s===t)m[t*t+t]=m[t*t+t]+T,u[t]=m[t*t+t],a[t]=0,t--,o=0;else if(s===t-1){if(f=m[t*t+t-1]*m[(t-1)*t+t],_=(m[(t-1)*t+(t-1)]-m[t*t+t])/2,w=_*_+f,M=Math.sqrt(Math.abs(w)),m[t*t+t]=m[t*t+t]+T,m[(t-1)*t+(t-1)]=m[(t-1)*t+(t-1)]+T,d=m[t*t+t],w>=0){for(M=_>=0?_+M:_-M,u[t-1]=d+M,u[t]=u[t-1],0!==M&&(u[t]=d-f/M),a[t-1]=0,a[t]=0,d=m[t*t+t-1],b=Math.abs(d)+Math.abs(M),_=d/b,w=M/b,y=Math.sqrt(_*_+w*w),_/=y,w/=y,n=t-1;c>n;n++)M=m[(t-1)*t+n],m[(t-1)*t+n]=w*M+_*m[t*t+n],m[t*t+n]=w*m[t*t+n]-_*M;for(i=0;t>=i;i++)M=m[i*t+t-1],m[i*t+t-1]=w*M+_*m[i*t+t],m[i*t+t]=w*m[i*t+t]-_*M;for(i=x;p>=i;i++)M=h[i*t+t-1],h[i*t+t-1]=w*M+_*h[i*t+t],h[i*t+t]=w*h[i*t+t]-_*M}else u[t-1]=d+_,u[t]=d+_,a[t-1]=M,a[t]=-M;t-=2,o=0}else{if(d=m[t*t+t],g=0,f=0,t>s&&(g=m[(t-1)*t+(t-1)],f=m[t*t+t-1]*m[(t-1)*t+t]),10===o){for(T+=d,i=x;t>=i;i++)m[i*t+i]-=d;b=Math.abs(m[t*t+t-1])+Math.abs(m[(t-1)*t+t-2]),d=g=.75*b,f=-.4375*b*b}if(30===o&&(b=(g-d)/2,b=b*b+f,b>0)){for(b=Math.sqrt(b),d>g&&(b=-b),b=d-f/((g-d)/2+b),i=x;t>=i;i++)m[i*t+i]-=b;T+=b,d=g=f=.964}for(o+=1,r=t-2;r>=s&&(M=m[r*t+r],y=d-M,b=g-M,_=(y*b-f)/m[(r+1)*t+r]+m[r*t+r+1],w=m[(r+1)*t+r+1]-M-y-b,y=m[(r+2)*t+r+1],b=Math.abs(_)+Math.abs(w)+Math.abs(y),_/=b,w/=b,y/=b,r!==s)&&!(Math.abs(m[r*t+(r-1)])*(Math.abs(w)+Math.abs(y))<v*Math.abs(_)*(Math.abs(m[(r-1)*t+r-1])+Math.abs(M)+Math.abs(m[(r+1)*t+r+1])));)r--;
for(i=r+2;t>=i;i++)m[i*t+i-2]=0,i>r+2&&(m[i*t+i-3]=0);for(e=r;t-1>=e;e++){var O=e!==t-1;if(e!==r&&(_=m[e*t+e-1],w=m[(e+1)*t+e-1],y=O?m[(e+2)*t+e-1]:0,d=Math.abs(_)+Math.abs(w)+Math.abs(y),0!==d&&(_/=d,w/=d,y/=d)),0===d)break;if(b=Math.sqrt(_*_+w*w+y*y),0>_&&(b=-b),0!==b){for(e!==r?m[e*t+e-1]=-b*d:s!==r&&(m[e*t+e-1]=-m[e*t+e-1]),_+=b,d=_/b,g=w/b,M=y/b,w/=_,y/=_,n=e;c>n;n++)_=m[e*t+n]+w*m[(e+1)*t+n],O&&(_+=y*m[(e+2)*t+n],m[(e+2)*t+n]=m[(e+2)*t+n]-_*M),m[e*t+n]=m[e*t+n]-_*d,m[(e+1)*t+n]=m[(e+1)*t+n]-_*g;for(i=0;i<=Math.min(t,e+3);i++)_=d*m[i*t+e]+g*m[i*t+e+1],O&&(_+=M*m[i*t+e+2],m[i*t+e+2]=m[i*t+e+2]-_*y),m[i*t+e]=m[i*t+e]-_,m[i*t+e+1]=m[i*t+e+1]-_*w;for(i=x;p>=i;i++)_=d*h[i*t+e]+g*h[i*t+e+1],O&&(_+=M*h[i*t+e+2],h[i*t+e+2]=h[i*t+e+2]-_*y),h[i*t+e]=h[i*t+e]-_,h[i*t+e+1]=h[i*t+e+1]-_*w}}}}if(0!==E){for(t=c-1;t>=0;t--)if(_=u[t],w=a[t],0===w)for(s=t,m[t*t+t]=1,i=t-1;i>=0;i--){for(f=m[i*t+i]-_,y=0,n=s;t>=n;n++)y+=m[i*this.n+n]*m[n*t+t];if(a[i]<0)M=f,b=y;else if(s=i,0===a[i]?m[i*t+t]=0!==f?-y/f:-y/(v*E):(d=m[i*t+i+1],g=m[(i+1)*t+i],w=(u[i]-_)*(u[i]-_)+a[i]*a[i],l=(d*b-M*y)/w,m[i*t+t]=l,m[(i+1)*t+t]=Math.abs(d)>Math.abs(M)?(-y-f*l)/d:(-b-g*l)/M),l=Math.abs(m[i*t+t]),v*l*l>1)for(n=i;t>=n;n++)m[n*t+t]=m[n*t+t]/l}else if(0>w)for(s=t-1,Math.abs(m[t*t+t-1])>Math.abs(m[(t-1)*t+t])?(m[(t-1)*t+(t-1)]=w/m[t*t+t-1],m[(t-1)*t+t]=-(m[t*t+t]-_)/m[t*t+t-1]):(this.cdiv(0,-m[(t-1)*t+t],m[(t-1)*t+(t-1)]-_,w),m[(t-1)*t+(t-1)]=this.cdivr,m[(t-1)*t+t]=this.cdivi),m[t*t+t-1]=0,m[t*t+t]=1,i=t-2;i>=0;i--){var A,P,I,S;for(A=0,P=0,n=s;t>=n;n++)A+=m[i*this.n+n]*m[n*t+t-1],P+=m[i*this.n+n]*m[n*t+t];if(f=m[i*t+i]-_,a[i]<0)M=f,y=A,b=P;else if(s=i,0===a[i]?(this.cdiv(-A,-P,f,w),m[i*t+t-1]=this.cdivr,m[i*t+t]=this.cdivi):(d=m[i*t+i+1],g=m[(i+1)*t+i],I=(u[i]-_)*(u[i]-_)+a[i]*a[i]-w*w,S=2*(u[i]-_)*w,0===I&&0===S&&(I=v*E*(Math.abs(f)+Math.abs(w)+Math.abs(d)+Math.abs(g)+Math.abs(M))),this.cdiv(d*y-M*A+w*P,d*b-M*P-w*A,I,S),m[i*t+t-1]=this.cdivr,m[i*t+t]=this.cdivi,Math.abs(d)>Math.abs(M)+Math.abs(w)?(m[(i+1)*t+t-1]=(-A-f*m[i*t+t-1]+w*m[i*t+t])/d,m[(i+1)*t+t]=(-P-f*m[i*t+t]-w*m[i*t+t-1])/d):(this.cdiv(-y-g*m[i*t+t-1],-b-g*m[i*t+t],M,w),m[(i+1)*t+t-1]=this.cdivr,m[(i+1)*t+t]=this.cdivi)),l=Math.max(Math.abs(m[i*t+t-1]),Math.abs(m[i*t+t])),v*l*l>1)for(n=i;t>=n;n++)m[n*t+t-1]=m[n*t+t-1]/l,m[n*t+t]=m[n*t+t]/l}for(i=0;c>i;i++)if(x>i||i>p)for(n=i;c>n;n++)h[i*this.n+n]=m[i*this.n+n];for(n=c-1;n>=x;n--)for(i=x;p>=i;i++){for(M=0,e=x;e<=Math.min(n,p);e++)M+=h[i*t+e]*m[e*t+n];h[i*this.n+n]=M}}}},e}),n("DOT/LinearFunction",["require","DOT/dot","DOT/Util"],function(t){var i=t("DOT/dot");return t("DOT/Util"),i.LinearFunction=function(t,n,e,s,r){r=_.isUndefined(r)?!1:r;var o=function(t,n,e,s,r,o){var h=i.Util.linear(t,n,e,s,r);if(o){var u=Math.max(e,s),a=Math.min(e,s);h=i.Util.clamp(h,a,u)}return h},h=function(i){return o(t,n,e,s,i,r)};return h.inverse=function(i){return o(e,s,t,n,i,r)},h},i.LinearFunction}),n("DOT/LUDecomposition",["require","DOT/dot"],function(t){var i=t("DOT/dot"),n=window.Float32Array||Array;i.LUDecomposition=function(t){var i,e,s;this.matrix=t,this.LU=t.getArrayCopy();var r=this.LU;this.m=t.getRowDimension();var o=this.m;this.n=t.getColumnDimension();var h=this.n;for(this.piv=new Uint32Array(o),i=0;o>i;i++)this.piv[i]=i;this.pivsign=1;var u=new n(o);for(e=0;h>e;e++){for(i=0;o>i;i++)u[i]=r[t.index(i,e)];for(i=0;o>i;i++){var a=Math.min(i,e),m=0;for(s=0;a>s;s++){var c=t.index(i,s);m+=r[c]*u[s]}u[i]-=m,r[t.index(i,e)]=u[i]}var l=e;for(i=e+1;o>i;i++)Math.abs(u[i])>Math.abs(u[l])&&(l=i);if(l!==e){for(s=0;h>s;s++){var f=t.index(l,s),d=t.index(e,s),g=r[f];r[f]=r[d],r[d]=g}s=this.piv[l],this.piv[l]=this.piv[e],this.piv[e]=s,this.pivsign=-this.pivsign}if(o>e&&0!==r[this.matrix.index(e,e)])for(i=e+1;o>i;i++)r[t.index(i,e)]/=r[t.index(e,e)]}};var e=i.LUDecomposition;return e.prototype={constructor:e,isNonsingular:function(){for(var t=0;t<this.n;t++){var i=this.matrix.index(t,t);if(0===this.LU[i])return!1}return!0},getL:function(){for(var t=new i.Matrix(this.m,this.n),n=0;n<this.m;n++)for(var e=0;e<this.n;e++)t.entries[t.index(n,e)]=n>e?this.LU[this.matrix.index(n,e)]:n===e?1:0;return t},getU:function(){for(var t=new i.Matrix(this.n,this.n),n=0;n<this.n;n++)for(var e=0;e<this.n;e++)t.entries[t.index(n,e)]=e>=n?this.LU[this.matrix.index(n,e)]:0;return t},getPivot:function(){for(var t=new Uint32Array(this.m),i=0;i<this.m;i++)t[i]=this.piv[i];return t},getDoublePivot:function(){for(var t=new n(this.m),i=0;i<this.m;i++)t[i]=this.piv[i];return t},det:function(){if(this.m!==this.n)throw new Error("Matrix must be square.");for(var t=this.pivsign,i=0;i<this.n;i++)t*=this.LU[this.matrix.index(i,i)];return t},solve:function(t){var i,n,e;if(t.getRowDimension()!==this.m)throw new Error("Matrix row dimensions must agree.");if(!this.isNonsingular())throw new Error("Matrix is singular.");var s=t.getColumnDimension(),r=t.getArrayRowMatrix(this.piv,0,s-1);for(e=0;e<this.n;e++)for(i=e+1;i<this.n;i++)for(n=0;s>n;n++)r.entries[r.index(i,n)]-=r.entries[r.index(e,n)]*this.LU[this.matrix.index(i,e)];for(e=this.n-1;e>=0;e--){for(n=0;s>n;n++)r.entries[r.index(e,n)]/=this.LU[this.matrix.index(e,e)];for(i=0;e>i;i++)for(n=0;s>n;n++)r.entries[r.index(i,n)]-=r.entries[r.index(e,n)]*this.LU[this.matrix.index(i,e)]}return r}},e}),n("PHET_CORE/isArray",["require","PHET_CORE/core"],function(t){var i=t("PHET_CORE/core");return i.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},i.isArray}),n("DOT/SingularValueDecomposition",["require","DOT/dot"],function(t){var i=t("DOT/dot"),n=window.Float32Array||Array;i.SingularValueDecomposition=function(t){this.matrix=t;var e=t,s=e.getArrayCopy();this.m=e.getRowDimension(),this.n=e.getColumnDimension();var r=this.m,o=this.n,h=Math.min,u=Math.max,a=Math.pow,m=Math.abs,c=h(r,o);this.s=new n(h(r+1,o));var l=this.s;this.U=new n(r*c);var f=this.U;this.V=new n(o*o);var d,g,x,p,v,T,_,w=this.V,y=new n(o),b=new n(r),M=!0,E=!0,O=i.Matrix.hypot,A=h(r-1,o),P=u(0,h(o-2,r));for(x=0;x<u(A,P);x++){if(A>x){for(l[x]=0,d=x;r>d;d++)l[x]=O(l[x],s[d*o+x]);if(0!==l[x]){for(s[x*o+x]<0&&(l[x]=-l[x]),d=x;r>d;d++)s[d*o+x]/=l[x];s[x*o+x]+=1}l[x]=-l[x]}for(g=x+1;o>g;g++){if(A>x&&0!==l[x]){for(p=0,d=x;r>d;d++)p+=s[d*o+x]*s[d*o+g];for(p=-p/s[x*o+x],d=x;r>d;d++)s[d*o+g]+=p*s[d*o+x]}y[g]=s[x*o+g]}if(M&&A>x)for(d=x;r>d;d++)f[d*c+x]=s[d*o+x];if(P>x){for(y[x]=0,d=x+1;o>d;d++)y[x]=O(y[x],y[d]);if(0!==y[x]){for(y[x+1]<0&&(y[x]=-y[x]),d=x+1;o>d;d++)y[d]/=y[x];y[x+1]+=1}if(y[x]=-y[x],r>x+1&&0!==y[x]){for(d=x+1;r>d;d++)b[d]=0;for(g=x+1;o>g;g++)for(d=x+1;r>d;d++)b[d]+=y[g]*s[d*o+g];for(g=x+1;o>g;g++)for(p=-y[g]/y[x+1],d=x+1;r>d;d++)s[d*o+g]+=p*b[d]}if(E)for(d=x+1;o>d;d++)w[d*o+x]=y[d]}}var I=h(o,r+1);if(o>A&&(l[A]=s[A*o+A]),I>r&&(l[I-1]=0),I>P+1&&(y[P]=s[P*o+I-1]),y[I-1]=0,M){for(g=A;c>g;g++){for(d=0;r>d;d++)f[d*c+g]=0;f[g*c+g]=1}for(x=A-1;x>=0;x--)if(0!==l[x]){for(g=x+1;c>g;g++){for(p=0,d=x;r>d;d++)p+=f[d*c+x]*f[d*c+g];for(p=-p/f[x*c+x],d=x;r>d;d++)f[d*c+g]+=p*f[d*c+x]}for(d=x;r>d;d++)f[d*c+x]=-f[d*c+x];for(f[x*c+x]=1+f[x*c+x],d=0;x-1>d;d++)f[d*c+x]=0}else{for(d=0;r>d;d++)f[d*c+x]=0;f[x*c+x]=1}}if(E)for(x=o-1;x>=0;x--){if(P>x&&0!==y[x])for(g=x+1;c>g;g++){for(p=0,d=x+1;o>d;d++)p+=w[d*o+x]*w[d*o+g];for(p=-p/w[(x+1)*o+x],d=x+1;o>d;d++)w[d*o+g]+=p*w[d*o+x]}for(d=0;o>d;d++)w[d*o+x]=0;w[x*o+x]=1}for(var S=I-1,Y=0,D=a(2,-52),C=a(2,-966);I>0;){var X;if(Y>500)break;for(x=I-2;x>=-1&&-1!==x;x--)if(m(y[x])<=C+D*(m(l[x])+m(l[x+1]))){y[x]=0;break}if(x===I-2)X=4;else{var R;for(R=I-1;R>=x&&R!==x;R--)if(p=(R!==I?m(y[R]):0)+(R!==x+1?m(y[R-1]):0),m(l[R])<=C+D*p){l[R]=0;break}R===x?X=3:R===I-1?X=1:(X=2,x=R)}switch(x++,X){case 1:for(v=y[I-2],y[I-2]=0,g=I-2;g>=x;g--)if(p=O(l[g],v),T=l[g]/p,_=v/p,l[g]=p,g!==x&&(v=-_*y[g-1],y[g-1]=T*y[g-1]),E)for(d=0;o>d;d++)p=T*w[d*o+g]+_*w[d*o+I-1],w[d*o+I-1]=-_*w[d*o+g]+T*w[d*o+I-1],w[d*o+g]=p;break;case 2:for(v=y[x-1],y[x-1]=0,g=x;I>g;g++)if(p=O(l[g],v),T=l[g]/p,_=v/p,l[g]=p,v=-_*y[g],y[g]=T*y[g],M)for(d=0;r>d;d++)p=T*f[d*c+g]+_*f[d*c+x-1],f[d*c+x-1]=-_*f[d*c+g]+T*f[d*c+x-1],f[d*c+g]=p;break;case 3:var N=u(u(u(u(m(l[I-1]),m(l[I-2])),m(y[I-2])),m(l[x])),m(y[x])),V=l[I-1]/N,j=l[I-2]/N,z=y[I-2]/N,F=l[x]/N,q=y[x]/N,L=((j+V)*(j-V)+z*z)/2,Z=V*z*V*z,H=0;(0!==L||0!==Z)&&(H=Math.sqrt(L*L+Z),0>L&&(H=-H),H=Z/(L+H)),v=(F+V)*(F-V)+H;var k=F*q;for(g=x;I-1>g;g++){if(p=O(v,k),T=v/p,_=k/p,g!==x&&(y[g-1]=p),v=T*l[g]+_*y[g],y[g]=T*y[g]-_*l[g],k=_*l[g+1],l[g+1]=T*l[g+1],E)for(d=0;o>d;d++)p=T*w[d*o+g]+_*w[d*o+g+1],w[d*o+g+1]=-_*w[d*o+g]+T*w[d*o+g+1],w[d*o+g]=p;if(p=O(v,k),T=v/p,_=k/p,l[g]=p,v=T*y[g]+_*l[g+1],l[g+1]=-_*y[g]+T*l[g+1],k=_*y[g+1],y[g+1]=T*y[g+1],M&&r-1>g)for(d=0;r>d;d++)p=T*f[d*c+g]+_*f[d*c+g+1],f[d*c+g+1]=-_*f[d*c+g]+T*f[d*c+g+1],f[d*c+g]=p}y[I-2]=v,Y+=1;break;case 4:if(l[x]<=0&&(l[x]=l[x]<0?-l[x]:0,E))for(d=0;S>=d;d++)w[d*o+x]=-w[d*o+x];for(;S>x&&!(l[x]>=l[x+1]);){if(p=l[x],l[x]=l[x+1],l[x+1]=p,E&&o-1>x)for(d=0;o>d;d++)p=w[d*o+x+1],w[d*o+x+1]=w[d*o+x],w[d*o+x]=p;if(M&&r-1>x)for(d=0;r>d;d++)p=f[d*c+x+1],f[d*c+x+1]=f[d*c+x],f[d*c+x]=p;x++}Y=0,I--}}};var e=i.SingularValueDecomposition;return e.prototype={constructor:e,getU:function(){return new i.Matrix(this.m,Math.min(this.m+1,this.n),this.U,!0)},getV:function(){return new i.Matrix(this.n,this.n,this.V,!0)},getSingularValues:function(){return this.s},getS:function(){for(var t=new i.Matrix(this.n,this.n),n=0;n<this.n;n++){for(var e=0;e<this.n;e++)t.entries[t.index(n,e)]=0;t.entries[t.index(n,n)]=this.s[n]}return t},norm2:function(){return this.s[0]},cond:function(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]},rank:function(){for(var t=Math.pow(2,-23),i=Math.max(this.m,this.n)*this.s[0]*t,n=0,e=0;e<this.s.length;e++)this.s[e]>i&&n++;return n}},e}),n("DOT/QRDecomposition",["require","DOT/dot"],function(t){var i=t("DOT/dot"),n=window.Float32Array||Array;i.QRDecomposition=function(t){this.matrix=t,this.QR=t.getArrayCopy();var e=this.QR;this.m=t.getRowDimension();var s=this.m;this.n=t.getColumnDimension();var r=this.n;this.Rdiag=new n(r);var o,h,u;for(u=0;r>u;u++){var a=0;for(o=u;s>o;o++)a=i.Matrix.hypot(a,e[this.matrix.index(o,u)]);if(0!==a){for(e[this.matrix.index(u,u)]<0&&(a=-a),o=u;s>o;o++)e[this.matrix.index(o,u)]/=a;for(e[this.matrix.index(u,u)]+=1,h=u+1;r>h;h++){var m=0;for(o=u;s>o;o++)m+=e[this.matrix.index(o,u)]*e[this.matrix.index(o,h)];for(m=-m/e[this.matrix.index(u,u)],o=u;s>o;o++)e[this.matrix.index(o,h)]+=m*e[this.matrix.index(o,u)]}}this.Rdiag[u]=-a}};var e=i.QRDecomposition;return e.prototype={constructor:e,isFullRank:function(){for(var t=0;t<this.n;t++)if(0===this.Rdiag[t])return!1;return!0},getH:function(){for(var t=new i.Matrix(this.m,this.n),n=0;n<this.m;n++)for(var e=0;e<this.n;e++)t.entries[t.index(n,e)]=n>=e?this.QR[this.matrix.index(n,e)]:0;return t},getR:function(){for(var t=new i.Matrix(this.n,this.n),n=0;n<this.n;n++)for(var e=0;e<this.n;e++)t.entries[t.index(n,e)]=e>n?this.QR[this.matrix.index(n,e)]:n===e?this.Rdiag[n]:0;return t},getQ:function(){var t,n,e,s=new i.Matrix(this.m,this.n);for(e=this.n-1;e>=0;e--){for(t=0;t<this.m;t++)s.entries[s.index(t,e)]=0;for(s.entries[s.index(e,e)]=1,n=e;n<this.n;n++)if(0!==this.QR[this.matrix.index(e,e)]){var r=0;for(t=e;t<this.m;t++)r+=this.QR[this.matrix.index(t,e)]*s.entries[s.index(t,n)];for(r=-r/this.QR[this.matrix.index(e,e)],t=e;t<this.m;t++)s.entries[s.index(t,n)]+=r*this.QR[this.matrix.index(t,e)]}}return s},solve:function(t){if(t.getRowDimension()!==this.m)throw new Error("Matrix row dimensions must agree.");if(!this.isFullRank())throw new Error("Matrix is rank deficient.");var n,e,s,r=t.getColumnDimension(),o=t.getArrayCopy();for(s=0;s<this.n;s++)for(e=0;r>e;e++){var h=0;for(n=s;n<this.m;n++)h+=this.QR[this.matrix.index(n,s)]*o[t.index(n,e)];for(h=-h/this.QR[this.matrix.index(s,s)],n=s;n<this.m;n++)o[t.index(n,e)]+=h*this.QR[this.matrix.index(n,s)]}for(s=this.n-1;s>=0;s--){for(e=0;r>e;e++)o[t.index(s,e)]/=this.Rdiag[s];for(n=0;s>n;n++)for(e=0;r>e;e++)o[t.index(n,e)]-=o[t.index(s,e)]*this.QR[this.matrix.index(n,s)]}return new i.Matrix(o,this.n,r).getMatrix(0,this.n-1,0,r-1)}},e}),n("DOT/Matrix",["require","DOT/dot","PHET_CORE/isArray","DOT/SingularValueDecomposition","DOT/LUDecomposition","DOT/QRDecomposition","DOT/EigenvalueDecomposition","DOT/Vector2","DOT/Vector3","DOT/Vector4"],function(t){var i=t("DOT/dot"),n=window.Float32Array||Array,e=t("PHET_CORE/isArray");t("DOT/SingularValueDecomposition"),t("DOT/LUDecomposition"),t("DOT/QRDecomposition"),t("DOT/EigenvalueDecomposition"),t("DOT/Vector2"),t("DOT/Vector3"),t("DOT/Vector4"),i.Matrix=function(t,i,s,r){this.m=t,this.n=i;var o=t*i;this.size=o;var h;if(r)this.entries=s;else if(s||(s=0),this.entries=new n(o),e(s))for(h=0;o>h;h++)this.entries[h]=s[h];else for(h=0;o>h;h++)this.entries[h]=s};var s=i.Matrix;return s.hypot=function(t,i){var n;return Math.abs(t)>Math.abs(i)?(n=i/t,n=Math.abs(t)*Math.sqrt(1+n*n)):0!==i?(n=t/i,n=Math.abs(i)*Math.sqrt(1+n*n)):n=0,n},s.prototype={constructor:s,copy:function(){for(var t=new s(this.m,this.n),i=0;i<this.size;i++)t.entries[i]=this.entries[i];return t},getArray:function(){return this.entries},getArrayCopy:function(){return new n(this.entries)},getRowDimension:function(){return this.m},getColumnDimension:function(){return this.n},index:function(t,i){return t*this.n+i},get:function(t,i){return this.entries[this.index(t,i)]},set:function(t,i,n){this.entries[this.index(t,i)]=n},getMatrix:function(t,i,n,e){for(var r=new s(i-t+1,e-n+1),o=t;i>=o;o++)for(var h=n;e>=h;h++)r.entries[r.index(o-t,h-n)]=this.entries[this.index(o,h)];return r},getArrayRowMatrix:function(t,i,n){for(var e=new s(t.length,n-i+1),r=0;r<t.length;r++)for(var o=i;n>=o;o++)e.entries[e.index(r,o-i)]=this.entries[this.index(t[r],o)];return e},transpose:function(t){t=t||new s(this.n,this.m);for(var i=0;i<this.m;i++)for(var n=0;n<this.n;n++)t.entries[t.index(n,i)]=this.entries[this.index(i,n)];return t},norm1:function(){for(var t=0,i=0;i<this.n;i++){for(var n=0,e=0;e<this.m;e++)n+=Math.abs(this.entries[this.index(e,i)]);t=Math.max(t,n)}return t},norm2:function(){return new i.SingularValueDecomposition(this).norm2()},normInf:function(){for(var t=0,i=0;i<this.m;i++){for(var n=0,e=0;e<this.n;e++)n+=Math.abs(this.entries[this.index(i,e)]);t=Math.max(t,n)}return t},normF:function(){for(var t=0,i=0;i<this.m;i++)for(var n=0;n<this.n;n++)t=s.hypot(t,this.entries[this.index(i,n)]);return t},uminus:function(){for(var t=new s(this.m,this.n),i=0;i<this.m;i++)for(var n=0;n<this.n;n++)t.entries[t.index(i,n)]=-this.entries[this.index(i,n)];return t},plus:function(t){this.checkMatrixDimensions(t);for(var i=new s(this.m,this.n),n=0;n<this.m;n++)for(var e=0;e<this.n;e++){var r=i.index(n,e);i.entries[r]=this.entries[r]+t.entries[r]}return i},plusEquals:function(t){this.checkMatrixDimensions(t);for(var i=new s(this.m,this.n),n=0;n<this.m;n++)for(var e=0;e<this.n;e++){var r=i.index(n,e);this.entries[r]=this.entries[r]+t.entries[r]}return this},minus:function(t){this.checkMatrixDimensions(t);for(var i=new s(this.m,this.n),n=0;n<this.m;n++)for(var e=0;e<this.n;e++){var r=this.index(n,e);i.entries[r]=this.entries[r]-t.entries[r]}return i},minusEquals:function(t){this.checkMatrixDimensions(t);for(var i=0;i<this.m;i++)for(var n=0;n<this.n;n++){var e=this.index(i,n);this.entries[e]=this.entries[e]-t.entries[e]}return this},arrayTimes:function(t){this.checkMatrixDimensions(t);for(var i=new s(this.m,this.n),n=0;n<this.m;n++)for(var e=0;e<this.n;e++){var r=i.index(n,e);i.entries[r]=this.entries[r]*t.entries[r]}return i},arrayTimesEquals:function(t){this.checkMatrixDimensions(t);for(var i=0;i<this.m;i++)for(var n=0;n<this.n;n++){var e=this.index(i,n);this.entries[e]=this.entries[e]*t.entries[e]}return this},arrayRightDivide:function(t){this.checkMatrixDimensions(t);for(var i=new s(this.m,this.n),n=0;n<this.m;n++)for(var e=0;e<this.n;e++){var r=this.index(n,e);i.entries[r]=this.entries[r]/t.entries[r]}return i},arrayRightDivideEquals:function(t){this.checkMatrixDimensions(t);for(var i=0;i<this.m;i++)for(var n=0;n<this.n;n++){var e=this.index(i,n);this.entries[e]=this.entries[e]/t.entries[e]}return this},arrayLeftDivide:function(t){this.checkMatrixDimensions(t);for(var i=new s(this.m,this.n),n=0;n<this.m;n++)for(var e=0;e<this.n;e++){var r=this.index(n,e);i.entries[r]=t.entries[r]/this.entries[r]}return i},arrayLeftDivideEquals:function(t){this.checkMatrixDimensions(t);for(var i=0;i<this.m;i++)for(var n=0;n<this.n;n++){var e=this.index(i,n);this.entries[e]=t.entries[e]/this.entries[e]}return this},times:function(t){var i,e,r,o,h,u;if(t.isMatrix){if(u=t,u.m!==this.n)throw new Error("Matrix inner dimensions must agree.");i=new s(this.m,u.n);var a=new n(this.n);for(r=0;r<u.n;r++){for(o=0;o<this.n;o++)a[o]=u.entries[u.index(o,r)];for(e=0;e<this.m;e++){for(h=0,o=0;o<this.n;o++)h+=this.entries[this.index(e,o)]*a[o];i.entries[i.index(e,r)]=h}}return i}for(h=t,i=new s(this.m,this.n),e=0;e<this.m;e++)for(r=0;r<this.n;r++)i.entries[i.index(e,r)]=h*this.entries[this.index(e,r)];return i},timesEquals:function(t){for(var i=0;i<this.m;i++)for(var n=0;n<this.n;n++){var e=this.index(i,n);this.entries[e]=t*this.entries[e]}return this},solve:function(t){return this.m===this.n?new i.LUDecomposition(this).solve(t):new i.QRDecomposition(this).solve(t)},solveTranspose:function(t){return this.transpose().solve(t.transpose())},inverse:function(){return this.solve(s.identity(this.m,this.m))},det:function(){return new i.LUDecomposition(this).det()},rank:function(){return new i.SingularValueDecomposition(this).rank()},cond:function(){return new i.SingularValueDecomposition(this).cond()},trace:function(){for(var t=0,i=0;i<Math.min(this.m,this.n);i++)t+=this.entries[this.index(i,i)];return t},checkMatrixDimensions:function(t){if(t.m!==this.m||t.n!==this.n)throw new Error("Matrix dimensions must agree.")},toString:function(){var t="";t+="dim: "+this.getRowDimension()+"x"+this.getColumnDimension()+"\n";for(var i=0;i<this.getRowDimension();i++){for(var n=0;n<this.getColumnDimension();n++)t+=this.get(i,n)+" ";t+="\n"}return t},extractVector2:function(t){return new i.Vector2(this.get(0,t),this.get(1,t))},extractVector3:function(t){return new i.Vector3(this.get(0,t),this.get(1,t),this.get(2,t))},extractVector4:function(t){return new i.Vector4(this.get(0,t),this.get(1,t),this.get(2,t),this.get(3,t))},setVectors3:function(t){for(var i=t.length,n=0;i>n;n++){var e=t[n];this.entries[n]=e.x,this.entries[n+i]=e.y,this.entries[n+2*i]=e.z}return this},isMatrix:!0},s.identity=function(t,i){for(var n=new s(t,i),e=0;t>e;e++)for(var r=0;i>r;r++)n.entries[n.index(e,r)]=e===r?1:0;return n},s.rowVector2=function(t){return new s(1,2,[t.x,t.y])},s.rowVector3=function(t){return new s(1,3,[t.x,t.y,t.z])},s.rowVector4=function(t){return new s(1,4,[t.x,t.y,t.z,t.w])},s.rowVector=function(t){if(t.isVector2)return s.rowVector2(t);if(t.isVector3)return s.rowVector3(t);if(t.isVector4)return s.rowVector4(t);throw new Error("undetected type of vector: "+t.toString())},s.columnVector2=function(t){return new s(2,1,[t.x,t.y])},s.columnVector3=function(t){return new s(3,1,[t.x,t.y,t.z])},s.columnVector4=function(t){return new s(4,1,[t.x,t.y,t.z,t.w])},s.columnVector=function(t){if(t.isVector2)return s.columnVector2(t);if(t.isVector3)return s.columnVector3(t);if(t.isVector4)return s.columnVector4(t);throw new Error("undetected type of vector: "+t.toString())},s.fromVectors2=function(t){for(var i=2,e=t.length,r=new n(i*e),o=0;e>o;o++){var h=t[o];r[o]=h.x,r[o+e]=h.y}return new s(i,e,r,!0)},s.fromVectors3=function(t){for(var i=3,e=t.length,r=new n(i*e),o=0;e>o;o++){var h=t[o];r[o]=h.x,r[o+e]=h.y,r[o+2*e]=h.z}return new s(i,e,r,!0)},s.fromVectors4=function(t){for(var i=4,e=t.length,r=new n(i*e),o=0;e>o;o++){var h=t[o];r[o]=h.x,r[o+e]=h.y,r[o+2*e]=h.z,r[o+3*e]=h.w}return new s(i,e,r,!0)},s}),n("AXON/axon",["require"],function(){var t={};return t}),n("AXON/Multilink",["require","AXON/axon","PHET_CORE/inherit"],function(t){var i=t("AXON/axon"),n=t("PHET_CORE/inherit");return i.Multilink=function(t,i,n){this.dependencies=t,this.dependencyValues=t.map(function(t){return t.get()});var e=this;this.dependencyListeners=[];for(var s=0;s<t.length;s++){var r=t[s];!function(t,n){var s=function(t){e.dependencyValues[n]=t,i.apply(null,e.dependencyValues)};e.dependencyListeners.push(s),t.lazyLink(s)}(r,s)}n||i.apply(null,this.dependencyValues)},n(Object,i.Multilink,{detach:function(){for(var t=0;t<this.dependencies.length;t++){var i=this.dependencies[t];i.unlink(this.dependencyListeners[t])}this.dependencies=null,this.dependencyListeners=null,this.dependencyValues=null}})}),n("AXON/Property",["require","AXON/axon","AXON/Multilink"],function(t){var i=t("AXON/axon");return t("AXON/Multilink"),i.Property=function(t,i){this.storeValue(t),this.storeInitialValue(t),this._observers=[],this.id=i?i.id:null,this.sendPhetEvents=!0,this.lastMessageTime=0,this.delay=0},i.Property.prototype={get:function(){return this._value},set:function(t){return this.equalsValue(t)||this._setAndNotifyObservers(t),this},equalsValue:function(t){return t===this._value},storeValue:function(t){this._value=t},storeInitialValue:function(t){this._initialValue=t},get initialValue(){return this._initialValue},_setAndNotifyObservers:function(t){var i=this.get();this.storeValue(t),this._notifyObservers(i)},_notifyObservers:function(t){var i=this.get(),n=null,e=null;phet.arch.active&&(n=Date.now(),e=this.sendPhetEvents&&(0===this.delay||n-this.lastMessageTime>1e3*this.delay),e&&phet.arch.start("model",this.id,"Property","changed",{value:i}));for(var s=this._observers.slice(),r=0;r<s.length;r++)s[r](i,t);e&&(phet.arch.end(),this.lastMessageTime=n)},notifyObserversStatic:function(){for(var t=this.get(),i=0;i<this._observers.length;i++)this._observers[i](t)},reset:function(){this.set(this._initialValue)},_set:function(t){return this.set.bind(this,t)},get value(){return this.get()},set value(t){this.set(t)},link:function(t){-1===this._observers.indexOf(t)&&(this._observers.push(t),t(this.get(),null))},unlink:function(t){var i=this._observers.indexOf(t);-1!==i&&this._observers.splice(i,1)},lazyLink:function(t){-1===this._observers.indexOf(t)&&this._observers.push(t)},toString:function(){return"Property{"+this.get()+"}"},valueOf:function(){return this.toString()},once:function(t){var i=this,n=function(e,s){i.unlink(n),t(e,s)};return this.lazyLink(n),n},linkAttribute:function(t,i){var n=function(n){t[i]=n};return this.link(n),n},valueEquals:function(t){return new i.DerivedProperty([this],function(i){return i===t})},and:function(t){return new i.DerivedProperty([this,t],function(t,i){return t&&i})},or:function(t){return new i.DerivedProperty([this,t],function(t,i){return t||i})},times:function(t){return new i.DerivedProperty([this],function(i){return i*t})},plus:function(t){return new i.DerivedProperty([this],function(i){return i+t})},lessThanNumber:function(t){return new i.DerivedProperty([this],function(i){return t>i})},greaterThanNumber:function(t){return new i.DerivedProperty([this],function(i){return i>t})},derivedNot:function(){return new i.DerivedProperty([this],function(t){return!t})},not:function(){var t=this,n=new i.Property(!this.value),e=function(t){n.set(!t)};t.link(e);var s=function(i){t.set(!i)};return n.link(s),n.detach=function(){t.unlink(e),n.unlink(s)},n},debug:function(t){var i=function(i){console.log(t,i)};return this.link(i),i},mapValues:function(t){return new i.DerivedProperty([this],function(i){return t[i]})},map:function(t){return new i.DerivedProperty([this],function(i){return t(i)})},get toggleFunction(){return this.toggle.bind(this)},toggle:function(){this.value=!this.value},onValue:function(t,i){var n=function(n){n===t&&i()};return this.link(n),n}},i.Property.multilink=function(t,n){return new i.Multilink(t,n,!1)},i.Property.lazyMultilink=function(t,n){return new i.Multilink(t,n,!0)},i.Property.prototype.setSendPhetEvents=function(t){return this.sendPhetEvents=t,this},i.Property.prototype.throttle=function(t){return this.delay=t,this},i.Property.initArch=function(){window.phet=window.phet||{},window.phet.arch=window.phet.arch||{active:!1,wrap:function(t,i,n,e,s){return s},trigger:function(){},start:function(){},end:function(){}}},i.Property.initArch(),i.Property}),n("DOT/ObservableBounds2",["require","DOT/dot","PHET_CORE/inherit","PHET_CORE/extend","PHET_CORE/PoolableMixin","AXON/Property","DOT/Bounds2"],function(t){var i=t("DOT/dot"),n=t("PHET_CORE/inherit"),e=t("PHET_CORE/extend"),s=t("PHET_CORE/PoolableMixin"),r=t("AXON/Property");t("DOT/Bounds2"),i.ObservableBounds2=function(t,n,e,s){i.Bounds2.call(this,t,n,e,s),this._oldValue=this.copy(),r.call(this,this)};var o=i.ObservableBounds2;return n(i.Bounds2,o,e({},r.prototype,{get:function(){return this},setMinMax:function(t,i,n,e){return(this.minX!==t||this.minY!==i||this.maxX!==n||this.maxY!==e)&&(this._oldValue.minX=this.minX,this._oldValue.minY=this.minY,this._oldValue.maxX=this.maxX,this._oldValue.maxY=this.maxY,this.minX=t,this.minY=i,this.maxX=n,this.maxY=e,this._notifyObservers(this._oldValue)),this},setMinX:function(t){return this.minX!==t&&(this._oldValue.minX=this.minX,this.minX=t,this._notifyObservers(this._oldValue)),this},setMinY:function(t){return this.minY!==t&&(this._oldValue.minY=this.minY,this.minY=t,this._notifyObservers(this._oldValue)),this},setMaxX:function(t){return this.maxX!==t&&(this._oldValue.maxX=this.maxX,this.maxX=t,this._notifyObservers(this._oldValue)),this},setMaxY:function(t){return this.maxY!==t&&(this._oldValue.maxY=this.maxY,this.maxY=t,this._notifyObservers(this._oldValue)),this},set:i.Bounds2.prototype.set,equalsValue:function(t){return this.equals(t)},storeValue:function(){},storeInitialValue:function(t){this._initialMinX=t.minX,this._initialMinY=t.minY,this._initialMaxX=t.maxX,this._initialMaxY=t.maxY},reset:function(){this.setMinMax(this._initialMinX,this._initialMinY,this._initialMaxX,this._initialMaxY)},toString:function(){return"ObservableBounds2("+this.minX+", "+this.minY+", "+this.maxX+", "+this.maxY+")"}})),s(o,{defaultFactory:function(){return new o},constructorDuplicateFactory:function(t){return function(i,n,e,s){return t.length?t.pop().setMinMax(i,n,e,s):new o(i,n,e,s)}}}),o}),n("DOT/ObservableMatrix3",["require","DOT/dot","PHET_CORE/inherit","PHET_CORE/extend","PHET_CORE/PoolableMixin","AXON/Property","DOT/Matrix3"],function(t){var i=t("DOT/dot"),n=t("PHET_CORE/inherit"),e=t("PHET_CORE/extend"),s=t("PHET_CORE/PoolableMixin"),r=t("AXON/Property");t("DOT/Matrix3"),i.ObservableMatrix3=function(t,n,e,s,o,h,u,a,m,c){i.Matrix3.call(this,t,n,e,s,o,h,u,a,m,c),this._oldValue=this.copy(),this._skipChecks=!1,r.call(this,this)};var o=i.ObservableMatrix3;return n(i.Matrix3,o,e({},r.prototype,{get:function(){return this},rowMajor:function(t,n,e,s,r,o,h,u,a,m){var c=this._skipChecks,l=c||t!==this.entries[0]||s!==this.entries[1]||h!==this.entries[2]||n!==this.entries[3]||r!==this.entries[4]||u!==this.entries[5]||e!==this.entries[6]||o!==this.entries[7]||a!==this.entries[8]||m!==this.type;return l&&(!c&&this._oldValue&&(this._oldValue.entries[0]=this.entries[0],this._oldValue.entries[1]=this.entries[1],this._oldValue.entries[2]=this.entries[2],this._oldValue.entries[3]=this.entries[3],this._oldValue.entries[4]=this.entries[4],this._oldValue.entries[5]=this.entries[5],this._oldValue.entries[6]=this.entries[6],this._oldValue.entries[7]=this.entries[7],this._oldValue.entries[8]=this.entries[8],this._oldValue.type=this.type),this.entries[0]=t,this.entries[1]=s,this.entries[2]=h,this.entries[3]=n,this.entries[4]=r,this.entries[5]=u,this.entries[6]=e,this.entries[7]=o,this.entries[8]=a,this.type=void 0===m?0===h&&0===u&&1===a?i.Matrix3.Types.AFFINE:i.Matrix3.Types.OTHER:m,this._observers&&this._notifyObservers(c?null:this._oldValue)),this},set:i.Matrix3.prototype.set,equalsValue:function(t){return this.equals(t)},storeValue:function(){},storeInitialValue:function(t){this._initial00=t.m00(),this._initial01=t.m01(),this._initial02=t.m02(),this._initial10=t.m10(),this._initial11=t.m11(),this._initial12=t.m12(),this._initial20=t.m20(),this._initial21=t.m21(),this._initial22=t.m22(),this._initialType=t.type},reset:function(){this.rowMajor(this._initial00,this._initial01,this._initial02,this._initial10,this._initial11,this._initial12,this._initial20,this._initial21,this._initial22,this._initialType)},toString:i.Matrix3.prototype.toString})),s(o,{defaultFactory:function(){return new o},constructorDuplicateFactory:function(t){return function(i,n,e,s,r,h,u,a,m,c){return t.length?t.pop().rowMajor(i,n,e,s,r,h,u,a,m,c):new o(i,n,e,s,r,h,u,a,m,c)}}}),o}),n("DOT/ObservableVector2",["require","DOT/dot","PHET_CORE/inherit","PHET_CORE/extend","PHET_CORE/PoolableMixin","AXON/Property","DOT/Vector2"],function(t){var i=t("DOT/dot"),n=t("PHET_CORE/inherit"),e=t("PHET_CORE/extend"),s=t("PHET_CORE/PoolableMixin"),r=t("AXON/Property");t("DOT/Vector2"),i.ObservableVector2=function(t,n){i.Vector2.call(this,t,n),this._oldValue=this.copy(),r.call(this,this)};var o=i.ObservableVector2;return n(i.Vector2,o,e({},r.prototype,{get:function(){return this},setXY:function(t,i){return(this.x!==t||this.y!==i)&&(this._oldValue.x=this.x,this._oldValue.y=this.y,this.x=t,this.y=i,this._notifyObservers(this._oldValue)),this},setX:function(t){return this.x!==t&&(this._oldValue.x=this.x,this.x=t,this._notifyObservers(this._oldValue)),this},setY:function(t){return this.y!==t&&(this._oldValue.y=this.y,this.y=t,this._notifyObservers(this._oldValue)),this},set:i.Vector2.prototype.set,equalsValue:function(t){return this.equals(t)},storeValue:function(){},storeInitialValue:function(t){this._initialX=t.x,this._initialY=t.y},reset:function(){this.setXY(this._initialX,this._initialY)},toString:function(){return"ObservableVector2("+this.x+", "+this.y+")"}})),s(o,{defaultFactory:function(){return new o},constructorDuplicateFactory:function(t){return function(i,n){return t.length?t.pop().setXY(i,n):new o(i,n)}}}),o}),n("DOT/Permutation",["require","DOT/dot","PHET_CORE/isArray","DOT/Util"],function(t){function i(t,n,e){if(0===t.length)e.call(void 0,n);else for(var s=0;s<t.length;s++){var r=t[s],o=t.slice(0);o.splice(s,1);var h=n.slice(0);h.push(r),i(o,h,e)}}var n=t("DOT/dot"),e=t("PHET_CORE/isArray");t("DOT/Util");var s=n.Permutation=function(t){this.indices=t};return s.identity=function(t){for(var i=new Array(t),n=0;t>n;n++)i[n]=n;return new s(i)},s.permutations=function(t){var i=[];return s.forEachPermutation(n.rangeInclusive(0,t-1),function(t){i.push(new s(t))}),i},s.forEachPermutation=function(t,n){i(t,[],n)},s.prototype={constructor:s,size:function(){return this.indices.length},apply:function(t){if(e(t)){if(t.length!==this.size())throw new Error("Permutation length "+this.size()+" not equal to list length "+t.length);for(var i=new Array(t.length),n=0;n<t.length;n++)i[n]=t[this.indices[n]];return i}return this.indices[t]},inverted:function(){for(var t=new Array(this.size()),i=0;i<this.size();i++)t[this.indices[i]]=i;return new s(t)},withIndicesPermuted:function(t){var i=[],n=this;return s.forEachPermutation(t,function(e){for(var r=n.indices,o=r.slice(0),h=0;h<t.length;h++)o[t[h]]=r[e[h]];i.push(new s(o))}),i},toString:function(){return"P["+this.indices.join(", ")+"]"}},s.testMe=function(t){var i=new s([1,4,3,2,0]);t.log(i.toString());var n=i.inverted();t.log(n.toString()),t.log(n.withIndicesPermuted([0,3,4]).toString()),t.log(s.permutations(4).toString())},s}),n("DOT/Plane3",["require","DOT/dot","DOT/Vector3"],function(t){var i=t("DOT/dot"),n=t("DOT/Vector3");i.Plane3=function(t,i){this.normal=t,this.distance=i};var e=i.Plane3;return e.prototype={constructor:e,intersectWithRay:function(t){return t.pointAtDistance(t.distanceToPlane(this))}},e.XY=new e(new n(0,0,1),0),e.XZ=new e(new n(0,1,0),0),e.YZ=new e(new n(1,0,0),0),e.fromTriangle=function(t,i,n){var s=n.minus(t).cross(i.minus(t));return 0===s.magnitude()?null:(s.normalize(),new e(s,s.dot(t)))},e}),n("DOT/Quaternion",["require","DOT/dot","PHET_CORE/PoolableMixin","DOT/Vector3","DOT/Matrix3","DOT/Util"],function(t){var i=t("DOT/dot"),n=t("PHET_CORE/PoolableMixin");t("DOT/Vector3"),t("DOT/Matrix3"),t("DOT/Util"),i.Quaternion=function(t,i,n,e){this.setXYZW(t,i,n,e)
};var e=i.Quaternion;return e.prototype={constructor:e,isQuaternion:!0,setXYZW:function(t,i,n,e){this.x=t||0,this.y=i||0,this.z=n||0,this.w=void 0!==e?e:1},plus:function(t){return new e(this.x+t.x,this.y+t.y,this.z+t.z,this.w+t.w)},timesScalar:function(t){return new e(this.x*t,this.y*t,this.z*t,this.w*t)},timesQuaternion:function(t){return new e(this.x*t.w-this.z*t.y+this.y*t.z+this.w*t.x,-this.x*t.z+this.y*t.w+this.z*t.x+this.w*t.y,this.x*t.y-this.y*t.x+this.z*t.w+this.w*t.z,-this.x*t.x-this.y*t.y-this.z*t.z+this.w*t.w)},timesVector3:function(t){return 0===t.magnitude()?new i.Vector3:new i.Vector3(this.w*this.w*t.x+2*this.y*this.w*t.z-2*this.z*this.w*t.y+this.x*this.x*t.x+2*this.y*this.x*t.y+2*this.z*this.x*t.z-this.z*this.z*t.x-this.y*this.y*t.x,2*this.x*this.y*t.x+this.y*this.y*t.y+2*this.z*this.y*t.z+2*this.w*this.z*t.x-this.z*this.z*t.y+this.w*this.w*t.y-2*this.x*this.w*t.z-this.x*this.x*t.y,2*this.x*this.z*t.x+2*this.y*this.z*t.y+this.z*this.z*t.z-2*this.w*this.y*t.x-this.y*this.y*t.z+2*this.w*this.x*t.y-this.x*this.x*t.z+this.w*this.w*t.z)},magnitude:function(){return Math.sqrt(this.magnitudeSquared())},magnitudeSquared:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},normalized:function(){var t=this.magnitude();return this.timesScalar(1/t)},negated:function(){return new e(-this.x,-this.y,-this.z,-this.w)},toRotationMatrix:function(){var t=this.magnitudeSquared(),n=1===t?2:t>0?2/t:0,e=this.x*this.x*n,s=this.x*this.y*n,r=this.x*this.z*n,o=this.w*this.x*n,h=this.y*this.y*n,u=this.y*this.z*n,a=this.w*this.y*n,m=this.z*this.z*n,c=this.w*this.z*n;return i.Matrix3.dirtyFromPool().columnMajor(1-(h+m),s+c,r-a,s-c,1-(e+m),u+o,r+a,u-o,1-(e+h))}},e.fromEulerAngles=function(t,i,n){var s=Math.sin(.5*n),r=Math.cos(.5*n),o=Math.sin(.5*i),h=Math.cos(.5*i),u=Math.sin(.5*t),a=Math.cos(.5*t),m=h*r,c=o*s,l=h*s,f=o*r;return new e(m*u+c*a,f*a+l*u,l*a-f*u,m*a-c*u)},e.fromRotationMatrix=function(t){var i,n=t.m00(),s=t.m01(),r=t.m02(),o=t.m10(),h=t.m11(),u=t.m12(),a=t.m20(),m=t.m21(),c=t.m22(),l=n+h+c;return l>=0?(i=Math.sqrt(l+1),new e(.5*(m-u)/i,.5*(r-a)/i,.5*(o-s)/i,.5*i)):n>h&&n>c?(i=Math.sqrt(1+n-h-c),new e(.5*i,.5*(o+s)/i,.5*(r+a)/i,.5*(m-u)/i)):h>c?(i=Math.sqrt(1+h-n-c),new e(.5*(o+s)/i,.5*i,.5*(m+u)/i,.5*(r-a)/i)):(i=Math.sqrt(1+c-n-h),new e(.5*(r+a)/i,.5*(m+u)/i,.5*i,.5*(o-s)/i))},e.getRotationQuaternion=function(t,n){return e.fromRotationMatrix(i.Matrix3.rotateAToB(t,n))},e.slerp=function(t,i,n){if(t.x===i.x&&t.y===i.y&&t.z===i.z&&t.w===i.w)return t;var s=t.x*i.x+t.y*i.y+t.z*i.z+t.w*i.w;0>s&&(i=i.negated(),s=-s);var r=1-n,o=n;if(1-s>.1){var h=Math.acos(s),u=1/Math.sin(h);r=Math.sin((1-n)*h)*u,o=Math.sin(n*h)*u}return new e(r*t.x+o*i.x,r*t.y+o*i.y,r*t.z+o*i.z,r*t.w+o*i.w)},n(e,{defaultFactory:function(){return new e},constructorDuplicateFactory:function(t){return function(i,n,s,r){return t.length?t.pop().set(i,n,s,r):new e(i,n,s,r)}}}),e}),n("DOT/Ray3",["require","DOT/dot"],function(t){var i=t("DOT/dot");i.Ray3=function(t,i){this.pos=t,this.dir=i};var n=i.Ray3;return n.prototype={constructor:n,shifted:function(t){return new n(this.pointAtDistance(t),this.dir)},pointAtDistance:function(t){return this.pos.plus(this.dir.timesScalar(t))},distanceToPlane:function(t){return(t.distance-this.pos.dot(t.normal))/this.dir.dot(t.normal)},toString:function(){return this.pos.toString()+" => "+this.dir.toString()}},n}),n("DOT/Rectangle",["require","DOT/dot","PHET_CORE/inherit","DOT/Bounds2"],function(t){var i=t("DOT/dot"),n=t("PHET_CORE/inherit"),e=t("DOT/Bounds2");i.Rectangle=function(t,i,n,s){e.call(this,t,i,t+n,i+s)};var s=i.Rectangle;return n(e,s),s}),n("DOT/Sphere3",["require","DOT/dot"],function(t){var i=t("DOT/dot");i.Sphere3=function(t,i){this.center=t,this.radius=i};var n=i.Sphere3;return n.prototype={constructor:n,intersect:function(t,i){var n=t.dir,e=t.pos,s=e.minus(this.center),r=n.dot(s),o=s.magnitudeSquared(),h=4*r*r-4*(o-this.radius*this.radius);if(i>h)return null;var u=n.dot(this.center)-n.dot(e),a=Math.sqrt(h)/2,m=u-a,c=u+a;if(i>c)return null;var l=t.pointAtDistance(c),f=l.minus(this.center).normalized();if(i>m)return{distance:c,hitPoint:l,normal:f.negated(),fromOutside:!1};var d=t.pointAtDistance(m),g=d.minus(this.center).normalized();return{distance:m,hitPoint:d,normal:g,fromOutside:!0}},intersections:function(t,i){var n=t.dir,e=t.pos,s=e.minus(this.center),r=n.dot(s),o=s.magnitudeSquared(),h=4*r*r-4*(o-this.radius*this.radius);if(i>h)return[];var u=n.dot(this.center)-n.dot(e),a=Math.sqrt(h)/2,m=u-a,c=u+a;if(i>c)return[];var l=t.pointAtDistance(c),f=l.minus(this.center).normalized(),d=t.pointAtDistance(m),g=d.minus(this.center).normalized(),x={distance:c,hitPoint:l,normal:f.negated(),fromOutside:!1},p={distance:m,hitPoint:d,normal:g,fromOutside:!0};return i>m?[x,p]:[p,x]}},n}),n("DOT/Transform4",["require","DOT/dot","DOT/Matrix4","DOT/Vector3","DOT/Ray3"],function(t){var i=t("DOT/dot");t("DOT/Matrix4"),t("DOT/Vector3"),t("DOT/Ray3"),i.Transform4=function(t){this.setMatrix(void 0===t?i.Matrix4.IDENTITY:t)};var n=i.Transform4;return n.prototype={constructor:n,setMatrix:function(t){this.matrix=t,this.inverse=null,this.matrixTransposed=null,this.inverseTransposed=null},getMatrix:function(){return this.matrix},getInverse:function(){return null===this.inverse&&(this.inverse=this.matrix.inverted()),this.inverse},getMatrixTransposed:function(){return null===this.matrixTransposed&&(this.matrixTransposed=this.matrix.transposed()),this.matrixTransposed},getInverseTransposed:function(){return null===this.inverseTransposed&&(this.inverseTransposed=this.getInverse().transposed()),this.inverseTransposed},prepend:function(t){this.setMatrix(t.timesMatrix(this.matrix))},append:function(t){this.setMatrix(this.matrix.timesMatrix(t))},prependTransform:function(t){this.prepend(t.matrix)},appendTransform:function(t){this.append(t.matrix)},isIdentity:function(){return this.matrix.type===i.Matrix4.Types.IDENTITY},applyToCanvasContext:function(t){t.setTransform(this.matrix.m00(),this.matrix.m10(),this.matrix.m01(),this.matrix.m11(),this.matrix.m03(),this.matrix.m13())},transformPosition3:function(t){return this.matrix.timesVector3(t)},transformDelta3:function(t){return this.matrix.timesRelativeVector3(t)},transformNormal3:function(t){return this.getInverse().timesTransposeVector3(t)},transformDeltaX:function(t){return this.transformDelta3(new i.Vector3(t,0,0)).x},transformDeltaY:function(t){return this.transformDelta3(new i.Vector3(0,t,0)).y},transformDeltaZ:function(t){return this.transformDelta3(new i.Vector3(0,0,t)).z},transformRay:function(t){return new i.Ray3(this.transformPosition3(t.pos),this.transformPosition3(t.pos.plus(t.dir)).minus(this.transformPosition3(t.pos)))},inversePosition3:function(t){return this.getInverse().timesVector3(t)},inverseDelta3:function(t){return this.inversePosition3(t).minus(this.inversePosition3(i.Vector3.ZERO))},inverseNormal3:function(t){return this.matrix.timesTransposeVector3(t)},inverseDeltaX:function(t){return this.inverseDelta3(new i.Vector3(t,0,0)).x},inverseDeltaY:function(t){return this.inverseDelta3(new i.Vector3(0,t,0)).y},inverseDeltaZ:function(t){return this.inverseDelta3(new i.Vector3(0,0,t)).z},inverseRay:function(t){return new i.Ray3(this.inversePosition3(t.pos),this.inversePosition3(t.pos.plus(t.dir)).minus(this.inversePosition3(t.pos)))}},n}),n("DOT/main",["DOT/dot","DOT/Bounds2","DOT/Bounds3","DOT/Complex","DOT/ConvexHull2","DOT/Dimension2","DOT/EigenvalueDecomposition","DOT/LinearFunction","DOT/LUDecomposition","DOT/Matrix","DOT/Matrix3","DOT/Matrix4","DOT/ObservableBounds2","DOT/ObservableMatrix3","DOT/ObservableVector2","DOT/Permutation","DOT/Plane3","DOT/QRDecomposition","DOT/Quaternion","DOT/Ray2","DOT/Ray3","DOT/Rectangle","DOT/SingularValueDecomposition","DOT/Sphere3","DOT/Transform3","DOT/Transform4","DOT/Util","DOT/Vector2","DOT/Vector3","DOT/Vector4"],function(t){return t}),n("PHET_CORE/arrayRemove",["require","PHET_CORE/core"],function(t){var i=t("PHET_CORE/core");return i.arrayRemove=function(t,i){var n=_.indexOf(t,i);t.splice(n,1)},i.arrayRemove}),n("PHET_CORE/cleanArray",["require","PHET_CORE/core"],function(t){var i=t("PHET_CORE/core");return i.cleanArray=function(t){if(t){for(;t.length;)t.pop();return t}return[]},i.cleanArray}),n("PHET_CORE/collect",["require","PHET_CORE/core"],function(t){var i=t("PHET_CORE/core");return i.collect=function(t){var i=[];return t(function(t){i.push(t)}),i},i.collect}),n("PHET_CORE/detectPrefix",["require","PHET_CORE/core"],function(t){var i=t("PHET_CORE/core");return i.detectPrefix=function(t,i){return void 0!==t[i]?i:(i=i.charAt(0).toUpperCase()+i.slice(1),void 0!==t["moz"+i]?"moz"+i:void 0!==t["Moz"+i]?"Moz"+i:void 0!==t["webkit"+i]?"webkit"+i:void 0!==t["ms"+i]?"ms"+i:void 0!==t["o"+i]?"o"+i:void 0)},i.detectPrefix}),n("PHET_CORE/detectPrefixEvent",["require","PHET_CORE/core"],function(t){var i=t("PHET_CORE/core");return i.detectPrefixEvent=function(t,i){return void 0!==t["on"+i]?i:void 0!==t["onmoz"+i]?"moz"+i:void 0!==t["onMoz"+i]?"Moz"+i:void 0!==t["onwebkit"+i]?"webkit"+i:void 0!==t["onms"+i]?"ms"+i:void 0!==t["ono"+i]?"o"+i:void 0},i.detectPrefixEvent}),n("PHET_CORE/escapeHTML",["require","PHET_CORE/core"],function(t){var i=t("PHET_CORE/core");return i.escapeHTML=function(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;").replace(/\'/g,"&#x27;").replace(/\//g,"&#x2F;")},i.escapeHTML}),n("PHET_CORE/EventTimer",["require","PHET_CORE/core","PHET_CORE/inherit"],function(t){var i=t("PHET_CORE/core"),n=t("PHET_CORE/inherit");return i.EventTimer=function(t,i){this.eventModel=t,this.eventCallback=i,this.timeBeforeNextEvent=this.eventModel.getPeriodBeforeNextEvent()},n(Object,i.EventTimer,{step:function(t){for(;t>=this.timeBeforeNextEvent;)t-=this.timeBeforeNextEvent,this.timeBeforeNextEvent=this.eventModel.getPeriodBeforeNextEvent(),this.eventCallback(t);this.timeBeforeNextEvent-=t}}),i.EventTimer.ConstantEventModel=n(Object,function(t){this.rate=t},{getPeriodBeforeNextEvent:function(){return 1/this.rate}}),i.EventTimer.UniformEventModel=n(Object,function(t,i){this.rate=t,this.pseudoRandomNumberSource=i},{getPeriodBeforeNextEvent:function(){var t=this.pseudoRandomNumberSource();return 2*t/this.rate}}),i.EventTimer.PoissonEventModel=n(Object,function(t,i){this.rate=t,this.pseudoRandomNumberSource=i},{getPeriodBeforeNextEvent:function(){var t=this.pseudoRandomNumberSource();return-Math.log(t)/this.rate}}),i.EventTimer}),n("PHET_CORE/loadScript",["require","PHET_CORE/core"],function(t){var i=t("PHET_CORE/core");return i.loadScript=function(t){"string"==typeof t&&(t={src:t});var i=t.src,n=t.callback,e=void 0===t.async?!0:t.async,s=void 0===t.cacheBuster?!1:t.cacheBuster,r=!1,o=document.createElement("script");o.type="text/javascript",o.async=e,o.onload=o.onreadystatechange=function(){var t=this.readyState;t&&"complete"!==t&&"loaded"!==t||r||(r=!0,n&&n())},o.src=i+(s?"?random="+Math.random().toFixed(10):"");var h=document.getElementsByTagName("script")[0];h.parentNode.insertBefore(o,h)},i.loadScript}),n("PHET_CORE/pairs",["require","PHET_CORE/core"],function(t){var i=t("PHET_CORE/core");return i.pairs=function(t){var i=[],n=t.length;if(n>1)for(var e=0;n-1>e;e++)for(var s=t[e],r=e+1;n>r;r++)i.push([s,t[r]]);return i},i.pairs}),n("PHET_CORE/partition",["require","PHET_CORE/core"],function(t){var i=t("PHET_CORE/core");return i.partition=function(t,i){for(var n=[],e=[],s=t.length,r=0;s>r;r++)i(t[r])?n.push(t[r]):e.push(t[r]);return[n,e]},i.partition}),n("PHET_CORE/platform",["require","PHET_CORE/core"],function(t){function i(t){return n()===t}function n(){var t=-1,i=null;return"Microsoft Internet Explorer"===navigator.appName?(i=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"),null!==i.exec(s)&&(t=parseFloat(RegExp.$1))):"Netscape"===navigator.appName&&(i=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})"),null!==i.exec(s)&&(t=parseFloat(RegExp.$1))),t}var e=t("PHET_CORE/core"),s=navigator.userAgent;return e.platform={get firefox(){return s.toLowerCase().indexOf("firefox")>-1},get mobileSafari(){return s.match(/(iPod|iPhone|iPad)/)&&s.match(/AppleWebKit/)},get safari5(){return s.match(/Version\/5\./)&&s.match(/Safari\//)&&s.match(/AppleWebKit/)},get safari6(){return s.match(/Version\/6\./)&&s.match(/Safari\//)&&s.match(/AppleWebKit/)},get safari7(){return s.match(/Version\/7\./)&&s.match(/Safari\//)&&s.match(/AppleWebKit/)},get ie9(){return i(9)},get ie10(){return i(10)},get ie11(){return i(11)},get ie(){return-1!==n()},get android(){return s.indexOf("Android")>0},get chromium(){return/chrom(e|ium)/.test(s.toLowerCase())}},e.platform}),n("PHET_CORE/profiler",["require","PHET_CORE/core"],function(t){var i=t("PHET_CORE/core"),n=[],e={},s=0,r=[];return i.profiler={displayCount:1e3,start:function(t){var i=Date.now();n.push({name:t,time:i})},addListener:function(t){r.push(t)},stop:function(){var t=Date.now(),i=n.pop(),o=t-i.time;if(e[i.name]||(e[i.name]=[]),e[i.name].push(o),s++,s%this.displayCount===0){var h=JSON.stringify(this.toJSON());console.log(h);for(var u=0;u<r.length;u++)r[u](h);e={}}},toJSON:function(){var t,i={};for(var n in e){t=0;for(var s=0;s<e[n].length;s++){var r=e[n][s];t+=r}var o=t/e[n].length;i[n]={average:o,count:e[n].length}}return i},testSelf:function(){var t,i,n=this;this.displayCount=1e7;for(var e=0;10>e;e++){n.start("physics");for(var s=0;1e4>s;s++){n.start("mloop");for(var r=0;1e4>r;r++)t=2e4;n.stop(),n.start("xloop");for(var o=0;2e4>o;o++)i=2e4;n.stop()}n.stop()}console.log("results: ",t,i),console.log(JSON.stringify(this.toJSON()))}},i.profiler}),n("PHET_CORE/main",["PHET_CORE/core","PHET_CORE/arrayRemove","PHET_CORE/cleanArray","PHET_CORE/collect","PHET_CORE/detectPrefix","PHET_CORE/detectPrefixEvent","PHET_CORE/escapeHTML","PHET_CORE/EventTimer","PHET_CORE/extend","PHET_CORE/inherit","PHET_CORE/isArray","PHET_CORE/loadScript","PHET_CORE/pairs","PHET_CORE/partition","PHET_CORE/phetAllocation","PHET_CORE/platform","PHET_CORE/PoolableMixin","PHET_CORE/profiler"],function(t){return t}),window.loadedKiteConfig=!0,i.config({deps:["main","DOT/main","PHET_CORE/main"],paths:{underscore:"../../sherpa/lodash-2.4.1",KITE:".",DOT:"../../dot/js",PHET_CORE:"../../phet-core/js",AXON:"../../axon/js"},shim:{underscore:{exports:"_"}},urlArgs:(new Date).getTime()}),n("production-config",function(){}),window.kite=i("main"),window.dot=i("DOT/main"),window.core=i("PHET_CORE/main")}();
//# sourceMappingURL=kite.min.js.map