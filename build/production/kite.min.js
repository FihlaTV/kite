!function(){var t,i,n;!function(e){function s(t,i){return w.call(t,i)}function r(t,i){var n,e,s,r,h,o,u,a,m,l,c=i&&i.split("/"),f=x.map,d=f&&f["*"]||{};if(t&&"."===t.charAt(0))if(i){for(c=c.slice(0,c.length-1),t=c.concat(t.split("/")),a=0;a<t.length;a+=1)if(l=t[a],"."===l)t.splice(a,1),a-=1;else if(".."===l){if(1===a&&(".."===t[2]||".."===t[0]))break;a>0&&(t.splice(a-1,2),a-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((c||d)&&f){for(n=t.split("/"),a=n.length;a>0;a-=1){if(e=n.slice(0,a).join("/"),c)for(m=c.length;m>0;m-=1)if(s=f[c.slice(0,m).join("/")],s&&(s=s[e])){r=s,h=a;break}if(r)break;!o&&d&&d[e]&&(o=d[e],u=a)}!r&&o&&(r=o,h=u),r&&(n.splice(0,h,r),t=n.join("/"))}return t}function h(t,i){return function(){return f.apply(e,y.call(arguments,0).concat([t,i]))}}function o(t){return function(i){return r(i,t)}}function u(t){return function(i){g[t]=i}}function a(t){if(s(v,t)){var i=v[t];delete v[t],T[t]=!0,c.apply(e,i)}if(!s(g,t)&&!s(T,t))throw new Error("No "+t);return g[t]}function m(t){var i,n=t?t.indexOf("!"):-1;return n>-1&&(i=t.substring(0,n),t=t.substring(n+1,t.length)),[i,t]}function l(t){return function(){return x&&x.config&&x.config[t]||{}}}var c,f,d,p,g={},v={},x={},T={},w=Object.prototype.hasOwnProperty,y=[].slice;d=function(t,i){var n,e=m(t),s=e[0];return t=e[1],s&&(s=r(s,i),n=a(s)),s?t=n&&n.normalize?n.normalize(t,o(i)):r(t,i):(t=r(t,i),e=m(t),s=e[0],t=e[1],s&&(n=a(s))),{f:s?s+"!"+t:t,n:t,pr:s,p:n}},p={require:function(t){return h(t)},exports:function(t){var i=g[t];return"undefined"!=typeof i?i:g[t]={}},module:function(t){return{id:t,uri:"",exports:g[t],config:l(t)}}},c=function(t,i,n,r){var o,m,l,c,f,x,w=[];if(r=r||t,"function"==typeof n){for(i=!i.length&&n.length?["require","exports","module"]:i,f=0;f<i.length;f+=1)if(c=d(i[f],r),m=c.f,"require"===m)w[f]=p.require(t);else if("exports"===m)w[f]=p.exports(t),x=!0;else if("module"===m)o=w[f]=p.module(t);else if(s(g,m)||s(v,m)||s(T,m))w[f]=a(m);else{if(!c.p)throw new Error(t+" missing "+m);c.p.load(c.n,h(r,!0),u(m),{}),w[f]=g[m]}l=n.apply(g[t],w),t&&(o&&o.exports!==e&&o.exports!==g[t]?g[t]=o.exports:l===e&&x||(g[t]=l))}else t&&(g[t]=n)},t=i=f=function(t,i,n,s,r){return"string"==typeof t?p[t]?p[t](i):a(d(t,i).f):(t.splice||(x=t,i.splice?(t=i,i=n,n=null):t=e),i=i||function(){},"function"==typeof n&&(n=s,s=r),s?c(e,t,i,n):setTimeout(function(){c(e,t,i,n)},4),f)},f.config=function(t){return x=t,x.deps&&f(x.deps,x.callback),f},t._defined=g,n=function(t,i,n){i.splice||(n=i,i=[]),s(g,t)||s(v,t)||(v[t]=[t,i,n])},n.amd={jQuery:!0}}(),n("almond",function(){}),n("PHET_CORE/phetAllocation",["require"],function(){return function(t){if(window.alloc){var i;try{throw new Error}catch(n){i=n.stack}window.alloc[t]||(window.alloc[t]={count:0,stacks:{}});var e=window.alloc[t];e.count++,e.stacks[i]?e.stacks[i]+=1:e.stacks[i]=1,e.report=function(){var t=Object.keys(e.stacks);t=_.sortBy(t,function(t){return e.stacks[t]}),_.each(t,function(t){console.log(e.stacks[t]+": "+t)})}}}}),n("KITE/kite",["require","PHET_CORE/phetAllocation"],function(t){window.phetAllocation=t("PHET_CORE/phetAllocation");var i={};return i.assert=null,i}),n("ASSERT/assert",["require"],function(){return function(t,i){var n="assert."+t,e=window.has&&void 0!==window.has(n),s=e?!window.has(n):i;return s?null:function(t,i){var n="function"==typeof t?t():t;if(!n){if(window.navigator&&"Microsoft Internet Explorer"===window.navigator.appName)try{throw new Error}catch(e){i=i+", stack=\n"+e.stack}throw new Error("Assertion failed: "+i)}}}}),n("DOT/dot",["require","PHET_CORE/phetAllocation"],function(t){window.phetAllocation=t("PHET_CORE/phetAllocation");var i=function n(){switch(arguments.length){case 2:return new n.Vector2(arguments[0],arguments[1]);case 3:return new n.Vector3(arguments[0],arguments[1],arguments[2]);case 4:return new n.Vector4(arguments[0],arguments[1],arguments[2],arguments[3]);default:throw new Error("dot takes 2-4 arguments")}};return i.FastArray=window.Float64Array?window.Float64Array:window.Array,i.assert=null,i}),n("PHET_CORE/extend",["require"],function(){return function(t){return _.each(Array.prototype.slice.call(arguments,1),function(i){if(i)for(var n in i)Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(i,n))}),t}}),n("PHET_CORE/inherit",["require","PHET_CORE/extend"],function(t){function i(t,i,e,s){function r(){}return r.prototype=t.prototype,i.prototype=n(new r,{constructor:i},e),n(i,s),i}var n=t("PHET_CORE/extend");return i}),n("PHET_CORE/Poolable",["require","PHET_CORE/extend"],function(t){var i=t("PHET_CORE/extend");return function(t,n){var e=t.prototype;n=i({maxPoolSize:50,initialSize:0},n);var s=t.pool=[];n.defaultFactory&&(t.dirtyFromPool=function(){return s.length?s.pop():n.defaultFactory()},t.fillPool=function(t){for(;s.length<t;)s.push(n.defaultFactory())},t.fillPool(n.initialSize)),n.constructorDuplicateFactory&&(t.createFromPool=n.constructorDuplicateFactory(s)),e.freeToPool=function(){s.length<n.maxPoolSize&&s.push(this)}}}),n("DOT/Util",["require","DOT/dot"],function(t){var i=t("DOT/dot");i.Util={testAssert:function(){return"assert.dot: false"},clamp:function(t,i,n){return i>t?i:t>n?n:t},moduloBetweenDown:function(t,i,n){var e=n-i,s=(t-i)%e;return 0>s&&(s+=e),s+i},moduloBetweenUp:function(t,i,e){return-n.moduloBetweenDown(-t,-e,-i)},rangeInclusive:function(t,i){if(t>i)return[];for(var n=new Array(i-t+1),e=t;i>=e;e++)n[e-t]=e;return n},rangeExclusive:function(t,i){return n.rangeInclusive(t+1,i-1)},toRadians:function(t){return Math.PI*t/180},toDegrees:function(t){return 180*t/Math.PI},lineLineIntersection:function(t,n,e,s){return new i.Vector2(((t.x*n.y-t.y*n.x)*(e.x-s.x)-(t.x-n.x)*(e.x*s.y-e.y*s.x))/((t.x-n.x)*(e.y-s.y)-(t.y-n.y)*(e.x-s.x)),((t.x*n.y-t.y*n.x)*(e.y-s.y)-(t.y-n.y)*(e.x*s.y-e.y*s.x))/((t.x-n.x)*(e.y-s.y)-(t.y-n.y)*(e.x-s.x)))},solveQuadraticRootsReal:function(t,i,n){var e=1e7;if(0===t||Math.abs(i/t)>e||Math.abs(n/t)>e)return[-n/i];var s=i*i-4*t*n;if(0>s)return[];var r=Math.sqrt(s);return[(-i-r)/(2*t),(-i+r)/(2*t)]},solveCubicRootsReal:function(t,i,e,s){var r=1e7;if(0===t||Math.abs(i/t)>r||Math.abs(e/t)>r||Math.abs(s/t)>r)return n.solveQuadraticRootsReal(i,e,s);if(0===s||Math.abs(t/s)>r||Math.abs(i/s)>r||Math.abs(e/s)>r)return n.solveQuadraticRootsReal(t,i,e);i/=t,e/=t,s/=t;var h=(3*e-i*i)/9,o=(-(27*s)+i*(9*e-2*i*i))/54,u=h*h*h+o*o,a=i/3;if(u>0){var m=Math.sqrt(u);return[n.cubeRoot(o+m)+n.cubeRoot(o-m)-a]}if(0===u){var l=n.cubeRoot(o),c=a-l;return[-a+2*l,c,c]}var f=-h*h*h;f=Math.acos(o/Math.sqrt(f));var d=2*Math.sqrt(-h);return[-a+d*Math.cos(f/3),-a+d*Math.cos((f+2*Math.PI)/3),-a+d*Math.cos((f+4*Math.PI)/3)]},cubeRoot:function(t){return t>=0?Math.pow(t,1/3):-Math.pow(-t,1/3)},linear:function(t,i,n,e,s){return(e-n)/(i-t)*(s-t)+n},toFixed:function(t,i){var n=Math.pow(10,i);return Math.round(t*n)/n},isInteger:function(t){return Math.floor(t)===t}};var n=i.Util;return i.testAssert=n.testAssert,i.clamp=n.clamp,i.moduloBetweenDown=n.moduloBetweenDown,i.moduloBetweenUp=n.moduloBetweenUp,i.rangeInclusive=n.rangeInclusive,i.rangeExclusive=n.rangeExclusive,i.toRadians=n.toRadians,i.toDegrees=n.toDegrees,i.lineLineIntersection=n.lineLineIntersection,i.solveQuadraticRootsReal=n.solveQuadraticRootsReal,i.solveCubicRootsReal=n.solveCubicRootsReal,i.cubeRoot=n.cubeRoot,i.linear=n.linear,n}),n("DOT/Vector2",["require","DOT/dot","PHET_CORE/inherit","PHET_CORE/Poolable","DOT/Util"],function(t){var i=t("DOT/dot"),n=t("PHET_CORE/inherit"),e=t("PHET_CORE/Poolable");t("DOT/Util"),i.Vector2=function(t,i){this.x=t||0,this.y=i||0};var s=i.Vector2;s.createPolar=function(t,i){return new s(t*Math.cos(i),t*Math.sin(i))},s.prototype={constructor:s,isVector2:!0,dimension:2,magnitude:function(){return Math.sqrt(this.magnitudeSquared())},magnitudeSquared:function(){return this.x*this.x+this.y*this.y},distance:function(t){return Math.sqrt(this.distanceSquared(t))},distanceXY:function(t,i){var n=this.x-t,e=this.y-i;return Math.sqrt(n*n+e*e)},distanceSquared:function(t){var i=this.x-t.x,n=this.y-t.y;return i*i+n*n},dot:function(t){return this.x*t.x+this.y*t.y},equals:function(t){return this.x===t.x&&this.y===t.y},equalsEpsilon:function(t,i){return i||(i=0),Math.max(Math.abs(this.x-t.x),Math.abs(this.y-t.y))<=i},isFinite:function(){return isFinite(this.x)&&isFinite(this.y)},copy:function(){return new s(this.x,this.y)},crossScalar:function(t){return this.x*t.y-this.y*t.x},normalized:function(){var t=this.magnitude();if(0===t)throw new Error("Cannot normalize a zero-magnitude vector");return new s(this.x/t,this.y/t)},timesScalar:function(t){return new s(this.x*t,this.y*t)},times:function(t){return this.timesScalar(t)},componentTimes:function(t){return new s(this.x*t.x,this.y*t.y)},plus:function(t){return new s(this.x+t.x,this.y+t.y)},plusScalar:function(t){return new s(this.x+t,this.y+t)},minus:function(t){return new s(this.x-t.x,this.y-t.y)},minusScalar:function(t){return new s(this.x-t,this.y-t)},dividedScalar:function(t){return new s(this.x/t,this.y/t)},negated:function(){return new s(-this.x,-this.y)},angle:function(){return Math.atan2(this.y,this.x)},perpendicular:function(){return new s(this.y,-this.x)},angleBetween:function(t){var n=this.magnitude(),e=t.magnitude();return Math.acos(i.clamp((this.x*t.x+this.y*t.y)/(n*e),-1,1))},rotated:function(t){var i=this.angle()+t,n=this.magnitude();return new s(n*Math.cos(i),n*Math.sin(i))},blend:function(t,i){return new s(this.x+(t.x-this.x)*i,this.y+(t.y-this.y)*i)},toString:function(){return"Vector2("+this.x+", "+this.y+")"},toVector3:function(){return new i.Vector3(this.x,this.y)},set:function(t,i){return this.x=t,this.y=i,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},add:function(t){return this.x+=t.x,this.y+=t.y,this},addScalar:function(t){return this.x+=t,this.y+=t,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this},subtractScalar:function(t){return this.x-=t,this.y-=t,this},componentMultiply:function(t){return this.x*=t.x,this.y*=t.y,this},divideScalar:function(t){return this.x/=t,this.y/=t,this},negate:function(){return this.x=-this.x,this.y=-this.y,this}},e(s,{defaultFactory:function(){return new s},constructorDuplicateFactory:function(t){return function(i,n){return t.length?t.pop().set(i,n):new s(i,n)}}}),s.Immutable=function(t,i){s.call(this,t,i)};var r=s.Immutable;return n(s,r),r.mutableOverrideHelper=function(t){r.prototype[t]=function(){throw new Error("Cannot call mutable method '"+t+"' on immutable Vector2")}},r.mutableOverrideHelper("set"),r.mutableOverrideHelper("setX"),r.mutableOverrideHelper("setY"),r.mutableOverrideHelper("add"),r.mutableOverrideHelper("addScalar"),r.mutableOverrideHelper("subtract"),r.mutableOverrideHelper("subtractScalar"),r.mutableOverrideHelper("componentMultiply"),r.mutableOverrideHelper("divideScalar"),r.mutableOverrideHelper("negate"),s.ZERO=new r(0,0),s.X_UNIT=new r(1,0),s.Y_UNIT=new r(0,1),s}),n("DOT/Bounds2",["require","DOT/dot","DOT/Vector2"],function(t){var i=t("DOT/dot");t("DOT/Vector2"),i.Bounds2=function(t,i,n,e){this.minX=t,this.minY=i,this.maxX=n,this.maxY=e};var n=i.Bounds2;return n.prototype={constructor:n,getWidth:function(){return this.maxX-this.minX},get width(){return this.getWidth()},getHeight:function(){return this.maxY-this.minY},get height(){return this.getHeight()},getX:function(){return this.minX},get x(){return this.getX()},getY:function(){return this.minY},get y(){return this.getY()},getCenter:function(){return new i.Vector2(this.getCenterX(),this.getCenterY())},get center(){return this.getCenter()},getCenterX:function(){return(this.maxX+this.minX)/2},get centerX(){return this.getCenterX()},getCenterY:function(){return(this.maxY+this.minY)/2},get centerY(){return this.getCenterY()},getMinX:function(){return this.minX},getMinY:function(){return this.minY},getMaxX:function(){return this.maxX},getMaxY:function(){return this.maxY},isEmpty:function(){return this.getWidth()<0||this.getHeight()<0},isFinite:function(){return isFinite(this.minX)&&isFinite(this.minY)&&isFinite(this.maxX)&&isFinite(this.maxY)},isValid:function(){return!this.isEmpty()&&this.isFinite()},containsCoordinates:function(t,i){return this.minX<=t&&t<=this.maxX&&this.minY<=i&&i<=this.maxY},containsPoint:function(t){return this.containsCoordinates(t.x,t.y)},containsBounds:function(t){return this.minX<=t.minX&&this.maxX>=t.maxX&&this.minY<=t.minY&&this.maxY>=t.maxY},intersectsBounds:function(t){return!this.intersection(t).isEmpty()},toString:function(){return"[x:("+this.minX+","+this.maxX+"),y:("+this.minY+","+this.maxY+")]"},equals:function(t){return this.minX===t.minX&&this.minY===t.minY&&this.maxX===t.maxX&&this.maxY===t.maxY},equalsEpsilon:function(t,i){i=i||0;var n=this.isFinite(),e=t.isFinite();return n&&e?Math.abs(this.minX-t.minX)<i&&Math.abs(this.minY-t.minY)<i&&Math.abs(this.maxX-t.maxX)<i&&Math.abs(this.maxY-t.maxY)<i:n!==e?!1:this===t?!0:(isFinite(this.minX+t.minX)?Math.abs(this.minX-t.minX)<i:this.minX===t.minX)&&(isFinite(this.minY+t.minY)?Math.abs(this.minY-t.minY)<i:this.minY===t.minY)&&(isFinite(this.maxX+t.maxX)?Math.abs(this.maxX-t.maxX)<i:this.maxX===t.maxX)&&(isFinite(this.maxY+t.maxY)?Math.abs(this.maxY-t.maxY)<i:this.maxY===t.maxY)},copy:function(){return new n(this.minX,this.minY,this.maxX,this.maxY)},union:function(t){return new n(Math.min(this.minX,t.minX),Math.min(this.minY,t.minY),Math.max(this.maxX,t.maxX),Math.max(this.maxY,t.maxY))},intersection:function(t){return new n(Math.max(this.minX,t.minX),Math.max(this.minY,t.minY),Math.min(this.maxX,t.maxX),Math.min(this.maxY,t.maxY))},withCoordinates:function(t,i){return new n(Math.min(this.minX,t),Math.min(this.minY,i),Math.max(this.maxX,t),Math.max(this.maxY,i))},withPoint:function(t){return this.withCoordinates(t.x,t.y)},withMinX:function(t){return new n(t,this.minY,this.maxX,this.maxY)},withMinY:function(t){return new n(this.minX,t,this.maxX,this.maxY)},withMaxX:function(t){return new n(this.minX,this.minY,t,this.maxY)},withMaxY:function(t){return new n(this.minX,this.minY,this.maxX,t)},roundedOut:function(){return new n(Math.floor(this.minX),Math.floor(this.minY),Math.ceil(this.maxX),Math.ceil(this.maxY))},roundedIn:function(){return new n(Math.ceil(this.minX),Math.ceil(this.minY),Math.floor(this.maxX),Math.floor(this.maxY))},transformed:function(t){return this.copy().transform(t)},dilated:function(t){return new n(this.minX-t,this.minY-t,this.maxX+t,this.maxY+t)},eroded:function(t){return this.dilated(-t)},shiftedX:function(t){return new n(this.minX+t,this.minY,this.maxX+t,this.maxY)},shiftedY:function(t){return new n(this.minX,this.minY+t,this.maxX,this.maxY+t)},shifted:function(t,i){return new n(this.minX+t,this.minY+i,this.maxX+t,this.maxY+i)},set:function(t,i,n,e){return this.minX=t,this.minY=i,this.maxX=n,this.maxY=e,this},setBounds:function(t){return this.set(t.minX,t.minY,t.maxX,t.maxY)},includeBounds:function(t){return this.minX=Math.min(this.minX,t.minX),this.minY=Math.min(this.minY,t.minY),this.maxX=Math.max(this.maxX,t.maxX),this.maxY=Math.max(this.maxY,t.maxY),this},constrainBounds:function(t){return this.minX=Math.max(this.minX,t.minX),this.minY=Math.max(this.minY,t.minY),this.maxX=Math.min(this.maxX,t.maxX),this.maxY=Math.min(this.maxY,t.maxY),this},addCoordinates:function(t,i){return this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,i),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,i),this},addPoint:function(t){return this.addCoordinates(t.x,t.y)},setMinX:function(t){return this.minX=t,this},setMinY:function(t){return this.minY=t,this},setMaxX:function(t){return this.maxX=t,this},setMaxY:function(t){return this.maxY=t,this},roundOut:function(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this},roundIn:function(){return this.minX=Math.ceil(this.minX),this.minY=Math.ceil(this.minY),this.maxX=Math.floor(this.maxX),this.maxY=Math.floor(this.maxY),this},transform:function(t){if(this.isEmpty())return this;var e=this.minX,s=this.minY,r=this.maxX,h=this.maxY,o=new i.Vector2;return this.setBounds(n.NOTHING),this.addPoint(t.multiplyVector2(o.set(e,s))),this.addPoint(t.multiplyVector2(o.set(e,h))),this.addPoint(t.multiplyVector2(o.set(r,s))),this.addPoint(t.multiplyVector2(o.set(r,h))),this},dilate:function(t){return this.set(this.minX-t,this.minY-t,this.maxX+t,this.maxY+t)},erode:function(t){return this.dilate(-t)},shiftX:function(t){return this.setMinX(this.minX+t).setMaxX(this.maxX+t)},shiftY:function(t){return this.setMinY(this.minY+t).setMaxY(this.maxY+t)},shift:function(t,i){return this.shiftX(t).shiftY(i)}},n.rect=function(t,i,e,s){return new n(t,i,t+e,i+s)},n.EVERYTHING=new n(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),n.NOTHING=new n(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),n}),n("DOT/Ray2",["require","DOT/dot"],function(t){var i=t("DOT/dot");i.Ray2=function(t,i){this.pos=t,this.dir=i};var n=i.Ray2;return n.prototype={constructor:n,shifted:function(t){return new n(this.pointAtDistance(t),this.dir)},pointAtDistance:function(t){return this.pos.plus(this.dir.timesScalar(t))},toString:function(){return this.pos.toString()+" => "+this.dir.toString()}},n}),n("DOT/Vector4",["require","DOT/dot","DOT/Util"],function(t){var i=t("DOT/dot");t("DOT/Util"),i.Vector4=function(t,i,n,e){this.x=t||0,this.y=i||0,this.z=n||0,this.w=void 0!==e?e:1};var n=i.Vector4;n.prototype={constructor:n,magnitude:function(){return Math.sqrt(this.magnitudeSquared())},magnitudeSquared:function(){this.dot(this)},distance:function(t){return this.minus(t).magnitude()},distanceSquared:function(t){return this.minus(t).magnitudeSquared()},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},isFinite:function(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.z)&&isFinite(this.w)},normalized:function(){var t=this.magnitude();if(0===t)throw new Error("Cannot normalize a zero-magnitude vector");return new n(this.x/t,this.y/t,this.z/t,this.w/t)},timesScalar:function(t){return new n(this.x*t,this.y*t,this.z*t,this.w*t)},times:function(t){return this.timesScalar(t)},componentTimes:function(t){return new n(this.x*t.x,this.y*t.y,this.z*t.z,this.w*t.w)},plus:function(t){return new n(this.x+t.x,this.y+t.y,this.z+t.z,this.w+t.w)},plusScalar:function(t){return new n(this.x+t,this.y+t,this.z+t,this.w+t)},minus:function(t){return new n(this.x-t.x,this.y-t.y,this.z-t.z,this.w-t.w)},minusScalar:function(t){return new n(this.x-t,this.y-t,this.z-t,this.w-t)},dividedScalar:function(t){return new n(this.x/t,this.y/t,this.z/t,this.w/t)},negated:function(){return new n(-this.x,-this.y,-this.z,-this.w)},angleBetween:function(t){return Math.acos(i.clamp(this.normalized().dot(t.normalized()),-1,1))},blend:function(t,i){return this.plus(t.minus(this).times(i))},toString:function(){return"Vector4("+this.x+", "+this.y+", "+this.z+", "+this.w+")"},toVector3:function(){return new i.Vector3(this.x,this.y,this.z)},set:function(t,i,n,e){this.x=t,this.y=i,this.z=n,this.w=e},setX:function(t){this.x=t},setY:function(t){this.y=t},setZ:function(t){this.z=t},setW:function(t){this.w=t},copy:function(t){this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w},add:function(t){this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w},addScalar:function(t){this.x+=t,this.y+=t,this.z+=t,this.w+=t},subtract:function(t){this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w},subtractScalar:function(t){this.x-=t,this.y-=t,this.z-=t,this.w-=t},componentMultiply:function(t){this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w},divideScalar:function(t){this.x/=t,this.y/=t,this.z/=t,this.w/=t},negate:function(){this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w},equalsEpsilon:function(t,i){return i||(i=0),Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)+Math.abs(this.w-t.w)<=i},isVector4:!0,dimension:4},n.Immutable=function(t,i,n,e){this.x=t||0,this.y=i||0,this.z=n||0,this.w=void 0!==e?e:1};var e=n.Immutable;return e.prototype=new n,e.prototype.constructor=e,e.mutableOverrideHelper=function(t){e.prototype[t]=function(){throw new Error("Cannot call mutable method '"+t+"' on immutable Vector4")}},e.mutableOverrideHelper("set"),e.mutableOverrideHelper("setX"),e.mutableOverrideHelper("setY"),e.mutableOverrideHelper("setZ"),e.mutableOverrideHelper("setW"),e.mutableOverrideHelper("copy"),e.mutableOverrideHelper("add"),e.mutableOverrideHelper("addScalar"),e.mutableOverrideHelper("subtract"),e.mutableOverrideHelper("subtractScalar"),e.mutableOverrideHelper("componentMultiply"),e.mutableOverrideHelper("divideScalar"),e.mutableOverrideHelper("negate"),n.ZERO=new e(0,0,0,0),n.X_UNIT=new e(1,0,0,0),n.Y_UNIT=new e(0,1,0,0),n.Z_UNIT=new e(0,0,1,0),n.W_UNIT=new e(0,0,0,1),n}),n("DOT/Vector3",["require","DOT/dot","DOT/Util","DOT/Vector2","DOT/Vector4"],function(t){var i=t("DOT/dot");t("DOT/Util"),t("DOT/Vector2"),t("DOT/Vector4"),i.Vector3=function(t,i,n){this.x=t||0,this.y=i||0,this.z=n||0};var n=i.Vector3;n.prototype={constructor:n,magnitude:function(){return Math.sqrt(this.magnitudeSquared())},magnitudeSquared:function(){return this.dot(this)},distance:function(t){return this.minus(t).magnitude()},distanceSquared:function(t){return this.minus(t).magnitudeSquared()},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},isFinite:function(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.z)},cross:function(t){return new n(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)},normalized:function(){var t=this.magnitude();if(0===t)throw new Error("Cannot normalize a zero-magnitude vector");return new n(this.x/t,this.y/t,this.z/t)},timesScalar:function(t){return new n(this.x*t,this.y*t,this.z*t)},times:function(t){return this.timesScalar(t)},componentTimes:function(t){return new n(this.x*t.x,this.y*t.y,this.z*t.z)},plus:function(t){return new n(this.x+t.x,this.y+t.y,this.z+t.z)},plusScalar:function(t){return new n(this.x+t,this.y+t,this.z+t)},minus:function(t){return new n(this.x-t.x,this.y-t.y,this.z-t.z)},minusScalar:function(t){return new n(this.x-t,this.y-t,this.z-t)},dividedScalar:function(t){return new n(this.x/t,this.y/t,this.z/t)},negated:function(){return new n(-this.x,-this.y,-this.z)},angleBetween:function(t){return Math.acos(i.clamp(this.normalized().dot(t.normalized()),-1,1))},blend:function(t,i){return this.plus(t.minus(this).times(i))},toString:function(){return"Vector3("+this.x+", "+this.y+", "+this.z+")"},toVector2:function(){return new i.Vector2(this.x,this.y)},toVector4:function(){return new i.Vector4(this.x,this.y,this.z)},set:function(t,i,n){this.x=t,this.y=i,this.z=n},setX:function(t){this.x=t},setY:function(t){this.y=t},setZ:function(t){this.z=t},copy:function(t){this.x=t.x,this.y=t.y,this.z=t.z},add:function(t){this.x+=t.x,this.y+=t.y,this.z+=t.z},addScalar:function(t){this.x+=t,this.y+=t,this.z+=t},subtract:function(t){this.x-=t.x,this.y-=t.y,this.z-=t.z},subtractScalar:function(t){this.x-=t,this.y-=t,this.z-=t},componentMultiply:function(t){this.x*=t.x,this.y*=t.y,this.z*=t.z},divideScalar:function(t){this.x/=t,this.y/=t,this.z/=t},negate:function(){this.x=-this.x,this.y=-this.y,this.z=-this.z},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z},equalsEpsilon:function(t,i){return i||(i=0),Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)<=i},isVector3:!0,dimension:3},n.Immutable=function(t,i,n){this.x=t||0,this.y=i||0,this.z=n||0};var e=n.Immutable;return e.prototype=new n,e.prototype.constructor=e,e.mutableOverrideHelper=function(t){e.prototype[t]=function(){throw new Error("Cannot call mutable method '"+t+"' on immutable Vector3")}},e.mutableOverrideHelper("set"),e.mutableOverrideHelper("setX"),e.mutableOverrideHelper("setY"),e.mutableOverrideHelper("setZ"),e.mutableOverrideHelper("copy"),e.mutableOverrideHelper("add"),e.mutableOverrideHelper("addScalar"),e.mutableOverrideHelper("subtract"),e.mutableOverrideHelper("subtractScalar"),e.mutableOverrideHelper("componentMultiply"),e.mutableOverrideHelper("divideScalar"),e.mutableOverrideHelper("negate"),n.ZERO=new e(0,0,0),n.X_UNIT=new e(1,0,0),n.Y_UNIT=new e(0,1,0),n.Z_UNIT=new e(0,0,1),n}),n("DOT/Matrix4",["require","DOT/dot","DOT/Vector3","DOT/Vector4"],function(t){var i=t("DOT/dot");t("DOT/Vector3"),t("DOT/Vector4");var n=window.Float32Array||Array;i.Matrix4=function(t,i,e,s,r,h,o,u,a,m,l,c,f,d,p,g,v){this.entries=new n(16),this.rowMajor(void 0===t?1:t,i||0,e||0,s||0,r||0,void 0===h?1:h,o||0,u||0,a||0,m||0,void 0===l?1:l,c||0,f||0,d||0,p||0,void 0===g?1:g,v)};var e=i.Matrix4;e.Types={OTHER:0,IDENTITY:1,TRANSLATION_3D:2,SCALING:3};var s=e.Types;return e.identity=function(){return new e(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,s.IDENTITY)},e.translation=function(t,i,n){return new e(1,0,0,t,0,1,0,i,0,0,1,n,0,0,0,1,s.TRANSLATION_3D)},e.translationFromVector=function(t){return e.translation(t.x,t.y,t.z)},e.scaling=function(t,i,n){return i=void 0===i?t:i,n=void 0===n?t:n,new e(t,0,0,0,0,i,0,0,0,0,n,0,0,0,0,1,s.SCALING)},e.rotationAxisAngle=function(t,i){var n=Math.cos(i),r=Math.sin(i),h=1-n;return new e(t.x*t.x*h+n,t.x*t.y*h-t.z*r,t.x*t.z*h+t.y*r,0,t.y*t.x*h+t.z*r,t.y*t.y*h+n,t.y*t.z*h-t.x*r,0,t.z*t.x*h-t.y*r,t.z*t.y*h+t.x*r,t.z*t.z*h+n,0,0,0,0,1,s.OTHER)},e.rotationX=function(t){var i=Math.cos(t),n=Math.sin(t);return new e(1,0,0,0,0,i,-n,0,0,n,i,0,0,0,0,1,s.OTHER)},e.rotationY=function(t){var i=Math.cos(t),n=Math.sin(t);return new e(i,0,n,0,0,1,0,0,-n,0,i,0,0,0,0,1,s.OTHER)},e.rotationZ=function(t){var i=Math.cos(t),n=Math.sin(t);return new e(i,-n,0,0,n,i,0,0,0,0,1,0,0,0,0,1,s.OTHER)},e.gluPerspective=function(t,i,n,s){var r=Math.cos(t)/Math.sin(t);return new e(r/i,0,0,0,0,r,0,0,0,0,(s+n)/(n-s),2*s*n/(n-s),0,0,-1,0)},e.prototype={constructor:e,rowMajor:function(t,i,n,e,r,h,o,u,a,m,l,c,f,d,p,g,v){this.entries[0]=t,this.entries[1]=r,this.entries[2]=a,this.entries[3]=f,this.entries[4]=i,this.entries[5]=h,this.entries[6]=m,this.entries[7]=d,this.entries[8]=n,this.entries[9]=o,this.entries[10]=l,this.entries[11]=p,this.entries[12]=e,this.entries[13]=u,this.entries[14]=c,this.entries[15]=g,this.type=void 0===v?s.OTHER:v},columnMajor:function(t,i,n,e,s,r,h,o,u,a,m,l,c,f,d,p,g){this.rowMajor(t,s,u,c,i,r,a,f,n,h,m,d,e,o,l,p,g)},m00:function(){return this.entries[0]},m01:function(){return this.entries[4]},m02:function(){return this.entries[8]},m03:function(){return this.entries[12]},m10:function(){return this.entries[1]},m11:function(){return this.entries[5]},m12:function(){return this.entries[9]},m13:function(){return this.entries[13]},m20:function(){return this.entries[2]},m21:function(){return this.entries[6]},m22:function(){return this.entries[10]},m23:function(){return this.entries[14]},m30:function(){return this.entries[3]},m31:function(){return this.entries[7]},m32:function(){return this.entries[11]},m33:function(){return this.entries[15]},plus:function(t){return new e(this.m00()+t.m00(),this.m01()+t.m01(),this.m02()+t.m02(),this.m03()+t.m03(),this.m10()+t.m10(),this.m11()+t.m11(),this.m12()+t.m12(),this.m13()+t.m13(),this.m20()+t.m20(),this.m21()+t.m21(),this.m22()+t.m22(),this.m23()+t.m23(),this.m30()+t.m30(),this.m31()+t.m31(),this.m32()+t.m32(),this.m33()+t.m33())},minus:function(t){return new e(this.m00()-t.m00(),this.m01()-t.m01(),this.m02()-t.m02(),this.m03()-t.m03(),this.m10()-t.m10(),this.m11()-t.m11(),this.m12()-t.m12(),this.m13()-t.m13(),this.m20()-t.m20(),this.m21()-t.m21(),this.m22()-t.m22(),this.m23()-t.m23(),this.m30()-t.m30(),this.m31()-t.m31(),this.m32()-t.m32(),this.m33()-t.m33())},transposed:function(){return new e(this.m00(),this.m10(),this.m20(),this.m30(),this.m01(),this.m11(),this.m21(),this.m31(),this.m02(),this.m12(),this.m22(),this.m32(),this.m03(),this.m13(),this.m23(),this.m33())},negated:function(){return new e(-this.m00(),-this.m01(),-this.m02(),-this.m03(),-this.m10(),-this.m11(),-this.m12(),-this.m13(),-this.m20(),-this.m21(),-this.m22(),-this.m23(),-this.m30(),-this.m31(),-this.m32(),-this.m33())},inverted:function(){var t=this.determinant();if(0!==t)return new e((-this.m31()*this.m22()*this.m13()+this.m21()*this.m32()*this.m13()+this.m31()*this.m12()*this.m23()-this.m11()*this.m32()*this.m23()-this.m21()*this.m12()*this.m33()+this.m11()*this.m22()*this.m33())/t,(this.m31()*this.m22()*this.m03()-this.m21()*this.m32()*this.m03()-this.m31()*this.m02()*this.m23()+this.m01()*this.m32()*this.m23()+this.m21()*this.m02()*this.m33()-this.m01()*this.m22()*this.m33())/t,(-this.m31()*this.m12()*this.m03()+this.m11()*this.m32()*this.m03()+this.m31()*this.m02()*this.m13()-this.m01()*this.m32()*this.m13()-this.m11()*this.m02()*this.m33()+this.m01()*this.m12()*this.m33())/t,(this.m21()*this.m12()*this.m03()-this.m11()*this.m22()*this.m03()-this.m21()*this.m02()*this.m13()+this.m01()*this.m22()*this.m13()+this.m11()*this.m02()*this.m23()-this.m01()*this.m12()*this.m23())/t,(this.m30()*this.m22()*this.m13()-this.m20()*this.m32()*this.m13()-this.m30()*this.m12()*this.m23()+this.m10()*this.m32()*this.m23()+this.m20()*this.m12()*this.m33()-this.m10()*this.m22()*this.m33())/t,(-this.m30()*this.m22()*this.m03()+this.m20()*this.m32()*this.m03()+this.m30()*this.m02()*this.m23()-this.m00()*this.m32()*this.m23()-this.m20()*this.m02()*this.m33()+this.m00()*this.m22()*this.m33())/t,(this.m30()*this.m12()*this.m03()-this.m10()*this.m32()*this.m03()-this.m30()*this.m02()*this.m13()+this.m00()*this.m32()*this.m13()+this.m10()*this.m02()*this.m33()-this.m00()*this.m12()*this.m33())/t,(-this.m20()*this.m12()*this.m03()+this.m10()*this.m22()*this.m03()+this.m20()*this.m02()*this.m13()-this.m00()*this.m22()*this.m13()-this.m10()*this.m02()*this.m23()+this.m00()*this.m12()*this.m23())/t,(-this.m30()*this.m21()*this.m13()+this.m20()*this.m31()*this.m13()+this.m30()*this.m11()*this.m23()-this.m10()*this.m31()*this.m23()-this.m20()*this.m11()*this.m33()+this.m10()*this.m21()*this.m33())/t,(this.m30()*this.m21()*this.m03()-this.m20()*this.m31()*this.m03()-this.m30()*this.m01()*this.m23()+this.m00()*this.m31()*this.m23()+this.m20()*this.m01()*this.m33()-this.m00()*this.m21()*this.m33())/t,(-this.m30()*this.m11()*this.m03()+this.m10()*this.m31()*this.m03()+this.m30()*this.m01()*this.m13()-this.m00()*this.m31()*this.m13()-this.m10()*this.m01()*this.m33()+this.m00()*this.m11()*this.m33())/t,(this.m20()*this.m11()*this.m03()-this.m10()*this.m21()*this.m03()-this.m20()*this.m01()*this.m13()+this.m00()*this.m21()*this.m13()+this.m10()*this.m01()*this.m23()-this.m00()*this.m11()*this.m23())/t,(this.m30()*this.m21()*this.m12()-this.m20()*this.m31()*this.m12()-this.m30()*this.m11()*this.m22()+this.m10()*this.m31()*this.m22()+this.m20()*this.m11()*this.m32()-this.m10()*this.m21()*this.m32())/t,(-this.m30()*this.m21()*this.m02()+this.m20()*this.m31()*this.m02()+this.m30()*this.m01()*this.m22()-this.m00()*this.m31()*this.m22()-this.m20()*this.m01()*this.m32()+this.m00()*this.m21()*this.m32())/t,(this.m30()*this.m11()*this.m02()-this.m10()*this.m31()*this.m02()-this.m30()*this.m01()*this.m12()+this.m00()*this.m31()*this.m12()+this.m10()*this.m01()*this.m32()-this.m00()*this.m11()*this.m32())/t,(-this.m20()*this.m11()*this.m02()+this.m10()*this.m21()*this.m02()+this.m20()*this.m01()*this.m12()-this.m00()*this.m21()*this.m12()-this.m10()*this.m01()*this.m22()+this.m00()*this.m11()*this.m22())/t);throw new Error("Matrix could not be inverted, determinant === 0")},timesMatrix:function(t){var i=s.OTHER;return this.type===s.TRANSLATION_3D&&t.type===s.TRANSLATION_3D&&(i=s.TRANSLATION_3D),this.type===s.SCALING&&t.type===s.SCALING&&(i=s.SCALING),this.type===s.IDENTITY&&(i=t.type),t.type===s.IDENTITY&&(i=this.type),new e(this.m00()*t.m00()+this.m01()*t.m10()+this.m02()*t.m20()+this.m03()*t.m30(),this.m00()*t.m01()+this.m01()*t.m11()+this.m02()*t.m21()+this.m03()*t.m31(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02()*t.m22()+this.m03()*t.m32(),this.m00()*t.m03()+this.m01()*t.m13()+this.m02()*t.m23()+this.m03()*t.m33(),this.m10()*t.m00()+this.m11()*t.m10()+this.m12()*t.m20()+this.m13()*t.m30(),this.m10()*t.m01()+this.m11()*t.m11()+this.m12()*t.m21()+this.m13()*t.m31(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12()*t.m22()+this.m13()*t.m32(),this.m10()*t.m03()+this.m11()*t.m13()+this.m12()*t.m23()+this.m13()*t.m33(),this.m20()*t.m00()+this.m21()*t.m10()+this.m22()*t.m20()+this.m23()*t.m30(),this.m20()*t.m01()+this.m21()*t.m11()+this.m22()*t.m21()+this.m23()*t.m31(),this.m20()*t.m02()+this.m21()*t.m12()+this.m22()*t.m22()+this.m23()*t.m32(),this.m20()*t.m03()+this.m21()*t.m13()+this.m22()*t.m23()+this.m23()*t.m33(),this.m30()*t.m00()+this.m31()*t.m10()+this.m32()*t.m20()+this.m33()*t.m30(),this.m30()*t.m01()+this.m31()*t.m11()+this.m32()*t.m21()+this.m33()*t.m31(),this.m30()*t.m02()+this.m31()*t.m12()+this.m32()*t.m22()+this.m33()*t.m32(),this.m30()*t.m03()+this.m31()*t.m13()+this.m32()*t.m23()+this.m33()*t.m33(),i)
},timesVector4:function(t){var n=this.m00()*t.x+this.m01()*t.y+this.m02()*t.z+this.m03()*t.w,e=this.m10()*t.x+this.m11()*t.y+this.m12()*t.z+this.m13()*t.w,s=this.m20()*t.x+this.m21()*t.y+this.m22()*t.z+this.m23()*t.w,r=this.m30()*t.x+this.m31()*t.y+this.m32()*t.z+this.m33()*t.w;return new i.Vector4(n,e,s,r)},timesVector3:function(t){return this.timesVector4(t.toVector4()).toVector3()},timesTransposeVector4:function(t){var n=this.m00()*t.x+this.m10()*t.y+this.m20()*t.z+this.m30()*t.w,e=this.m01()*t.x+this.m11()*t.y+this.m21()*t.z+this.m31()*t.w,s=this.m02()*t.x+this.m12()*t.y+this.m22()*t.z+this.m32()*t.w,r=this.m03()*t.x+this.m13()*t.y+this.m23()*t.z+this.m33()*t.w;return new i.Vector4(n,e,s,r)},timesTransposeVector3:function(t){return this.timesTransposeVector4(t.toVector4()).toVector3()},timesRelativeVector3:function(t){var n=this.m00()*t.x+this.m10()*t.y+this.m20()*t.z,e=this.m01()*t.y+this.m11()*t.y+this.m21()*t.z,s=this.m02()*t.z+this.m12()*t.y+this.m22()*t.z;return new i.Vector3(n,e,s)},determinant:function(){return this.m03()*this.m12()*this.m21()*this.m30()-this.m02()*this.m13()*this.m21()*this.m30()-this.m03()*this.m11()*this.m22()*this.m30()+this.m01()*this.m13()*this.m22()*this.m30()+this.m02()*this.m11()*this.m23()*this.m30()-this.m01()*this.m12()*this.m23()*this.m30()-this.m03()*this.m12()*this.m20()*this.m31()+this.m02()*this.m13()*this.m20()*this.m31()+this.m03()*this.m10()*this.m22()*this.m31()-this.m00()*this.m13()*this.m22()*this.m31()-this.m02()*this.m10()*this.m23()*this.m31()+this.m00()*this.m12()*this.m23()*this.m31()+this.m03()*this.m11()*this.m20()*this.m32()-this.m01()*this.m13()*this.m20()*this.m32()-this.m03()*this.m10()*this.m21()*this.m32()+this.m00()*this.m13()*this.m21()*this.m32()+this.m01()*this.m10()*this.m23()*this.m32()-this.m00()*this.m11()*this.m23()*this.m32()-this.m02()*this.m11()*this.m20()*this.m33()+this.m01()*this.m12()*this.m20()*this.m33()+this.m02()*this.m10()*this.m21()*this.m33()-this.m00()*this.m12()*this.m21()*this.m33()-this.m01()*this.m10()*this.m22()*this.m33()+this.m00()*this.m11()*this.m22()*this.m33()},toString:function(){return this.m00()+" "+this.m01()+" "+this.m02()+" "+this.m03()+"\n"+this.m10()+" "+this.m11()+" "+this.m12()+" "+this.m13()+"\n"+this.m20()+" "+this.m21()+" "+this.m22()+" "+this.m23()+"\n"+this.m30()+" "+this.m31()+" "+this.m32()+" "+this.m33()},translation:function(){return new i.Vector3(this.m03(),this.m13(),this.m23())},scaling:function(){return new i.Vector3(this.m00(),this.m11(),this.m22())},makeImmutable:function(){this.rowMajor=function(){throw new Error("Cannot modify immutable matrix")}}},e.IDENTITY=new e,e.IDENTITY.makeImmutable(),e}),n("DOT/Matrix3",["require","DOT/dot","DOT/Vector2","DOT/Vector3","DOT/Matrix4"],function(t){var i=t("DOT/dot"),n=i.FastArray;t("DOT/Vector2"),t("DOT/Vector3"),t("DOT/Matrix4"),i.Matrix3=function(t,i,e,s,r,h,o,u,a,m){this.entries=new n(9),this.rowMajor(void 0===t?1:t,i||0,e||0,s||0,void 0===r?1:r,h||0,o||0,u||0,void 0===a?1:a,m)};var e=i.Matrix3;e.Types={OTHER:0,IDENTITY:1,TRANSLATION_2D:2,SCALING:3,AFFINE:4};var s=e.Types;return e.identity=function(){return new e(1,0,0,0,1,0,0,0,1,s.IDENTITY)},e.translation=function(t,i){return new e(1,0,t,0,1,i,0,0,1,s.TRANSLATION_2D)},e.translationFromVector=function(t){return e.translation(t.x,t.y)},e.scaling=function(t,i){return i=void 0===i?t:i,new e(t,0,0,0,i,0,0,0,1,s.SCALING)},e.scale=e.scaling,e.affine=function(t,i,n,r,h,o){return new e(t,n,h,i,r,o,0,0,1,s.AFFINE)},e.rotationAxisAngle=function(t,i){var n=Math.cos(i),r=Math.sin(i),h=1-n;return new e(t.x*t.x*h+n,t.x*t.y*h-t.z*r,t.x*t.z*h+t.y*r,t.y*t.x*h+t.z*r,t.y*t.y*h+n,t.y*t.z*h-t.x*r,t.z*t.x*h-t.y*r,t.z*t.y*h+t.x*r,t.z*t.z*h+n,s.OTHER)},e.rotationX=function(t){var i=Math.cos(t),n=Math.sin(t);return new e(1,0,0,0,i,-n,0,n,i,s.OTHER)},e.rotationY=function(t){var i=Math.cos(t),n=Math.sin(t);return new e(i,0,n,0,1,0,-n,0,i,s.OTHER)},e.rotationZ=function(t){var i=Math.cos(t),n=Math.sin(t);return new e(i,-n,0,n,i,0,0,0,1,s.AFFINE)},e.rotation2=e.rotationZ,e.fromSVGMatrix=function(t){return new e(t.a,t.c,t.e,t.b,t.d,t.f,0,0,1,s.AFFINE)},e.rotateAToB=function(t,n){var s,r,h,o=t,u=n,a=1e-4,m=o.cross(u);if(s=o.dot(u),h=0>s?-s:s,h>1-a){var l,c,f,d=new i.Vector3(o.x>0?o.x:-o.x,o.y>0?o.y:-o.y,o.z>0?o.z:-o.z);d=d.x<d.y?d.x<d.z?i.Vector3.X_UNIT:i.Vector3.Z_UNIT:d.y<d.z?i.Vector3.Y_UNIT:i.Vector3.Z_UNIT;var p=d.minus(o);return m=d.minus(u),l=2/p.dot(p),c=2/m.dot(m),f=l*c*p.dot(m),e.IDENTITY.plus(e.rowMajor(-l*p.x*p.x-c*m.x*m.x+f*m.x*p.x,-l*p.x*p.y-c*m.x*m.y+f*m.x*p.y,-l*p.x*p.z-c*m.x*m.z+f*m.x*p.z,-l*p.y*p.x-c*m.y*m.x+f*m.y*p.x,-l*p.y*p.y-c*m.y*m.y+f*m.y*p.y,-l*p.y*p.z-c*m.y*m.z+f*m.y*p.z,-l*p.z*p.x-c*m.z*m.x+f*m.z*p.x,-l*p.z*p.y-c*m.z*m.y+f*m.z*p.y,-l*p.z*p.z-c*m.z*m.z+f*m.z*p.z))}var g,v,x,T,w;return r=1/(1+s),g=r*m.x,v=r*m.z,x=g*m.y,T=g*m.z,w=v*m.y,e.rowMajor(s+g*m.x,x-m.z,T+m.y,x+m.z,s+r*m.y*m.y,w-m.x,T-m.y,w+m.x,s+v*m.z)},e.prototype={constructor:e,m00:function(){return this.entries[0]},m01:function(){return this.entries[3]},m02:function(){return this.entries[6]},m10:function(){return this.entries[1]},m11:function(){return this.entries[4]},m12:function(){return this.entries[7]},m20:function(){return this.entries[2]},m21:function(){return this.entries[5]},m22:function(){return this.entries[8]},isAffine:function(){return this.type===s.AFFINE||0===this.m20()&&0===this.m21()&&1===this.m22()},isFinite:function(){return isFinite(this.m00())&&isFinite(this.m01())&&isFinite(this.m02())&&isFinite(this.m10())&&isFinite(this.m11())&&isFinite(this.m12())&&isFinite(this.m20())&&isFinite(this.m21())&&isFinite(this.m22())},getDeterminant:function(){return this.m00()*this.m11()*this.m22()+this.m01()*this.m12()*this.m20()+this.m02()*this.m10()*this.m21()-this.m02()*this.m11()*this.m20()-this.m01()*this.m10()*this.m22()-this.m00()*this.m12()*this.m21()},get determinant(){return this.getDeterminant()},getTranslation:function(){return new i.Vector2(this.m02(),this.m12())},get translation(){return this.getTranslation()},getScaleVector:function(){return new i.Vector2(Math.sqrt(this.m00()*this.m00()+this.m10()*this.m10()),Math.sqrt(this.m01()*this.m01()+this.m11()*this.m11()))},get scaleVector(){return this.getScaleVector()},getRotation:function(){var t=this.timesVector2(i.Vector2.X_UNIT).minus(this.timesVector2(i.Vector2.ZERO));return Math.atan2(t.y,t.x)},get rotation(){return this.getRotation()},toMatrix4:function(){return new i.Matrix4(this.m00(),this.m01(),this.m02(),0,this.m10(),this.m11(),this.m12(),0,this.m20(),this.m21(),this.m22(),0,0,0,0,1)},toString:function(){return this.m00()+" "+this.m01()+" "+this.m02()+"\n"+this.m10()+" "+this.m11()+" "+this.m12()+"\n"+this.m20()+" "+this.m21()+" "+this.m22()},toSVGMatrix:function(){var t=document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix();return t.a=this.m00(),t.b=this.m10(),t.c=this.m01(),t.d=this.m11(),t.e=this.m02(),t.f=this.m12(),t},getCSSTransform:function(){return"matrix("+this.entries[0].toFixed(20)+","+this.entries[1].toFixed(20)+","+this.entries[3].toFixed(20)+","+this.entries[4].toFixed(20)+","+this.entries[6].toFixed(20)+","+this.entries[7].toFixed(20)+")"},get cssTransform(){return this.getCSSTransform()},getSVGTransform:function(){function t(t){return t.toFixed(20)}switch(this.type){case s.IDENTITY:return"";case s.TRANSLATION_2D:return"translate("+t(this.entries[6])+","+this.entries[7]+")";case s.SCALING:return"scale("+t(this.entries[0])+(this.entries[0]===this.entries[4]?"":","+t(this.entries[4]))+")";default:return"matrix("+t(this.entries[0])+","+t(this.entries[1])+","+t(this.entries[3])+","+t(this.entries[4])+","+t(this.entries[6])+","+t(this.entries[7])+")"}},get svgTransform(){return this.getSVGTransform()},getCSSTransformStyles:function(){var t=this.getCSSTransform();return{"-webkit-perspective":1e3,"-webkit-backface-visibility":"hidden","-webkit-transform":t+" translateZ(0)","-moz-transform":t+" translateZ(0)","-ms-transform":t,"-o-transform":t,transform:t,"transform-origin":"top left","-ms-transform-origin":"top left"}},get cssTransformStyles(){return this.getCSSTransformStyles()},equals:function(t){return this.m00()===t.m00()&&this.m01()===t.m01()&&this.m02()===t.m02()&&this.m10()===t.m10()&&this.m11()===t.m11()&&this.m12()===t.m12()&&this.m20()===t.m20()&&this.m21()===t.m21()&&this.m22()===t.m22()},equalsEpsilon:function(t,i){return Math.abs(this.m00()-t.m00())<i&&Math.abs(this.m01()-t.m01())<i&&Math.abs(this.m02()-t.m02())<i&&Math.abs(this.m10()-t.m10())<i&&Math.abs(this.m11()-t.m11())<i&&Math.abs(this.m12()-t.m12())<i&&Math.abs(this.m20()-t.m20())<i&&Math.abs(this.m21()-t.m21())<i&&Math.abs(this.m22()-t.m22())<i},copy:function(){return new e(this.m00(),this.m01(),this.m02(),this.m10(),this.m11(),this.m12(),this.m20(),this.m21(),this.m22(),this.type)},plus:function(t){return new e(this.m00()+t.m00(),this.m01()+t.m01(),this.m02()+t.m02(),this.m10()+t.m10(),this.m11()+t.m11(),this.m12()+t.m12(),this.m20()+t.m20(),this.m21()+t.m21(),this.m22()+t.m22())},minus:function(t){return new e(this.m00()-t.m00(),this.m01()-t.m01(),this.m02()-t.m02(),this.m10()-t.m10(),this.m11()-t.m11(),this.m12()-t.m12(),this.m20()-t.m20(),this.m21()-t.m21(),this.m22()-t.m22())},transposed:function(){return new e(this.m00(),this.m10(),this.m20(),this.m01(),this.m11(),this.m21(),this.m02(),this.m12(),this.m22(),this.type===s.IDENTITY||this.type===s.SCALING?this.type:void 0)},negated:function(){return new e(-this.m00(),-this.m01(),-this.m02(),-this.m10(),-this.m11(),-this.m12(),-this.m20(),-this.m21(),-this.m22())},inverted:function(){var t;switch(this.type){case s.IDENTITY:return this;case s.TRANSLATION_2D:return new e(1,0,-this.m02(),0,1,-this.m12(),0,0,1,s.TRANSLATION_2D);case s.SCALING:return new e(1/this.m00(),0,0,0,1/this.m11(),0,0,0,1/this.m22(),s.SCALING);case s.AFFINE:if(t=this.getDeterminant(),0!==t)return new e((-this.m12()*this.m21()+this.m11()*this.m22())/t,(this.m02()*this.m21()-this.m01()*this.m22())/t,(-this.m02()*this.m11()+this.m01()*this.m12())/t,(this.m12()*this.m20()-this.m10()*this.m22())/t,(-this.m02()*this.m20()+this.m00()*this.m22())/t,(this.m02()*this.m10()-this.m00()*this.m12())/t,0,0,1,s.AFFINE);throw new Error("Matrix could not be inverted, determinant === 0");case s.OTHER:if(t=this.getDeterminant(),0!==t)return new e((-this.m12()*this.m21()+this.m11()*this.m22())/t,(this.m02()*this.m21()-this.m01()*this.m22())/t,(-this.m02()*this.m11()+this.m01()*this.m12())/t,(this.m12()*this.m20()-this.m10()*this.m22())/t,(-this.m02()*this.m20()+this.m00()*this.m22())/t,(this.m02()*this.m10()-this.m00()*this.m12())/t,(-this.m11()*this.m20()+this.m10()*this.m21())/t,(this.m01()*this.m20()-this.m00()*this.m21())/t,(-this.m01()*this.m10()+this.m00()*this.m11())/t,s.OTHER);throw new Error("Matrix could not be inverted, determinant === 0");default:throw new Error("Matrix3.inverted with unknown type: "+this.type)}},timesMatrix:function(t){if(this.type===s.IDENTITY||t.type===s.IDENTITY)return this.type===s.IDENTITY?t:this;if(this.type===t.type){if(this.type===s.TRANSLATION_2D)return new e(1,0,this.m02()+t.m02(),0,1,this.m12()+t.m12(),0,0,1,s.TRANSLATION_2D);if(this.type===s.SCALING)return new e(this.m00()*t.m00(),0,0,0,this.m11()*t.m11(),0,0,0,1,s.SCALING)}return this.type!==s.OTHER&&t.type!==s.OTHER?new e(this.m00()*t.m00()+this.m01()*t.m10(),this.m00()*t.m01()+this.m01()*t.m11(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02(),this.m10()*t.m00()+this.m11()*t.m10(),this.m10()*t.m01()+this.m11()*t.m11(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12(),0,0,1,s.AFFINE):new e(this.m00()*t.m00()+this.m01()*t.m10()+this.m02()*t.m20(),this.m00()*t.m01()+this.m01()*t.m11()+this.m02()*t.m21(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02()*t.m22(),this.m10()*t.m00()+this.m11()*t.m10()+this.m12()*t.m20(),this.m10()*t.m01()+this.m11()*t.m11()+this.m12()*t.m21(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12()*t.m22(),this.m20()*t.m00()+this.m21()*t.m10()+this.m22()*t.m20(),this.m20()*t.m01()+this.m21()*t.m11()+this.m22()*t.m21(),this.m20()*t.m02()+this.m21()*t.m12()+this.m22()*t.m22())},timesVector2:function(t){var n=this.m00()*t.x+this.m01()*t.y+this.m02(),e=this.m10()*t.x+this.m11()*t.y+this.m12();return new i.Vector2(n,e)},timesVector3:function(t){var n=this.m00()*t.x+this.m01()*t.y+this.m02()*t.z,e=this.m10()*t.x+this.m11()*t.y+this.m12()*t.z,s=this.m20()*t.x+this.m21()*t.y+this.m22()*t.z;return new i.Vector3(n,e,s)},timesTransposeVector2:function(t){var n=this.m00()*t.x+this.m10()*t.y,e=this.m01()*t.x+this.m11()*t.y;return new i.Vector2(n,e)},timesRelativeVector2:function(t){var n=this.m00()*t.x+this.m01()*t.y,e=this.m10()*t.y+this.m11()*t.y;return new i.Vector2(n,e)},makeImmutable:function(){return this.rowMajor=function(){throw new Error("Cannot modify immutable matrix")},this},rowMajor:function(t,i,n,e,r,h,o,u,a,m){return this.entries[0]=t,this.entries[1]=e,this.entries[2]=o,this.entries[3]=i,this.entries[4]=r,this.entries[5]=u,this.entries[6]=n,this.entries[7]=h,this.entries[8]=a,this.type=void 0===m?0===o&&0===u&&1===a?s.AFFINE:s.OTHER:m,this},columnMajor:function(t,i,n,e,s,r,h,o,u,a){return this.rowMajor(t,e,h,i,s,o,n,r,u,a)},add:function(t){return this.rowMajor(this.m00()+t.m00(),this.m01()+t.m01(),this.m02()+t.m02(),this.m10()+t.m10(),this.m11()+t.m11(),this.m12()+t.m12(),this.m20()+t.m20(),this.m21()+t.m21(),this.m22()+t.m22())},subtract:function(t){return this.rowMajor(this.m00()-t.m00(),this.m01()-t.m01(),this.m02()-t.m02(),this.m10()-t.m10(),this.m11()-t.m11(),this.m12()-t.m12(),this.m20()-t.m20(),this.m21()-t.m21(),this.m22()-t.m22())},transpose:function(){return this.rowMajor(this.m00(),this.m10(),this.m20(),this.m01(),this.m11(),this.m21(),this.m02(),this.m12(),this.m22(),this.type===s.IDENTITY||this.type===s.SCALING?this.type:void 0)},negate:function(){return this.rowMajor(-this.m00(),-this.m01(),-this.m02(),-this.m10(),-this.m11(),-this.m12(),-this.m20(),-this.m21(),-this.m22())},invert:function(){var t;switch(this.type){case s.IDENTITY:return this;case s.TRANSLATION_2D:return this.rowMajor(1,0,-this.m02(),0,1,-this.m12(),0,0,1,s.TRANSLATION_2D);case s.SCALING:return this.rowMajor(1/this.m00(),0,0,0,1/this.m11(),0,0,0,1/this.m22(),s.SCALING);case s.AFFINE:if(t=this.getDeterminant(),0!==t)return this.rowMajor((-this.m12()*this.m21()+this.m11()*this.m22())/t,(this.m02()*this.m21()-this.m01()*this.m22())/t,(-this.m02()*this.m11()+this.m01()*this.m12())/t,(this.m12()*this.m20()-this.m10()*this.m22())/t,(-this.m02()*this.m20()+this.m00()*this.m22())/t,(this.m02()*this.m10()-this.m00()*this.m12())/t,0,0,1,s.AFFINE);throw new Error("Matrix could not be inverted, determinant === 0");case s.OTHER:if(t=this.getDeterminant(),0!==t)return this.rowMajor((-this.m12()*this.m21()+this.m11()*this.m22())/t,(this.m02()*this.m21()-this.m01()*this.m22())/t,(-this.m02()*this.m11()+this.m01()*this.m12())/t,(this.m12()*this.m20()-this.m10()*this.m22())/t,(-this.m02()*this.m20()+this.m00()*this.m22())/t,(this.m02()*this.m10()-this.m00()*this.m12())/t,(-this.m11()*this.m20()+this.m10()*this.m21())/t,(this.m01()*this.m20()-this.m00()*this.m21())/t,(-this.m01()*this.m10()+this.m00()*this.m11())/t,s.OTHER);throw new Error("Matrix could not be inverted, determinant === 0");default:throw new Error("Matrix3.inverted with unknown type: "+this.type)}},multiplyMatrix:function(t){if(this.type===s.IDENTITY||t.type===s.IDENTITY)return this.type===s.IDENTITY?t:this;if(this.type===t.type){if(this.type===s.TRANSLATION_2D)return this.rowMajor(1,0,this.m02()+t.m02(),0,1,this.m12()+t.m12(),0,0,1,s.TRANSLATION_2D);if(this.type===s.SCALING)return this.rowMajor(this.m00()*t.m00(),0,0,0,this.m11()*t.m11(),0,0,0,1,s.SCALING)}return this.type!==s.OTHER&&t.type!==s.OTHER?this.rowMajor(this.m00()*t.m00()+this.m01()*t.m10(),this.m00()*t.m01()+this.m01()*t.m11(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02(),this.m10()*t.m00()+this.m11()*t.m10(),this.m10()*t.m01()+this.m11()*t.m11(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12(),0,0,1,s.AFFINE):this.rowMajor(this.m00()*t.m00()+this.m01()*t.m10()+this.m02()*t.m20(),this.m00()*t.m01()+this.m01()*t.m11()+this.m02()*t.m21(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02()*t.m22(),this.m10()*t.m00()+this.m11()*t.m10()+this.m12()*t.m20(),this.m10()*t.m01()+this.m11()*t.m11()+this.m12()*t.m21(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12()*t.m22(),this.m20()*t.m00()+this.m21()*t.m10()+this.m22()*t.m20(),this.m20()*t.m01()+this.m21()*t.m11()+this.m22()*t.m21(),this.m20()*t.m02()+this.m21()*t.m12()+this.m22()*t.m22())},multiplyVector2:function(t){var i=this.m00()*t.x+this.m01()*t.y+this.m02(),n=this.m10()*t.x+this.m11()*t.y+this.m12();return t.setX(i),t.setY(n),t},multiplyVector3:function(t){var i=this.m00()*t.x+this.m01()*t.y+this.m02()*t.z,n=this.m10()*t.x+this.m11()*t.y+this.m12()*t.z,e=this.m20()*t.x+this.m21()*t.y+this.m22()*t.z;return t.setX(i),t.setY(n),t.setZ(e),t},multiplyTransposeVector2:function(t){var i=this.m00()*t.x+this.m10()*t.y,n=this.m01()*t.x+this.m11()*t.y;return t.setX(i),t.setY(n),t},multiplyRelativeVector2:function(t){var i=this.m00()*t.x+this.m01()*t.y,n=this.m10()*t.y+this.m11()*t.y;return t.setX(i),t.setY(n),t},canvasSetTransform:function(t){t.setTransform(this.entries[0],this.entries[1],this.entries[3],this.entries[4],this.entries[6],this.entries[7])},canvasAppendTransform:function(t){this.type!==s.IDENTITY&&t.transform(this.entries[0],this.entries[1],this.entries[3],this.entries[4],this.entries[6],this.entries[7])}},e.IDENTITY=new e(1,0,0,0,1,0,0,0,1,s.IDENTITY),e.IDENTITY.makeImmutable(),e.X_REFLECTION=new e(-1,0,0,0,1,0,0,0,1,s.AFFINE),e.X_REFLECTION.makeImmutable(),e.Y_REFLECTION=new e(1,0,0,0,-1,0,0,0,1,s.AFFINE),e.Y_REFLECTION.makeImmutable(),e.translationTimesMatrix=function(t,i,n){var r;return n.type===s.IDENTITY||n.type===s.TRANSLATION_2D?new e(1,0,n.m02()+t,0,1,n.m12()+i,0,0,1,s.TRANSLATION_2D):(r=n.type===s.OTHER?s.OTHER:s.AFFINE,new e(n.m00(),n.m01(),n.m02()+t,n.m10(),n.m11(),n.m12()+i,n.m20(),n.m21(),n.m22(),r))},e.printer={print:function(t){console.log(t.toString())}},e}),n("DOT/Transform3",["require","DOT/dot","DOT/Matrix3","DOT/Vector2","DOT/Ray2"],function(t){var i=t("DOT/dot");t("DOT/Matrix3"),t("DOT/Vector2"),t("DOT/Ray2"),i.Transform3=function(t){this.listeners=[],this.set(void 0===t?i.Matrix3.IDENTITY:t)};var n=i.Transform3;return n.prototype={constructor:n,set:function(t){var i,n=this.matrix,e=this.listeners.length;for(i=0;e>i;i++)this.listeners[i].before(t,n);for(this.matrix=t,this.inverse=null,this.matrixTransposed=null,this.inverseTransposed=null,i=0;e>i;i++)this.listeners[i].after(t,n)},prepend:function(t){this.set(t.timesMatrix(this.matrix))},prependTranslation:function(t,n){this.set(i.Matrix3.translationTimesMatrix(t,n,this.matrix))},append:function(t){this.set(this.matrix.timesMatrix(t))},prependTransform:function(t){this.prepend(t.matrix)},appendTransform:function(t){this.append(t.matrix)},applyToCanvasContext:function(t){t.setTransform(this.matrix.m00(),this.matrix.m10(),this.matrix.m01(),this.matrix.m11(),this.matrix.m02(),this.matrix.m12())},copy:function(){var t=new n(this.matrix);t.inverse=this.inverse,t.matrixTransposed=this.matrixTransposed,t.inverseTransposed=this.inverseTransposed},deepCopy:function(){var t=new n(this.matrix.copy());t.inverse=this.inverse?this.inverse.copy():null,t.matrixTransposed=this.matrixTransposed?this.matrixTransposed.copy():null,t.inverseTransposed=this.inverseTransposed?this.inverseTransposed.copy():null},getMatrix:function(){return this.matrix},getInverse:function(){return null===this.inverse&&(this.inverse=this.matrix.inverted()),this.inverse},getMatrixTransposed:function(){return null===this.matrixTransposed&&(this.matrixTransposed=this.matrix.transposed()),this.matrixTransposed},getInverseTransposed:function(){return null===this.inverseTransposed&&(this.inverseTransposed=this.getInverse().transposed()),this.inverseTransposed},isIdentity:function(){return this.matrix.type===i.Matrix3.Types.IDENTITY},isFinite:function(){return this.matrix.isFinite()},transformPosition2:function(t){return this.matrix.timesVector2(t)},transformDelta2:function(t){var n=this.getMatrix();return new i.Vector2(n.m00()*t.x+n.m01()*t.y,n.m10()*t.x+n.m11()*t.y)},transformNormal2:function(t){return this.getInverse().timesTransposeVector2(t)},transformX:function(t){var i=this.getMatrix();return i.m00()*t+i.m02()},transformY:function(t){var i=this.getMatrix();return i.m11()*t+i.m12()},transformDeltaX:function(t){var i=this.getMatrix();return i.m00()*t},transformDeltaY:function(t){var i=this.getMatrix();return i.m11()*t},transformBounds2:function(t){return t.transformed(this.matrix)},transformShape:function(t){return t.transformed(this.matrix)},transformRay2:function(t){return new i.Ray2(this.transformPosition2(t.pos),this.transformDelta2(t.dir).normalized())},inversePosition2:function(t){return this.getInverse().timesVector2(t)},inverseDelta2:function(t){var n=this.getInverse();return new i.Vector2(n.m00()*t.x+n.m01()*t.y,n.m10()*t.x+n.m11()*t.y)},inverseNormal2:function(t){return this.matrix.timesTransposeVector2(t)},inverseX:function(t){var i=this.getInverse();return i.m00()*t+i.m02()},inverseY:function(t){var i=this.getInverse();return i.m11()*t+i.m12()},inverseDeltaX:function(t){var i=this.getInverse();return i.m00()*t},inverseDeltaY:function(t){var i=this.getInverse();return i.m11()*t},inverseBounds2:function(t){return t.transformed(this.getInverse())},inverseShape:function(t){return t.transformed(this.getInverse())},inverseRay2:function(t){return new i.Ray2(this.inversePosition2(t.pos),this.inverseDelta2(t.dir).normalized())},addTransformListener:function(t){this.listeners.push(t)},prependTransformListener:function(t){this.listeners.unshift(t)},removeTransformListener:function(t){this.listeners.splice(_.indexOf(this.listeners,t),1)}},n}),n("KITE/segments/Segment",["require","KITE/kite","DOT/Util"],function(t){var i=t("KITE/kite"),n=t("DOT/Util");i.Segment=function(){};var e=i.Segment;return e.prototype={constructor:e,subdivisions:function(t,i){for(var e=this,s=[],r=0;r<t.length;r++){var h=t[r],o=e.subdivided(h,i);s.push(o[0]),e=o[1];for(var u=r+1;u<t.length;u++)t[u]=n.linear(h,1,0,1,t[u])}return s.push(e),s},subdividedIntoMonotone:function(){return this.subdivisions(this.getInteriorExtremaTs())}},e}),n("KITE/segments/Line",["require","KITE/kite","PHET_CORE/inherit","DOT/Bounds2","DOT/Util","KITE/segments/Segment"],function(t){t("KITE/kite");var i=t("PHET_CORE/inherit"),n=t("DOT/Bounds2"),e=t("DOT/Util").lineLineIntersection,s=t("KITE/segments/Segment");return s.Line=function(t,i){return this.start=t,this.end=i,t.equals(i,0)?(this.invalid=!0,void 0):(this.startTangent=i.minus(t).normalized(),this.endTangent=this.startTangent,this.bounds=n.NOTHING.withPoint(t).withPoint(i),void 0)},i(s,s.Line,{positionAt:function(t){return this.start.plus(this.end.minus(this.start).times(t))},tangentAt:function(){return this.startTangent},curvatureAt:function(){return 0},getSVGPathFragment:function(){return"L "+this.end.x+" "+this.end.y},strokeLeft:function(t){var i=this.endTangent.perpendicular().negated().times(t/2);return[new s.Line(this.start.plus(i),this.end.plus(i))]},strokeRight:function(t){var i=this.startTangent.perpendicular().times(t/2);return[new s.Line(this.end.plus(i),this.start.plus(i))]},getInteriorExtremaTs:function(){return[]},subdivided:function(t){var i=this.positionAt(t);return[new s.Line(this.start,i),new s.Line(i,this.end)]},intersectsBounds:function(){throw new Error("Segment.Line.intersectsBounds unimplemented")},intersection:function(t){var i=[],n=this.start,s=this.end,r=e(n,s,t.pos,t.pos.plus(t.dir));if(!isFinite(r.x)||!isFinite(r.y))return i;if(n.x!==s.x&&(n.x>s.x?r.x>=n.x||r.x<s.x:r.x<=n.x||r.x>s.x))return i;if(n.y!==s.y&&(n.y>s.y?r.y>=n.y||r.y<s.y:r.y<=n.y||r.y>s.y))return i;var h=r.minus(t.pos).dot(t.dir);if(0>h)return i;var o=s.minus(n),u=o.perpendicular();return i.push({distance:h,point:t.pointAtDistance(h),normal:u.dot(t.dir)>0?u.negated():u,wind:t.dir.perpendicular().dot(o)<0?1:-1}),i},windingIntersection:function(t){var i=this.intersection(t);return i.length?i[0].wind:0},writeToContext:function(t){t.lineTo(this.end.x,this.end.y)},transformed:function(t){return new s.Line(t.timesVector2(this.start),t.timesVector2(this.end))}}),s.Line}),n("KITE/segments/Arc",["require","KITE/kite","PHET_CORE/inherit","DOT/Vector2","DOT/Bounds2","DOT/Util","KITE/segments/Segment"],function(t){t("KITE/kite");var i=t("PHET_CORE/inherit"),n=t("DOT/Vector2"),e=t("DOT/Bounds2"),s=t("DOT/Util"),r=t("KITE/segments/Segment");return r.Arc=function(t,i,s,r,h){function o(e){u.containsAngle(e)&&(u.bounds=u.bounds.withPoint(t.plus(n.createPolar(i,e))))}if(0>i&&(i=-i,s+=Math.PI,r+=Math.PI),this.center=t,this.radius=i,this.startAngle=s,this.endAngle=r,this.anticlockwise=h,this.start=this.positionAtAngle(s),this.end=this.positionAtAngle(r),this.startTangent=this.tangentAtAngle(s),this.endTangent=this.tangentAtAngle(r),0>=i||s===r)return this.invalid=!0,void 0;this.actualEndAngle=this.anticlockwise?this.startAngle>this.endAngle?this.endAngle:this.startAngle<this.endAngle?this.endAngle-2*Math.PI:this.startAngle:this.startAngle<this.endAngle?this.endAngle:this.startAngle>this.endAngle?this.endAngle+2*Math.PI:this.startAngle,!h&&r-s>=2*Math.PI||h&&s-r>=2*Math.PI,this.angleDifference=this.anticlockwise?this.startAngle-this.endAngle:this.endAngle-this.startAngle,this.angleDifference<0&&(this.angleDifference+=2*Math.PI),this.bounds=e.NOTHING,this.bounds=this.bounds.withPoint(this.start),this.bounds=this.bounds.withPoint(this.end);var u=this;s!==r&&(o(0),o(Math.PI/2),o(Math.PI),o(3*Math.PI/2))},i(r,r.Arc,{mapAngle:function(t){return this.startAngle>this.actualEndAngle?s.moduloBetweenUp(t,this.startAngle-2*Math.PI,this.startAngle):s.moduloBetweenDown(t,this.startAngle,this.startAngle+2*Math.PI)},tAtAngle:function(t){return(this.mapAngle(t)-this.startAngle)/(this.actualEndAngle-this.startAngle)},angleAt:function(t){return this.startAngle+(this.actualEndAngle-this.startAngle)*t},positionAt:function(t){return this.positionAtAngle(this.angleAt(t))},tangentAt:function(t){return this.tangentAtAngle(this.angleAt(t))},curvatureAt:function(){return(this.anticlockwise?-1:1)/this.radius},positionAtAngle:function(t){return this.center.plus(n.createPolar(this.radius,t))},tangentAtAngle:function(t){var i=n.createPolar(1,t);return this.anticlockwise?i.perpendicular():i.perpendicular().negated()},containsAngle:function(t){var i=this.anticlockwise?t-this.endAngle:t-this.startAngle,n=s.moduloBetweenDown(i,0,2*Math.PI);return n<=this.angleDifference},getSVGPathFragment:function(){var t,i=.01,e=this.anticlockwise?"0":"1";if(this.angleDifference<2*Math.PI-i)return t=this.angleDifference<Math.PI?"0":"1","A "+this.radius+" "+this.radius+" 0 "+t+" "+e+" "+this.end.x+" "+this.end.y;var s=(this.startAngle+this.endAngle)/2,r=this.center.plus(n.createPolar(this.radius,s));t="0";var h="A "+this.radius+" "+this.radius+" 0 "+t+" "+e+" "+r.x+" "+r.y,o="A "+this.radius+" "+this.radius+" 0 "+t+" "+e+" "+this.end.x+" "+this.end.y;return h+" "+o},strokeLeft:function(t){return[new r.Arc(this.center,this.radius+(this.anticlockwise?1:-1)*t/2,this.startAngle,this.endAngle,this.anticlockwise)]},strokeRight:function(t){return[new r.Arc(this.center,this.radius+(this.anticlockwise?-1:1)*t/2,this.endAngle,this.startAngle,!this.anticlockwise)]},getInteriorExtremaTs:function(){var t=this,i=[];return _.each([0,Math.PI/2,Math.PI,3*Math.PI/2],function(n){if(t.containsAngle(n)){var e=t.tAtAngle(n),s=1e-10;e>s&&1-s>e&&i.push(e)}}),i.sort()},subdivided:function(t){var i=this.angleAt(0),n=this.angleAt(t),e=this.angleAt(1);return[new r.Arc(this.center,this.radius,i,n,this.anticlockwise),new r.Arc(this.center,this.radius,n,e,this.anticlockwise)]},intersectsBounds:function(){throw new Error("Segment.intersectsBounds unimplemented!")},intersection:function(t){var i=[],n=0,e=t.pos.minus(this.center),s=t.dir.dot(e),r=e.magnitudeSquared(),h=4*s*s-4*(r-this.radius*this.radius);if(n>h)return i;var o=t.dir.dot(this.center)-t.dir.dot(t.pos),u=Math.sqrt(h)/2,a=o-u,m=o+u;if(n>m)return i;var l=t.pointAtDistance(m),c=l.minus(this.center).normalized();if(n>a)this.containsAngle(c.angle())&&i.push({distance:m,point:l,normal:c.negated(),wind:this.anticlockwise?-1:1});else{var f=t.pointAtDistance(a),d=f.minus(this.center).normalized();this.containsAngle(d.angle())&&i.push({distance:a,point:f,normal:d,wind:this.anticlockwise?1:-1}),this.containsAngle(c.angle())&&i.push({distance:m,point:l,normal:c.negated(),wind:this.anticlockwise?-1:1})}return i},windingIntersection:function(t){var i=0,n=this.intersection(t);return _.each(n,function(t){i+=t.wind}),i},writeToContext:function(t){t.arc(this.center.x,this.center.y,this.radius,this.startAngle,this.endAngle,this.anticlockwise)},transformed:function(t){var i=t.timesVector2(n.createPolar(1,this.startAngle)).minus(t.timesVector2(n.ZERO)).angle(),e=t.timesVector2(n.createPolar(1,this.endAngle)).minus(t.timesVector2(n.ZERO)).angle(),s=t.getDeterminant()>=0?this.anticlockwise:!this.anticlockwise,h=t.getScaleVector();if(h.x!==h.y){var o=h.x*this.radius,u=h.y*this.radius;return new r.EllipticalArc(t.timesVector2(this.center),o,u,0,i,e,s)}var a=h.x*this.radius;return new r.Arc(t.timesVector2(this.center),a,i,e,s)}}),r.Arc}),n("KITE/util/Subpath",["require","DOT/Vector2","DOT/Bounds2","DOT/Util","KITE/kite","KITE/segments/Line","KITE/segments/Arc"],function(t){t("DOT/Vector2");var i=t("DOT/Bounds2"),n=t("DOT/Util").lineLineIntersection,e=t("KITE/kite");t("KITE/segments/Line"),t("KITE/segments/Arc"),e.Subpath=function(t,i,n){this.segments=t||[],this.points=i||(t&&t.length?_.map(t,function(t){return t.start}).concat(t[t.length-1].end):[]),this.closed=!!n,this._strokedSubpaths=null,this._strokedSubpathsComputed=!1,this._strokedStyles=null};var s=e.Subpath;return s.prototype={copy:function(){return new s(this.segments.slice(0),this.points.slice(0),this.closed)},invalidate:function(){this._strokedSubpathsComputed=!1},addPoint:function(t){return this.points.push(t),this},addSegment:function(t){return t.invalid||(this.segments.push(t),this.invalidate()),this},close:function(){this.closed=!0},getLength:function(){return this.points.length},getFirstPoint:function(){return _.first(this.points)},getLastPoint:function(){return _.last(this.points)},getFirstSegment:function(){return _.first(this.segments)},getLastSegment:function(){return _.last(this.segments)},isDrawable:function(){return this.segments.length>0},isClosed:function(){return this.closed},hasClosingSegment:function(){return!this.getFirstPoint().equalsEpsilon(this.getLastPoint(),1e-9)},getClosingSegment:function(){return new e.Segment.Line(this.getLastPoint(),this.getFirstPoint())},writeToContext:function(t){if(this.isDrawable()){var i=this.getFirstSegment().start;t.moveTo(i.x,i.y);for(var n=this.segments.length,e=0;n>e;e++)this.segments[e].writeToContext(t);this.closed&&t.closePath()}},transformed:function(t){return new s(_.map(this.segments,function(i){return i.transformed(t)}),_.map(this.points,function(i){return t.timesVector2(i)}),this.closed)},computeBounds:function(){for(var t=i.NOTHING.copy(),n=this.segments.length,e=0;n>e;e++)t.includeBounds(this.segments[e].bounds);return t},stroked:function(t){function i(i,s,r){var h=i.plus(s.perpendicular().negated().times(a/2)),o=i.plus(r.perpendicular().negated().times(a/2)),u=h.equals(o)?[]:[new e.Segment.Line(h,o)];if(!(s.perpendicular().dot(r)>0))return u;switch(t.lineJoin){case"round":var m=s.angle()+Math.PI/2,l=r.angle()+Math.PI/2;return[new e.Segment.Arc(i,a/2,m,l,!0)];case"miter":var c=s.angleBetween(r.negated());if(c<Math.PI-1e-5,1/Math.sin(c/2)<=t.miterLimit&&c<Math.PI-1e-5){var f=n(h,h.plus(s),o,o.plus(r));return[new e.Segment.Line(h,f),new e.Segment.Line(f,o)]}return u;case"bevel":return u}}function r(i,n){var s=i.plus(n.perpendicular().times(-a/2)),r=i.plus(n.perpendicular().times(a/2));switch(t.lineCap){case"butt":return[new e.Segment.Line(s,r)];case"round":var h=n.angle();return[new e.Segment.Arc(i,a/2,h+Math.PI/2,h-Math.PI/2,!0)];
case"square":var o=n.perpendicular().negated().times(a/2),u=n.perpendicular().times(a/2),m=n.times(a/2),l=i.plus(o).plus(m),c=i.plus(u).plus(m);return[new e.Segment.Line(s,l),new e.Segment.Line(l,c),new e.Segment.Line(c,r)]}}function h(t){m=m.concat(t)}function o(t){l=l.concat(t)}if(!this.isDrawable())return[];if(void 0===t&&(t=new e.LineStyles),this._strokedSubpathsComputed&&this._strokedStyles.equals(t))return this._strokedSubpaths;var u,a=t.lineWidth,m=[],l=[],c=this.getFirstSegment(),f=this.getLastSegment(),d=f.end.equals(c.start),p=d?null:new e.Segment.Line(this.segments[this.segments.length-1].end,this.segments[0].start);for(u=0;u<this.segments.length;u++)u>0&&h(i(this.segments[u].start,this.segments[u-1].endTangent,this.segments[u].startTangent,!0)),h(this.segments[u].strokeLeft(a));for(u=this.segments.length-1;u>=0;u--)u<this.segments.length-1&&o(i(this.segments[u].end,this.segments[u+1].startTangent.negated(),this.segments[u].endTangent.negated(),!1)),o(this.segments[u].strokeRight(a));var g;return this.closed?(d?(h(i(f.end,f.endTangent,c.startTangent)),o(i(f.end,c.startTangent.negated(),f.endTangent.negated()))):(h(i(p.start,f.endTangent,p.startTangent)),h(p.strokeLeft(a)),h(i(p.end,p.endTangent,c.startTangent)),o(i(p.end,c.startTangent.negated(),p.endTangent.negated())),o(p.strokeRight(a)),o(i(p.start,p.startTangent.negated(),f.endTangent.negated()))),g=[new s(m,null,!0),new s(l,null,!0)]):g=[new s(m.concat(r(f.end,f.endTangent)).concat(l).concat(r(c.start,c.startTangent.negated())),null,!0)],this._strokedSubpaths=g,this._strokedSubpathsComputed=!0,this._strokedStyles=new e.LineStyles(t),g}},e.Subpath}),n("KITE/../parser/svgPath",["require","KITE/kite"],function(t){function i(t){return'"'+t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E-\x1F\x80-\uFFFF]/g,escape)+'"'}var n=t("KITE/kite");n.svgPath={parse:function(t,n){function e(t){W>G||(G>W&&(W=G,J=[]),J.push(t))}function s(){var t,i,n,e,s,h;for(s=G,h=G,t=[],i=U();null!==i;)t.push(i),i=U();if(null!==t)if(i=r(),i=null!==i?i:"",null!==i){for(n=[],e=U();null!==e;)n.push(e),e=U();null!==n?t=[t,i,n]:(t=null,G=h)}else t=null,G=h;else t=null,G=h;return null!==t&&(t=function(t,i){return i?i:[]}(s,t[1])),null===t&&(G=s),t}function r(){var t,i,n,e,s;if(e=G,s=G,t=h(),null!==t){for(i=[],n=U();null!==n;)i.push(n),n=U();null!==i?(n=r(),null!==n?t=[t,i,n]:(t=null,G=s)):(t=null,G=s)}else t=null,G=s;return null!==t&&(t=function(t,i,n){return i.concat(n)}(e,t[0],t[2])),null===t&&(G=e),null===t&&(e=G,t=h(),null!==t&&(t=function(t,i){return i}(e,t)),null===t&&(G=e)),t}function h(){var t,i,n,e,s;if(e=G,s=G,t=a(),null!==t){for(i=[],n=U();null!==n;)i.push(n),n=U();null!==i?(n=o(),n=null!==n?n:"",null!==n?t=[t,i,n]:(t=null,G=s)):(t=null,G=s)}else t=null,G=s;return null!==t&&(t=function(t,i,n){return n.length?i.concat(n):i}(e,t[0],t[2])),null===t&&(G=e),t}function o(){var t,i,n,e,s;if(e=G,s=G,t=u(),null!==t){for(i=[],n=U();null!==n;)i.push(n),n=U();null!==i?(n=o(),null!==n?t=[t,i,n]:(t=null,G=s)):(t=null,G=s)}else t=null,G=s;return null!==t&&(t=function(t,i,n){return i.concat(n)}(e,t[0],t[2])),null===t&&(G=e),null===t&&(e=G,t=u(),null!==t&&(t=function(t,i){return i}(e,t)),null===t&&(G=e)),t}function u(){var t;return t=l(),null===t&&(t=c(),null===t&&(t=d(),null===t&&(t=g(),null===t&&(t=x(),null===t&&(t=y(),null===t&&(t=M(),null===t&&(t=O(),null===t&&(t=S())))))))),t}function a(){var i,n,s,r,h;if(r=G,h=G,77===t.charCodeAt(G)?(i="M",G++):(i=null,0===Z&&e('"M"')),null!==i){for(n=[],s=U();null!==s;)n.push(s),s=U();null!==n?(s=m(),null!==s?i=[i,n,s]:(i=null,G=h)):(i=null,G=h)}else i=null,G=h;if(null!==i&&(i=function(t,i){return Q(i,!1)}(r,i[2])),null===i&&(G=r),null===i){if(r=G,h=G,109===t.charCodeAt(G)?(i="m",G++):(i=null,0===Z&&e('"m"')),null!==i){for(n=[],s=U();null!==s;)n.push(s),s=U();null!==n?(s=m(),null!==s?i=[i,n,s]:(i=null,G=h)):(i=null,G=h)}else i=null,G=h;null!==i&&(i=function(t,i){return Q(i,!0)}(r,i[2])),null===i&&(G=r)}return i}function m(){var t,i,n,e,s;return e=G,s=G,t=R(),null!==t?(i=L(),i=null!==i?i:"",null!==i?(n=f(),null!==n?t=[t,i,n]:(t=null,G=s)):(t=null,G=s)):(t=null,G=s),null!==t&&(t=function(t,i,n){return[i].concat(n)}(e,t[0],t[2])),null===t&&(G=e),null===t&&(e=G,t=R(),null!==t&&(t=function(t,i){return[i]}(e,t)),null===t&&(G=e)),t}function l(){var i,n;return n=G,90===t.charCodeAt(G)?(i="Z",G++):(i=null,0===Z&&e('"Z"')),null===i&&(122===t.charCodeAt(G)?(i="z",G++):(i=null,0===Z&&e('"z"'))),null!==i&&(i=function(){return{cmd:"close"}}(n,i)),null===i&&(G=n),i}function c(){var i,n,s,r,h;if(r=G,h=G,76===t.charCodeAt(G)?(i="L",G++):(i=null,0===Z&&e('"L"')),null!==i){for(n=[],s=U();null!==s;)n.push(s),s=U();null!==n?(s=f(),null!==s?i=[i,n,s]:(i=null,G=h)):(i=null,G=h)}else i=null,G=h;if(null!==i&&(i=function(t,i){return i.map(function(t){return{cmd:"lineTo",args:[t.x,t.y]}})}(r,i[2])),null===i&&(G=r),null===i){if(r=G,h=G,108===t.charCodeAt(G)?(i="l",G++):(i=null,0===Z&&e('"l"')),null!==i){for(n=[],s=U();null!==s;)n.push(s),s=U();null!==n?(s=f(),null!==s?i=[i,n,s]:(i=null,G=h)):(i=null,G=h)}else i=null,G=h;null!==i&&(i=function(t,i){return i.map(function(t){return{cmd:"lineToRelative",args:[t.x,t.y]}})}(r,i[2])),null===i&&(G=r)}return i}function f(){var t,i,n,e,s;return e=G,s=G,t=R(),null!==t?(i=L(),i=null!==i?i:"",null!==i?(n=f(),null!==n?t=[t,i,n]:(t=null,G=s)):(t=null,G=s)):(t=null,G=s),null!==t&&(t=function(t,i,n){return[i].concat(n)}(e,t[0],t[2])),null===t&&(G=e),null===t&&(e=G,t=R(),null!==t&&(t=function(t,i){return[i]}(e,t)),null===t&&(G=e)),t}function d(){var i,n,s,r,h;if(r=G,h=G,72===t.charCodeAt(G)?(i="H",G++):(i=null,0===Z&&e('"H"')),null!==i){for(n=[],s=U();null!==s;)n.push(s),s=U();null!==n?(s=p(),null!==s?i=[i,n,s]:(i=null,G=h)):(i=null,G=h)}else i=null,G=h;if(null!==i&&(i=function(t,i){return i.map(function(t){return{cmd:"horizontalLineTo",args:[t]}})}(r,i[2])),null===i&&(G=r),null===i){if(r=G,h=G,104===t.charCodeAt(G)?(i="h",G++):(i=null,0===Z&&e('"h"')),null!==i){for(n=[],s=U();null!==s;)n.push(s),s=U();null!==n?(s=p(),null!==s?i=[i,n,s]:(i=null,G=h)):(i=null,G=h)}else i=null,G=h;null!==i&&(i=function(t,i){return i.map(function(t){return{cmd:"horizontalLineToRelative",args:[t]}})}(r,i[2])),null===i&&(G=r)}return i}function p(){var t,i,n,e,s;return e=G,s=G,t=z(),null!==t?(i=L(),i=null!==i?i:"",null!==i?(n=p(),null!==n?t=[t,i,n]:(t=null,G=s)):(t=null,G=s)):(t=null,G=s),null!==t&&(t=function(t,i,n){return[i].concat(n)}(e,t[0],t[2])),null===t&&(G=e),null===t&&(e=G,t=z(),null!==t&&(t=function(t,i){return[i]}(e,t)),null===t&&(G=e)),t}function g(){var i,n,s,r,h;if(r=G,h=G,86===t.charCodeAt(G)?(i="V",G++):(i=null,0===Z&&e('"V"')),null!==i){for(n=[],s=U();null!==s;)n.push(s),s=U();null!==n?(s=v(),null!==s?i=[i,n,s]:(i=null,G=h)):(i=null,G=h)}else i=null,G=h;if(null!==i&&(i=function(t,i){return i.map(function(t){return{cmd:"verticalLineTo",args:[t]}})}(r,i[2])),null===i&&(G=r),null===i){if(r=G,h=G,118===t.charCodeAt(G)?(i="v",G++):(i=null,0===Z&&e('"v"')),null!==i){for(n=[],s=U();null!==s;)n.push(s),s=U();null!==n?(s=v(),null!==s?i=[i,n,s]:(i=null,G=h)):(i=null,G=h)}else i=null,G=h;null!==i&&(i=function(t,i){return i.map(function(t){return{cmd:"verticalLineToRelative",args:[t]}})}(r,i[2])),null===i&&(G=r)}return i}function v(){var t,i,n,e,s;return e=G,s=G,t=z(),null!==t?(i=L(),i=null!==i?i:"",null!==i?(n=v(),null!==n?t=[t,i,n]:(t=null,G=s)):(t=null,G=s)):(t=null,G=s),null!==t&&(t=function(t,i,n){return[i].concat(n)}(e,t[0],t[2])),null===t&&(G=e),null===t&&(e=G,t=z(),null!==t&&(t=function(t,i){return[i]}(e,t)),null===t&&(G=e)),t}function x(){var i,n,s,r,h;if(r=G,h=G,67===t.charCodeAt(G)?(i="C",G++):(i=null,0===Z&&e('"C"')),null!==i){for(n=[],s=U();null!==s;)n.push(s),s=U();null!==n?(s=T(),null!==s?i=[i,n,s]:(i=null,G=h)):(i=null,G=h)}else i=null,G=h;if(null!==i&&(i=function(t,i){return i.map(function(t){return{cmd:"cubicCurveTo",args:t}})}(r,i[2])),null===i&&(G=r),null===i){if(r=G,h=G,99===t.charCodeAt(G)?(i="c",G++):(i=null,0===Z&&e('"c"')),null!==i){for(n=[],s=U();null!==s;)n.push(s),s=U();null!==n?(s=T(),null!==s?i=[i,n,s]:(i=null,G=h)):(i=null,G=h)}else i=null,G=h;null!==i&&(i=function(t,i){return i.map(function(t){return{cmd:"cubicCurveToRelative",args:t}})}(r,i[2])),null===i&&(G=r)}return i}function T(){var t,i,n,e,s;return e=G,s=G,t=w(),null!==t?(i=L(),i=null!==i?i:"",null!==i?(n=T(),null!==n?t=[t,i,n]:(t=null,G=s)):(t=null,G=s)):(t=null,G=s),null!==t&&(t=function(t,i,n){return[i].concat(n)}(e,t[0],t[2])),null===t&&(G=e),null===t&&(e=G,t=w(),null!==t&&(t=function(t,i){return[i]}(e,t)),null===t&&(G=e)),t}function w(){var t,i,n,e,s,r,h;return r=G,h=G,t=R(),null!==t?(i=L(),i=null!==i?i:"",null!==i?(n=R(),null!==n?(e=L(),e=null!==e?e:"",null!==e?(s=R(),null!==s?t=[t,i,n,e,s]:(t=null,G=h)):(t=null,G=h)):(t=null,G=h)):(t=null,G=h)):(t=null,G=h),null!==t&&(t=function(t,i,n,e){return[i.x,i.y,n.x,n.y,e.x,e.y]}(r,t[0],t[2],t[4])),null===t&&(G=r),t}function y(){var i,n,s,r,h;if(r=G,h=G,83===t.charCodeAt(G)?(i="S",G++):(i=null,0===Z&&e('"S"')),null!==i){for(n=[],s=U();null!==s;)n.push(s),s=U();null!==n?(s=A(),null!==s?i=[i,n,s]:(i=null,G=h)):(i=null,G=h)}else i=null,G=h;if(null!==i&&(i=function(t,i){return i.map(function(t){return{cmd:"smoothCubicCurveTo",args:t}})}(r,i[2])),null===i&&(G=r),null===i){if(r=G,h=G,115===t.charCodeAt(G)?(i="s",G++):(i=null,0===Z&&e('"s"')),null!==i){for(n=[],s=U();null!==s;)n.push(s),s=U();null!==n?(s=A(),null!==s?i=[i,n,s]:(i=null,G=h)):(i=null,G=h)}else i=null,G=h;null!==i&&(i=function(t,i){return i.map(function(t){return{cmd:"smoothCubicCurveToRelative",args:t}})}(r,i[2])),null===i&&(G=r)}return i}function A(){var t,i,n,e,s;return e=G,s=G,t=b(),null!==t?(i=L(),i=null!==i?i:"",null!==i?(n=A(),null!==n?t=[t,i,n]:(t=null,G=s)):(t=null,G=s)):(t=null,G=s),null!==t&&(t=function(t,i,n){return[i].concat(n)}(e,t[0],t[2])),null===t&&(G=e),null===t&&(e=G,t=b(),null!==t&&(t=function(t,i){return[i]}(e,t)),null===t&&(G=e)),t}function b(){var t,i,n,e,s;return e=G,s=G,t=R(),null!==t?(i=L(),i=null!==i?i:"",null!==i?(n=R(),null!==n?t=[t,i,n]:(t=null,G=s)):(t=null,G=s)):(t=null,G=s),null!==t&&(t=function(t,i,n){return[i.x,i.y,n.x,n.y]}(e,t[0],t[2])),null===t&&(G=e),t}function M(){var i,n,s,r,h;if(r=G,h=G,81===t.charCodeAt(G)?(i="Q",G++):(i=null,0===Z&&e('"Q"')),null!==i){for(n=[],s=U();null!==s;)n.push(s),s=U();null!==n?(s=E(),null!==s?i=[i,n,s]:(i=null,G=h)):(i=null,G=h)}else i=null,G=h;if(null!==i&&(i=function(t,i){return i.map(function(t){return{cmd:"quadraticCurveTo",args:t}})}(r,i[2])),null===i&&(G=r),null===i){if(r=G,h=G,113===t.charCodeAt(G)?(i="q",G++):(i=null,0===Z&&e('"q"')),null!==i){for(n=[],s=U();null!==s;)n.push(s),s=U();null!==n?(s=E(),null!==s?i=[i,n,s]:(i=null,G=h)):(i=null,G=h)}else i=null,G=h;null!==i&&(i=function(t,i){return i.map(function(t){return{cmd:"quadraticCurveToRelative",args:t}})}(r,i[2])),null===i&&(G=r)}return i}function E(){var t,i,n,e,s;return e=G,s=G,t=D(),null!==t?(i=L(),i=null!==i?i:"",null!==i?(n=E(),null!==n?t=[t,i,n]:(t=null,G=s)):(t=null,G=s)):(t=null,G=s),null!==t&&(t=function(t,i,n){return[i].concat(n)}(e,t[0],t[2])),null===t&&(G=e),null===t&&(e=G,t=D(),null!==t&&(t=function(t,i){return[i]}(e,t)),null===t&&(G=e)),t}function D(){var t,i,n,e,s;return e=G,s=G,t=R(),null!==t?(i=L(),i=null!==i?i:"",null!==i?(n=R(),null!==n?t=[t,i,n]:(t=null,G=s)):(t=null,G=s)):(t=null,G=s),null!==t&&(t=function(t,i,n){return[i.x,i.y,n.x,n.y]}(e,t[0],t[2])),null===t&&(G=e),t}function O(){var i,n,s,r,h;if(r=G,h=G,84===t.charCodeAt(G)?(i="T",G++):(i=null,0===Z&&e('"T"')),null!==i){for(n=[],s=U();null!==s;)n.push(s),s=U();null!==n?(s=I(),null!==s?i=[i,n,s]:(i=null,G=h)):(i=null,G=h)}else i=null,G=h;if(null!==i&&(i=function(t,i){return i.map(function(t){return{cmd:"smoothQuadraticCurveTo",args:[t.x,t.y]}})}(r,i[2])),null===i&&(G=r),null===i){if(r=G,h=G,116===t.charCodeAt(G)?(i="t",G++):(i=null,0===Z&&e('"t"')),null!==i){for(n=[],s=U();null!==s;)n.push(s),s=U();null!==n?(s=I(),null!==s?i=[i,n,s]:(i=null,G=h)):(i=null,G=h)}else i=null,G=h;null!==i&&(i=function(t,i){return i.map(function(t){return{cmd:"smoothQuadraticCurveToRelative",args:[t.x,t.y]}})}(r,i[2])),null===i&&(G=r)}return i}function I(){var t,i,n,e,s;return e=G,s=G,t=R(),null!==t?(i=L(),i=null!==i?i:"",null!==i?(n=I(),null!==n?t=[t,i,n]:(t=null,G=s)):(t=null,G=s)):(t=null,G=s),null!==t&&(t=function(t,i,n){return[i].concat(n)}(e,t[0],t[2])),null===t&&(G=e),null===t&&(e=G,t=R(),null!==t&&(t=function(t,i){return[i]}(e,t)),null===t&&(G=e)),t}function S(){var i,n,s,r,h;if(r=G,h=G,65===t.charCodeAt(G)?(i="A",G++):(i=null,0===Z&&e('"A"')),null!==i){for(n=[],s=U();null!==s;)n.push(s),s=U();null!==n?(s=P(),null!==s?i=[i,n,s]:(i=null,G=h)):(i=null,G=h)}else i=null,G=h;if(null!==i&&(i=function(t,i){return i.map(function(t){return{cmd:"ellipticalArcTo",args:t}})}(r,i[2])),null===i&&(G=r),null===i){if(r=G,h=G,97===t.charCodeAt(G)?(i="a",G++):(i=null,0===Z&&e('"a"')),null!==i){for(n=[],s=U();null!==s;)n.push(s),s=U();null!==n?(s=P(),null!==s?i=[i,n,s]:(i=null,G=h)):(i=null,G=h)}else i=null,G=h;null!==i&&(i=function(t,i){return i.map(function(t){return{cmd:"ellipticalArcToRelative",args:t}})}(r,i[2])),null===i&&(G=r)}return i}function P(){var t,i,n,e,s;return e=G,s=G,t=C(),null!==t?(i=L(),i=null!==i?i:"",null!==i?(n=P(),null!==n?t=[t,i,n]:(t=null,G=s)):(t=null,G=s)):(t=null,G=s),null!==t&&(t=function(t,i,n){return[i].concat(n)}(e,t[0],t[2])),null===t&&(G=e),null===t&&(e=G,t=C(),null!==t&&(t=function(t,i){return[i]}(e,t)),null===t&&(G=e)),t}function C(){var t,i,n,e,s,r,h,o,u,a,m,l,c;return l=G,c=G,t=V(),null!==t?(i=L(),i=null!==i?i:"",null!==i?(n=V(),null!==n?(e=L(),e=null!==e?e:"",null!==e?(s=z(),null!==s?(r=L(),null!==r?(h=Y(),null!==h?(o=L(),o=null!==o?o:"",null!==o?(u=Y(),null!==u?(a=L(),a=null!==a?a:"",null!==a?(m=R(),null!==m?t=[t,i,n,e,s,r,h,o,u,a,m]:(t=null,G=c)):(t=null,G=c)):(t=null,G=c)):(t=null,G=c)):(t=null,G=c)):(t=null,G=c)):(t=null,G=c)):(t=null,G=c)):(t=null,G=c)):(t=null,G=c)):(t=null,G=c),null!==t&&(t=function(t,i,n,e,s,r,h){return[i,n,e,s,r,h.x,h.y]}(l,t[0],t[2],t[4],t[6],t[8],t[10])),null===t&&(G=l),t}function R(){var t,i,n,e,s;return e=G,s=G,t=z(),null!==t?(i=L(),i=null!==i?i:"",null!==i?(n=z(),null!==n?t=[t,i,n]:(t=null,G=s)):(t=null,G=s)):(t=null,G=s),null!==t&&(t=function(t,i,n){return{x:i,y:n}}(e,t[0],t[2])),null===t&&(G=e),t}function V(){var t,i;return i=G,t=X(),null!==t&&(t=function(t,i){return parseFloat(i,10)}(i,t)),null===t&&(G=i),null===t&&(i=G,t=k(),null!==t&&(t=function(t,i){return parseInt(i,10)}(i,t)),null===t&&(G=i)),t}function z(){var t,i,n,e;return n=G,e=G,t=H(),t=null!==t?t:"",null!==t?(i=X(),null!==i?t=[t,i]:(t=null,G=e)):(t=null,G=e),null!==t&&(t=function(t,i,n){return parseFloat(i+n,10)}(n,t[0],t[1])),null===t&&(G=n),null===t&&(n=G,e=G,t=H(),t=null!==t?t:"",null!==t?(i=k(),null!==i?t=[t,i]:(t=null,G=e)):(t=null,G=e),null!==t&&(t=function(t,i,n){return parseInt(i+n,10)}(n,t[0],t[1])),null===t&&(G=n)),t}function Y(){var i,n;return n=G,48===t.charCodeAt(G)?(i="0",G++):(i=null,0===Z&&e('"0"')),null!==i&&(i=function(){return!1}(n)),null===i&&(G=n),null===i&&(n=G,49===t.charCodeAt(G)?(i="1",G++):(i=null,0===Z&&e('"1"')),null!==i&&(i=function(){return!0}(n)),null===i&&(G=n)),i}function L(){var t,i,n,e,s;if(s=G,i=U(),null!==i)for(t=[];null!==i;)t.push(i),i=U();else t=null;if(null!==t)if(i=N(),i=null!==i?i:"",null!==i){for(n=[],e=U();null!==e;)n.push(e),e=U();null!==n?t=[t,i,n]:(t=null,G=s)}else t=null,G=s;else t=null,G=s;if(null===t)if(s=G,t=N(),null!==t){for(i=[],n=U();null!==n;)i.push(n),n=U();null!==i?t=[t,i]:(t=null,G=s)}else t=null,G=s;return t}function N(){var i;return 44===t.charCodeAt(G)?(i=",",G++):(i=null,0===Z&&e('","')),i}function X(){var t,i,n,e;return n=G,e=G,t=_(),null!==t?(i=q(),i=null!==i?i:"",null!==i?t=[t,i]:(t=null,G=e)):(t=null,G=e),null!==t&&(t=function(t,i,n){return i+n}(n,t[0],t[1])),null===t&&(G=n),null===t&&(n=G,e=G,t=k(),null!==t?(i=q(),null!==i?t=[t,i]:(t=null,G=e)):(t=null,G=e),null!==t&&(t=function(t,i,n){return i+n}(n,t[0],t[1])),null===t&&(G=n)),t}function _(){var i,n,s,r,h;return r=G,h=G,i=k(),i=null!==i?i:"",null!==i?(46===t.charCodeAt(G)?(n=".",G++):(n=null,0===Z&&e('"."')),null!==n?(s=k(),null!==s?i=[i,n,s]:(i=null,G=h)):(i=null,G=h)):(i=null,G=h),null!==i&&(i=function(t,i,n){return i+"."+n}(r,i[0],i[2])),null===i&&(G=r),null===i&&(r=G,h=G,i=k(),null!==i?(46===t.charCodeAt(G)?(n=".",G++):(n=null,0===Z&&e('"."')),null!==n?i=[i,n]:(i=null,G=h)):(i=null,G=h),null!==i&&(i=function(t,i){return i}(r,i[0])),null===i&&(G=r)),i}function q(){var i,n,s,r,h;return r=G,h=G,101===t.charCodeAt(G)?(i="e",G++):(i=null,0===Z&&e('"e"')),null===i&&(69===t.charCodeAt(G)?(i="E",G++):(i=null,0===Z&&e('"E"'))),null!==i?(n=H(),n=null!==n?n:"",null!==n?(s=k(),null!==s?i=[i,n,s]:(i=null,G=h)):(i=null,G=h)):(i=null,G=h),null!==i&&(i=function(t,i,n,e){return i+n+e}(r,i[0],i[1],i[2])),null===i&&(G=r),i}function H(){var i;return 43===t.charCodeAt(G)?(i="+",G++):(i=null,0===Z&&e('"+"')),null===i&&(45===t.charCodeAt(G)?(i="-",G++):(i=null,0===Z&&e('"-"'))),i}function k(){var t,i,n,e;return n=G,e=G,t=F(),null!==t?(i=k(),null!==i?t=[t,i]:(t=null,G=e)):(t=null,G=e),null!==t&&(t=function(t,i,n){return i+n}(n,t[0],t[1])),null===t&&(G=n),null===t&&(t=F()),t}function F(){var i;return/^[0-9]/.test(t.charAt(G))?(i=t.charAt(G),G++):(i=null,0===Z&&e("[0-9]")),i}function U(){var i;return 32===t.charCodeAt(G)?(i=" ",G++):(i=null,0===Z&&e('" "')),null===i&&(9===t.charCodeAt(G)?(i="	",G++):(i=null,0===Z&&e('"\\t"')),null===i&&(13===t.charCodeAt(G)?(i="\r",G++):(i=null,0===Z&&e('"\\r"')),null===i&&(10===t.charCodeAt(G)?(i="\n",G++):(i=null,0===Z&&e('"\\n"'))))),i}function B(t){t.sort();for(var i=null,n=[],e=0;e<t.length;e++)t[e]!==i&&(n.push(t[e]),i=t[e]);return n}function K(){for(var i=1,n=1,e=!1,s=0;s<Math.max(G,W);s++){var r=t.charAt(s);"\n"===r?(e||i++,n=1,e=!1):"\r"===r||"\u2028"===r||"\u2029"===r?(i++,n=1,e=!0):(n++,e=!1)}return{line:i,column:n}}function Q(t,i){var n=[{cmd:i?"moveToRelative":"moveTo",args:[t[0].x,t[0].y]}];if(t.length>1)for(var e=1;e<t.length;e++)n.push({cmd:i?"lineToRelative":"lineTo",args:[t[e].x,t[e].y]});return n}var j={svgPath:s,movetoDrawtoCommandGroups:r,movetoDrawtoCommandGroup:h,drawtoCommands:o,drawtoCommand:u,moveto:a,movetoArgumentSequence:m,closepath:l,lineto:c,linetoArgumentSequence:f,horizontalLineto:d,horizontalLinetoArgumentSequence:p,verticalLineto:g,verticalLinetoArgumentSequence:v,curveto:x,curvetoArgumentSequence:T,curvetoArgument:w,smoothCurveto:y,smoothCurvetoArgumentSequence:A,smoothCurvetoArgument:b,quadraticBezierCurveto:M,quadraticBezierCurvetoArgumentSequence:E,quadraticBezierCurvetoArgument:D,smoothQuadraticBezierCurveto:O,smoothQuadraticBezierCurvetoArgumentSequence:I,ellipticalArc:S,ellipticalArcArgumentSequence:P,ellipticalArcArgument:C,coordinatePair:R,nonnegativeNumber:V,number:z,flag:Y,commaWsp:L,comma:N,floatingPointConstant:X,fractionalConstant:_,exponent:q,sign:H,digitSequence:k,digit:F,wsp:U};if(void 0!==n){if(void 0===j[n])throw new Error("Invalid rule name: "+i(n)+".")}else n="svgPath";var G=0,Z=0,W=0,J=[],$=j[n]();if(null===$||G!==t.length){var ti=Math.max(G,W),ii=ti<t.length?t.charAt(ti):null,ni=K();throw new this.SyntaxError(B(J),ii,ti,ni.line,ni.column)}return $},toSource:function(){return this._source}};var e=n.svgPath;return e.SyntaxError=function(t,n,e,s,r){function h(t,n){var e,s;switch(t.length){case 0:e="end of input";break;case 1:e=t[0];break;default:e=t.slice(0,t.length-1).join(", ")+" or "+t[t.length-1]}return s=n?i(n):"end of input","Expected "+e+" but "+s+" found."}this.name="SyntaxError",this.expected=t,this.found=n,this.message=h(t,n),this.offset=e,this.line=s,this.column=r},e.SyntaxError.prototype=Error.prototype,e}),n("KITE/util/LineStyles",["require","KITE/kite"],function(t){var i=t("KITE/kite");i.LineStyles=function(t){void 0===t&&(t={}),this.lineWidth=void 0!==t.lineWidth?t.lineWidth:1,this.lineCap=void 0!==t.lineCap?t.lineCap:"butt",this.lineJoin=void 0!==t.lineJoin?t.lineJoin:"miter",this.lineDash=void 0!==t.lineDash?t.lineDash:null,this.lineDashOffset=void 0!==t.lineDashOffset?t.lineDashOffset:0,this.miterLimit=void 0!==t.miterLimit?t.miterLimit:10};var n=i.LineStyles;return n.prototype={constructor:n,equals:function(t){var i=this.lineWidth===t.lineWidth&&this.lineCap===t.lineCap&&this.lineJoin===t.lineJoin&&this.miterLimit===t.miterLimit&&this.lineDashOffset===t.lineDashOffset;if(!i)return!1;if(!this.lineDash!=!t.lineDash)return!1;if(this.lineDash){if(this.lineDash.length!==t.lineDash.length)return!1;for(var n=0;n<this.lineDash.length;n++)if(this.lineDash[n]!==t.lineDash[n])return!1;return!0}return!0}},i.LineStyles}),n("KITE/segments/Quadratic",["require","KITE/kite","PHET_CORE/inherit","DOT/Bounds2","DOT/Matrix3","DOT/Util","KITE/segments/Segment"],function(t){t("KITE/kite");var i=t("PHET_CORE/inherit"),n=t("DOT/Bounds2"),e=t("DOT/Matrix3"),s=t("DOT/Util").solveQuadraticRootsReal,r=t("KITE/segments/Segment");return r.Quadratic=function(t,i,e,s){if(this.start=t,this.control=i,this.end=e,t.equals(e)&&t.equals(i))return this.invalid=!0,void 0;var r;if(!s){var h=t.equals(i),o=e.equals(i);this.startTangent=h?e.minus(t).normalized():i.minus(t).normalized(),this.endTangent=o?e.minus(t).normalized():e.minus(i).normalized(),this.bounds=new n(Math.min(t.x,e.x),Math.min(t.y,e.y),Math.max(t.x,e.x),Math.max(t.y,e.y));var u=2*(e.x-2*i.x+t.x);0!==u&&(this.tCriticalX=-2*(i.x-t.x)/u,r>0&&1>r&&(this.bounds=this.bounds.withPoint(this.positionAt(this.tCriticalX))));var a=2*(e.y-2*i.y+t.y);0!==a&&(this.tCriticalY=-2*(i.y-t.y)/a,r>0&&1>r&&(this.bounds=this.bounds.withPoint(this.positionAt(this.tCriticalY))))}},i(r,r.Quadratic,{degree:2,positionAt:function(t){var i=1-t;return this.start.times(i*i).plus(this.control.times(2*i*t)).plus(this.end.times(t*t))},tangentAt:function(t){return this.control.minus(this.start).times(2*(1-t)).plus(this.end.minus(this.control).times(2*t))},curvatureAt:function(t){var i=1e-7;if(Math.abs(t-.5)>.5-i){var n=.5>t,e=n?this.start:this.end,s=this.control,r=n?this.end:this.start,h=s.minus(e),o=h.magnitude(),u=(n?-1:1)*h.perpendicular().normalized().dot(r.minus(s));return u*(this.degree-1)/(this.degree*o*o)}return this.subdivided(t,!0)[0].curvatureAt(1)},offsetTo:function(t,i){for(var n=[this],e=5,s=0;e>s;s++)n=_.flatten(_.map(n,function(t){return t.subdivided(.5,!0)}));var r=_.map(n,function(i){return i.approximateOffset(t)});return i&&(r.reverse(),r=_.map(r,function(t){return t.reversed(!0)})),r},subdivided:function(t,i){var n=this.start.blend(this.control,t),e=this.control.blend(this.end,t),s=n.blend(e,t);return[new r.Quadratic(this.start,n,s,i),new r.Quadratic(s,e,this.end,i)]},reversed:function(){return new r.Quadratic(this.end,this.control,this.start)},approximateOffset:function(t){return new r.Quadratic(this.start.plus((this.start.equals(this.control)?this.end.minus(this.start):this.control.minus(this.start)).perpendicular().normalized().times(t)),this.control.plus(this.end.minus(this.start).perpendicular().normalized().times(t)),this.end.plus((this.end.equals(this.control)?this.end.minus(this.start):this.end.minus(this.control)).perpendicular().normalized().times(t)))},getSVGPathFragment:function(){return"Q "+this.control.x+" "+this.control.y+" "+this.end.x+" "+this.end.y},strokeLeft:function(t){return this.offsetTo(-t/2,!1)},strokeRight:function(t){return this.offsetTo(t/2,!0)},getInteriorExtremaTs:function(){var t=[],i=1e-10;return void 0!==this.tCriticalX&&this.tCriticalX>i&&this.tCriticalX<1-i&&t.push(this.tCriticalX),void 0!==this.tCriticalY&&this.tCriticalY>i&&this.tCriticalY<1-i&&t.push(this.tCriticalY),t.sort()},intersectsBounds:function(){throw new Error("Segment.Quadratic.intersectsBounds unimplemented")},intersection:function(t){var i=this,n=[],r=e.rotation2(-t.dir.angle()).timesMatrix(e.translation(-t.pos.x,-t.pos.y)),h=r.timesVector2(this.start),o=r.timesVector2(this.control),u=r.timesVector2(this.end),a=h.y-2*o.y+u.y,m=-2*h.y+2*o.y,l=h.y,c=s(a,m,l);return _.each(c,function(e){if(e>=0&&1>=e){var s=i.positionAt(e),r=i.tangentAt(e).normalized(),h=r.perpendicular(),o=s.minus(t.pos);o.dot(t.dir)>0&&n.push({distance:o.magnitude(),point:s,normal:h.dot(t.dir)>0?h.negated():h,wind:t.dir.perpendicular().dot(r)<0?1:-1})}}),n},windingIntersection:function(t){var i=0,n=this.intersection(t);return _.each(n,function(t){i+=t.wind}),i},writeToContext:function(t){t.quadraticCurveTo(this.control.x,this.control.y,this.end.x,this.end.y)},transformed:function(t){return new r.Quadratic(t.timesVector2(this.start),t.timesVector2(this.control),t.timesVector2(this.end))}}),r.Quadratic}),n("KITE/segments/Cubic",["require","KITE/kite","PHET_CORE/inherit","DOT/Bounds2","DOT/Vector2","DOT/Matrix3","DOT/Util","DOT/Util","KITE/segments/Segment","KITE/segments/Quadratic"],function(t){t("KITE/kite");var i=t("PHET_CORE/inherit"),n=t("DOT/Bounds2"),e=t("DOT/Vector2"),s=t("DOT/Matrix3"),r=t("DOT/Util").solveQuadraticRootsReal,h=t("DOT/Util").solveCubicRootsReal,o=t("KITE/segments/Segment");return t("KITE/segments/Quadratic"),o.Cubic=function(t,i,e,s,h){function u(t,i,n,e){var s=-3*t+9*i-9*n+3*e,h=6*t-12*i+6*n,o=-3*t+3*i;return r(s,h,o)}if(this.start=t,this.control1=i,this.control2=e,this.end=s,!h){if(t.equals(s,0)&&t.equals(i,0)&&t.equals(e,0))return this.invalid=!0,void 0;this.startTangent=this.tangentAt(0).normalized(),this.endTangent=this.tangentAt(1).normalized(),this.r=i.minus(t).normalized(),this.s=this.r.perpendicular();var a=t.times(-1).plus(i.times(3)).plus(e.times(-3)).plus(s),m=t.times(3).plus(i.times(-6)).plus(e.times(3)),l=t.times(-3).plus(i.times(3)),c=a.perpendicular(),f=m.perpendicular(),d=c.dot(m);if(this.tCusp=-.5*(c.dot(l)/d),this.tDeterminant=this.tCusp*this.tCusp-1/3*(f.dot(l)/d),this.tDeterminant>=0){var p=Math.sqrt(this.tDeterminant);this.tInflection1=this.tCusp-p,this.tInflection2=this.tCusp+p}if(this.hasCusp()){var g=this.subdivided(this.tCusp,!0);this.startQuadratic=new o.Quadratic(g[0].start,g[0].control1,g[0].end,!1),this.endQuadratic=new o.Quadratic(g[1].start,g[1].control2,g[1].end,!1)}this.bounds=n.NOTHING,this.bounds=this.bounds.withPoint(this.start),this.bounds=this.bounds.withPoint(this.end);var v=this;this.xExtremaT=u(this.start.x,this.control1.x,this.control2.x,this.end.x),_.each(this.xExtremaT,function(t){t>=0&&1>=t&&(v.bounds=v.bounds.withPoint(v.positionAt(t)))}),this.yExtremaT=u(this.start.y,this.control1.y,this.control2.y,this.end.y),_.each(this.yExtremaT,function(t){t>=0&&1>=t&&(v.bounds=v.bounds.withPoint(v.positionAt(t)))}),this.hasCusp()&&(this.bounds=this.bounds.withPoint(this.positionAt(this.tCusp)))}},i(o,o.Cubic,{degree:3,hasCusp:function(){var t=1e-6;return this.tangentAt(this.tCusp).magnitude()<t&&this.tCusp>=0&&this.tCusp<=1},positionAt:function(t){var i=1-t;return this.start.times(i*i*i).plus(this.control1.times(3*i*i*t)).plus(this.control2.times(3*i*t*t)).plus(this.end.times(t*t*t))},tangentAt:function(t){var i=1-t;return this.start.times(-3*i*i).plus(this.control1.times(3*i*i-6*i*t)).plus(this.control2.times(6*i*t-3*t*t)).plus(this.end.times(3*t*t))},curvatureAt:function(t){var i=1e-7;if(Math.abs(t-.5)>.5-i){var n=.5>t,e=n?this.start:this.end,s=n?this.control1:this.control2,r=n?this.control2:this.control1,h=s.minus(e),o=h.magnitude(),u=(n?-1:1)*h.perpendicular().normalized().dot(r.minus(s));return u*(this.degree-1)/(this.degree*o*o)}return this.subdivided(t,!0)[0].curvatureAt(1)},toRS:function(t){var i=t.minus(this.start);return new e(i.dot(this.r),i.dot(this.s))},subdivided:function(t,i){var n=this.start.blend(this.control1,t),e=this.control2.blend(this.end,t),s=this.control1.blend(this.control2,t),r=n.blend(s,t),h=s.blend(e,t),u=r.blend(h,t);return[new o.Cubic(this.start,n,r,u,i),new o.Cubic(u,h,e,this.end,i)]},offsetTo:function(t,i){for(var n=32,e=[],s=[],r=0;n>r;r++){var h=r/(n-1);i&&(h=1-h),e.push(this.positionAt(h).plus(this.tangentAt(h).perpendicular().normalized().times(t))),r>0&&s.push(new o.Line(e[r-1],e[r]))}return s},getSVGPathFragment:function(){return"C "+this.control1.x+" "+this.control1.y+" "+this.control2.x+" "+this.control2.y+" "+this.end.x+" "+this.end.y},strokeLeft:function(t){return this.offsetTo(-t/2,!1)},strokeRight:function(t){return this.offsetTo(t/2,!0)},getInteriorExtremaTs:function(){var t=this.xExtremaT.concat(this.yExtremaT),i=[];return _.each(t,function(t){var n=1e-10;t>n&&1-n>t&&_.every(i,function(i){return Math.abs(t-i)>n})&&i.push(t)}),i.sort()},intersectsBounds:function(){throw new Error("Segment.Cubic.intersectsBounds unimplemented")},intersection:function(t){var i=this,n=[],e=s.rotation2(-t.dir.angle()).timesMatrix(s.translation(-t.pos.x,-t.pos.y)),r=e.timesVector2(this.start),o=e.timesVector2(this.control1),u=e.timesVector2(this.control2),a=e.timesVector2(this.end),m=-r.y+3*o.y-3*u.y+a.y,l=3*r.y-6*o.y+3*u.y,c=-3*r.y+3*o.y,f=r.y,d=h(m,l,c,f);return _.each(d,function(e){if(e>=0&&1>=e){var s=i.positionAt(e),r=i.tangentAt(e).normalized(),h=r.perpendicular(),o=s.minus(t.pos);o.dot(t.dir)>0&&n.push({distance:o.magnitude(),point:s,normal:h.dot(t.dir)>0?h.negated():h,wind:t.dir.perpendicular().dot(r)<0?1:-1})}}),n},windingIntersection:function(t){var i=0,n=this.intersection(t);return _.each(n,function(t){i+=t.wind}),i},writeToContext:function(t){t.bezierCurveTo(this.control1.x,this.control1.y,this.control2.x,this.control2.y,this.end.x,this.end.y)},transformed:function(t){return new o.Cubic(t.timesVector2(this.start),t.timesVector2(this.control1),t.timesVector2(this.control2),t.timesVector2(this.end))}}),o.Cubic}),n("KITE/segments/EllipticalArc",["require","KITE/kite","PHET_CORE/inherit","DOT/Vector2","DOT/Bounds2","DOT/Matrix3","DOT/Transform3","DOT/Util","DOT/Util","KITE/segments/Segment","KITE/util/Subpath"],function(t){t("KITE/kite");var i=t("PHET_CORE/inherit"),n=t("DOT/Vector2"),e=t("DOT/Bounds2"),s=t("DOT/Matrix3"),r=t("DOT/Transform3"),h=t("DOT/Util").toDegrees,o=t("DOT/Util"),u=t("KITE/segments/Segment");return t("KITE/util/Subpath"),u.EllipticalArc=function(t,i,s,r,h,o,a){function m(t){c.containsAngle(t)&&(c.bounds=c.bounds.withPoint(c.positionAtAngle(t)))}if(0>i&&(i=-i,h=Math.PI-h,o=Math.PI-o,a=!a),0>s&&(s=-s,h=-h,o=-o,a=!a),s>i){r+=Math.PI/2,h-=Math.PI/2,o-=Math.PI/2;var l=i;i=s,s=l}if(this.center=t,this.radiusX=i,this.radiusY=s,this.rotation=r,this.startAngle=h,this.endAngle=o,this.anticlockwise=a,this.unitTransform=u.EllipticalArc.computeUnitTransform(t,i,s,r),this.start=this.positionAtAngle(h),this.end=this.positionAtAngle(o),this.startTangent=this.tangentAtAngle(h).normalized(),this.endTangent=this.tangentAtAngle(o).normalized(),0===i||0===s||h===o)return this.invalid=!0,void 0;if(s>i)throw new Error("Not verified to work if radiusX < radiusY");this.actualEndAngle=this.anticlockwise?this.startAngle>this.endAngle?this.endAngle:this.startAngle<this.endAngle?this.endAngle-2*Math.PI:this.startAngle:this.startAngle<this.endAngle?this.endAngle:this.startAngle>this.endAngle?this.endAngle+2*Math.PI:this.startAngle,!a&&o-h>=2*Math.PI||a&&h-o>=2*Math.PI,this.angleDifference=this.anticlockwise?this.startAngle-this.endAngle:this.endAngle-this.startAngle,this.angleDifference<0&&(this.angleDifference+=2*Math.PI),this.unitArcSegment=new u.Arc(n.ZERO,1,h,o,a),this.bounds=e.NOTHING,this.bounds=this.bounds.withPoint(this.start),this.bounds=this.bounds.withPoint(this.end);var c=this;if(h!==o){var f=Math.atan(-(s/i)*Math.tan(r)),d=Math.atan(s/i/Math.tan(r));this.possibleExtremaAngles=[f,f+Math.PI,d,d+Math.PI],_.each(this.possibleExtremaAngles,m)}},i(u,u.EllipticalArc,{mapAngle:function(t){return this.startAngle>this.actualEndAngle?o.moduloBetweenUp(t,this.startAngle-2*Math.PI,this.startAngle):o.moduloBetweenDown(t,this.startAngle,this.startAngle+2*Math.PI)},tAtAngle:function(t){return(this.mapAngle(t)-this.startAngle)/(this.actualEndAngle-this.startAngle)},angleAt:function(t){return this.startAngle+(this.actualEndAngle-this.startAngle)*t},positionAt:function(t){return this.positionAtAngle(this.angleAt(t))},tangentAt:function(t){return this.tangentAtAngle(this.angleAt(t))
},curvatureAt:function(t){var i=this.angleAt(t),n=this.radiusX*Math.sin(i),e=this.radiusY*Math.cos(i),s=Math.pow(e*e+n*n,1.5);return(this.anticlockwise?-1:1)*this.radiusX*this.radiusY/s},positionAtAngle:function(t){return this.unitTransform.transformPosition2(n.createPolar(1,t))},tangentAtAngle:function(t){var i=this.unitTransform.transformNormal2(n.createPolar(1,t));return this.anticlockwise?i.perpendicular():i.perpendicular().negated()},containsAngle:function(t){var i=this.anticlockwise?t-this.endAngle:t-this.startAngle,n=i%(2*Math.PI);return 0>n&&(n+=2*Math.PI),n<=this.angleDifference},offsetTo:function(t,i){for(var n=32,e=[],s=[],r=0;n>r;r++){var h=r/(n-1);i&&(h=1-h);var o=this.angleAt(h);e.push(this.positionAtAngle(o).plus(this.tangentAtAngle(o).perpendicular().normalized().times(t))),r>0&&s.push(new u.Line(e[r-1],e[r]))}return s},getSVGPathFragment:function(){var t,i=.01,n=this.anticlockwise?"0":"1",e=h(this.rotation);if(this.angleDifference<2*Math.PI-i)return t=this.angleDifference<Math.PI?"0":"1","A "+this.radiusX+" "+this.radiusY+" "+e+" "+t+" "+n+" "+this.end.x+" "+this.end.y;var s=(this.startAngle+this.endAngle)/2,r=this.positionAtAngle(s);t="0";var o="A "+this.radiusX+" "+this.radiusY+" "+e+" "+t+" "+n+" "+r.x+" "+r.y,u="A "+this.radiusX+" "+this.radiusY+" "+e+" "+t+" "+n+" "+this.end.x+" "+this.end.y;return o+" "+u},strokeLeft:function(t){return this.offsetTo(-t/2,!1)},strokeRight:function(t){return this.offsetTo(t/2,!0)},getInteriorExtremaTs:function(){var t=this,i=[];return _.each(this.possibleExtremaAngles,function(n){if(t.containsAngle(n)){var e=t.tAtAngle(n),s=1e-10;e>s&&1-s>e&&i.push(e)}}),i.sort()},subdivided:function(t){var i=this.angleAt(0),n=this.angleAt(t),e=this.angleAt(1);return[new u.EllipticalArc(this.center,this.radiusX,this.radiusY,this.rotation,i,n,this.anticlockwise),new u.EllipticalArc(this.center,this.radiusX,this.radiusY,this.rotation,n,e,this.anticlockwise)]},intersectsBounds:function(){throw new Error("Segment.EllipticalArc.intersectsBounds unimplemented")},intersection:function(t){var i=this.unitTransform,n=i.inverseRay2(t),e=this.unitArcSegment.intersection(n);return _.map(e,function(n){var e=i.transformPosition2(n.point);return{distance:t.pos.distance(e),point:e,normal:i.inverseNormal2(n.normal),wind:n.wind}})},windingIntersection:function(t){var i=this.unitTransform.inverseRay2(t);return this.unitArcSegment.windingIntersection(i)},writeToContext:function(t){t.ellipse?t.ellipse(this.center.x,this.center.y,this.radiusX,this.radiusY,this.rotation,this.startAngle,this.endAngle,this.anticlockwise):(this.unitTransform.getMatrix().canvasAppendTransform(t),t.arc(0,0,1,this.startAngle,this.endAngle,this.anticlockwise),this.unitTransform.getInverse().canvasAppendTransform(t))},transformed:function(t){var i=t.timesVector2(n.createPolar(this.radiusX,this.rotation)).minus(t.timesVector2(n.ZERO)),e=t.timesVector2(n.createPolar(this.radiusY,this.rotation+Math.PI/2)).minus(t.timesVector2(n.ZERO)),s=i.angle(),r=i.magnitude(),h=e.magnitude(),o=t.getDeterminant()<0,a=o?!this.anticlockwise:this.anticlockwise,m=o?-this.startAngle:this.startAngle,l=o?-this.endAngle:this.endAngle;return new u.EllipticalArc(t.timesVector2(this.center),r,h,s,m,l,a)}}),u.EllipticalArc.computeUnitTransform=function(t,i,n,e){return new r(s.translation(t.x,t.y).timesMatrix(s.rotation2(e)).timesMatrix(s.scaling(i,n)))},u.EllipticalArc}),n("KITE/Shape",["require","ASSERT/assert","KITE/kite","DOT/Vector2","DOT/Bounds2","DOT/Ray2","DOT/Matrix3","DOT/Transform3","DOT/Util","DOT/Util","KITE/util/Subpath","KITE/../parser/svgPath","KITE/util/LineStyles","KITE/segments/Arc","KITE/segments/Cubic","KITE/segments/EllipticalArc","KITE/segments/Line","KITE/segments/Quadratic"],function(t){function i(t,i){return new s(t,i)}function n(t,i){return new s(t,i)}t("ASSERT/assert")("kite.extra",!0);var e=t("KITE/kite"),s=t("DOT/Vector2"),r=t("DOT/Bounds2"),h=t("DOT/Ray2");t("DOT/Matrix3"),t("DOT/Transform3"),t("DOT/Util").toDegrees,t("DOT/Util").lineLineIntersection;var o=t("KITE/util/Subpath"),u=t("KITE/../parser/svgPath");t("KITE/util/LineStyles"),t("KITE/segments/Arc"),t("KITE/segments/Cubic"),t("KITE/segments/EllipticalArc"),t("KITE/segments/Line"),t("KITE/segments/Quadratic"),e.Shape=function(t,i){this.subpaths="object"==typeof t?t:[],this.bounds=i||r.NOTHING;var n=this;t&&"object"!=typeof t&&_.each(u.parse(t),function(t){n[t.cmd].apply(n,t.args)})};var a=e.Shape;return a.prototype={constructor:a,moveTo:function(t,i){return this.moveToPoint(n(t,i))},moveToRelative:function(t,i){return this.moveToPointRelative(n(t,i))},moveToPointRelative:function(t){return this.moveToPoint(this.getRelativePoint().plus(t))},moveToPoint:function(t){return this.addSubpath((new e.Subpath).addPoint(t))},lineTo:function(t,i){return this.lineToPoint(n(t,i))},lineToRelative:function(t,i){return this.lineToPointRelative(n(t,i))},lineToPointRelative:function(t){return this.lineToPoint(this.getRelativePoint().plus(t))},lineToPoint:function(t){if(this.hasSubpaths()){var i=this.getLastSubpath().getLastPoint(),n=t,s=new e.Segment.Line(i,n);this.getLastSubpath().addPoint(n),s.invalid||(this.getLastSubpath().addSegment(s),this.bounds=this.bounds.withPoint(i).withPoint(n))}else this.ensure(t);return this},horizontalLineTo:function(t){return this.lineTo(t,this.getRelativePoint().y)},horizontalLineToRelative:function(t){return this.lineToRelative(t,0)},verticalLineTo:function(t){return this.lineTo(this.getRelativePoint().x,t)},verticalLineToRelative:function(t){return this.lineToRelative(0,t)},quadraticCurveTo:function(t,i,e,s){return this.quadraticCurveToPoint(n(t,i),n(e,s))},quadraticCurveToRelative:function(t,i,e,s){return this.quadraticCurveToPointRelative(n(t,i),n(e,s))},quadraticCurveToPointRelative:function(t,i){var n=this.getRelativePoint();return this.quadraticCurveToPoint(n.plus(t),n.plus(i))},smoothQuadraticCurveTo:function(t,i){return this.quadraticCurveToPoint(this.getSmoothQuadraticControlPoint(),n(t,i))},smoothQuadraticCurveToRelative:function(t,i){return this.quadraticCurveToPoint(this.getSmoothQuadraticControlPoint(),n(t,i).plus(this.getRelativePoint()))},quadraticCurveToPoint:function(t,i){this.ensure(t);var n=this.getLastSubpath().getLastPoint(),s=new e.Segment.Quadratic(n,t,i);return this.getLastSubpath().addPoint(i),s.invalid||(this.getLastSubpath().addSegment(s),this.bounds=this.bounds.union(s.bounds)),this},cubicCurveTo:function(t,i,e,s,r,h){return this.cubicCurveToPoint(n(t,i),n(e,s),n(r,h))},cubicCurveToRelative:function(t,i,e,s,r,h){return this.cubicCurveToPointRelative(n(t,i),n(e,s),n(r,h))},cubicCurveToPointRelative:function(t,i,n){var e=this.getRelativePoint();return this.cubicCurveToPoint(e.plus(t),e.plus(i),e.plus(n))},smoothCubicCurveTo:function(t,i,e,s){return this.cubicCurveToPoint(this.getSmoothCubicControlPoint(),n(t,i),n(e,s))},smoothCubicCurveToRelative:function(t,i,e,s){return this.cubicCurveToPoint(this.getSmoothCubicControlPoint(),n(t,i).plus(this.getRelativePoint()),n(e,s).plus(this.getRelativePoint()))},cubicCurveToPoint:function(t,i,n){this.ensure(t);var s=this.getLastSubpath().getLastPoint(),r=new e.Segment.Cubic(s,t,i,n);return r.invalid||(r.hasCusp()?(this.getLastSubpath().addSegment(r.startQuadratic),this.getLastSubpath().addSegment(r.endQuadratic)):this.getLastSubpath().addSegment(r),this.bounds=this.bounds.union(r.bounds)),this.getLastSubpath().addPoint(n),this},arc:function(t,i,e,s,r,h){return this.arcPoint(n(t,i),e,s,r,h)},arcPoint:function(t,i,n,s,r){var h=new e.Segment.Arc(t,i,n,s,r),o=h.start,u=h.end;return this.hasSubpaths()&&this.getLastSubpath().getLength()>0&&!o.equals(this.getLastSubpath().getLastPoint(),0)&&this.getLastSubpath().addSegment(new e.Segment.Line(this.getLastSubpath().getLastPoint(),o)),this.hasSubpaths()||this.addSubpath(new e.Subpath),this.getLastSubpath().addPoint(o),this.getLastSubpath().addPoint(u),h.invalid||(this.getLastSubpath().addSegment(h),this.bounds=this.bounds.union(h.bounds)),this},ellipticalArc:function(t,i,e,s,r,h,o,u){return this.ellipticalArcPoint(n(t,i),e,s,r,h,o,u)},ellipticalArcPoint:function(t,i,n,s,r,h,o){var u=new e.Segment.EllipticalArc(t,i,n,s,r,h,o),a=u.start,m=u.end;return this.hasSubpaths()&&this.getLastSubpath().getLength()>0&&!a.equals(this.getLastSubpath().getLastPoint(),0)&&this.getLastSubpath().addSegment(new e.Segment.Line(this.getLastSubpath().getLastPoint(),a)),this.hasSubpaths()||this.addSubpath(new e.Subpath),this.getLastSubpath().addPoint(a),this.getLastSubpath().addPoint(m),u.invalid||(this.getLastSubpath().addSegment(u),this.bounds=this.bounds.union(u.bounds)),this},close:function(){if(this.hasSubpaths()){var t=this.getLastSubpath(),i=new e.Subpath;t.close(),this.addSubpath(i),i.addPoint(t.getFirstPoint())}return this},ellipticalArcToRelative:function(t,i,n,e,s,r,h){var o=this.getRelativePoint();return this.ellipticalArcTo(t,i,n,e,s,r+o.x,h+o.y)},ellipticalArcTo:function(){throw new Error("ellipticalArcTo unimplemented")},circle:function(t,n,e){if("object"==typeof t){var s=t;return e=n,this.arcPoint(s,e,0,2*Math.PI,!1)}return this.arcPoint(i(t,n),e,0,2*Math.PI,!1)},ellipse:function(t,i,e,s,r){if("object"==typeof t){var h=t;return r=s,s=e,e=i,this.ellipticalArcPoint(h,e,s,r||0,0,2*Math.PI,!1)}return this.ellipticalArcPoint(n(t,i),e,s,r||0,0,2*Math.PI,!1)},rect:function(t,i,s,r){var h=new e.Subpath;return this.addSubpath(h),h.addPoint(n(t,i)),h.addPoint(n(t+s,i)),h.addPoint(n(t+s,i+r)),h.addPoint(n(t,i+r)),h.addSegment(new e.Segment.Line(h.points[0],h.points[1])),h.addSegment(new e.Segment.Line(h.points[1],h.points[2])),h.addSegment(new e.Segment.Line(h.points[2],h.points[3])),h.close(),this.addSubpath(new e.Subpath),this.getLastSubpath().addPoint(n(t,i)),this.bounds=this.bounds.withCoordinates(t,i).withCoordinates(t+s,i+r),this},roundRect:function(t,i,n,e,s,r){var h=t+s,o=t+n-s,u=i+r,a=i+e-r;return s===r?this.arc(o,u,s,-Math.PI/2,0,!1).arc(o,a,s,0,Math.PI/2,!1).arc(h,a,s,Math.PI/2,Math.PI,!1).arc(h,u,s,Math.PI,3*Math.PI/2,!1).close():this.ellipticalArc(o,u,s,r,0,-Math.PI/2,0,!1).ellipticalArc(o,a,s,r,0,0,Math.PI/2,!1).ellipticalArc(h,a,s,r,0,Math.PI/2,Math.PI,!1).ellipticalArc(h,u,s,r,0,Math.PI,3*Math.PI/2,!1).close(),this},copy:function(){return new a(_.map(this.subpaths,function(t){return t.copy()}),this.bounds)},writeToContext:function(t){for(var i=this.subpaths.length,n=0;i>n;n++)this.subpaths[n].writeToContext(t)},getSVGPath:function(){for(var t=[],i=this.subpaths.length,n=0;i>n;n++){var e=this.subpaths[n];if(e.isDrawable()){var s=e.getFirstSegment().start,r="M "+s.x+" "+s.y+" ";r+=_.map(e.segments,function(t){return t.getSVGPathFragment()}).join(" "),e.isClosed()&&(r+=" Z"),t.push(r)}}return t.join(" ")},transformed:function(t){var i=_.map(this.subpaths,function(i){return i.transformed(t)}),n=_.reduce(i,function(t,i){return t.union(i.computeBounds())},r.NOTHING);return new a(i,n)},computeBounds:function(t){return t?this.bounds.union(this.getStrokedShape(t).bounds):this.bounds},containsPoint:function(t){var i=new h(t,s.X_UNIT);return 0!==this.windingIntersection(i)},intersection:function(t){for(var i=[],n=this.subpaths.length,e=0;n>e;e++){var s=this.subpaths[e];if(s.isDrawable()){for(var r=s.segments.length,h=0;r>h;h++){var o=s.segments[h];i=i.concat(o.intersection(t))}s.hasClosingSegment()&&(i=i.concat(s.getClosingSegment().intersection(t)))}}return _.sortBy(i,function(t){return t.distance})},windingIntersection:function(t){for(var i=0,n=this.subpaths.length,e=0;n>e;e++){var s=this.subpaths[e];if(s.isDrawable()){for(var r=s.segments.length,h=0;r>h;h++)i+=s.segments[h].windingIntersection(t);s.hasClosingSegment()&&(i+=s.getClosingSegment().windingIntersection(t))}}return i},intersectsBounds:function(t){for(var i=this.subpaths.length,n=0;i>n;n++){var e=this.subpaths[n];if(e.isDrawable()){for(var s=e.segments.length,r=0;s>r;r++)if(e.segments[r].intersectsBounds(t))return!0;if(e.hasClosingSegment()&&e.getClosingSegment().intersectsBounds(t))return!0}}return!1},getStrokedShape:function(t){for(var i=[],n=r.NOTHING.copy(),e=this.subpaths.length,s=0;e>s;s++){var h=this.subpaths[s],o=h.stroked(t);i=i.concat(o)}for(e=i.length,s=0;e>s;s++)n.includeBounds(i[s].computeBounds());return new a(i,n)},toString:function(){return"new kite.Shape( '"+this.getSVGPath()+"' )"},ensure:function(t){this.hasSubpaths()||(this.addSubpath(new o),this.getLastSubpath().addPoint(t))},addSubpath:function(t){return this.subpaths.push(t),this},hasSubpaths:function(){return this.subpaths.length>0},getLastSubpath:function(){return _.last(this.subpaths)},getLastPoint:function(){return this.hasSubpaths()?this.getLastSubpath().getLastPoint():null},getLastSegment:function(){if(!this.hasSubpaths())return null;var t=this.getLastSubpath();return t.isDrawable()?t.getLastSegment():null},getSmoothQuadraticControlPoint:function(){var t=this.getLastPoint(),i=this.getLastSegment();return i&&i instanceof e.Segment.Quadratic?t.plus(t.minus(i.control)):t},getSmoothCubicControlPoint:function(){var t=this.getLastPoint(),i=this.getLastSegment();return i&&i instanceof e.Segment.Cubic?t.plus(t.minus(i.control2)):t},getRelativePoint:function(){var t=this.getLastPoint();return t?t:s.ZERO}},a.rectangle=function(t,i,n,e){return(new a).rect(t,i,n,e)},a.rect=a.rectangle,a.roundRect=function(t,i,n,e,s,r){return(new a).roundRect(t,i,n,e,s,r)},a.roundRectangle=a.roundRect,a.bounds=function(t){return(new a).rect(t.minX,t.minY,t.maxX-t.minX,t.maxY-t.minY)},a.lineSegment=function(t,i,n,e){return"number"==typeof t?(new a).moveTo(t,i).lineTo(n,e):(new a).moveToPoint(t).lineToPoint(i)},a.regularPolygon=function(t,i){var n=new a;return _.each(_.range(t),function(e){var r=s.createPolar(i,2*Math.PI*e/t);0===e?n.moveToPoint(r):n.lineToPoint(r)}),n.close()},a.circle=function(t,i,n){return void 0===i?(new a).circle(0,0,t):(new a).circle(t,i,n).close()},a.ellipse=function(t,i,n,e){return void 0===n?(new a).ellipse(0,0,t,i):(new a).ellipse(t,i,n,e).close()},a.arc=function(t,i,n,e,s,r){return(new a).arc(t,i,n,e,s,r)},a}),n("main",["KITE/kite","KITE/Shape","KITE/segments/Arc","KITE/segments/Cubic","KITE/segments/EllipticalArc","KITE/segments/Line","KITE/segments/Quadratic","KITE/segments/Segment","KITE/util/LineStyles","KITE/util/Subpath","KITE/../parser/svgPath"],function(t){return t}),n("DOT/Complex",["require","DOT/dot","PHET_CORE/inherit","DOT/Vector2"],function(t){var i=t("DOT/dot"),n=t("PHET_CORE/inherit"),e=t("DOT/Vector2");i.Complex=function(t,i){e.call(this,t,i),this.real=t,this.imaginary=i};var s=i.Complex;return s.real=function(t){return new s(t,0)},s.imaginary=function(t){return new s(0,t)},s.createPolar=function(t,i){return new s(t*Math.cos(i),t*Math.sin(i))},n(e.Immutable,s,{phase:e.prototype.angle,times:function(t){return new s(this.real*t.real-this.imaginary*t.imaginary,this.real*t.imaginary+this.imaginary*t.real)},dividedBy:function(t){var i=t.magnitudeSquared();return new s((this.real*t.real+this.imaginary*t.imaginary)/i,(this.imaginary*t.real-this.real*t.imaginary)/i)},sqrt:function(){var t=this.magnitude();return new s(Math.sqrt((t+this.real)/2),(this.imaginary>=0?1:-1)*Math.sqrt((t-this.real)/2))},conjugate:function(){return new s(this.real,-this.imaginary)},exponentiated:function(){return s.createPolar(Math.exp(this.real),this.imaginary)},toString:function(){return"Complex("+this.x+", "+this.y+")"}}),s.ZERO=new s(0,0),s.ONE=new s(1,0),s.I=new s(0,1),s}),n("DOT/ConvexHull2",["require","DOT/dot"],function(t){function i(t,i,n){return i.minus(t).crossScalar(n.minus(t))}var n=t("DOT/dot");return n.ConvexHull2={grahamScan:function(t,n){if(t.length<=2)return t;var e=Number.POSITIVE_INFINITY,s=null;_.each(t,function(t){t.y<=e&&(t.y===e&&s?t.x<s.x&&(s=t):(e=t.y,s=t))}),t=_.sortBy(t,function(t){return t.minus(s).angle()}),t.splice(_.indexOf(t,s),1);var r=[s];return _.each(t,function(t){function e(){if(r.length<2)return!1;var e=i(r[r.length-2],r[r.length-1],t);return n?0>e:0>=e}if(s.x!==t.x||s.y!==t.y){for(;e();)r.pop();r.push(t)}}),r}},n.ConvexHull2}),n("DOT/Dimension2",["require","DOT/dot"],function(t){var i=t("DOT/dot");i.Dimension2=function(t,i){this.width=t,this.height=i};var n=i.Dimension2;return n.prototype={constructor:n,toString:function(){return"["+this.width+"w, "+this.height+"h]"},equals:function(t){return this.width===t.width&&this.height===t.height}},n}),n("DOT/EigenvalueDecomposition",["require","DOT/dot"],function(t){var i=t("DOT/dot"),n=window.Float32Array||Array;i.EigenvalueDecomposition=function(t){var i,e,s=t.entries;this.n=t.getColumnDimension();var r=this.n;for(this.V=new n(r*r),this.d=new n(r),this.e=new n(r),this.issymmetric=!0,e=0;r>e&&this.issymmetric;e++)for(i=0;r>i&&this.issymmetric;i++)this.issymmetric=s[i*this.n+e]===s[e*this.n+i];if(this.issymmetric){for(i=0;r>i;i++)for(e=0;r>e;e++)this.V[i*this.n+e]=s[i*this.n+e];this.tred2(),this.tql2()}else{for(this.H=new n(r*r),this.ort=new n(r),e=0;r>e;e++)for(i=0;r>i;i++)this.H[i*this.n+e]=s[i*this.n+e];this.orthes(),this.hqr2()}};var e=i.EigenvalueDecomposition;return e.prototype={constructor:e,getV:function(){return this.V.copy()},getRealEigenvalues:function(){return this.d},getImagEigenvalues:function(){return this.e},getD:function(){for(var t=this.n,n=this.d,e=this.e,s=new i.Matrix(t,t),r=s.entries,h=0;t>h;h++){for(var o=0;t>o;o++)r[h*this.n+o]=0;r[h*this.n+h]=n[h],e[h]>0?r[h*this.n+h+1]=e[h]:e[h]<0&&(r[h*this.n+h-1]=e[h])}return s},tred2:function(){var t,i,n,e,s,r,h=this.n,o=this.V,u=this.d,a=this.e;for(i=0;h>i;i++)u[i]=o[(h-1)*h+i];for(t=h-1;t>0;t--){var m=0;for(r=0,n=0;t>n;n++)m+=Math.abs(u[n]);if(0===m)for(a[t]=u[t-1],i=0;t>i;i++)u[i]=o[(t-1)*h+i],o[t*this.n+i]=0,o[i*this.n+t]=0;else{for(n=0;t>n;n++)u[n]/=m,r+=u[n]*u[n];for(e=u[t-1],s=Math.sqrt(r),e>0&&(s=-s),a[t]=m*s,r-=e*s,u[t-1]=e-s,i=0;t>i;i++)a[i]=0;for(i=0;t>i;i++){for(e=u[i],o[i*this.n+t]=e,s=a[i]+o[i*h+i]*e,n=i+1;t-1>=n;n++)s+=o[n*h+i]*u[n],a[n]+=o[n*h+i]*e;a[i]=s}for(e=0,i=0;t>i;i++)a[i]/=r,e+=a[i]*u[i];var l=e/(r+r);for(i=0;t>i;i++)a[i]-=l*u[i];for(i=0;t>i;i++){for(e=u[i],s=a[i],n=i;t-1>=n;n++)o[n*h+i]-=e*a[n]+s*u[n];u[i]=o[(t-1)*h+i],o[t*this.n+i]=0}}u[t]=r}for(t=0;h-1>t;t++){if(o[(h-1)*h+t]=o[t*h+t],o[t*h+t]=1,r=u[t+1],0!==r){for(n=0;t>=n;n++)u[n]=o[n*h+(t+1)]/r;for(i=0;t>=i;i++){for(s=0,n=0;t>=n;n++)s+=o[n*h+(t+1)]*o[n*h+i];for(n=0;t>=n;n++)o[n*h+i]-=s*u[n]}}for(n=0;t>=n;n++)o[n*h+(t+1)]=0}for(i=0;h>i;i++)u[i]=o[(h-1)*h+i],o[(h-1)*h+i]=0;o[(h-1)*h+(h-1)]=1,a[0]=0},tql2:function(){var t,n,e,s,r,h,o,u=this.n,a=this.V,m=this.d,l=this.e;for(t=1;u>t;t++)l[t-1]=l[t];l[u-1]=0;var c=0,f=0,d=Math.pow(2,-52);for(s=0;u>s;s++){f=Math.max(f,Math.abs(m[s])+Math.abs(l[s]));for(var p=s;u>p&&!(Math.abs(l[p])<=d*f);)p++;if(p>s){o=0;do{o+=1,r=m[s],h=(m[s+1]-r)/(2*l[s]);var g=i.Matrix.hypot(h,1);0>h&&(g=-g),m[s]=l[s]/(h+g),m[s+1]=l[s]*(h+g);var v=m[s+1],x=r-m[s];for(t=s+2;u>t;t++)m[t]-=x;c+=x,h=m[p];var T=1,w=T,y=T,A=l[s+1],b=0,M=0;for(t=p-1;t>=s;t--)for(y=w,w=T,M=b,r=T*l[t],x=T*h,g=i.Matrix.hypot(h,l[t]),l[t+1]=b*g,b=l[t]/g,T=h/g,h=T*m[t]-b*r,m[t+1]=x+b*(T*r+b*m[t]),e=0;u>e;e++)x=a[e*u+(t+1)],a[e*u+(t+1)]=b*a[e*u+t]+T*x,a[e*u+t]=T*a[e*u+t]-b*x;h=-b*M*y*A*l[s]/v,l[s]=b*h,m[s]=T*h}while(Math.abs(l[s])>d*f)}m[s]=m[s]+c,l[s]=0}for(t=0;u-1>t;t++){for(e=t,h=m[t],n=t+1;u>n;n++)m[n]<h&&(e=n,h=m[n]);if(e!==t)for(m[e]=m[t],m[t]=h,n=0;u>n;n++)h=a[n*this.n+t],a[n*this.n+t]=a[n*u+e],a[n*u+e]=h}},orthes:function(){var t,i,n,e,s,r=this.n,h=this.V,o=this.H,u=this.ort,a=0,m=r-1;for(n=a+1;m-1>=n;n++){var l=0;for(t=n;m>=t;t++)l+=Math.abs(o[t*r+(n-1)]);if(0!==l){var c=0;for(t=m;t>=n;t--)u[t]=o[t*r+(n-1)]/l,c+=u[t]*u[t];for(s=Math.sqrt(c),u[n]>0&&(s=-s),c-=u[n]*s,u[n]=u[n]-s,i=n;r>i;i++){for(e=0,t=m;t>=n;t--)e+=u[t]*o[t*this.n+i];for(e/=c,t=n;m>=t;t++)o[t*this.n+i]-=e*u[t]}for(t=0;m>=t;t++){for(e=0,i=m;i>=n;i--)e+=u[i]*o[t*this.n+i];for(e/=c,i=n;m>=i;i++)o[t*this.n+i]-=e*u[i]}u[n]=l*u[n],o[n*r+(n-1)]=l*s}}for(t=0;r>t;t++)for(i=0;r>i;i++)h[t*this.n+i]=t===i?1:0;for(n=m-1;n>=a+1;n--)if(0!==o[n*r+(n-1)]){for(t=n+1;m>=t;t++)u[t]=o[t*r+(n-1)];for(i=n;m>=i;i++){for(s=0,t=n;m>=t;t++)s+=u[t]*h[t*this.n+i];for(s=s/u[n]/o[n*r+(n-1)],t=n;m>=t;t++)h[t*this.n+i]+=s*u[t]}}},cdiv:function(t,i,n,e){var s,r;Math.abs(n)>Math.abs(e)?(s=e/n,r=n+s*e,this.cdivr=(t+s*i)/r,this.cdivi=(i-s*t)/r):(s=n/e,r=e+s*n,this.cdivr=(s*t+i)/r,this.cdivi=(s*i-t)/r)},hqr2:function(){var t,i,n,e,s,r,h,o=this.V,u=this.d,a=this.e,m=this.H,l=this.n;t=l-1;var c,f,d,p,g=0,v=l-1,x=Math.pow(2,-52),T=0,w=0,y=0,A=0,b=0,M=0,E=0;for(i=0;l>i;i++)for((g>i||i>v)&&(u[i]=m[i*t+i],a[i]=0),n=Math.max(i-1,0);l>n;n++)E+=Math.abs(m[i*this.n+n]);for(h=0;t>=g;){for(s=t;s>g&&(b=Math.abs(m[(s-1)*t+(s-1)])+Math.abs(m[s*t+s]),0===b&&(b=E),!(Math.abs(m[s*t+(s-1)])<x*b));)s--;if(s===t)m[t*t+t]=m[t*t+t]+T,u[t]=m[t*t+t],a[t]=0,t--,h=0;else if(s===t-1){if(f=m[t*t+t-1]*m[(t-1)*t+t],w=(m[(t-1)*t+(t-1)]-m[t*t+t])/2,y=w*w+f,M=Math.sqrt(Math.abs(y)),m[t*t+t]=m[t*t+t]+T,m[(t-1)*t+(t-1)]=m[(t-1)*t+(t-1)]+T,d=m[t*t+t],y>=0){for(M=w>=0?w+M:w-M,u[t-1]=d+M,u[t]=u[t-1],0!==M&&(u[t]=d-f/M),a[t-1]=0,a[t]=0,d=m[t*t+t-1],b=Math.abs(d)+Math.abs(M),w=d/b,y=M/b,A=Math.sqrt(w*w+y*y),w/=A,y/=A,n=t-1;l>n;n++)M=m[(t-1)*t+n],m[(t-1)*t+n]=y*M+w*m[t*t+n],m[t*t+n]=y*m[t*t+n]-w*M;for(i=0;t>=i;i++)M=m[i*t+t-1],m[i*t+t-1]=y*M+w*m[i*t+t],m[i*t+t]=y*m[i*t+t]-w*M;for(i=g;v>=i;i++)M=o[i*t+t-1],o[i*t+t-1]=y*M+w*o[i*t+t],o[i*t+t]=y*o[i*t+t]-w*M}else u[t-1]=d+w,u[t]=d+w,a[t-1]=M,a[t]=-M;t-=2,h=0}else{if(d=m[t*t+t],p=0,f=0,t>s&&(p=m[(t-1)*t+(t-1)],f=m[t*t+t-1]*m[(t-1)*t+t]),10===h){for(T+=d,i=g;t>=i;i++)m[i*t+i]-=d;b=Math.abs(m[t*t+t-1])+Math.abs(m[(t-1)*t+t-2]),d=p=.75*b,f=-.4375*b*b}if(30===h&&(b=(p-d)/2,b=b*b+f,b>0)){for(b=Math.sqrt(b),d>p&&(b=-b),b=d-f/((p-d)/2+b),i=g;t>=i;i++)m[i*t+i]-=b;T+=b,d=p=f=.964}for(h+=1,r=t-2;r>=s&&(M=m[r*t+r],A=d-M,b=p-M,w=(A*b-f)/m[(r+1)*t+r]+m[r*t+r+1],y=m[(r+1)*t+r+1]-M-A-b,A=m[(r+2)*t+r+1],b=Math.abs(w)+Math.abs(y)+Math.abs(A),w/=b,y/=b,A/=b,r!==s)&&!(Math.abs(m[r*t+(r-1)])*(Math.abs(y)+Math.abs(A))<x*Math.abs(w)*(Math.abs(m[(r-1)*t+r-1])+Math.abs(M)+Math.abs(m[(r+1)*t+r+1])));)r--;for(i=r+2;t>=i;i++)m[i*t+i-2]=0,i>r+2&&(m[i*t+i-3]=0);for(e=r;t-1>=e;e++){var D=e!==t-1;if(e!==r&&(w=m[e*t+e-1],y=m[(e+1)*t+e-1],A=D?m[(e+2)*t+e-1]:0,d=Math.abs(w)+Math.abs(y)+Math.abs(A),0!==d&&(w/=d,y/=d,A/=d)),0===d)break;if(b=Math.sqrt(w*w+y*y+A*A),0>w&&(b=-b),0!==b){for(e!==r?m[e*t+e-1]=-b*d:s!==r&&(m[e*t+e-1]=-m[e*t+e-1]),w+=b,d=w/b,p=y/b,M=A/b,y/=w,A/=w,n=e;l>n;n++)w=m[e*t+n]+y*m[(e+1)*t+n],D&&(w+=A*m[(e+2)*t+n],m[(e+2)*t+n]=m[(e+2)*t+n]-w*M),m[e*t+n]=m[e*t+n]-w*d,m[(e+1)*t+n]=m[(e+1)*t+n]-w*p;for(i=0;i<=Math.min(t,e+3);i++)w=d*m[i*t+e]+p*m[i*t+e+1],D&&(w+=M*m[i*t+e+2],m[i*t+e+2]=m[i*t+e+2]-w*A),m[i*t+e]=m[i*t+e]-w,m[i*t+e+1]=m[i*t+e+1]-w*y;for(i=g;v>=i;i++)w=d*o[i*t+e]+p*o[i*t+e+1],D&&(w+=M*o[i*t+e+2],o[i*t+e+2]=o[i*t+e+2]-w*A),o[i*t+e]=o[i*t+e]-w,o[i*t+e+1]=o[i*t+e+1]-w*y}}}}if(0!==E){for(t=l-1;t>=0;t--)if(w=u[t],y=a[t],0===y)for(s=t,m[t*t+t]=1,i=t-1;i>=0;i--){for(f=m[i*t+i]-w,A=0,n=s;t>=n;n++)A+=m[i*this.n+n]*m[n*t+t];if(a[i]<0)M=f,b=A;else if(s=i,0===a[i]?m[i*t+t]=0!==f?-A/f:-A/(x*E):(d=m[i*t+i+1],p=m[(i+1)*t+i],y=(u[i]-w)*(u[i]-w)+a[i]*a[i],c=(d*b-M*A)/y,m[i*t+t]=c,m[(i+1)*t+t]=Math.abs(d)>Math.abs(M)?(-A-f*c)/d:(-b-p*c)/M),c=Math.abs(m[i*t+t]),x*c*c>1)for(n=i;t>=n;n++)m[n*t+t]=m[n*t+t]/c}else if(0>y)for(s=t-1,Math.abs(m[t*t+t-1])>Math.abs(m[(t-1)*t+t])?(m[(t-1)*t+(t-1)]=y/m[t*t+t-1],m[(t-1)*t+t]=-(m[t*t+t]-w)/m[t*t+t-1]):(this.cdiv(0,-m[(t-1)*t+t],m[(t-1)*t+(t-1)]-w,y),m[(t-1)*t+(t-1)]=this.cdivr,m[(t-1)*t+t]=this.cdivi),m[t*t+t-1]=0,m[t*t+t]=1,i=t-2;i>=0;i--){var O,I,S,P;for(O=0,I=0,n=s;t>=n;n++)O+=m[i*this.n+n]*m[n*t+t-1],I+=m[i*this.n+n]*m[n*t+t];if(f=m[i*t+i]-w,a[i]<0)M=f,A=O,b=I;else if(s=i,0===a[i]?(this.cdiv(-O,-I,f,y),m[i*t+t-1]=this.cdivr,m[i*t+t]=this.cdivi):(d=m[i*t+i+1],p=m[(i+1)*t+i],S=(u[i]-w)*(u[i]-w)+a[i]*a[i]-y*y,P=2*(u[i]-w)*y,0===S&&0===P&&(S=x*E*(Math.abs(f)+Math.abs(y)+Math.abs(d)+Math.abs(p)+Math.abs(M))),this.cdiv(d*A-M*O+y*I,d*b-M*I-y*O,S,P),m[i*t+t-1]=this.cdivr,m[i*t+t]=this.cdivi,Math.abs(d)>Math.abs(M)+Math.abs(y)?(m[(i+1)*t+t-1]=(-O-f*m[i*t+t-1]+y*m[i*t+t])/d,m[(i+1)*t+t]=(-I-f*m[i*t+t]-y*m[i*t+t-1])/d):(this.cdiv(-A-p*m[i*t+t-1],-b-p*m[i*t+t],M,y),m[(i+1)*t+t-1]=this.cdivr,m[(i+1)*t+t]=this.cdivi)),c=Math.max(Math.abs(m[i*t+t-1]),Math.abs(m[i*t+t])),x*c*c>1)for(n=i;t>=n;n++)m[n*t+t-1]=m[n*t+t-1]/c,m[n*t+t]=m[n*t+t]/c}for(i=0;l>i;i++)if(g>i||i>v)for(n=i;l>n;n++)o[i*this.n+n]=m[i*this.n+n];for(n=l-1;n>=g;n--)for(i=g;v>=i;i++){for(M=0,e=g;e<=Math.min(n,v);e++)M+=o[i*t+e]*m[e*t+n];o[i*this.n+n]=M}}}},e}),n("DOT/LinearFunction",["require","DOT/dot","DOT/Util"],function(t){var i=t("DOT/dot");return t("DOT/Util"),i.LinearFunction=function(t,n,e,s,r){r=_.isUndefined(r)?!1:r;var h=function(t,n,e,s,r,h){var o=i.Util.linear(t,n,e,s,r);if(h){var u=Math.max(e,s),a=Math.min(e,s);o=i.Util.clamp(o,a,u)}return o},o=function(i){return h(t,n,e,s,i,r)};return o.inverse=function(i){return h(e,s,t,n,i,r)},o},i.LinearFunction}),n("DOT/LUDecomposition",["require","DOT/dot"],function(t){var i=t("DOT/dot"),n=window.Float32Array||Array;i.LUDecomposition=function(t){var i,e,s;this.matrix=t,this.LU=t.getArrayCopy();var r=this.LU;this.m=t.getRowDimension();var h=this.m;this.n=t.getColumnDimension();var o=this.n;for(this.piv=new Uint32Array(h),i=0;h>i;i++)this.piv[i]=i;this.pivsign=1;var u=new n(h);for(e=0;o>e;e++){for(i=0;h>i;i++)u[i]=r[t.index(i,e)];for(i=0;h>i;i++){var a=Math.min(i,e),m=0;for(s=0;a>s;s++){var l=t.index(i,s);m+=r[l]*u[s]}u[i]-=m,r[t.index(i,e)]=u[i]}var c=e;for(i=e+1;h>i;i++)Math.abs(u[i])>Math.abs(u[c])&&(c=i);if(c!==e){for(s=0;o>s;s++){var f=t.index(c,s),d=t.index(e,s),p=r[f];r[f]=r[d],r[d]=p}s=this.piv[c],this.piv[c]=this.piv[e],this.piv[e]=s,this.pivsign=-this.pivsign}if(h>e&&0!==r[this.matrix.index(e,e)])for(i=e+1;h>i;i++)r[t.index(i,e)]/=r[t.index(e,e)]}};var e=i.LUDecomposition;return e.prototype={constructor:e,isNonsingular:function(){for(var t=0;t<this.n;t++){var i=this.matrix.index(t,t);if(0===this.LU[i])return!1}return!0},getL:function(){for(var t=new i.Matrix(this.m,this.n),n=0;n<this.m;n++)for(var e=0;e<this.n;e++)t.entries[t.index(n,e)]=n>e?this.LU[this.matrix.index(n,e)]:n===e?1:0;return t},getU:function(){for(var t=new i.Matrix(this.n,this.n),n=0;n<this.n;n++)for(var e=0;e<this.n;e++)t.entries[t.index(n,e)]=e>=n?this.LU[this.matrix.index(n,e)]:0;return t},getPivot:function(){for(var t=new Uint32Array(this.m),i=0;i<this.m;i++)t[i]=this.piv[i];return t},getDoublePivot:function(){for(var t=new n(this.m),i=0;i<this.m;i++)t[i]=this.piv[i];return t},det:function(){if(this.m!==this.n)throw new Error("Matrix must be square.");for(var t=this.pivsign,i=0;i<this.n;i++)t*=this.LU[this.matrix.index(i,i)];return t},solve:function(t){var i,n,e;if(t.getRowDimension()!==this.m)throw new Error("Matrix row dimensions must agree.");if(!this.isNonsingular())throw new Error("Matrix is singular.");var s=t.getColumnDimension(),r=t.getArrayRowMatrix(this.piv,0,s-1);for(e=0;e<this.n;e++)for(i=e+1;i<this.n;i++)for(n=0;s>n;n++)r.entries[r.index(i,n)]-=r.entries[r.index(e,n)]*this.LU[this.matrix.index(i,e)];for(e=this.n-1;e>=0;e--){for(n=0;s>n;n++)r.entries[r.index(e,n)]/=this.LU[this.matrix.index(e,e)];for(i=0;e>i;i++)for(n=0;s>n;n++)r.entries[r.index(i,n)]-=r.entries[r.index(e,n)]*this.LU[this.matrix.index(i,e)]}return r}},e}),n("PHET_CORE/isArray",["require"],function(){return function(t){return"[object Array]"===Object.prototype.toString.call(t)}}),n("DOT/SingularValueDecomposition",["require","DOT/dot"],function(t){var i=t("DOT/dot"),n=window.Float32Array||Array;i.SingularValueDecomposition=function(t){this.matrix=t;var e=t,s=e.getArrayCopy();this.m=e.getRowDimension(),this.n=e.getColumnDimension();var r=this.m,h=this.n,o=Math.min,u=Math.max,a=Math.pow,m=Math.abs,l=o(r,h);this.s=new n(o(r+1,h));var c=this.s;this.U=new n(r*l);var f=this.U;this.V=new n(h*h);var d,p,g,v,x,T,w,y=this.V,A=new n(h),b=new n(r),M=!0,E=!0,D=i.Matrix.hypot,O=o(r-1,h),I=u(0,o(h-2,r));for(g=0;g<u(O,I);g++){if(O>g){for(c[g]=0,d=g;r>d;d++)c[g]=D(c[g],s[d*h+g]);if(0!==c[g]){for(s[g*h+g]<0&&(c[g]=-c[g]),d=g;r>d;d++)s[d*h+g]/=c[g];s[g*h+g]+=1}c[g]=-c[g]}for(p=g+1;h>p;p++){if(O>g&&0!==c[g]){for(v=0,d=g;r>d;d++)v+=s[d*h+g]*s[d*h+p];for(v=-v/s[g*h+g],d=g;r>d;d++)s[d*h+p]+=v*s[d*h+g]}A[p]=s[g*h+p]}if(M&&O>g)for(d=g;r>d;d++)f[d*l+g]=s[d*h+g];if(I>g){for(A[g]=0,d=g+1;h>d;d++)A[g]=D(A[g],A[d]);if(0!==A[g]){for(A[g+1]<0&&(A[g]=-A[g]),d=g+1;h>d;d++)A[d]/=A[g];A[g+1]+=1}if(A[g]=-A[g],r>g+1&&0!==A[g]){for(d=g+1;r>d;d++)b[d]=0;for(p=g+1;h>p;p++)for(d=g+1;r>d;d++)b[d]+=A[p]*s[d*h+p];for(p=g+1;h>p;p++)for(v=-A[p]/A[g+1],d=g+1;r>d;d++)s[d*h+p]+=v*b[d]}if(E)for(d=g+1;h>d;d++)y[d*h+g]=A[d]}}var S=o(h,r+1);if(h>O&&(c[O]=s[O*h+O]),S>r&&(c[S-1]=0),S>I+1&&(A[I]=s[I*h+S-1]),A[S-1]=0,M){for(p=O;l>p;p++){for(d=0;r>d;d++)f[d*l+p]=0;f[p*l+p]=1}for(g=O-1;g>=0;g--)if(0!==c[g]){for(p=g+1;l>p;p++){for(v=0,d=g;r>d;d++)v+=f[d*l+g]*f[d*l+p];for(v=-v/f[g*l+g],d=g;r>d;d++)f[d*l+p]+=v*f[d*l+g]}for(d=g;r>d;d++)f[d*l+g]=-f[d*l+g];for(f[g*l+g]=1+f[g*l+g],d=0;g-1>d;d++)f[d*l+g]=0}else{for(d=0;r>d;d++)f[d*l+g]=0;f[g*l+g]=1}}if(E)for(g=h-1;g>=0;g--){if(I>g&&0!==A[g])for(p=g+1;l>p;p++){for(v=0,d=g+1;h>d;d++)v+=y[d*h+g]*y[d*h+p];for(v=-v/y[(g+1)*h+g],d=g+1;h>d;d++)y[d*h+p]+=v*y[d*h+g]}for(d=0;h>d;d++)y[d*h+g]=0;y[g*h+g]=1}for(var P=S-1,C=0,R=a(2,-52),V=a(2,-966);S>0;){var z;for(g=S-2;g>=-1&&-1!==g;g--)if(m(A[g])<=V+R*(m(c[g])+m(c[g+1]))){A[g]=0;break}if(g===S-2)z=4;else{var Y;for(Y=S-1;Y>=g&&Y!==g;Y--)if(v=(Y!==S?m(A[Y]):0)+(Y!==g+1?m(A[Y-1]):0),m(c[Y])<=V+R*v){c[Y]=0;break}Y===g?z=3:Y===S-1?z=1:(z=2,g=Y)}switch(g++,z){case 1:for(x=A[S-2],A[S-2]=0,p=S-2;p>=g;p--)if(v=D(c[p],x),T=c[p]/v,w=x/v,c[p]=v,p!==g&&(x=-w*A[p-1],A[p-1]=T*A[p-1]),E)for(d=0;h>d;d++)v=T*y[d*h+p]+w*y[d*h+S-1],y[d*h+S-1]=-w*y[d*h+p]+T*y[d*h+S-1],y[d*h+p]=v;break;case 2:for(x=A[g-1],A[g-1]=0,p=g;S>p;p++)if(v=D(c[p],x),T=c[p]/v,w=x/v,c[p]=v,x=-w*A[p],A[p]=T*A[p],M)for(d=0;r>d;d++)v=T*f[d*l+p]+w*f[d*l+g-1],f[d*l+g-1]=-w*f[d*l+p]+T*f[d*l+g-1],f[d*l+p]=v;break;case 3:var L=u(u(u(u(m(c[S-1]),m(c[S-2])),m(A[S-2])),m(c[g])),m(A[g])),N=c[S-1]/L,X=c[S-2]/L,_=A[S-2]/L,q=c[g]/L,H=A[g]/L,k=((X+N)*(X-N)+_*_)/2,F=N*_*N*_,U=0;(0!==k||0!==F)&&(U=Math.sqrt(k*k+F),0>k&&(U=-U),U=F/(k+U)),x=(q+N)*(q-N)+U;var B=q*H;for(p=g;S-1>p;p++){if(v=D(x,B),T=x/v,w=B/v,p!==g&&(A[p-1]=v),x=T*c[p]+w*A[p],A[p]=T*A[p]-w*c[p],B=w*c[p+1],c[p+1]=T*c[p+1],E)for(d=0;h>d;d++)v=T*y[d*h+p]+w*y[d*h+p+1],y[d*h+p+1]=-w*y[d*h+p]+T*y[d*h+p+1],y[d*h+p]=v;if(v=D(x,B),T=x/v,w=B/v,c[p]=v,x=T*A[p]+w*c[p+1],c[p+1]=-w*A[p]+T*c[p+1],B=w*A[p+1],A[p+1]=T*A[p+1],M&&r-1>p)for(d=0;r>d;d++)v=T*f[d*l+p]+w*f[d*l+p+1],f[d*l+p+1]=-w*f[d*l+p]+T*f[d*l+p+1],f[d*l+p]=v}A[S-2]=x,C+=1;break;case 4:if(c[g]<=0&&(c[g]=c[g]<0?-c[g]:0,E))for(d=0;P>=d;d++)y[d*h+g]=-y[d*h+g];for(;P>g&&!(c[g]>=c[g+1]);){if(v=c[g],c[g]=c[g+1],c[g+1]=v,E&&h-1>g)for(d=0;h>d;d++)v=y[d*h+g+1],y[d*h+g+1]=y[d*h+g],y[d*h+g]=v;if(M&&r-1>g)for(d=0;r>d;d++)v=f[d*l+g+1],f[d*l+g+1]=f[d*l+g],f[d*l+g]=v;g++}C=0,S--}}};var e=i.SingularValueDecomposition;e.prototype={constructor:e,getU:function(){return new i.Matrix(this.m,Math.min(this.m+1,this.n),this.U,!0)},getV:function(){return new i.Matrix(this.n,this.n,this.V,!0)},getSingularValues:function(){return this.s},getS:function(){for(var t=new i.Matrix(this.n,this.n),n=0;n<this.n;n++){for(var e=0;e<this.n;e++)t.entries[t.index(n,e)]=0;t.entries[t.index(n,n)]=this.s[n]}return t},norm2:function(){return this.s[0]},cond:function(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]},rank:function(){for(var t=Math.pow(2,-23),i=Math.max(this.m,this.n)*this.s[0]*t,n=0,e=0;e<this.s.length;e++)this.s[e]>i&&n++;return n}}}),n("DOT/QRDecomposition",["require","DOT/dot"],function(t){var i=t("DOT/dot"),n=window.Float32Array||Array;i.QRDecomposition=function(t){this.matrix=t,this.QR=t.getArrayCopy();var e=this.QR;this.m=t.getRowDimension();var s=this.m;this.n=t.getColumnDimension();var r=this.n;this.Rdiag=new n(r);var h,o,u;for(u=0;r>u;u++){var a=0;for(h=u;s>h;h++)a=i.Matrix.hypot(a,e[this.matrix.index(h,u)]);if(0!==a){for(e[this.matrix.index(u,u)]<0&&(a=-a),h=u;s>h;h++)e[this.matrix.index(h,u)]/=a;for(e[this.matrix.index(u,u)]+=1,o=u+1;r>o;o++){var m=0;
for(h=u;s>h;h++)m+=e[this.matrix.index(h,u)]*e[this.matrix.index(h,o)];for(m=-m/e[this.matrix.index(u,u)],h=u;s>h;h++)e[this.matrix.index(h,o)]+=m*e[this.matrix.index(h,u)]}}this.Rdiag[u]=-a}};var e=i.QRDecomposition;return e.prototype={constructor:e,isFullRank:function(){for(var t=0;t<this.n;t++)if(0===this.Rdiag[t])return!1;return!0},getH:function(){for(var t=new i.Matrix(this.m,this.n),n=0;n<this.m;n++)for(var e=0;e<this.n;e++)t.entries[t.index(n,e)]=n>=e?this.QR[this.matrix.index(n,e)]:0;return t},getR:function(){for(var t=new i.Matrix(this.n,this.n),n=0;n<this.n;n++)for(var e=0;e<this.n;e++)t.entries[t.index(n,e)]=e>n?this.QR[this.matrix.index(n,e)]:n===e?this.Rdiag[n]:0;return t},getQ:function(){var t,n,e,s=new i.Matrix(this.m,this.n);for(e=this.n-1;e>=0;e--){for(t=0;t<this.m;t++)s.entries[s.index(t,e)]=0;for(s.entries[s.index(e,e)]=1,n=e;n<this.n;n++)if(0!==this.QR[this.matrix.index(e,e)]){var r=0;for(t=e;t<this.m;t++)r+=this.QR[this.matrix.index(t,e)]*s.entries[s.index(t,n)];for(r=-r/this.QR[this.matrix.index(e,e)],t=e;t<this.m;t++)s.entries[s.index(t,n)]+=r*this.QR[this.matrix.index(t,e)]}}return s},solve:function(t){if(t.getRowDimension()!==this.m)throw new Error("Matrix row dimensions must agree.");if(!this.isFullRank())throw new Error("Matrix is rank deficient.");var n,e,s,r=t.getColumnDimension(),h=t.getArrayCopy();for(s=0;s<this.n;s++)for(e=0;r>e;e++){var o=0;for(n=s;n<this.m;n++)o+=this.QR[this.matrix.index(n,s)]*h[t.index(n,e)];for(o=-o/this.QR[this.matrix.index(s,s)],n=s;n<this.m;n++)h[t.index(n,e)]+=o*this.QR[this.matrix.index(n,s)]}for(s=this.n-1;s>=0;s--){for(e=0;r>e;e++)h[t.index(s,e)]/=this.Rdiag[s];for(n=0;s>n;n++)for(e=0;r>e;e++)h[t.index(n,e)]-=h[t.index(s,e)]*this.QR[this.matrix.index(n,s)]}return new i.Matrix(h,this.n,r).getMatrix(0,this.n-1,0,r-1)}},e}),n("DOT/Matrix",["require","DOT/dot","PHET_CORE/isArray","DOT/SingularValueDecomposition","DOT/LUDecomposition","DOT/QRDecomposition","DOT/EigenvalueDecomposition","DOT/Vector2","DOT/Vector3","DOT/Vector4"],function(t){var i=t("DOT/dot"),n=window.Float32Array||Array,e=t("PHET_CORE/isArray");t("DOT/SingularValueDecomposition"),t("DOT/LUDecomposition"),t("DOT/QRDecomposition"),t("DOT/EigenvalueDecomposition"),t("DOT/Vector2"),t("DOT/Vector3"),t("DOT/Vector4"),i.Matrix=function(t,i,s,r){this.m=t,this.n=i;var h=t*i;this.size=h;var o;if(r)this.entries=s;else if(s||(s=0),this.entries=new n(h),e(s))for(o=0;h>o;o++)this.entries[o]=s[o];else for(o=0;h>o;o++)this.entries[o]=s};var s=i.Matrix;return s.hypot=function(t,i){var n;return Math.abs(t)>Math.abs(i)?(n=i/t,n=Math.abs(t)*Math.sqrt(1+n*n)):0!==i?(n=t/i,n=Math.abs(i)*Math.sqrt(1+n*n)):n=0,n},s.prototype={constructor:s,copy:function(){for(var t=new s(this.m,this.n),i=0;i<this.size;i++)t.entries[i]=this.entries[i];return t},getArray:function(){return this.entries},getArrayCopy:function(){return new n(this.entries)},getRowDimension:function(){return this.m},getColumnDimension:function(){return this.n},index:function(t,i){return t*this.n+i},get:function(t,i){return this.entries[this.index(t,i)]},set:function(t,i,n){this.entries[this.index(t,i)]=n},getMatrix:function(t,i,n,e){for(var r=new s(i-t+1,e-n+1),h=t;i>=h;h++)for(var o=n;e>=o;o++)r.entries[r.index(h-t,o-n)]=this.entries[this.index(h,o)];return r},getArrayRowMatrix:function(t,i,n){for(var e=new s(t.length,n-i+1),r=0;r<t.length;r++)for(var h=i;n>=h;h++)e.entries[e.index(r,h-i)]=this.entries[this.index(t[r],h)];return e},transpose:function(){for(var t=new s(this.n,this.m),i=0;i<this.m;i++)for(var n=0;n<this.n;n++)t.entries[t.index(n,i)]=this.entries[this.index(i,n)];return t},norm1:function(){for(var t=0,i=0;i<this.n;i++){for(var n=0,e=0;e<this.m;e++)n+=Math.abs(this.entries[this.index(e,i)]);t=Math.max(t,n)}return t},norm2:function(){return new i.SingularValueDecomposition(this).norm2()},normInf:function(){for(var t=0,i=0;i<this.m;i++){for(var n=0,e=0;e<this.n;e++)n+=Math.abs(this.entries[this.index(i,e)]);t=Math.max(t,n)}return t},normF:function(){for(var t=0,i=0;i<this.m;i++)for(var n=0;n<this.n;n++)t=s.hypot(t,this.entries[this.index(i,n)]);return t},uminus:function(){for(var t=new s(this.m,this.n),i=0;i<this.m;i++)for(var n=0;n<this.n;n++)t.entries[t.index(i,n)]=-this.entries[this.index(i,n)];return t},plus:function(t){this.checkMatrixDimensions(t);for(var i=new s(this.m,this.n),n=0;n<this.m;n++)for(var e=0;e<this.n;e++){var r=i.index(n,e);i.entries[r]=this.entries[r]+t.entries[r]}return i},plusEquals:function(t){this.checkMatrixDimensions(t);for(var i=new s(this.m,this.n),n=0;n<this.m;n++)for(var e=0;e<this.n;e++){var r=i.index(n,e);this.entries[r]=this.entries[r]+t.entries[r]}return this},minus:function(t){this.checkMatrixDimensions(t);for(var i=new s(this.m,this.n),n=0;n<this.m;n++)for(var e=0;e<this.n;e++){var r=this.index(n,e);i.entries[r]=this.entries[r]-t.entries[r]}return i},minusEquals:function(t){this.checkMatrixDimensions(t);for(var i=0;i<this.m;i++)for(var n=0;n<this.n;n++){var e=this.index(i,n);this.entries[e]=this.entries[e]-t.entries[e]}return this},arrayTimes:function(t){this.checkMatrixDimensions(t);for(var i=new s(this.m,this.n),n=0;n<this.m;n++)for(var e=0;e<this.n;e++){var r=i.index(n,e);i.entries[r]=this.entries[r]*t.entries[r]}return i},arrayTimesEquals:function(t){this.checkMatrixDimensions(t);for(var i=0;i<this.m;i++)for(var n=0;n<this.n;n++){var e=this.index(i,n);this.entries[e]=this.entries[e]*t.entries[e]}return this},arrayRightDivide:function(t){this.checkMatrixDimensions(t);for(var i=new s(this.m,this.n),n=0;n<this.m;n++)for(var e=0;e<this.n;e++){var r=this.index(n,e);i.entries[r]=this.entries[r]/t.entries[r]}return i},arrayRightDivideEquals:function(t){this.checkMatrixDimensions(t);for(var i=0;i<this.m;i++)for(var n=0;n<this.n;n++){var e=this.index(i,n);this.entries[e]=this.entries[e]/t.entries[e]}return this},arrayLeftDivide:function(t){this.checkMatrixDimensions(t);for(var i=new s(this.m,this.n),n=0;n<this.m;n++)for(var e=0;e<this.n;e++){var r=this.index(n,e);i.entries[r]=t.entries[r]/this.entries[r]}return i},arrayLeftDivideEquals:function(t){this.checkMatrixDimensions(t);for(var i=0;i<this.m;i++)for(var n=0;n<this.n;n++){var e=this.index(i,n);this.entries[e]=t.entries[e]/this.entries[e]}return this},times:function(t){var i,e,r,h,o,u;if(t.isMatrix){if(u=t,u.m!==this.n)throw new Error("Matrix inner dimensions must agree.");i=new s(this.m,u.n);var a=new n(this.n);for(r=0;r<u.n;r++){for(h=0;h<this.n;h++)a[h]=u.entries[u.index(h,r)];for(e=0;e<this.m;e++){for(o=0,h=0;h<this.n;h++)o+=this.entries[this.index(e,h)]*a[h];i.entries[i.index(e,r)]=o}}return i}for(o=t,i=new s(this.m,this.n),e=0;e<this.m;e++)for(r=0;r<this.n;r++)i.entries[i.index(e,r)]=o*this.entries[this.index(e,r)];return i},timesEquals:function(t){for(var i=0;i<this.m;i++)for(var n=0;n<this.n;n++){var e=this.index(i,n);this.entries[e]=t*this.entries[e]}return this},solve:function(t){return this.m===this.n?new i.LUDecomposition(this).solve(t):new i.QRDecomposition(this).solve(t)},solveTranspose:function(t){return this.transpose().solve(t.transpose())},inverse:function(){return this.solve(s.identity(this.m,this.m))},det:function(){return new i.LUDecomposition(this).det()},rank:function(){return new i.SingularValueDecomposition(this).rank()},cond:function(){return new i.SingularValueDecomposition(this).cond()},trace:function(){for(var t=0,i=0;i<Math.min(this.m,this.n);i++)t+=this.entries[this.index(i,i)];return t},checkMatrixDimensions:function(t){if(t.m!==this.m||t.n!==this.n)throw new Error("Matrix dimensions must agree.")},toString:function(){var t="";t+="dim: "+this.getRowDimension()+"x"+this.getColumnDimension()+"\n";for(var i=0;i<this.getRowDimension();i++){for(var n=0;n<this.getColumnDimension();n++)t+=this.get(i,n)+" ";t+="\n"}return t},extractVector2:function(t){return new i.Vector2(this.get(0,t),this.get(1,t))},extractVector3:function(t){return new i.Vector3(this.get(0,t),this.get(1,t),this.get(2,t))},extractVector4:function(t){return new i.Vector4(this.get(0,t),this.get(1,t),this.get(2,t),this.get(3,t))},isMatrix:!0},s.identity=function(t,i){for(var n=new s(t,i),e=0;t>e;e++)for(var r=0;i>r;r++)n.entries[n.index(e,r)]=e===r?1:0;return n},s.rowVector2=function(t){return new s(1,2,[t.x,t.y])},s.rowVector3=function(t){return new s(1,3,[t.x,t.y,t.z])},s.rowVector4=function(t){return new s(1,4,[t.x,t.y,t.z,t.w])},s.rowVector=function(t){if(t.isVector2)return s.rowVector2(t);if(t.isVector3)return s.rowVector3(t);if(t.isVector4)return s.rowVector4(t);throw new Error("undetected type of vector: "+t.toString())},s.columnVector2=function(t){return new s(2,1,[t.x,t.y])},s.columnVector3=function(t){return new s(3,1,[t.x,t.y,t.z])},s.columnVector4=function(t){return new s(4,1,[t.x,t.y,t.z,t.w])},s.columnVector=function(t){if(t.isVector2)return s.columnVector2(t);if(t.isVector3)return s.columnVector3(t);if(t.isVector4)return s.columnVector4(t);throw new Error("undetected type of vector: "+t.toString())},s.fromVectors2=function(t){for(var i=2,e=t.length,r=new n(i*e),h=0;e>h;h++){var o=t[h];r[h]=o.x,r[h+e]=o.y}return new s(i,e,r,!0)},s.fromVectors3=function(t){for(var i=3,e=t.length,r=new n(i*e),h=0;e>h;h++){var o=t[h];r[h]=o.x,r[h+e]=o.y,r[h+2*e]=o.z}return new s(i,e,r,!0)},s.fromVectors4=function(t){for(var i=4,e=t.length,r=new n(i*e),h=0;e>h;h++){var o=t[h];r[h]=o.x,r[h+e]=o.y,r[h+2*e]=o.z,r[h+3*e]=o.w}return new s(i,e,r,!0)},s}),n("DOT/Permutation",["require","DOT/dot","PHET_CORE/isArray","DOT/Util"],function(t){function i(t,n,e){if(0===t.length)e.call(void 0,n);else for(var s=0;s<t.length;s++){var r=t[s],h=t.slice(0);h.splice(s,1);var o=n.slice(0);o.push(r),i(h,o,e)}}var n=t("DOT/dot"),e=t("PHET_CORE/isArray");t("DOT/Util");var s=function(t){this.indices=t};return s.identity=function(t){for(var i=new Array(t),n=0;t>n;n++)i[n]=n;return new s(i)},s.permutations=function(t){var i=[];return s.forEachPermutation(n.rangeInclusive(0,t-1),function(t){i.push(new s(t))}),i},s.forEachPermutation=function(t,n){i(t,[],n)},s.prototype={constructor:s,size:function(){return this.indices.length},apply:function(t){if(e(t)){if(t.length!==this.size())throw new Error("Permutation length "+this.size()+" not equal to list length "+t.length);for(var i=new Array(t.length),n=0;n<t.length;n++)i[n]=t[this.indices[n]];return i}return this.indices[t]},inverted:function(){for(var t=new Array(this.size()),i=0;i<this.size();i++)t[this.indices[i]]=i;return new s(t)},withIndicesPermuted:function(t){var i=[],n=this;return s.forEachPermutation(t,function(e){for(var r=n.indices,h=r.slice(0),o=0;o<t.length;o++)h[t[o]]=r[e[o]];i.push(new s(h))}),i},toString:function(){return"P["+this.indices.join(", ")+"]"}},s.testMe=function(t){var i=new s([1,4,3,2,0]);t.log(i.toString());var n=i.inverted();t.log(n.toString()),t.log(n.withIndicesPermuted([0,3,4]).toString()),t.log(s.permutations(4).toString())},s}),n("DOT/Ray3",["require","DOT/dot"],function(t){var i=t("DOT/dot");i.Ray3=function(t,i){this.pos=t,this.dir=i};var n=i.Ray3;return n.prototype={constructor:n,shifted:function(t){return new n(this.pointAtDistance(t),this.dir)},pointAtDistance:function(t){return this.pos.plus(this.dir.timesScalar(t))},toString:function(){return this.pos.toString()+" => "+this.dir.toString()}},n}),n("DOT/Rectangle",["require","DOT/dot","PHET_CORE/inherit","DOT/Bounds2"],function(t){var i=t("DOT/dot"),n=t("PHET_CORE/inherit"),e=t("DOT/Bounds2");i.Rectangle=function(t,i,n,s){e.call(this,t,i,t+n,i+s)};var s=i.Rectangle;return n(e,s),s}),n("DOT/Transform4",["require","DOT/dot","DOT/Matrix4","DOT/Vector3","DOT/Ray3"],function(t){var i=t("DOT/dot");t("DOT/Matrix4"),t("DOT/Vector3"),t("DOT/Ray3"),i.Transform4=function(t){this.set(void 0===t?i.Matrix4.IDENTITY:t)};var n=i.Transform4;return n.prototype={constructor:n,set:function(t){this.matrix=t,this.inverse=null,this.matrixTransposed=null,this.inverseTransposed=null},getMatrix:function(){return this.matrix},getInverse:function(){return null===this.inverse&&(this.inverse=this.matrix.inverted()),this.inverse},getMatrixTransposed:function(){return null===this.matrixTransposed&&(this.matrixTransposed=this.matrix.transposed()),this.matrixTransposed},getInverseTransposed:function(){return null===this.inverseTransposed&&(this.inverseTransposed=this.getInverse().transposed()),this.inverseTransposed},prepend:function(t){this.set(t.timesMatrix(this.matrix))},append:function(t){this.set(this.matrix.timesMatrix(t))},prependTransform:function(t){this.prepend(t.matrix)},appendTransform:function(t){this.append(t.matrix)},isIdentity:function(){return this.matrix.type===i.Matrix4.Types.IDENTITY},applyToCanvasContext:function(t){t.setTransform(this.matrix.m00(),this.matrix.m10(),this.matrix.m01(),this.matrix.m11(),this.matrix.m03(),this.matrix.m13())},transformPosition3:function(t){return this.matrix.timesVector3(t)},transformDelta3:function(t){return this.matrix.timesRelativeVector3(t)},transformNormal3:function(t){return this.getInverse().timesTransposeVector3(t)},transformDeltaX:function(t){return this.transformDelta3(new i.Vector3(t,0,0)).x},transformDeltaY:function(t){return this.transformDelta3(new i.Vector3(0,t,0)).y},transformDeltaZ:function(t){return this.transformDelta3(new i.Vector3(0,0,t)).z},transformRay:function(t){return new i.Ray3(this.transformPosition3(t.pos),this.transformPosition3(t.pos.plus(t.dir)).minus(this.transformPosition3(t.pos)))},inversePosition3:function(t){return this.getInverse().timesVector3(t)},inverseDelta3:function(t){return this.inversePosition3(t).minus(this.inversePosition3(i.Vector3.ZERO))},inverseNormal3:function(t){return this.matrix.timesTransposeVector3(t)},inverseDeltaX:function(t){return this.inverseDelta3(new i.Vector3(t,0,0)).x},inverseDeltaY:function(t){return this.inverseDelta3(new i.Vector3(0,t,0)).y},inverseDeltaZ:function(t){return this.inverseDelta3(new i.Vector3(0,0,t)).z},inverseRay:function(t){return new i.Ray3(this.inversePosition3(t.pos),this.inversePosition3(t.pos.plus(t.dir)).minus(this.inversePosition3(t.pos)))}},n}),n("DOT/main",["DOT/dot","DOT/Bounds2","DOT/Complex","DOT/ConvexHull2","DOT/Dimension2","DOT/EigenvalueDecomposition","DOT/LinearFunction","DOT/LUDecomposition","DOT/Matrix","DOT/Matrix3","DOT/Matrix4","DOT/Permutation","DOT/QRDecomposition","DOT/Ray2","DOT/Ray3","DOT/Rectangle","DOT/SingularValueDecomposition","DOT/Transform3","DOT/Transform4","DOT/Util","DOT/Vector2","DOT/Vector3","DOT/Vector4"],function(t){return t}),n("PHET_CORE/callSuper",["require"],function(){function t(t,i,n){!function(){var n=t.prototype[i];Function.call.apply(n,arguments)}(n)}return t}),n("PHET_CORE/collect",["require"],function(){return function(t){var i=[];return t(function(t){i.push(t)}),i}}),n("PHET_CORE/escapeHTML",["require"],function(){return function(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;").replace(/\'/g,"&#x27;").replace(/\//g,"&#x2F;")}}),n("PHET_CORE/inheritPrototype",["require"],function(){function t(t,i){var n=Object(i.prototype);n.constructor=t,t.prototype=n}return t}),n("PHET_CORE/loadScript",["require"],function(){return function(t){"string"==typeof t&&(t={src:t});var i=t.src,n=t.callback,e=void 0===t.async?!0:t.async,s=void 0===t.cacheBuster?!1:t.cacheBuster,r=!1,h=document.createElement("script");h.type="text/javascript",h.async=e,h.onload=h.onreadystatechange=function(){var t=this.readyState;t&&"complete"!==t&&"loaded"!==t||r||(r=!0,n&&n())},h.src=i+(s?"?random="+Math.random().toFixed(10):"");var o=document.getElementsByTagName("script")[0];o.parentNode.insertBefore(h,o)}}),n("PHET_CORE/main",["require","PHET_CORE/callSuper","PHET_CORE/collect","PHET_CORE/escapeHTML","PHET_CORE/inherit","PHET_CORE/inheritPrototype","PHET_CORE/isArray","PHET_CORE/extend","PHET_CORE/loadScript","PHET_CORE/phetAllocation","PHET_CORE/Poolable"],function(t){return{callSuper:t("PHET_CORE/callSuper"),collect:t("PHET_CORE/collect"),escapeHTML:t("PHET_CORE/escapeHTML"),inherit:t("PHET_CORE/inherit"),inheritPrototype:t("PHET_CORE/inheritPrototype"),isArray:t("PHET_CORE/isArray"),extend:t("PHET_CORE/extend"),loadScript:t("PHET_CORE/loadScript"),phetAllocation:t("PHET_CORE/phetAllocation"),Poolable:t("PHET_CORE/Poolable")}}),window.has&&(window.has.add("assert.kite",function(){return!1}),window.has.add("assert.kite.extra",function(){return!1})),window.loadedKiteConfig=!0,i.config({deps:["main","DOT/main","PHET_CORE/main"],paths:{underscore:"../../sherpa/lodash-2.0.0",KITE:".",DOT:"../../dot/js",PHET_CORE:"../../phet-core/js",ASSERT:"../../assert/js"},shim:{underscore:{exports:"_"}},urlArgs:(new Date).getTime()}),n("production-config",function(){}),window.kite=i("main"),window.dot=i("DOT/main"),window.core=i("PHET_CORE/main")}();
//# sourceMappingURL=kite.min.js.map