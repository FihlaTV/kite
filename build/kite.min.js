!function(){if(!window.hasOwnProperty("_"))throw new Error("Underscore/Lodash not found: _");!function(){"use strict";window.assertions=window.assertions||{},window.assertions.assertFunction=window.assertions.assertFunction||function(t,e){if(!t){if(window.navigator&&"Microsoft Internet Explorer"===window.navigator.appName)try{throw new Error}catch(t){e=e+", stack=\n"+t.stack}var i=e?"Assertion failed: "+e:"Assertion failed";throw console&&console.log&&console.log(i),new Error(i)}},window.assert=window.assert||null,window.assertSlow=window.assertSlow||null,window.assertions.enableAssert=function(){window.assert=window.assertions.assertFunction,window.console&&window.console.log&&window.console.log("enabling assert")},window.assertions.disableAssert=function(){window.assert=null,window.console&&window.console.log&&window.console.log("disabling assert")},window.assertions.enableAssertSlow=function(){window.assertSlow=window.assertions.assertFunction,window.console&&window.console.log&&window.console.log("enabling assertSlow")},window.assertions.disableAssertSlow=function(){window.assertSlow=null,window.console&&window.console.log&&window.console.log("disabling assertSlow")}}(),function(){"use strict";window.phetio=window.phetio||{};window.phetio.PhetioIDUtils={append:function(t,e){return t+"."+e},getComponentName:function(t){var e=t.lastIndexOf(".");return-1===e?t:t.substring(e+1,t.length)},getParentID:function(t){var e=t.lastIndexOf(".");return t.substring(0,e)},getDOMElementID:function(t){return"phetioID:"+t},SEPARATOR:"."}}();var t,e,i;!function(n){function s(t,e){return x.call(t,e)}function r(t,e){var i,n,s,r,a,o,h,u,l,c,m,d=e&&e.split("/"),f=p.map,g=f&&f["*"]||{};if(t&&"."===t.charAt(0))if(e){for(d=d.slice(0,d.length-1),a=(t=t.split("/")).length-1,p.nodeIdCompat&&y.test(t[a])&&(t[a]=t[a].replace(y,"")),t=d.concat(t),l=0;l<t.length;l+=1)if("."===(m=t[l]))t.splice(l,1),l-=1;else if(".."===m){if(1===l&&(".."===t[2]||".."===t[0]))break;l>0&&(t.splice(l-1,2),l-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((d||g)&&f){for(l=(i=t.split("/")).length;l>0;l-=1){if(n=i.slice(0,l).join("/"),d)for(c=d.length;c>0;c-=1)if((s=f[d.slice(0,c).join("/")])&&(s=s[n])){r=s,o=l;break}if(r)break;!h&&g&&g[n]&&(h=g[n],u=l)}!r&&h&&(r=h,o=u),r&&(i.splice(0,o,r),t=i.join("/"))}return t}function a(t,e){return function(){return c.apply(n,T.call(arguments,0).concat([t,e]))}}function o(t){return function(e){f[t]=e}}function h(t){if(s(g,t)){var e=g[t];delete g[t],v[t]=!0,l.apply(n,e)}if(!s(f,t)&&!s(v,t))throw new Error("No "+t);return f[t]}function u(t){var e,i=t?t.indexOf("!"):-1;return i>-1&&(e=t.substring(0,i),t=t.substring(i+1,t.length)),[e,t]}var l,c,m,d,f={},g={},p={},v={},x=Object.prototype.hasOwnProperty,T=[].slice,y=/\.js$/;m=function(t,e){var i,n=u(t),s=n[0];return t=n[1],s&&(i=h(s=r(s,e))),s?t=i&&i.normalize?i.normalize(t,function(t){return function(e){return r(e,t)}}(e)):r(t,e):(s=(n=u(t=r(t,e)))[0],t=n[1],s&&(i=h(s))),{f:s?s+"!"+t:t,n:t,pr:s,p:i}},d={require:function(t){return a(t)},exports:function(t){var e=f[t];return void 0!==e?e:f[t]={}},module:function(t){return{id:t,uri:"",exports:f[t],config:function(t){return function(){return p&&p.config&&p.config[t]||{}}}(t)}}},l=function(t,e,i,r){var u,l,c,p,x,T,y=[],_=typeof i;if(r=r||t,"undefined"===_||"function"===_){for(e=!e.length&&i.length?["require","exports","module"]:e,x=0;x<e.length;x+=1)if(p=m(e[x],r),"require"===(l=p.f))y[x]=d.require(t);else if("exports"===l)y[x]=d.exports(t),T=!0;else if("module"===l)u=y[x]=d.module(t);else if(s(f,l)||s(g,l)||s(v,l))y[x]=h(l);else{if(!p.p)throw new Error(t+" missing "+l);p.p.load(p.n,a(r,!0),o(l),{}),y[x]=f[l]}c=i?i.apply(f[t],y):void 0,t&&(u&&u.exports!==n&&u.exports!==f[t]?f[t]=u.exports:c===n&&T||(f[t]=c))}else t&&(f[t]=i)},t=e=c=function(t,e,i,s,r){if("string"==typeof t)return d[t]?d[t](e):h(m(t,e).f);if(!t.splice){if((p=t).deps&&c(p.deps,p.callback),!e)return;e.splice?(t=e,e=i,i=null):t=n}return e=e||function(){},"function"==typeof i&&(i=s,s=r),s?l(n,t,e,i):setTimeout(function(){l(n,t,e,i)},4),c},c.config=function(t){return c(t)},t._defined=f,(i=function(t,e,i){e.splice||(i=e,e=[]),s(f,t)||s(g,t)||(g[t]=[t,e,i])}).amd={jQuery:!0}}(),i("almond",function(){}),i("PHET_CORE/Namespace",["require"],function(t){"use strict";function e(t){this.name=t,window.phet&&(window.phet[t]=this)}return e.prototype={constructor:e,register:function(t,e){if(t.indexOf(".")<0)this[t]=e;else{for(var i=t.split("."),n=this,s=0;s<i.length-1;s++)n=n[i[s]];var r=i[i.length-1];n[r]=e}return e}},e}),i("AXON/axon",["require","PHET_CORE/Namespace"],function(t){"use strict";return new(t("PHET_CORE/Namespace"))("axon")}),i("PHET_CORE/phetCore",["require","PHET_CORE/Namespace"],function(t){"use strict";var e=t("PHET_CORE/Namespace"),i=new e("phetCore");return i.register("Namespace",e),i}),i("PHET_CORE/extend",["require","PHET_CORE/phetCore"],function(t){"use strict";function e(t){return _.each(Array.prototype.slice.call(arguments,1),function(e){if(e)for(var i in e)Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(e,i))}),t}return t("PHET_CORE/phetCore").register("extend",e),e}),i("PHET_CORE/inherit",["require","PHET_CORE/extend","PHET_CORE/phetCore"],function(t){"use strict";function e(t,e,n,s){function r(){}return r.prototype=t.prototype,e.prototype=i(new r,{constructor:e},n),i(e,s),e}var i=t("PHET_CORE/extend");return t("PHET_CORE/phetCore").register("inherit",e),e}),i("ifphetio",["require"],function(t){"use strict";var e={};return{load:function(i,n,s,r){if(r.isBuild){var a=n.toUrl(i);!1===/\.js$/.test(a)&&(a+=".js"),global.phet&&global.phet.chipper&&"phet-io"===global.phet.chipper.brand?(e[i]={content:global.phet.chipper.grunt.file.read(a),attach:t.attach},n([i],s)):s()}else{if("phet-io"===(window.phet&&window.phet.chipper&&window.phet.chipper.brand))n([i],s);else{var o=function(){};"PHET_IO/phetioEvents"===i&&(o.start=function(){},o.end=function(){}),s(o)}}},write:function(t,i,n){var s=null;global.phet&&global.phet.chipper&&"phet-io"===global.phet.chipper.brand?(s='define("'+i+'", function(){'+e[i].content+"});",n.asModule(i,s,e[i].content)):n(s="PHET_IO/phetioEvents"===i?'define("'+i+'", function(){return function(){ var f = function() {}; f.start = function() {}; f.end = function() {}; return f; };});':'define("'+i+'", function(){return function(){ return function(){}; };});')}}}),i("PHET_IO/assertInstanceOf",function(){return function(){return function(){}}}),i("PHET_IO/types/FunctionIO",function(){return function(){return function(){}}}),i("PHET_IO/types/ObjectIO",function(){return function(){return function(){}}}),i("PHET_IO/phetioInherit",function(){return function(){return function(){}}}),i("PHET_IO/types/VoidIO",function(){return function(){return function(){}}}),i("AXON/EmitterIO",["require","AXON/axon","ifphetio!PHET_IO/assertInstanceOf","ifphetio!PHET_IO/types/FunctionIO","ifphetio!PHET_IO/types/ObjectIO","ifphetio!PHET_IO/phetioInherit","ifphetio!PHET_IO/types/VoidIO"],function(t){"use strict";function e(t){return r(s,"EmitterIO",function(t,e){s.call(this,t,e)},{addListener:{returnType:a,parameterTypes:[n(a,t)],implementation:function(t){this.instance.addListener(t)},documentation:"Add a listener which will be called when the emitter emits."},emit:{returnType:a,parameterTypes:[],implementation:function(){this.instance.emit()},documentation:"Emit a single event with no arguments to all added listeners.",canBeInvokedForReadOnlyInstances:!1}},{documentation:"Emitters indicate when events have occurred, with optional arguments describing the event",events:["emitted"],parameterTypes:t})}var i=t("AXON/axon"),n=(t("ifphetio!PHET_IO/assertInstanceOf"),t("ifphetio!PHET_IO/types/FunctionIO")),s=t("ifphetio!PHET_IO/types/ObjectIO"),r=t("ifphetio!PHET_IO/phetioInherit"),a=t("ifphetio!PHET_IO/types/VoidIO");return i.register("EmitterIO",e),e}),i("TANDEM/tandemNamespace",["require","PHET_CORE/Namespace"],function(t){"use strict";return new(t("PHET_CORE/Namespace"))("tandem")}),i("PHET_CORE/toCamelCase",["require","PHET_CORE/phetCore"],function(t){"use strict";function e(t){return t.toLowerCase().replace(/-(.)/g,function(t,e){return e.toUpperCase()})}return t("PHET_CORE/phetCore").register("toCamelCase",e),e}),i("text",["module"],function(t){"use strict";var i,n,s,r,a,o=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],h=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,u=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,l="undefined"!=typeof location&&location.href,c=l&&location.protocol&&location.protocol.replace(/\:/,""),m=l&&location.hostname,d=l&&(location.port||void 0),f={},g=t.config&&t.config()||{};return i={version:"2.0.12",strip:function(t){if(t){var e=(t=t.replace(h,"")).match(u);e&&(t=e[1])}else t="";return t},jsEscape:function(t){return t.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:g.createXhr||function(){var t,e,i;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(e=0;e<3;e+=1){i=o[e];try{t=new ActiveXObject(i)}catch(t){}if(t){o=[i];break}}return t},parseName:function(t){var e,i,n,s=!1,r=t.indexOf("."),a=0===t.indexOf("./")||0===t.indexOf("../");return-1!==r&&(!a||r>1)?(e=t.substring(0,r),i=t.substring(r+1,t.length)):e=t,n=i||e,-1!==(r=n.indexOf("!"))&&(s="strip"===n.substring(r+1),n=n.substring(0,r),i?i=n:e=n),{moduleName:e,ext:i,strip:s}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(t,e,n,s){var r,a,o,h=i.xdRegExp.exec(t);return!h||(r=h[2],a=h[3],a=a.split(":"),o=a[1],a=a[0],!(r&&r!==e||a&&a.toLowerCase()!==n.toLowerCase()||(o||a)&&o!==s))},finishLoad:function(t,e,n,s){n=e?i.strip(n):n,g.isBuild&&(f[t]=n),s(n)},load:function(t,e,n,s){if(s&&s.isBuild&&!s.inlineText)n();else{g.isBuild=s&&s.isBuild;var r=i.parseName(t),a=r.moduleName+(r.ext?"."+r.ext:""),o=e.toUrl(a),h=g.useXhr||i.useXhr;0!==o.indexOf("empty:")?!l||h(o,c,m,d)?i.get(o,function(e){i.finishLoad(t,r.strip,e,n)},function(t){n.error&&n.error(t)}):e([a],function(t){i.finishLoad(r.moduleName+"."+r.ext,r.strip,t,n)}):n()}},write:function(t,e,n,s){if(f.hasOwnProperty(e)){var r=i.jsEscape(f[e]);n.asModule(t+"!"+e,"define(function () { return '"+r+"';});\n")}},writeFile:function(t,e,n,s,r){var a=i.parseName(e),o=a.ext?"."+a.ext:"",h=a.moduleName+o,u=n.toUrl(a.moduleName+o)+".js";i.load(h,n,function(e){var n=function(t){return s(u,t)};n.asModule=function(t,e){return s.asModule(t,u,e)},i.write(t,h,n,r)},r)}},"node"===g.env||!g.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]?(n=e.nodeRequire("fs"),i.get=function(t,e,i){try{var s=n.readFileSync(t,"utf8");0===s.indexOf("\ufeff")&&(s=s.substring(1)),e(s)}catch(t){i&&i(t)}}):"xhr"===g.env||!g.env&&i.createXhr()?i.get=function(t,e,n,s){var r,a=i.createXhr();if(a.open("GET",t,!0),s)for(r in s)s.hasOwnProperty(r)&&a.setRequestHeader(r.toLowerCase(),s[r]);g.onXhr&&g.onXhr(a,t),a.onreadystatechange=function(i){var s,r;4===a.readyState&&((s=a.status||0)>399&&s<600?((r=new Error(t+" HTTP status: "+s)).xhr=a,n&&n(r)):e(a.responseText),g.onXhrComplete&&g.onXhrComplete(a,t))},a.send(null)}:"rhino"===g.env||!g.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?i.get=function(t,e){var i,n,s=new java.io.File(t),r=java.lang.System.getProperty("line.separator"),a=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),"utf-8")),o="";try{for(i=new java.lang.StringBuffer,(n=a.readLine())&&n.length()&&65279===n.charAt(0)&&(n=n.substring(1)),null!==n&&i.append(n);null!==(n=a.readLine());)i.append(r),i.append(n);o=String(i.toString())}finally{a.close()}e(o)}:("xpconnect"===g.env||!g.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(s=Components.classes,r=Components.interfaces,Components.utils.import("resource://gre/modules/FileUtils.jsm"),a="@mozilla.org/windows-registry-key;1"in s,i.get=function(t,e){var i,n,o,h={};a&&(t=t.replace(/\//g,"\\")),o=new FileUtils.File(t);try{(i=s["@mozilla.org/network/file-input-stream;1"].createInstance(r.nsIFileInputStream)).init(o,1,0,!1),(n=s["@mozilla.org/intl/converter-input-stream;1"].createInstance(r.nsIConverterInputStream)).init(i,"utf-8",i.available(),r.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),n.readString(i.available(),h),n.close(),i.close(),e(h.value)}catch(t){throw new Error((o&&o.path||"")+": "+t)}}),i}),i("text!REPOSITORY/package.json",[],function(){return'{\n  "name": "kite",\n  "version": "0.0.0",\n  "license": "MIT",\n  "repository": {\n    "type": "git",\n    "url": "https://github.com/phetsims/kite.git"\n  },\n  "devDependencies": {\n    "grunt": "~1.0.0",\n    "pegjs": "0.7.0"\n  },\n  "phet": {\n    "generatedUnitTests": true,\n    "requirejsNamespace": "KITE",\n    "buildStandalone": true,\n    "isJSOnly": true,\n    "requiresLodash": true,\n    "assignGlobals": {\n      "kite": "KITE/main",\n      "dot": "DOT/main",\n      "axon": "AXON/main",\n      "phetCore": "PHET_CORE/main"\n    }\n  }\n}\n'}),i("TANDEM/Tandem",["require","PHET_CORE/inherit","TANDEM/tandemNamespace","PHET_CORE/toCamelCase","text!REPOSITORY/package.json"],function(t){"use strict";function e(t,e){e=_.extend({enabled:!0,supplied:!0,required:!0},e),this.phetioID=void 0!==t?t:"",this.required=e.required,this.supplied=e.supplied,this.enabled=e.enabled}function i(t){e.call(this,t),this.groupElementIndex=0}var n=t("PHET_CORE/inherit"),s=t("TANDEM/tandemNamespace"),r=t("PHET_CORE/toCamelCase"),a=t("text!REPOSITORY/package.json"),o=JSON.parse(a),h=!(!window.phet||!window.phet.phetio),u=[],l=!1,c=[],m=0;return s.register("Tandem",e),n(Object,e,{addInstance:function(t){if(h&&this.enabled){if(phet.phetio.queryParameters.phetioValidateTandems,phet.phetio.queryParameters.printMissingTandems&&this.required&&!this.supplied&&console.log("Required Tandem not supplied.\nthis.phetioID = "+this.phetioID+"\nStack trace: "+(new Error).stack),!this.required&&!this.supplied){if(phet.phetio.queryParameters.printMissingTandems){var e=(new Error).stack;-1===e.indexOf("PhetFont")&&console.log("Optional Tandem not supplied.\nthis.phetioID = "+this.phetioID+"\nStack trace: "+e)}return}if(l)for(var i=0;i<u.length;i++)u[i].addInstance(t);else c.push(t)}},removeInstance:function(t){if((this.required||this.supplied)&&h&&this.enabled)for(var e=0;e<u.length;e++)u[e].removeInstance(t)},createTandem:function(t,i){var n=this.phetioID.length>0?phetio.PhetioIDUtils.append(this.phetioID,t):t;return i=_.extend({enabled:this.enabled,supplied:this.supplied,required:this.required},i),new e(n,i)},createGroupTandem:function(t){return new i(phetio.PhetioIDUtils.append(this.phetioID,t))},get tail(){return phetio.PhetioIDUtils.getComponentName(this.phetioID)},get parentTandem(){return new e(phetio.PhetioIDUtils.getParentID(this.phetioID),{required:this.required,supplied:this.supplied,enabled:this.enabled})},isSuppliedAndEnabled:function(){return this.supplied&&h}},{addInstanceListener:function(t){u.push(t)},launch:function(){for(l=!0;c.length>0;){var t=c.shift();t.tandem.addInstance(t)}},disallowTandem:function(t){e.validationEnabled()},indicateUninstrumentedCode:function(){if(h&&(phet.phetio.queryParameters.phetioValidateTandems,phet.phetio.queryParameters.printMissingTandems)){var t=(new Error).stack;console.log("Uninstrumented Code! Tandem not supplied: "+m+++".\nStack trace: "+t)}},validationEnabled:function(){return h&&phet.phetio.queryParameters.phetioValidateTandems}}),e.rootTandem=new e(r(o.name)),e.optional=e.rootTandem.createTandem("optionalTandem",{required:!1,supplied:!1}),e.required=e.rootTandem.createTandem("requiredTandem",{required:!0,supplied:!1}),s.register("Tandem.GroupTandem",i),n(e,i,{createNextTandem:function(){return new e(this.phetioID+"_"+this.groupElementIndex++)}}),e}),i("PHET_IO/phetioEvents",function(){return function(){var t=function(){};return t.start=function(){},t.end=function(){},t}}),i("TANDEM/PhetioObject",["require","PHET_CORE/inherit","TANDEM/tandemNamespace","TANDEM/Tandem","ifphetio!PHET_IO/types/ObjectIO","ifphetio!PHET_IO/phetioEvents"],function(t){"use strict";function e(t){this.tandem=null,this.phetioType=null,this.phetioState=null,this.phetioReadOnly=null,this.phetioInstanceDocumentation=null,this.phetioWrapper=null,this.phetioObjectInitialized=!1,this.phetioMessageStack=[],this.phetioObjectDisposed=!1,this.phetioEventType=null,t&&this.initializePhetioObject({},t)}var i=t("PHET_CORE/inherit"),n=t("TANDEM/tandemNamespace"),s=t("TANDEM/Tandem"),r=t("ifphetio!PHET_IO/types/ObjectIO"),a=t("ifphetio!PHET_IO/phetioEvents"),o=!(!window.phet||!window.phet.phetio),h={tandem:s.optional,phetioType:r,phetioState:!0,phetioReadOnly:!1,phetioInstanceDocumentation:null,phetioEventType:"model"},u={highFrequencyEvent:!1},l=_.keys(h);return n.register("PhetioObject",e),i(Object,e,{initializePhetioObject:function(t,e){if(0!==_.intersection(_.keys(e),l).length){e=_.extend({},h,t,e),this.tandem=e.tandem,this.phetioType=e.phetioType,this.phetioState=e.phetioState,this.phetioReadOnly=e.phetioReadOnly,this.phetioEventType=e.phetioEventType,this.phetioInstanceDocumentation=e.phetioInstanceDocumentation,o&&this.tandem.enabled&&this.tandem.supplied&&(this.phetioWrapper=new this.phetioType(this,this.tandem.phetioID)),this.tandem.addInstance(this),this.phetioObjectInitialized=!0}},phetioStartEvent:function(t,e,i){var n=(i=i||u).phetioEventType||this.phetioEventType;i.phetioEventType&&delete i.phetioEventType,window.phet&&window.phet.phetio&&!window.phet.phetio.queryParameters.phetioEmitHighFrequencyEvents&&i.highFrequency?this.phetioMessageStack.push(-1):this.tandem.isSuppliedAndEnabled()&&this.phetioMessageStack.push(a.start(n,this,t,e))},phetioEndEvent:function(){var t=this.phetioMessageStack.pop();-1!==t&&this.tandem.isSuppliedAndEnabled()&&a.end(t)},dispose:function(){this.phetioObjectInitialized&&(this.tandem.removeInstance(this),this.phetioWrapper&&this.phetioWrapper.dispose&&this.phetioWrapper.dispose()),this.phetioObjectDisposed=!0}},{DEFAULT_OPTIONS:h})}),i("AXON/Emitter",["require","AXON/axon","AXON/EmitterIO","PHET_CORE/inherit","TANDEM/PhetioObject","TANDEM/Tandem"],function(t){"use strict";function e(t){t=_.extend({tandem:a.optional,phetioState:!1,phetioType:n([])},t),this.listeners=[],this.activeListenersStack=[],r.call(this,t)}var i=t("AXON/axon"),n=t("AXON/EmitterIO"),s=t("PHET_CORE/inherit"),r=t("TANDEM/PhetioObject"),a=t("TANDEM/Tandem");return i.register("Emitter",e),s(r,e,{dispose:function(){this.listeners.length=0,r.prototype.dispose.call(this)},addListener:function(t){this.defendListeners(),this.listeners.push(t)},removeListener:function(t){var e=this.listeners.indexOf(t);this.defendListeners(),this.listeners.splice(e,1)},removeAllListeners:function(){for(;this.listeners.length>0;)this.removeListener(this.listeners[0])},defendListeners:function(){for(var t=this.activeListenersStack.length-1;t>=0&&!this.activeListenersStack[t].defended;t--){var e=this.listeners.slice();e.defended=!0,this.activeListenersStack[t]=e}},emit:function(){this.phetioStartEvent("emitted"),this.activeListenersStack.push(this.listeners);for(var t=this.activeListenersStack.length-1,e=0;e<this.activeListenersStack[t].length;e++)this.activeListenersStack[t][e]();this.activeListenersStack.pop(),this.phetioEndEvent()},emit1:function(t){this.tandem.isSuppliedAndEnabled()&&this.phetioStartEvent("emitted",{args:[this.phetioType.parameterTypes[0].toStateObject(t)]}),this.activeListenersStack.push(this.listeners);for(var e=this.activeListenersStack.length-1,i=0;i<this.activeListenersStack[e].length;i++)this.activeListenersStack[e][i](t);this.activeListenersStack.pop(),this.tandem.isSuppliedAndEnabled()&&this.phetioEndEvent()},emit2:function(t,e){this.tandem.isSuppliedAndEnabled()&&this.phetioStartEvent("emitted",{args:[this.phetioType.parameterTypes[0].toStateObject(t),this.phetioType.parameterTypes[1].toStateObject(e)]}),this.activeListenersStack.push(this.listeners);for(var i=this.activeListenersStack.length-1,n=0;n<this.activeListenersStack[i].length;n++)this.activeListenersStack[i][n](t,e);this.activeListenersStack.pop(),this.tandem.isSuppliedAndEnabled()&&this.phetioEndEvent()},emit3:function(t,e,i){this.tandem.isSuppliedAndEnabled()&&this.phetioStartEvent("emitted",{args:[this.phetioType.parameterTypes[0].toStateObject(t),this.phetioType.parameterTypes[1].toStateObject(e),this.phetioType.parameterTypes[2].toStateObject(i)]}),this.activeListenersStack.push(this.listeners);for(var n=this.activeListenersStack.length-1,s=0;s<this.activeListenersStack[n].length;s++)this.activeListenersStack[n][s](t,e,i);this.activeListenersStack.pop(),this.tandem.isSuppliedAndEnabled()&&this.phetioEndEvent()},hasListener:function(t){return this.listeners.indexOf(t)>=0},hasListeners:function(){return this.listeners.length>0},getListenerCount:function(){return this.listeners.length}})}),i("AXON/Multilink",["require","AXON/axon","PHET_CORE/inherit"],function(t){"use strict";function e(t,e,i){this.dependencies=t,this.dependencyValues=t.map(function(t){return t.get()});var n=this;this.dependencyListeners=[],t.forEach(function(t,i){var s=function(t){n.dependencyValues[i]=t,e.apply(null,n.dependencyValues)};n.dependencyListeners.push(s),t.lazyLink(s)}),i||e.apply(null,this.dependencyValues)}var i=t("AXON/axon"),n=t("PHET_CORE/inherit");return i.register("Multilink",e),n(Object,e,{dispose:function(){for(var t=0;t<this.dependencies.length;t++)this.dependencies[t].unlink(this.dependencyListeners[t]);this.dependencies=null,this.dependencyListeners=null,this.dependencyValues=null}})}),i("AXON/units",["require","AXON/axon"],function(t){"use strict";var e={values:["amperes","milliamperes","becquerels","centimeters","centimeters-squared","coulombs","degrees Celsius","farads","kilograms","grams","gray","henrys","henries","hertz","joules","katals","kelvins","liters","liters/second","lumens","lux","meters","meters/second","meters/second/second","moles","moles/liter","nanometers","newtons","newtons/meters","newtons-second/meters","ohms","ohm-centimeters","pascals","percent","radians","radians/second","seconds","siemens","sieverts","steradians","tesla","view-coordinates/second","volts","watts","webers","cm","nm"],isValidUnits:function(t){return _.includes(e.values,t)}};return t("AXON/axon").register("units",e),e}),i("AXON/Property",["require","AXON/axon","AXON/Emitter","PHET_CORE/inherit","AXON/Multilink","AXON/units","TANDEM/PhetioObject","TANDEM/Tandem"],function(t){"use strict";function e(t,e){var i=this;e=_.extend({tandem:o.optional,valueType:null,validValues:null,isValidValue:null,useDeepEquality:!1,highFrequency:!1,units:null,reentrant:!1},e),a.call(this,e),this.units=e.units,this.useDeepEquality=e.useDeepEquality,this.assertPropertyValidateValue=!1,this.assertPropertyValidateValue&&e.validValues&&e.validValues.forEach(function(t){i.assertPropertyValidateValue(t)}),this.assertPropertyValidateValue&&this.assertPropertyValidateValue(t),o.validationEnabled()&&this.tandem.isSuppliedAndEnabled()&&!1&&(!1)(!!e.phetioType,"phetioType passed to Property must be specified. Tandem.phetioID: "+this.tandem.phetioID),o.validationEnabled()&&this.tandem.isSuppliedAndEnabled()&&!1&&(!1)(!!e.phetioType.elementType,"phetioType.elementType must be specified. Tandem.phetioID: "+this.tandem.phetioID),this._value=t,this._initialValue=t,this.validValues=e.validValues,this.changedEmitter=new n,this.notifying=!1,this.reentrant=e.reentrant,this.isDisposed=!1,this.changeEventOptions={highFrequency:e.highFrequency}}var i=t("AXON/axon"),n=t("AXON/Emitter"),s=t("PHET_CORE/inherit"),r=t("AXON/Multilink"),a=(t("AXON/units"),t("TANDEM/PhetioObject")),o=t("TANDEM/Tandem");return i.register("Property",e),s(a,e,{get:function(){return this._value},set:function(t){return this.assertPropertyValidateValue&&this.assertPropertyValidateValue(t),this.equalsValue(t)||this.setValueAndNotifyListeners(t),this},equalsValue:function(t){return this.areValuesEqual(t,this._value)},areValuesEqual:function(t,e){return this.useDeepEquality&&t&&e&&t.constructor===e.constructor?t.equals(e):t===e},get initialValue(){return this._initialValue},setValueAndNotifyListeners:function(t){var e=this.get();this._value=t,this._notifyListeners(e)},_notifyListeners:function(t){this.tandem.isSuppliedAndEnabled()&&this.phetioStartEvent("changed",{oldValue:this.phetioType.elementType.toStateObject(t),newValue:this.phetioType.elementType.toStateObject(this.get()),units:this.phetioType&&this.phetioType.units},this.changeEventOptions),this.notifying=!0,this.changedEmitter.emit2(this.get(),t),this.notifying=!1,this.tandem.isSuppliedAndEnabled()&&this.phetioEndEvent()},notifyListenersStatic:function(){this.changedEmitter.emit1(this.get())},reset:function(){this.set(this._initialValue)},get value(){return this.get()},set value(t){this.set(t)},link:function(t){this.changedEmitter.addListener(t),t(this.get(),null)},lazyLink:function(t){this.changedEmitter.addListener(t)},unlink:function(t){this.changedEmitter.removeListener(t)},unlinkAll:function(){this.changedEmitter.removeAllListeners()},linkAttribute:function(t,e){var i=function(i){t[e]=i};return this.link(i),i},unlinkAttribute:function(t){this.unlink(t)},toString:function(){return"Property{"+this.get()+"}"},valueOf:function(){return this.toString()},debug:function(t){var e=function(e){console.log(t,e)};return this.link(e),e},toggle:function(){this.value=!this.value},dispose:function(){this.isDisposed=!0,this.unlinkAll(),a.prototype.dispose.call(this)},hasListener:function(t){return this.changedEmitter.hasListener(t)},hasListeners:function(){return this.changedEmitter.hasListeners()}},{multilink:function(t,e){return new r(t,e,!1)},lazyMultilink:function(t,e){return new r(t,e,!0)},unmultilink:function(t){t.dispose()}})}),i("PHET_IO/phetio",function(){return function(){return function(){}}}),i("AXON/PropertyIO",["require","AXON/axon","ifphetio!PHET_IO/assertInstanceOf","ifphetio!PHET_IO/types/FunctionIO","ifphetio!PHET_IO/types/ObjectIO","ifphetio!PHET_IO/phetio","ifphetio!PHET_IO/phetioInherit","ifphetio!PHET_IO/types/VoidIO"],function(t){"use strict";function e(t){return a(s,"PropertyIO",function(t,e){s.call(this,t,e)},{getValue:{returnType:t,parameterTypes:[],implementation:function(){return this.instance.get()},documentation:"Gets the current value."},setValue:{returnType:o,parameterTypes:[t],implementation:function(t){this.instance.set(t)},documentation:"Sets the value of the property. If the value differs from the previous value, listeners are notified with the new value.",canBeInvokedForReadOnlyInstances:!1},link:{returnType:o,parameterTypes:[n(o,[t,t])],implementation:function(t){this.instance.link(t)},documentation:"Adds a listener which will be called when the value changes. On registration, the listener is also called with the current value. The listener takes two arguments, the new value and the previous value."},lazyLink:{returnType:o,parameterTypes:[n(o,[t,t])],implementation:function(t){this.instance.lazyLink(t)},documentation:'Adds a listener which will be called when the value changes. This method is like "link", but without the current-value callback on registration. The listener takes two arguments, the new value and the previous value.'},unlink:{returnType:o,parameterTypes:[n(o,[t])],implementation:function(t){this.instance.unlink(t)},documentation:"Removes a listener."}},{documentation:"Observable values that send out notifications when the value changes. This differs from the traditional listener pattern in that added listeners also receive a callback with the current value when the listeners are registered. This is a widely-used pattern in PhET-iO simulations.",methodOrder:["link","lazyLink"],elementType:t,parameterTypes:[t],events:["changed"],getAPI:function(){return{elementType:r.getAPIForType(t)}},toStateObject:function(e){var i={value:t.toStateObject(e.value)};return e.validValues&&(i.validValues=e.validValues.map(function(e){return t.toStateObject(e)})),e.units&&(i.units=e.units),i},fromStateObject:function(e){return{units:e.units,value:t.fromStateObject(e.value),validValues:e.validValues&&e.validValues.map(function(e){return t.fromStateObject(e)})}},setValue:function(t,e){t.units=e.units,t.set(e.value),t.validValues=e.validValues}})}var i=t("AXON/axon"),n=(t("ifphetio!PHET_IO/assertInstanceOf"),t("ifphetio!PHET_IO/types/FunctionIO")),s=t("ifphetio!PHET_IO/types/ObjectIO"),r=t("ifphetio!PHET_IO/phetio"),a=t("ifphetio!PHET_IO/phetioInherit"),o=t("ifphetio!PHET_IO/types/VoidIO");return i.register("PropertyIO",e),e}),i("PHET_IO/types/BooleanIO",function(){return function(){return function(){}}}),i("AXON/BooleanProperty",["require","AXON/axon","PHET_CORE/inherit","AXON/Property","AXON/PropertyIO","ifphetio!PHET_IO/types/BooleanIO"],function(t){"use strict";function e(t,e){(e=_.extend({phetioType:r(a)},e)).valueType="boolean",s.call(this,t,e)}var i=t("AXON/axon"),n=t("PHET_CORE/inherit"),s=t("AXON/Property"),r=t("AXON/PropertyIO"),a=t("ifphetio!PHET_IO/types/BooleanIO");return i.register("BooleanProperty",e),n(s,e)}),i("AXON/DerivedPropertyIO",["require","AXON/axon","AXON/PropertyIO","ifphetio!PHET_IO/assertInstanceOf","ifphetio!PHET_IO/phetioInherit","ifphetio!PHET_IO/types/VoidIO"],function(t){"use strict";function e(t){var i=new n(t),a=function(t,e){i.call(this,t,e)};return s(i,"DerivedPropertyIO",a,{setValue:{returnType:r,parameterTypes:[t],implementation:function(t){return this.instance.set(t)},documentation:"Errors out when you try to set a derived property.",canBeInvokedForReadOnlyInstances:!1}},{documentation:"Like PropertyIO, but not settable.  Instead it is derived from other DerivedPropertyIO or PropertyIO instances",parameterTypes:[t],elementType:t}),a.outerType=e,a}var i=t("AXON/axon"),n=t("AXON/PropertyIO"),s=(t("ifphetio!PHET_IO/assertInstanceOf"),t("ifphetio!PHET_IO/phetioInherit")),r=t("ifphetio!PHET_IO/types/VoidIO");return i.register("DerivedPropertyIO",e),e}),i("AXON/DerivedProperty",["require","AXON/axon","AXON/DerivedPropertyIO","PHET_CORE/inherit","AXON/Property","TANDEM/Tandem"],function(t){"use strict";function e(t,e,i){(i=_.extend({tandem:h.optional,phetioType:null,phetioReadOnly:!0},i)).tandem.isSuppliedAndEnabled(),this.dependencies=t;var n=e.apply(null,t.map(function(t){return t.get()}));o.call(this,n,i);var s=this;this.dependencyListeners=[];for(var r=0;r<t.length;r++){!function(i){var n=function(){o.prototype.set.call(s,e.apply(null,t.map(function(t){return t.get()})))};s.dependencyListeners.push(n),i.lazyLink(n)}(t[r])}}function i(t,e){return t===e}function n(t,e){return t&&e.value}function s(t,e){return t||e.value}var r=t("AXON/axon"),a=(t("AXON/DerivedPropertyIO"),t("PHET_CORE/inherit")),o=t("AXON/Property"),h=t("TANDEM/Tandem");return r.register("DerivedProperty",e),a(o,e,{dispose:function(){for(var t=0;t<this.dependencies.length;t++){this.dependencies[t].unlink(this.dependencyListeners[t])}this.dependencies=null,this.dependencyListeners=null,o.prototype.dispose.call(this)},set:function(t){throw new Error("Cannot set values directly to a DerivedProperty, tried to set: "+t)},set value(t){throw new Error("Cannot es5-set values directly to a DerivedProperty, tried to set: "+t)},reset:function(){throw new Error("Cannot reset a DerivedProperty directly")},get value(){return o.prototype.get.call(this)}},{valueEquals:function(t,n,s){return new e([t,n],i,s)},and:function(t,i){return new e(t,_.reduce.bind(null,t,n,!0),i)},or:function(t,i){return new e(t,_.reduce.bind(null,t,s,!1),i)}})}),i("AXON/DynamicProperty",["require","AXON/axon","PHET_CORE/inherit","AXON/Property"],function(t){"use strict";function e(t,e){e=_.extend({bidirectional:!1,defaultValue:null,derive:_.identity,map:_.identity,inverseMap:_.identity},e),this.isExternallyChanging=!1,this.valuePropertyProperty=t,this.bidirectional=e.bidirectional,this.defaultValue=e.defaultValue,this.derive="string"==typeof e.derive?_.property(e.derive):e.derive,this.map="string"==typeof e.map?_.property(e.map):e.map,this.inverseMap="string"==typeof e.inverseMap?_.property(e.inverseMap):e.inverseMap;var i;i=null===this.valuePropertyProperty.value?this.map(this.defaultValue):this.map(this.derive(this.valuePropertyProperty.value).value),s.call(this,i,e),this.propertyPropertyListener=this.onPropertyPropertyChange.bind(this),this.propertyListener=this.onPropertyChange.bind(this),t.link(this.propertyListener),e.bidirectional&&this.lazyLink(this.onSelfChange.bind(this))}var i=t("AXON/axon"),n=t("PHET_CORE/inherit"),s=t("AXON/Property");return i.register("DynamicProperty",e),n(s,e,{onPropertyPropertyChange:function(t){s.prototype.set.call(this,this.map(t))},onPropertyChange:function(t,e){e&&this.derive(e).unlink(this.propertyPropertyListener),t?this.derive(t).link(this.propertyPropertyListener):this.onPropertyPropertyChange(this.defaultValue)},onSelfChange:function(t){null!==this.valuePropertyProperty.value&&(this.derive(this.valuePropertyProperty.value).value=this.inverseMap(t))},dispose:function(){this.valuePropertyProperty.unlink(this.propertyListener),null!==this.valuePropertyProperty.value&&this.derive(this.valuePropertyProperty.value).unlink(this.propertyPropertyListener),s.prototype.dispose.call(this)},reset:function(){null!==this.valuePropertyProperty.value&&this.derive(this.valuePropertyProperty.value).reset()},set:function(t){this.isExternallyChanging=!0,s.prototype.set.call(this,t),this.isExternallyChanging=!1}})}),i("PHET_CORE/cleanArray",["require","PHET_CORE/phetCore"],function(t){"use strict";function e(t){if(t){for(;t.length;)t.pop();return t}return[]}return t("PHET_CORE/phetCore").register("cleanArray",e),e}),i("AXON/Events",["require","AXON/axon","PHET_CORE/cleanArray"],function(t){"use strict";function e(){this._eventListeners={},this._staticEventListeners={}}var i=t("AXON/axon"),n=t("PHET_CORE/cleanArray");return i.register("Events",e),e.prototype={dispose:function(){},on:function(t,e){this._eventListeners[t]=this._eventListeners[t]||[],this._eventListeners[t].push(e)},onStatic:function(t,e){this._staticEventListeners[t]=this._staticEventListeners[t]||[],this._staticEventListeners[t].push(e)},off:function(t,e){var i=-1;return this._eventListeners[t]&&-1!==(i=this._eventListeners[t].indexOf(e))&&this._eventListeners[t].splice(i,1),i},offStatic:function(t,e){var i=-1;return this._staticEventListeners[t]&&-1!==(i=this._staticEventListeners[t].indexOf(e))&&this._staticEventListeners[t].splice(i,1),i},hasListener:function(t,e){var i=this._eventListeners[t];return!!i&&i.indexOf(e)>=0},hasStaticListener:function(t,e){var i=this._staticEventListeners[t];return!!i&&i.indexOf(e)>=0},removeAllEventListeners:function(){var t;for(t in this._eventListeners)n(this._eventListeners[t]);for(t in this._staticEventListeners)n(this._staticEventListeners[t])},trigger:function(t){var e,i=this._eventListeners[t],n=this._staticEventListeners[t],s=i?i.length:0,r=n?n.length:0,a=1===arguments.length;!a&&(s>0||r>0)&&(e=Array.prototype.slice.call(arguments,1)),s>0&&(i=i.slice());var o;for(o=0;o<s;o++){var h=i[o];a?h():h.apply(this,e)}for(o=0;o<r;o++){var u=n[o];a?u(arguments):u.apply(this,e)}},trigger0:function(t){var e=this._eventListeners[t],i=this._staticEventListeners[t],n=e?e.length:0,s=i?i.length:0;n>0&&(e=e.slice());var r;for(r=0;r<n;r++)e[r]();for(r=0;r<s;r++)i[r]()},trigger1:function(t,e){var i=this._eventListeners[t],n=this._staticEventListeners[t],s=i?i.length:0,r=n?n.length:0;s>0&&(i=i.slice());var a;for(a=0;a<s;a++)i[a](e);for(a=0;a<r;a++)n[a](e)},trigger2:function(t,e,i){var n=this._eventListeners[t],s=this._staticEventListeners[t],r=n?n.length:0,a=s?s.length:0;r>0&&(n=n.slice());var o;for(o=0;o<r;o++)n[o](e,i);for(o=0;o<a;o++)s[o](e,i)}},e}),i("PHET_IO/types/NumberIO",function(){return function(){return function(){}}}),i("AXON/NumberPropertyIO",["require","AXON/axon","AXON/PropertyIO","ifphetio!PHET_IO/assertInstanceOf","ifphetio!PHET_IO/types/NumberIO","ifphetio!PHET_IO/phetioInherit"],function(t){"use strict";function e(t,e){o.call(this,t,e)}var i=t("AXON/axon"),n=t("AXON/PropertyIO"),s=(t("ifphetio!PHET_IO/assertInstanceOf"),t("ifphetio!PHET_IO/types/NumberIO")),r=t("ifphetio!PHET_IO/phetioInherit"),a=s,o=n(a),h=["FloatingPoint","Integer"];return i.register("NumberPropertyIO",e),r(o,"NumberPropertyIO",e,{},{elementType:s,getAPI:function(){return{elementType:phet.phetIo.phetio.getAPIForType(a)}},toStateObject:function(t){var e=o.toStateObject(t);return t.numberType&&(e.numberType=t.numberType),t.range&&(e.range=t.range),e},fromStateObject:function(t){var e=o.fromStateObject(t);return e.numberType=t.numberType,e.range=t.range,e},setValue:function(t,e){o.setValue(t,e),t.range=e.range,t.numberType=e.numberType},documentation:"Extends PropertyIO to add values for the numeric range ( min, max ) and numberType ( '"+h.join("' | '")+"' )"}),e.VALID_NUMBER_TYPES=h,e}),i("AXON/NumberProperty",["require","AXON/axon","PHET_CORE/inherit","AXON/NumberPropertyIO","AXON/Property"],function(t){"use strict";function e(t,e){(e=_.extend({numberType:"FloatingPoint",range:null,phetioType:s},e)).range&&!1&&(!1)(function(t){return"object"==typeof t&&t.hasOwnProperty("min")&&t.hasOwnProperty("max")}(e.range),"invalid range: "+e.range),this.numberType=e.numberType,this.range=e.range,e.valueType="number",this.assertNumberPropertyValidateValue=!1,e.validValues&&this.assertNumberPropertyValidateValue&&e.validValues.forEach(this.assertNumberPropertyValidateValue),this.assertNumberPropertyValidateValue&&this.assertNumberPropertyValidateValue(t),r.call(this,t,e)}var i=t("AXON/axon"),n=t("PHET_CORE/inherit"),s=t("AXON/NumberPropertyIO"),r=t("AXON/Property");s.VALID_NUMBER_TYPES;return i.register("NumberProperty",e),n(r,e,{set:function(t){this.assertNumberPropertyValidateValue&&this.assertNumberPropertyValidateValue(t),r.prototype.set.call(this,t)}})}),i("AXON/ObservableArrayIO",["require","AXON/axon","ifphetio!PHET_IO/assertInstanceOf","ifphetio!PHET_IO/types/FunctionIO","ifphetio!PHET_IO/types/NumberIO","ifphetio!PHET_IO/types/ObjectIO","ifphetio!PHET_IO/phetio","ifphetio!PHET_IO/phetioInherit","ifphetio!PHET_IO/types/VoidIO"],function(t){"use strict";function e(t){return o(r,"ObservableArrayIO",function(t,e){r.call(this,t,e)},{addItemAddedListener:{returnType:h,parameterTypes:[n(h,[t])],implementation:function(t){this.instance.addItemAddedListener(t)},documentation:"Add a listener that is called when an item is added to the observable array."},addItemRemovedListener:{returnType:h,parameterTypes:[n(h,[t])],implementation:function(t){this.instance.addItemRemovedListener(t)},documentation:"Add a listener that is called when an item is removed from the observable array."},getLength:{returnType:s,parameterTypes:[],implementation:function(){return this.instance.length},documentation:"Get the number of elements in the observable array"}},{toStateObject:function(t){return t?{array:t.getArray().map(function(t){return t.phetioID})}:t},fromStateObject:function(t){var e=[];return t.array.forEach(function(t){e.push(a.getInstance(t))}),e},setValue:function(t,e){t.clear(),t.addAll(e)},documentation:"An array that sends notifications when its values have changed.",elementType:t,events:["itemAdded","itemRemoved"]})}var i=t("AXON/axon"),n=(t("ifphetio!PHET_IO/assertInstanceOf"),t("ifphetio!PHET_IO/types/FunctionIO")),s=t("ifphetio!PHET_IO/types/NumberIO"),r=t("ifphetio!PHET_IO/types/ObjectIO"),a=t("ifphetio!PHET_IO/phetio"),o=t("ifphetio!PHET_IO/phetioInherit"),h=t("ifphetio!PHET_IO/types/VoidIO");return i.register("ObservableArrayIO",e),e}),i("AXON/ObservableArray",["require","AXON/axon","PHET_CORE/inherit","AXON/NumberProperty","AXON/ObservableArrayIO","TANDEM/PhetioObject","TANDEM/Tandem","ifphetio!PHET_IO/types/ObjectIO"],function(t){"use strict";function e(t,e){t instanceof Object&&!Array.isArray(t)&&(e=t,t=null),e=_.extend({allowDuplicates:!1,phetioType:r(h),tandem:o.optional},e),this.allowDuplicates=e.allowDuplicates,this._array=t||[],this._addedListeners=[],this._removedListeners=[],this.lengthProperty=new s(this._array.length,{numberType:"Integer",tandem:e.tandem.createTandem("lengthProperty"),phetioReadOnly:!0}),this.initialArray=t?t.slice():[],a.call(this,e)}var i=t("AXON/axon"),n=t("PHET_CORE/inherit"),s=t("AXON/NumberProperty"),r=t("AXON/ObservableArrayIO"),a=t("TANDEM/PhetioObject"),o=t("TANDEM/Tandem"),h=t("ifphetio!PHET_IO/types/ObjectIO");return i.register("ObservableArray",e),n(a,e,{dispose:function(){this.lengthProperty.dispose(),a.prototype.dispose.call(this)},reset:function(){for(var t=0;t<this._array.length;t++)this._fireItemRemoved(this._array[t]);for(this._array=this.initialArray.slice(),t=0;t<this._array.length;t++)this._fireItemAdded(this._array[t])},get length(){return this._array.length},addItemAddedListener:function(t){this._addedListeners.push(t)},removeItemAddedListener:function(t){var e=this._addedListeners.indexOf(t);this._addedListeners.splice(e,1)},addItemRemovedListener:function(t){this._removedListeners.push(t)},removeItemRemovedListener:function(t){var e=this._removedListeners.indexOf(t);this._removedListeners.splice(e,1)},_fireItemAdded:function(t){this.tandem.isSuppliedAndEnabled()&&this.phetioStartEvent("itemAdded",this.phetioType.elementType.toStateObject&&this.phetioType.elementType.toStateObject(t));for(var e=this._addedListeners.slice(0),i=0;i<e.length;i++)e[i](t,this);this.tandem.isSuppliedAndEnabled()&&this.phetioEndEvent()},_fireItemRemoved:function(t){this.tandem.isSuppliedAndEnabled()&&this.phetioStartEvent("itemRemoved",this.phetioType.elementType.toStateObject&&this.phetioType.elementType.toStateObject(t));for(var e=this._removedListeners.slice(0),i=0;i<e.length;i++)e[i](t,this);this.tandem.isSuppliedAndEnabled()&&this.phetioEndEvent()},add:function(t){this.push(t)},addAll:function(t){for(var e=0;e<t.length;e++)this.add(t[e])},remove:function(t){var e=this._array.indexOf(t);-1!==e&&(this._array.splice(e,1),this.lengthProperty.set(this._array.length),this._fireItemRemoved(t))},removeAll:function(t){for(var e=0;e<t.length;e++)this.remove(t[e])},push:function(t){if(!this.allowDuplicates&&this.contains(t))throw new Error("duplicates are not allowed");this._array.push(t),this.lengthProperty.set(this._array.length),this._fireItemAdded(t)},pop:function(){var t=this._array.pop();return void 0!==t&&(this.lengthProperty.set(this._array.length),this._fireItemRemoved(t)),t},shift:function(){var t=this._array.shift();return void 0!==t&&(this.lengthProperty.set(this._array.length),this._fireItemRemoved(t)),t},contains:function(t){return-1!==this.indexOf(t)},get:function(t){return this._array[t]},indexOf:function(t){return this._array.indexOf(t)},clear:function(){for(;this.length>0;)this.pop()},forEach:function(t){this._array.slice().forEach(t)},map:function(t){return new e(this._array.map(t))},filter:function(t){return new e(this._array.filter(t))},count:function(t){for(var e=0,i=0;i<this._array.length;i++)t(this._array[i])&&e++;return e},find:function(t,e){return _.find(this._array,t,e)},some:function(t){return _.some(this._array,t)},reduce:function(t,e){for(var i=0;i<this._array.length;i++)t=e(t,this._array[i]);return t},getArray:function(){return this._array},splice:function(t,e,i,n,s){for(var r=this._array.splice.apply(this._array,arguments),a=Array.prototype.slice.call(arguments),o=0;o<r.length;o++)this._fireItemRemoved(r[o]);for(var h=2;h<a.length;h++)this._fireItemAdded(a[h]);return r},shuffle:function(t){var e=t.shuffle(this._array);this._array.length=0,Array.prototype.push.apply(this._array,e)}})}),i("PHET_IO/types/StringIO",function(){return function(){return function(){}}}),i("AXON/StringProperty",["require","AXON/axon","PHET_CORE/inherit","AXON/Property","AXON/PropertyIO","ifphetio!PHET_IO/types/StringIO"],function(t){"use strict";function e(t,e){(e=_.extend({phetioType:r(a)},e)).valueType="string",s.call(this,t,e)}var i=t("AXON/axon"),n=t("PHET_CORE/inherit"),s=t("AXON/Property"),r=t("AXON/PropertyIO"),a=t("ifphetio!PHET_IO/types/StringIO");return i.register("StringProperty",e),n(s,e)}),i("AXON/main",["AXON/axon","AXON/BooleanProperty","AXON/DerivedProperty","AXON/DynamicProperty","AXON/Emitter","AXON/Events","AXON/Multilink","AXON/ObservableArray","AXON/Property","AXON/StringProperty","AXON/NumberProperty"],function(t){"use strict";return t}),i("DOT/dot",["require","PHET_CORE/Namespace"],function(t){"use strict";var e=new(t("PHET_CORE/Namespace"))("dot");return e.register("v2",function(t,i){return new e.Vector2(t,i)}),e.register("v3",function(t,i,n){return new e.Vector3(t,i,n)}),e.register("v4",function(t,i,n,s){return new e.Vector4(t,i,n,s)}),e.register("FastArray",window.Float64Array?window.Float64Array:window.Array),e}),i("PHET_CORE/Poolable",["require","PHET_CORE/extend","PHET_CORE/phetCore"],function(t){"use strict";var e=t("PHET_CORE/extend"),i={mixInto:function(t,i){i=_.extend({defaultArguments:[],initialize:t,maxSize:100,initialSize:0,useDefaultConstruction:!1},i);var n=[],s=Function.prototype.bind.bind(t,t),r=s.apply(null,i.defaultArguments),a=i.initialize,o=i.useDefaultConstruction;for(e(t,{pool:n,dirtyFromPool:function(){return n.length?n.pop():new r},createFromPool:function(){var t;return n.length?(t=n.pop(),a.apply(t,arguments)):o?(t=new r,a.apply(t,arguments)):t=new(s.apply(null,arguments)),t}}),e(t.prototype,{freeToPool:function(){n.length<i.maxSize&&n.push(this)}});n.length<i.initialSize;)n.push(new r)}};return t("PHET_CORE/phetCore").register("Poolable",i),i}),i("DOT/Util",["require","DOT/dot"],function(t){"use strict";var e,i,n,s=t("DOT/dot"),r=Number.MIN_VALUE,a=2*Math.PI,o={clamp:function(t,e,i){return t<e?e:t>i?i:t},moduloBetweenDown:function(t,e,i){var n=i-e,s=(t-e)%n;return s<0&&(s+=n),s+e},moduloBetweenUp:function(t,e,i){return-o.moduloBetweenDown(-t,-i,-e)},rangeInclusive:function(t,e){if(e<t)return[];for(var i=new Array(e-t+1),n=t;n<=e;n++)i[n-t]=n;return i},rangeExclusive:function(t,e){return o.rangeInclusive(t+1,e-1)},toRadians:function(t){return Math.PI*t/180},toDegrees:function(t){return 180*t/Math.PI},mod:function(t,e){return t/e%1==0?0:t%e},gcd:function(t,e){return Math.abs(0===e?t:this.gcd(e,o.mod(t,e)))},lcm:function(t,e){return o.roundSymmetric(Math.abs(t*e)/o.gcd(t,e))},lineLineIntersection:function(t,e,i,n){if(t.equals(e)||i.equals(n))return null;var r=t.x-e.x,a=i.x-n.x,o=t.y-e.y,h=i.y-n.y,u=r*h-o*a;if(Math.abs(u)<1e-10)return null;var l=t.x*e.y-t.y*e.x,c=i.x*n.y-i.y*n.x;return new s.Vector2((l*a-r*c)/u,(l*h-o*c)/u)},circleCenterFromPoints:function(t,e,i){var n=new s.Vector2((t.x+e.x)/2,(t.y+e.y)/2),r=new s.Vector2((e.x+i.x)/2,(e.y+i.y)/2),a=new s.Vector2(n.x+(e.y-t.y),n.y-(e.x-t.x)),h=new s.Vector2(r.x+(i.y-e.y),r.y-(i.x-e.x));return o.lineLineIntersection(n,a,r,h)},pointInCircleFromPoints:function(t,e,i,n){var s=t.x-n.x,r=t.y-n.y,a=(t.x-n.x)*(t.x-n.x)+(t.y-n.y)*(t.y-n.y),o=e.x-n.x,h=e.y-n.y,u=(e.x-n.x)*(e.x-n.x)+(e.y-n.y)*(e.y-n.y),l=i.x-n.x,c=i.y-n.y,m=(i.x-n.x)*(i.x-n.x)+(i.y-n.y)*(i.y-n.y);return s*h*m+r*u*l+a*o*c-a*h*l-r*o*m-s*u*c>0},sphereRayIntersection:function(t,e,i){i=void 0===i?1e-5:i;var n=new s.Vector3,r=e.direction,a=e.position,o=a.minus(n),h=r.dot(o),u=4*h*h-4*(o.magnitudeSquared()-t*t);if(u<i)return null;var l=r.dot(n)-r.dot(a),c=Math.sqrt(u)/2,m=l-c,d=l+c;if(d<i)return null;var f=e.pointAtDistance(d),g=f.minus(n).normalized();if(m<i)return{distance:d,hitPoint:f,normal:g.negated(),fromOutside:!1};var p=e.pointAtDistance(m);return{distance:m,hitPoint:p,normal:p.minus(n).normalized(),fromOutside:!0}},solveLinearRootsReal:function(t,e){return 0===t?0===e?null:[]:[-e/t]},solveQuadraticRootsReal:function(t,e,i){if(0===t||Math.abs(e/t)>1e7||Math.abs(i/t)>1e7)return o.solveLinearRootsReal(e,i);var n=e*e-4*t*i;if(n<0)return[];var s=Math.sqrt(n);return[(-e-s)/(2*t),(-e+s)/(2*t)]},solveCubicRootsReal:function(t,e,i,n){if(0===t)return o.solveQuadraticRootsReal(e,i,n);if(0===t||Math.abs(e/t)>1e7||Math.abs(i/t)>1e7||Math.abs(n/t)>1e7)return o.solveQuadraticRootsReal(e,i,n);if(0===n||Math.abs(t/n)>1e7||Math.abs(e/n)>1e7||Math.abs(i/n)>1e7)return[0].concat(o.solveQuadraticRootsReal(t,e,i));var s=(3*(i/=t)-(e/=t)*e)/9,r=(-27*(n/=t)+e*(9*i-e*e*2))/54,a=s*s*s+r*r,h=e/3;if(a>1e-7){var u=Math.sqrt(a);return[o.cubeRoot(r+u)+o.cubeRoot(r-u)-h]}if(0===a){var l=o.cubeRoot(r),c=-h-l;return[2*l-h,c,c]}var m=-s*s*s;m=Math.acos(r/Math.sqrt(m));var d=2*Math.sqrt(-s);return[-h+d*Math.cos(m/3),-h+d*Math.cos((m+2*Math.PI)/3),-h+d*Math.cos((m+4*Math.PI)/3)]},cubeRoot:function(t){return t>=0?Math.pow(t,1/3):-Math.pow(-t,1/3)},linear:function(t,e,i,n,s){return(n-i)/(e-t)*(s-t)+i},roundSymmetric:function(t){return(t<0?-1:1)*Math.round(Math.abs(t))},toFixed:function(t,e){var i=Math.pow(10,e);return(o.roundSymmetric(t*i)/i).toFixed(e)},toFixedNumber:function(t,e){return parseFloat(o.toFixed(t,e))},isInteger:function(t){return t%1==0},equalsEpsilon:function(t,e,i){return Math.abs(t-e)<=i},lineSegmentIntersection:function(t,e,i,n,r,a,o,h){var u=function(t,e,i,n,s,r){return(r-e)*(i-t)-(n-e)*(s-t)};if(u(t,e,r,a,o,h)*u(i,n,r,a,o,h)>0||u(r,a,t,e,i,n)*u(o,h,t,e,i,n)>0)return null;var l=(t-i)*(a-h)-(e-n)*(r-o);if(Math.abs(l)<1e-10)return null;if(t===r&&e===a||t===o&&e===h)return new s.Vector2(t,e);if(i===r&&n===a||i===o&&n===h)return new s.Vector2(i,n);var c=((t*n-e*i)*(r-o)-(t-i)*(r*h-a*o))/l,m=((t*n-e*i)*(a-h)-(e-n)*(r*h-a*o))/l;return new s.Vector2(c,m)},distToSegmentSquared:function(t,e,i){var n=e.distanceSquared(i);if(0===n)return t.distanceSquared(e);var r=((t.x-e.x)*(i.x-e.x)+(t.y-e.y)*(i.y-e.y))/n;return r<0?t.distanceSquared(e):r>1?t.distanceSquared(i):t.distanceSquared(new s.Vector2(e.x+r*(i.x-e.x),e.y+r*(i.y-e.y)))},distToSegment:function(t,e,i){return Math.sqrt(this.distToSegmentSquared(t,e,i))},arePointsCollinear:function(t,e,i,n){return void 0===n&&(n=0),o.triangleArea(t,e,i)<=n},triangleArea:function(t,e,i){return Math.abs(o.triangleAreaSigned(t,e,i))},triangleAreaSigned:function(t,e,i){return t.x*(e.y-i.y)+e.x*(i.y-t.y)+i.x*(t.y-e.y)},sign:function(t){return(t>0)-(t<0)||+t},cosh:function(t){return(Math.exp(t)+Math.exp(-t))/2},sinh:function(t){return(Math.exp(t)-Math.exp(-t))/2},log10:function(t){return Math.log(t)/Math.LN10},boxMullerTransform:function(t,s,o){if(!(e=!e))return n*s+t;var h,u;do{h=o.nextDouble(),u=o.nextDouble()}while(h<=r);return i=Math.sqrt(-2*Math.log(h))*Math.cos(a*u),n=Math.sqrt(-2*Math.log(h))*Math.sin(a*u),i*s+t},median:function(t){if(t.sort(function(t,e){return t-e}),0===t.length)return null;var e=Math.floor(t.length/2);return t.length%2?t[e]:(t[e-1]+t[e])/2},numberOfDecimalPlaces:function(t){for(var e=0,i=1;t*i%1!=0;)e++,i*=10;return e},roundToInterval:function(t,e){return o.toFixedNumber(o.roundSymmetric(t/e)*e,o.numberOfDecimalPlaces(e))}};return s.register("Util",o),s.clamp=o.clamp,s.moduloBetweenDown=o.moduloBetweenDown,s.moduloBetweenUp=o.moduloBetweenUp,s.rangeInclusive=o.rangeInclusive,s.rangeExclusive=o.rangeExclusive,s.toRadians=o.toRadians,s.toDegrees=o.toDegrees,s.lineLineIntersection=o.lineLineIntersection,s.lineSegmentIntersection=o.lineSegmentIntersection,s.sphereRayIntersection=o.sphereRayIntersection,s.solveQuadraticRootsReal=o.solveQuadraticRootsReal,s.solveCubicRootsReal=o.solveCubicRootsReal,s.cubeRoot=o.cubeRoot,s.linear=o.linear,s.boxMullerTransform=o.boxMullerTransform,o}),i("DOT/Vector2",["require","DOT/dot","PHET_CORE/inherit","PHET_CORE/Poolable","DOT/Util"],function(t){"use strict";function e(t,e){this.x=void 0!==t?t:0,this.y=void 0!==e?e:0}var i=t("DOT/dot"),n=t("PHET_CORE/inherit"),s=t("PHET_CORE/Poolable");t("DOT/Util"),i.register("Vector2",e),n(Object,e,{isVector2:!0,dimension:2,magnitude:function(){return Math.sqrt(this.magnitudeSquared())},magnitudeSquared:function(){return this.x*this.x+this.y*this.y},distance:function(t){return Math.sqrt(this.distanceSquared(t))},distanceXY:function(t,e){var i=this.x-t,n=this.y-e;return Math.sqrt(i*i+n*n)},distanceSquared:function(t){var e=this.x-t.x,i=this.y-t.y;return e*e+i*i},distanceSquaredXY:function(t,e){var i=this.x-t,n=this.y-e;return i*i+n*n},dot:function(t){return this.x*t.x+this.y*t.y},dotXY:function(t,e){return this.x*t+this.y*e},angle:function(){return Math.atan2(this.y,this.x)},angleBetween:function(t){var e=this.magnitude(),n=t.magnitude();return Math.acos(i.clamp((this.x*t.x+this.y*t.y)/(e*n),-1,1))},equals:function(t){return this.x===t.x&&this.y===t.y},equalsEpsilon:function(t,e){return e||(e=0),Math.max(Math.abs(this.x-t.x),Math.abs(this.y-t.y))<=e},isFinite:function(){return isFinite(this.x)&&isFinite(this.y)},copy:function(t){return t?t.set(this):new e(this.x,this.y)},crossScalar:function(t){return this.x*t.y-this.y*t.x},normalized:function(){var t=this.magnitude();if(0===t)throw new Error("Cannot normalize a zero-magnitude vector");return new e(this.x/t,this.y/t)},roundedSymmetric:function(){return this.copy().roundSymmetric()},withMagnitude:function(t){return this.copy().setMagnitude(t)},timesScalar:function(t){return new e(this.x*t,this.y*t)},times:function(t){return this.timesScalar(t)},componentTimes:function(t){return new e(this.x*t.x,this.y*t.y)},plus:function(t){return new e(this.x+t.x,this.y+t.y)},plusXY:function(t,i){return new e(this.x+t,this.y+i)},plusScalar:function(t){return new e(this.x+t,this.y+t)},minus:function(t){return new e(this.x-t.x,this.y-t.y)},minusXY:function(t,i){return new e(this.x-t,this.y-i)},minusScalar:function(t){return new e(this.x-t,this.y-t)},dividedScalar:function(t){return new e(this.x/t,this.y/t)},negated:function(){return new e(-this.x,-this.y)},perpendicular:function(){return new e(this.y,-this.x)},rotated:function(t){var i=this.angle()+t,n=this.magnitude();return new e(n*Math.cos(i),n*Math.sin(i))},rotateAboutXY:function(t,e,i){var n=this.x-t,s=this.y-e,r=Math.cos(i),a=Math.sin(i);return this.x=t+n*r-s*a,this.y=e+n*a+s*r,this},rotateAboutPoint:function(t,e){return this.rotateAboutXY(t.x,t.y,e)},rotatedAboutXY:function(t,i,n){return new e(this.x,this.y).rotateAboutXY(t,i,n)},rotatedAboutPoint:function(t,e){return this.rotatedAboutXY(t.x,t.y,e)},blend:function(t,i){return new e(this.x+(t.x-this.x)*i,this.y+(t.y-this.y)*i)},average:function(t){return this.blend(t,.5)},toString:function(){return"Vector2("+this.x+", "+this.y+")"},toVector3:function(){return new i.Vector3(this.x,this.y,0)},setXY:function(t,e){return this.x=t,this.y=e,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},set:function(t){return this.setXY(t.x,t.y)},setMagnitude:function(t){var e=t/this.magnitude();return this.multiplyScalar(e)},add:function(t){return this.setXY(this.x+t.x,this.y+t.y)},addXY:function(t,e){return this.setXY(this.x+t,this.y+e)},addScalar:function(t){return this.setXY(this.x+t,this.y+t)},subtract:function(t){return this.setXY(this.x-t.x,this.y-t.y)},subtractXY:function(t,e){return this.setXY(this.x-t,this.y-e)},subtractScalar:function(t){return this.setXY(this.x-t,this.y-t)},multiplyScalar:function(t){return this.setXY(this.x*t,this.y*t)},multiply:function(t){return this.multiplyScalar(t)},componentMultiply:function(t){return this.setXY(this.x*t.x,this.y*t.y)},divideScalar:function(t){return this.setXY(this.x/t,this.y/t)},negate:function(){return this.setXY(-this.x,-this.y)},normalize:function(){var t=this.magnitude();if(0===t)throw new Error("Cannot normalize a zero-magnitude vector");return this.divideScalar(t)},roundSymmetric:function(){return this.setXY(i.Util.roundSymmetric(this.x),i.Util.roundSymmetric(this.y))},rotate:function(t){var e=this.angle()+t,i=this.magnitude();return this.setXY(i*Math.cos(e),i*Math.sin(e))},setPolar:function(t,e){return this.setXY(t*Math.cos(e),t*Math.sin(e))},toStateObject:function(){return{x:this.x,y:this.y}}},{createPolar:function(t,i){return(new e).setPolar(t,i)},fromStateObject:function(t){return new e(t.x,t.y)},getAngleBetweenVectors:function(t,e){var i=e.x-t.x,n=e.y-t.y;return Math.atan2(n,i)},getDistanceBetweenVectors:function(t,e){var i=e.x-t.x,n=e.y-t.y;return Math.sqrt(i*i+n*n)}}),s.mixInto(e,{initialize:e.prototype.setXY});var r=e.Immutable=function(t,i){e.call(this,t,i)};return n(e,r),r.mutableOverrideHelper=function(t){r.prototype[t]=function(){throw new Error("Cannot call mutable method '"+t+"' on immutable Vector2")}},r.mutableOverrideHelper("setXY"),r.mutableOverrideHelper("setX"),r.mutableOverrideHelper("setY"),e.ZERO=new e(0,0),e.X_UNIT=new e(1,0),e.Y_UNIT=new e(0,1),e}),i("DOT/Bounds2",["require","DOT/dot","PHET_CORE/inherit","PHET_CORE/Poolable","DOT/Vector2"],function(t){"use strict";function e(t,e,i,n){this.minX=t,this.minY=e,this.maxX=i,this.maxY=n}var i=t("DOT/dot"),n=t("PHET_CORE/inherit"),s=t("PHET_CORE/Poolable"),r=t("DOT/Vector2"),a=new i.Vector2;return i.register("Bounds2",e),n(Object,e,{isBounds:!0,dimension:2,getWidth:function(){return this.maxX-this.minX},get width(){return this.getWidth()},getHeight:function(){return this.maxY-this.minY},get height(){return this.getHeight()},getX:function(){return this.minX},get x(){return this.getX()},getY:function(){return this.minY},get y(){return this.getY()},getMinX:function(){return this.minX},getMinY:function(){return this.minY},getMaxX:function(){return this.maxX},getMaxY:function(){return this.maxY},getLeft:function(){return this.minX},get left(){return this.minX},getTop:function(){return this.minY},get top(){return this.minY},getRight:function(){return this.maxX},get right(){return this.maxX},getBottom:function(){return this.maxY},get bottom(){return this.maxY},getCenterX:function(){return(this.maxX+this.minX)/2},get centerX(){return this.getCenterX()},getCenterY:function(){return(this.maxY+this.minY)/2},get centerY(){return this.getCenterY()},getLeftTop:function(){return new i.Vector2(this.minX,this.minY)},get leftTop(){return this.getLeftTop()},getCenterTop:function(){return new i.Vector2(this.getCenterX(),this.minY)},get centerTop(){return this.getCenterTop()},getRightTop:function(){return new i.Vector2(this.maxX,this.minY)},get rightTop(){return this.getRightTop()},getLeftCenter:function(){return new i.Vector2(this.minX,this.getCenterY())},get leftCenter(){return this.getLeftCenter()},getCenter:function(){return new i.Vector2(this.getCenterX(),this.getCenterY())},get center(){return this.getCenter()},getRightCenter:function(){return new i.Vector2(this.maxX,this.getCenterY())},get rightCenter(){return this.getRightCenter()},getLeftBottom:function(){return new i.Vector2(this.minX,this.maxY)},get leftBottom(){return this.getLeftBottom()},getCenterBottom:function(){return new i.Vector2(this.getCenterX(),this.maxY)},get centerBottom(){return this.getCenterBottom()},getRightBottom:function(){return new i.Vector2(this.maxX,this.maxY)},get rightBottom(){return this.getRightBottom()},isEmpty:function(){return this.getWidth()<0||this.getHeight()<0},isFinite:function(){return isFinite(this.minX)&&isFinite(this.minY)&&isFinite(this.maxX)&&isFinite(this.maxY)},hasNonzeroArea:function(){return this.getWidth()>0&&this.getHeight()>0},isValid:function(){return!this.isEmpty()&&this.isFinite()},closestPointTo:function(t){if(this.containsCoordinates(t.x,t.y))return t;var e=Math.max(Math.min(t.x,this.maxX),this.x),i=Math.max(Math.min(t.y,this.maxY),this.y);return new r(e,i)},containsCoordinates:function(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY},containsPoint:function(t){return this.containsCoordinates(t.x,t.y)},containsBounds:function(t){return this.minX<=t.minX&&this.maxX>=t.maxX&&this.minY<=t.minY&&this.maxY>=t.maxY},intersectsBounds:function(t){var e=Math.max(this.minX,t.minX),i=Math.max(this.minY,t.minY),n=Math.min(this.maxX,t.maxX),s=Math.min(this.maxY,t.maxY);return n-e>=0&&s-i>=0},minimumDistanceToPointSquared:function(t){var e,i=t.x<this.minX?this.minX:t.x>this.maxX?this.maxX:null,n=t.y<this.minY?this.minY:t.y>this.maxY?this.maxY:null;if(null===i&&null===n)return 0;if(null===i)return(e=n-t.y)*e;if(null===n)return(e=i-t.x)*e;var s=i-t.x,r=n-t.y;return s*s+r*r},maximumDistanceToPointSquared:function(t){var e=t.x>this.getCenterX()?this.minX:this.maxX,i=t.y>this.getCenterY()?this.minY:this.maxY;return e-=t.x,i-=t.y,e*e+i*i},toString:function(){return"[x:("+this.minX+","+this.maxX+"),y:("+this.minY+","+this.maxY+")]"},equals:function(t){return this.minX===t.minX&&this.minY===t.minY&&this.maxX===t.maxX&&this.maxY===t.maxY},equalsEpsilon:function(t,e){e=void 0!==e?e:0;var i=this.isFinite(),n=t.isFinite();return i&&n?Math.abs(this.minX-t.minX)<e&&Math.abs(this.minY-t.minY)<e&&Math.abs(this.maxX-t.maxX)<e&&Math.abs(this.maxY-t.maxY)<e:i===n&&(this===t||(isFinite(this.minX+t.minX)?Math.abs(this.minX-t.minX)<e:this.minX===t.minX)&&(isFinite(this.minY+t.minY)?Math.abs(this.minY-t.minY)<e:this.minY===t.minY)&&(isFinite(this.maxX+t.maxX)?Math.abs(this.maxX-t.maxX)<e:this.maxX===t.maxX)&&(isFinite(this.maxY+t.maxY)?Math.abs(this.maxY-t.maxY)<e:this.maxY===t.maxY))},copy:function(t){return t?t.set(this):new e(this.minX,this.minY,this.maxX,this.maxY)},union:function(t){return new e(Math.min(this.minX,t.minX),Math.min(this.minY,t.minY),Math.max(this.maxX,t.maxX),Math.max(this.maxY,t.maxY))},intersection:function(t){return new e(Math.max(this.minX,t.minX),Math.max(this.minY,t.minY),Math.min(this.maxX,t.maxX),Math.min(this.maxY,t.maxY))},withCoordinates:function(t,i){return new e(Math.min(this.minX,t),Math.min(this.minY,i),Math.max(this.maxX,t),Math.max(this.maxY,i))},withPoint:function(t){return this.withCoordinates(t.x,t.y)},withX:function(t){return this.copy().addX(t)},withY:function(t){return this.copy().addY(t)},withMinX:function(t){return new e(t,this.minY,this.maxX,this.maxY)},withMinY:function(t){return new e(this.minX,t,this.maxX,this.maxY)},withMaxX:function(t){return new e(this.minX,this.minY,t,this.maxY)},withMaxY:function(t){return new e(this.minX,this.minY,this.maxX,t)},roundedOut:function(){return new e(Math.floor(this.minX),Math.floor(this.minY),Math.ceil(this.maxX),Math.ceil(this.maxY))},roundedIn:function(){return new e(Math.ceil(this.minX),Math.ceil(this.minY),Math.floor(this.maxX),Math.floor(this.maxY))},transformed:function(t){return this.copy().transform(t)},dilated:function(t){return new e(this.minX-t,this.minY-t,this.maxX+t,this.maxY+t)},dilatedX:function(t){return new e(this.minX-t,this.minY,this.maxX+t,this.maxY)},dilatedY:function(t){return new e(this.minX,this.minY-t,this.maxX,this.maxY+t)},dilatedXY:function(t,i){return new e(this.minX-t,this.minY-i,this.maxX+t,this.maxY+i)},eroded:function(t){return this.dilated(-t)},erodedX:function(t){return this.dilatedX(-t)},erodedY:function(t){return this.dilatedY(-t)},erodedXY:function(t,e){return this.dilatedXY(-t,-e)},withOffsets:function(t,i,n,s){return new e(this.minX-t,this.minY-i,this.maxX+n,this.maxY+s)},shiftedX:function(t){return new e(this.minX+t,this.minY,this.maxX+t,this.maxY)},shiftedY:function(t){return new e(this.minX,this.minY+t,this.maxX,this.maxY+t)},shifted:function(t,i){return new e(this.minX+t,this.minY+i,this.maxX+t,this.maxY+i)},blend:function(t,i){var n=1-i;return new e(n*this.minX+i*t.minX,n*this.minY+i*t.minY,n*this.maxX+i*t.maxX,n*this.maxY+i*t.maxY)},setMinMax:function(t,e,i,n){return this.minX=t,this.minY=e,this.maxX=i,this.maxY=n,this},setMinX:function(t){return this.minX=t,this},setMinY:function(t){return this.minY=t,this},setMaxX:function(t){return this.maxX=t,this},setMaxY:function(t){return this.maxY=t,this},set:function(t){return this.setMinMax(t.minX,t.minY,t.maxX,t.maxY)},includeBounds:function(t){return this.setMinMax(Math.min(this.minX,t.minX),Math.min(this.minY,t.minY),Math.max(this.maxX,t.maxX),Math.max(this.maxY,t.maxY))},constrainBounds:function(t){return this.setMinMax(Math.max(this.minX,t.minX),Math.max(this.minY,t.minY),Math.min(this.maxX,t.maxX),Math.min(this.maxY,t.maxY))},addCoordinates:function(t,e){return this.setMinMax(Math.min(this.minX,t),Math.min(this.minY,e),Math.max(this.maxX,t),Math.max(this.maxY,e))},addPoint:function(t){return this.addCoordinates(t.x,t.y)},addX:function(t){return this.minX=Math.min(t,this.minX),this.maxX=Math.max(t,this.maxX),this},addY:function(t){return this.minY=Math.min(t,this.minY),this.maxY=Math.max(t,this.maxY),this},roundOut:function(){return this.setMinMax(Math.floor(this.minX),Math.floor(this.minY),Math.ceil(this.maxX),Math.ceil(this.maxY))},roundIn:function(){return this.setMinMax(Math.ceil(this.minX),Math.ceil(this.minY),Math.floor(this.maxX),Math.floor(this.maxY))},transform:function(t){if(this.isEmpty())return this;if(t.isIdentity())return this;var e=this.minX,n=this.minY,s=this.maxX,r=this.maxY;return this.set(i.Bounds2.NOTHING),this.addPoint(t.multiplyVector2(a.setXY(e,n))),this.addPoint(t.multiplyVector2(a.setXY(e,r))),this.addPoint(t.multiplyVector2(a.setXY(s,n))),this.addPoint(t.multiplyVector2(a.setXY(s,r))),this},dilate:function(t){return this.setMinMax(this.minX-t,this.minY-t,this.maxX+t,this.maxY+t)},dilateX:function(t){return this.setMinMax(this.minX-t,this.minY,this.maxX+t,this.maxY)},dilateY:function(t){return this.setMinMax(this.minX,this.minY-t,this.maxX,this.maxY+t)},dilateXY:function(t,e){return this.setMinMax(this.minX-t,this.minY-e,this.maxX+t,this.maxY+e)},erode:function(t){return this.dilate(-t)},erodeX:function(t){return this.dilateX(-t)},erodeY:function(t){return this.dilateY(-t)},erodeXY:function(t,e){return this.dilateXY(-t,-e)},offset:function(t,i,n,s){return new e(this.minX-t,this.minY-i,this.maxX+n,this.maxY+s)},shiftX:function(t){return this.setMinMax(this.minX+t,this.minY,this.maxX+t,this.maxY)},shiftY:function(t){return this.setMinMax(this.minX,this.minY+t,this.maxX,this.maxY+t)},shift:function(t,e){return this.setMinMax(this.minX+t,this.minY+e,this.maxX+t,this.maxY+e)},getClosestPoint:function(t,e,n){return n?n.setXY(t,e):n=new i.Vector2(t,e),n.x<this.minX&&(n.x=this.minX),n.x>this.maxX&&(n.x=this.maxX),n.y<this.minY&&(n.y=this.minY),n.y>this.maxY&&(n.y=this.maxY),n}},{rect:function(t,i,n,s){return new e(t,i,t+n,i+s)},point:function(t,n){if(t instanceof i.Vector2){var s=t;return new e(s.x,s.y,s.x,s.y)}return new e(t,n,t,n)}}),s.mixInto(e,{initialize:e.prototype.setMinMax}),e.NOTHING=new e(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),e.EVERYTHING=new e(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),e}),i("DOT/BinPacker",["require","DOT/Bounds2","DOT/dot","PHET_CORE/inherit"],function(t){"use strict";function e(t){this.rootBin=new n.BinPacker.Bin(t,null)}var i=t("DOT/Bounds2"),n=t("DOT/dot"),s=t("PHET_CORE/inherit");return n.register("BinPacker",e),s(Object,e,{allocate:function(t,e){var i=this.rootBin.findAvailableBin(t,e);if(i){var n=i.split(t,e);return n.use(),n}return null},deallocate:function(t){t.unuse()},toString:function(){function t(n){e+=i+n.toString()+"\n",i+="  ",_.each(n.children,t),i=i.substring(2)}var e="",i="";return t(this.rootBin),e}}),e.Bin=function(t,e){this.bounds=t,this.parent=e,this.isSplit=!1,this.isUsed=!1,this.children=[]},s(Object,e.Bin,{findAvailableBin:function(t,e){if(this.isUsed)return null;if(this.bounds.width<t||this.bounds.height<e)return null;if(this.isSplit){for(var i=0;i<this.children.length;i++){var n=this.children[i].findAvailableBin(t,e);if(n)return n}return null}return this},split:function(t,e){if(t===this.bounds.width&&e===this.bounds.height)return this;this.isSplit=!0;var s=this.bounds.minX+t,r=this.bounds.minY+e,a=new i(this.bounds.minX,this.bounds.minY,s,r),o=new i(s,this.bounds.minY,this.bounds.maxX,r),h=new i(this.bounds.minX,r,this.bounds.maxX,this.bounds.maxY),u=new n.BinPacker.Bin(a,this);return this.children.push(u),o.hasNonzeroArea()&&this.children.push(new n.BinPacker.Bin(o,this)),h.hasNonzeroArea()&&this.children.push(new n.BinPacker.Bin(h,this)),u},use:function(){this.isUsed=!0},unuse:function(){this.isUsed=!1,this.parent&&this.parent.attemptToCollapse()},attemptToCollapse:function(){for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.isSplit||e.isUsed)return}this.children=[],this.isSplit=!1,this.parent&&this.parent.attemptToCollapse()},toString:function(){return this.bounds.toString()+(this.isUsed?" used":"")}}),e}),i("DOT/Vector4",["require","DOT/dot","PHET_CORE/inherit","PHET_CORE/Poolable","DOT/Util"],function(t){"use strict";function e(t,e,i,n){this.x=void 0!==t?t:0,this.y=void 0!==e?e:0,this.z=void 0!==i?i:0,this.w=void 0!==n?n:1}var i=t("DOT/dot"),n=t("PHET_CORE/inherit"),s=t("PHET_CORE/Poolable");t("DOT/Util"),i.register("Vector4",e),n(Object,e,{isVector4:!0,dimension:4,magnitude:function(){return Math.sqrt(this.magnitudeSquared())},magnitudeSquared:function(){this.dot(this)},distance:function(t){return this.minus(t).magnitude()},distanceXYZW:function(t,e,i,n){var s=this.x-t,r=this.y-e,a=this.z-i,o=this.w-n;return Math.sqrt(s*s+r*r+a*a+o*o)},distanceSquared:function(t){return this.minus(t).magnitudeSquared()},distanceSquaredXYZW:function(t,e,i,n){var s=this.x-t,r=this.y-e,a=this.z-i,o=this.w-n;return s*s+r*r+a*a+o*o},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},dotXYZW:function(t,e,i,n){return this.x*t+this.y*e+this.z*i+this.w*n},angleBetween:function(t){return Math.acos(i.clamp(this.normalized().dot(t.normalized()),-1,1))},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w},equalsEpsilon:function(t,e){return e||(e=0),Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)+Math.abs(this.w-t.w)<=e},isFinite:function(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.z)&&isFinite(this.w)},copy:function(t){return t?t.set(this):new e(this.x,this.y,this.z,this.w)},normalized:function(){var t=this.magnitude();return this.dividedScalar(t)},roundedSymmetric:function(){return this.copy().roundSymmetric()},withMagnitude:function(t){return this.copy().setMagnitude(t)},timesScalar:function(t){return new e(this.x*t,this.y*t,this.z*t,this.w*t)},times:function(t){return this.timesScalar(t)},componentTimes:function(t){return new e(this.x*t.x,this.y*t.y,this.z*t.z,this.w*t.w)},plus:function(t){return new e(this.x+t.x,this.y+t.y,this.z+t.z,this.w+t.w)},plusXYZW:function(t,i,n,s){return new e(this.x+t,this.y+i,this.z+n,this.w+s)},plusScalar:function(t){return new e(this.x+t,this.y+t,this.z+t,this.w+t)},minus:function(t){return new e(this.x-t.x,this.y-t.y,this.z-t.z,this.w-t.w)},minusXYZW:function(t,i,n,s){return new e(this.x-t,this.y-i,this.z-n,this.w-s)},minusScalar:function(t){return new e(this.x-t,this.y-t,this.z-t,this.w-t)},dividedScalar:function(t){return new e(this.x/t,this.y/t,this.z/t,this.w/t)},negated:function(){return new e(-this.x,-this.y,-this.z,-this.w)},blend:function(t,e){return this.plus(t.minus(this).times(e))},average:function(t){return this.blend(t,.5)},toString:function(){return"Vector4("+this.x+", "+this.y+", "+this.z+", "+this.w+")"},toVector3:function(){return new i.Vector3(this.x,this.y,this.z)},setXYZW:function(t,e,i,n){return this.x=t,this.y=e,this.z=i,this.w=n,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},set:function(t){return this.setXYZW(t.x,t.y,t.z,t.w)},setMagnitude:function(t){var e=t/this.magnitude();return this.multiplyScalar(e)},add:function(t){return this.setXYZW(this.x+t.x,this.y+t.y,this.z+t.z,this.w+t.w)},addXYZW:function(t,e,i,n){return this.setXYZW(this.x+t,this.y+e,this.z+i,this.w+n)},addScalar:function(t){return this.setXYZW(this.x+t,this.y+t,this.z+t,this.w+t)},subtract:function(t){return this.setXYZW(this.x-t.x,this.y-t.y,this.z-t.z,this.w-t.w)},subtractXYZW:function(t,e,i,n){return this.setXYZW(this.x-t,this.y-e,this.z-i,this.w-n)},subtractScalar:function(t){return this.setXYZW(this.x-t,this.y-t,this.z-t,this.w-t)},multiplyScalar:function(t){return this.setXYZW(this.x*t,this.y*t,this.z*t,this.w*t)},multiply:function(t){return this.multiplyScalar(t)},componentMultiply:function(t){return this.setXYZW(this.x*t.x,this.y*t.y,this.z*t.z,this.w*t.w)},divideScalar:function(t){return this.setXYZW(this.x/t,this.y/t,this.z/t,this.w/t)},negate:function(){return this.setXYZW(-this.x,-this.y,-this.z,-this.w)},normalize:function(){var t=this.magnitude();if(0===t)throw new Error("Cannot normalize a zero-magnitude vector");return this.divideScalar(t)},roundSymmetric:function(){return this.setXYZW(i.Util.roundSymmetric(this.x),i.Util.roundSymmetric(this.y),i.Util.roundSymmetric(this.z),i.Util.roundSymmetric(this.w))}}),s.mixInto(e,{initialize:e.prototype.setXYZW});var r=e.Immutable=function(t,e,i,n){this.x=void 0!==t?t:0,this.y=void 0!==e?e:0,this.z=void 0!==i?i:0,this.w=void 0!==n?n:1};return n(e,r),r.mutableOverrideHelper=function(t){r.prototype[t]=function(){throw new Error("Cannot call mutable method '"+t+"' on immutable Vector4")}},r.mutableOverrideHelper("setXYZW"),r.mutableOverrideHelper("setX"),r.mutableOverrideHelper("setY"),r.mutableOverrideHelper("setZ"),r.mutableOverrideHelper("setW"),e.ZERO=new e(0,0,0,0),e.X_UNIT=new e(1,0,0,0),e.Y_UNIT=new e(0,1,0,0),e.Z_UNIT=new e(0,0,1,0),e.W_UNIT=new e(0,0,0,1),e}),i("DOT/Vector3",["require","DOT/dot","PHET_CORE/inherit","PHET_CORE/Poolable","DOT/Util","DOT/Vector2","DOT/Vector4"],function(t){"use strict";function e(t,e,i){this.x=void 0!==t?t:0,this.y=void 0!==e?e:0,this.z=void 0!==i?i:0}var i=t("DOT/dot"),n=t("PHET_CORE/inherit"),s=t("PHET_CORE/Poolable");t("DOT/Util"),t("DOT/Vector2"),t("DOT/Vector4"),i.register("Vector3",e),n(Object,e,{isVector3:!0,dimension:3,magnitude:function(){return Math.sqrt(this.magnitudeSquared())},magnitudeSquared:function(){return this.dot(this)},distance:function(t){return Math.sqrt(this.distanceSquared(t))},distanceXYZ:function(t,e,i){var n=this.x-t,s=this.y-e,r=this.z-i;return Math.sqrt(n*n+s*s+r*r)},distanceSquared:function(t){var e=this.x-t.x,i=this.y-t.y,n=this.z-t.z;return e*e+i*i+n*n},distanceSquaredXYZ:function(t,e,i){var n=this.x-t,s=this.y-e,r=this.z-i;return n*n+s*s+r*r},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},dotXYZ:function(t,e,i){return this.x*t+this.y*e+this.z*i},angleBetween:function(t){return Math.acos(i.clamp(this.normalized().dot(t.normalized()),-1,1))},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z},equalsEpsilon:function(t,e){return e||(e=0),Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)<=e},isFinite:function(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.z)},copy:function(t){return t?t.set(this):new e(this.x,this.y,this.z)},cross:function(t){return new e(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)},normalized:function(){var t=this.magnitude();if(0===t)throw new Error("Cannot normalize a zero-magnitude vector");return new e(this.x/t,this.y/t,this.z/t)},roundedSymmetric:function(){return this.copy().roundSymmetric()},withMagnitude:function(t){return this.copy().setMagnitude(t)},timesScalar:function(t){return new e(this.x*t,this.y*t,this.z*t)},times:function(t){return this.timesScalar(t)},componentTimes:function(t){return new e(this.x*t.x,this.y*t.y,this.z*t.z)},plus:function(t){return new e(this.x+t.x,this.y+t.y,this.z+t.z)},plusXYZ:function(t,i,n){return new e(this.x+t,this.y+i,this.z+n)},plusScalar:function(t){return new e(this.x+t,this.y+t,this.z+t)},minus:function(t){return new e(this.x-t.x,this.y-t.y,this.z-t.z)},minusXYZ:function(t,i,n){return new e(this.x-t,this.y-i,this.z-n)},minusScalar:function(t){return new e(this.x-t,this.y-t,this.z-t)},dividedScalar:function(t){return new e(this.x/t,this.y/t,this.z/t)},negated:function(){return new e(-this.x,-this.y,-this.z)},blend:function(t,e){return this.plus(t.minus(this).times(e))},average:function(t){return this.blend(t,.5)},toString:function(){return"Vector3("+this.x+", "+this.y+", "+this.z+")"},toVector2:function(){return new i.Vector2(this.x,this.y)},toVector4:function(){return new i.Vector4(this.x,this.y,this.z,1)},setXYZ:function(t,e,i){return this.x=t,this.y=e,this.z=i,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},set:function(t){return this.setXYZ(t.x,t.y,t.z)},setMagnitude:function(t){var e=t/this.magnitude();return this.multiplyScalar(e)},add:function(t){return this.setXYZ(this.x+t.x,this.y+t.y,this.z+t.z)},addXYZ:function(t,e,i){return this.setXYZ(this.x+t,this.y+e,this.z+i)},addScalar:function(t){return this.setXYZ(this.x+t,this.y+t,this.z+t)},subtract:function(t){return this.setXYZ(this.x-t.x,this.y-t.y,this.z-t.z)},subtractXYZ:function(t,e,i){return this.setXYZ(this.x-t,this.y-e,this.z-i)},subtractScalar:function(t){return this.setXYZ(this.x-t,this.y-t,this.z-t)},multiplyScalar:function(t){return this.setXYZ(this.x*t,this.y*t,this.z*t)},multiply:function(t){return this.multiplyScalar(t)},componentMultiply:function(t){return this.setXYZ(this.x*t.x,this.y*t.y,this.z*t.z)},divideScalar:function(t){return this.setXYZ(this.x/t,this.y/t,this.z/t)},negate:function(){return this.setXYZ(-this.x,-this.y,-this.z)},normalize:function(){var t=this.magnitude();if(0===t)throw new Error("Cannot normalize a zero-magnitude vector");return this.divideScalar(t)},roundSymmetric:function(){return this.setXYZ(i.Util.roundSymmetric(this.x),i.Util.roundSymmetric(this.y),i.Util.roundSymmetric(this.z))}},{slerp:function(t,e,n){return i.Quaternion.slerp(new i.Quaternion,i.Quaternion.getRotationQuaternion(t,e),n).timesVector3(t)}}),s.mixInto(e,{initialize:e.prototype.setXYZ});var r=e.Immutable=function(t,e,i){this.x=void 0!==t?t:0,this.y=void 0!==e?e:0,this.z=void 0!==i?i:0};return n(e,r),r.mutableOverrideHelper=function(t){r.prototype[t]=function(){throw new Error("Cannot call mutable method '"+t+"' on immutable Vector3")}},r.mutableOverrideHelper("setXYZ"),r.mutableOverrideHelper("setX"),r.mutableOverrideHelper("setY"),r.mutableOverrideHelper("setZ"),e.ZERO=new e(0,0,0),e.X_UNIT=new e(1,0,0),e.Y_UNIT=new e(0,1,0),e.Z_UNIT=new e(0,0,1),e}),i("DOT/Bounds3",["require","DOT/dot","PHET_CORE/inherit","PHET_CORE/Poolable","DOT/Vector3"],function(t){"use strict";function e(t,e,i,n,s,r){this.minX=t,this.minY=e,this.minZ=i,this.maxX=n,this.maxY=s,this.maxZ=r}var i=t("DOT/dot"),n=t("PHET_CORE/inherit"),s=t("PHET_CORE/Poolable");return t("DOT/Vector3"),i.register("Bounds3",e),n(Object,e,{isBounds:!0,dimension:3,getWidth:function(){return this.maxX-this.minX},get width(){return this.getWidth()},getHeight:function(){return this.maxY-this.minY},get height(){return this.getHeight()},getDepth:function(){return this.maxZ-this.minZ},get depth(){return this.getDepth()},getX:function(){return this.minX},get x(){return this.getX()},getY:function(){return this.minY},get y(){return this.getY()},getZ:function(){return this.minZ},get z(){return this.getZ()},getMinX:function(){return this.minX},getMinY:function(){return this.minY},getMinZ:function(){return this.minZ},getMaxX:function(){return this.maxX},getMaxY:function(){return this.maxY},getMaxZ:function(){return this.maxZ},getLeft:function(){return this.minX},get left(){return this.minX},getTop:function(){return this.minY},get top(){return this.minY},getBack:function(){return this.minZ},get back(){return this.minZ},getRight:function(){return this.maxX},get right(){return this.maxX},getBottom:function(){return this.maxY},get bottom(){return this.maxY},getFront:function(){return this.maxZ},get front(){return this.maxZ},getCenterX:function(){return(this.maxX+this.minX)/2},get centerX(){return this.getCenterX()},getCenterY:function(){return(this.maxY+this.minY)/2},get centerY(){return this.getCenterY()},getCenterZ:function(){return(this.maxZ+this.minZ)/2},get centerZ(){return this.getCenterZ()},getCenter:function(){return new i.Vector3(this.getCenterX(),this.getCenterY(),this.getCenterZ())},get center(){return this.getCenter()},isEmpty:function(){return this.getWidth()<0||this.getHeight()<0||this.getDepth()<0},isFinite:function(){return isFinite(this.minX)&&isFinite(this.minY)&&isFinite(this.minZ)&&isFinite(this.maxX)&&isFinite(this.maxY)&&isFinite(this.maxZ)},hasNonzeroArea:function(){return this.getWidth()>0&&this.getHeight()>0&&this.getDepth()>0},isValid:function(){return!this.isEmpty()&&this.isFinite()},containsCoordinates:function(t,e,i){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY&&this.minZ<=i&&i<=this.maxZ},containsPoint:function(t){return this.containsCoordinates(t.x,t.y,t.z)},containsBounds:function(t){return this.minX<=t.minX&&this.maxX>=t.maxX&&this.minY<=t.minY&&this.maxY>=t.maxY&&this.minZ<=t.minZ&&this.maxZ>=t.maxZ},intersectsBounds:function(t){return!this.intersection(t).isEmpty()},toString:function(){return"[x:("+this.minX+","+this.maxX+"),y:("+this.minY+","+this.maxY+"),z:("+this.minZ+","+this.maxZ+")]"},equals:function(t){return this.minX===t.minX&&this.minY===t.minY&&this.minZ===t.minZ&&this.maxX===t.maxX&&this.maxY===t.maxY&&this.maxZ===t.maxZ},equalsEpsilon:function(t,e){e=void 0!==e?e:0;var i=this.isFinite(),n=t.isFinite();return i&&n?Math.abs(this.minX-t.minX)<e&&Math.abs(this.minY-t.minY)<e&&Math.abs(this.minZ-t.minZ)<e&&Math.abs(this.maxX-t.maxX)<e&&Math.abs(this.maxY-t.maxY)<e&&Math.abs(this.maxZ-t.maxZ)<e:i===n&&(this===t||(isFinite(this.minX+t.minX)?Math.abs(this.minX-t.minX)<e:this.minX===t.minX)&&(isFinite(this.minY+t.minY)?Math.abs(this.minY-t.minY)<e:this.minY===t.minY)&&(isFinite(this.minZ+t.minZ)?Math.abs(this.minZ-t.minZ)<e:this.minZ===t.minZ)&&(isFinite(this.maxX+t.maxX)?Math.abs(this.maxX-t.maxX)<e:this.maxX===t.maxX)&&(isFinite(this.maxY+t.maxY)?Math.abs(this.maxY-t.maxY)<e:this.maxY===t.maxY)&&(isFinite(this.maxZ+t.maxZ)?Math.abs(this.maxZ-t.maxZ)<e:this.maxZ===t.maxZ))},copy:function(t){return t?t.set(this):new e(this.minX,this.minY,this.minZ,this.maxX,this.maxY,this.maxZ)},union:function(t){return new e(Math.min(this.minX,t.minX),Math.min(this.minY,t.minY),Math.min(this.minZ,t.minZ),Math.max(this.maxX,t.maxX),Math.max(this.maxY,t.maxY),Math.max(this.maxZ,t.maxZ))},intersection:function(t){return new e(Math.max(this.minX,t.minX),Math.max(this.minY,t.minY),Math.max(this.minZ,t.minZ),Math.min(this.maxX,t.maxX),Math.min(this.maxY,t.maxY),Math.min(this.maxZ,t.maxZ))},withCoordinates:function(t,i,n){return new e(Math.min(this.minX,t),Math.min(this.minY,i),Math.min(this.minZ,n),Math.max(this.maxX,t),Math.max(this.maxY,i),Math.max(this.maxZ,n))},withPoint:function(t){return this.withCoordinates(t.x,t.y,t.z)},withMinX:function(t){return new e(t,this.minY,this.minZ,this.maxX,this.maxY,this.maxZ)},withMinY:function(t){return new e(this.minX,t,this.minZ,this.maxX,this.maxY,this.maxZ)},withMinZ:function(t){return new e(this.minX,this.minY,t,this.maxX,this.maxY,this.maxZ)},withMaxX:function(t){return new e(this.minX,this.minY,this.minZ,t,this.maxY,this.maxZ)},withMaxY:function(t){return new e(this.minX,this.minY,this.minZ,this.maxX,t,this.maxZ)},withMaxZ:function(t){return new e(this.minX,this.minY,this.minZ,this.maxX,this.maxY,t)},roundedOut:function(){return new e(Math.floor(this.minX),Math.floor(this.minY),Math.floor(this.minZ),Math.ceil(this.maxX),Math.ceil(this.maxY),Math.ceil(this.maxZ))},roundedIn:function(){return new e(Math.ceil(this.minX),Math.ceil(this.minY),Math.ceil(this.minZ),Math.floor(this.maxX),Math.floor(this.maxY),Math.floor(this.maxZ))},transformed:function(t){return this.copy().transform(t)},dilated:function(t){return new e(this.minX-t,this.minY-t,this.minZ-t,this.maxX+t,this.maxY+t,this.maxZ+t)},dilatedX:function(t){return new e(this.minX-t,this.minY,this.minZ,this.maxX+t,this.maxY,this.maxZ)},dilatedY:function(t){return new e(this.minX,this.minY-t,this.minZ,this.maxX,this.maxY+t,this.maxZ)},dilatedZ:function(t){return new e(this.minX,this.minY,this.minZ-t,this.maxX,this.maxY,this.maxZ+t)},dilatedXYZ:function(t,i,n){return new e(this.minX-t,this.minY-i,this.minZ-n,this.maxX+t,this.maxY+i,this.maxZ+n)},eroded:function(t){return this.dilated(-t)},erodedX:function(t){return this.dilatedX(-t)},erodedY:function(t){return this.dilatedY(-t)},erodedZ:function(t){return this.dilatedZ(-t)},erodedXYZ:function(t,e,i){return this.dilatedXYZ(-t,-e,-i)},shiftedX:function(t){return new e(this.minX+t,this.minY,this.minZ,this.maxX+t,this.maxY,this.maxZ)},shiftedY:function(t){return new e(this.minX,this.minY+t,this.minZ,this.maxX,this.maxY+t,this.maxZ)},shiftedZ:function(t){return new e(this.minX,this.minY,this.minZ+t,this.maxX,this.maxY,this.maxZ+t)},shifted:function(t,i,n){return new e(this.minX+t,this.minY+i,this.minZ+n,this.maxX+t,this.maxY+i,this.maxZ+n)},setMinMax:function(t,e,i,n,s,r){return this.minX=t,this.minY=e,this.minZ=i,this.maxX=n,this.maxY=s,this.maxZ=r,this},setMinX:function(t){return this.minX=t,this},setMinY:function(t){return this.minY=t,this},setMinZ:function(t){return this.minZ=t,this},setMaxX:function(t){return this.maxX=t,this},setMaxY:function(t){return this.maxY=t,this},setMaxZ:function(t){return this.maxZ=t,this},set:function(t){return this.setMinMax(t.minX,t.minY,t.minZ,t.maxX,t.maxY,t.maxZ)},includeBounds:function(t){return this.setMinMax(Math.min(this.minX,t.minX),Math.min(this.minY,t.minY),Math.min(this.minZ,t.minZ),Math.max(this.maxX,t.maxX),Math.max(this.maxY,t.maxY),Math.max(this.maxZ,t.maxZ))},constrainBounds:function(t){return this.setMinMax(Math.max(this.minX,t.minX),Math.max(this.minY,t.minY),Math.max(this.minZ,t.minZ),Math.min(this.maxX,t.maxX),Math.min(this.maxY,t.maxY),Math.min(this.maxZ,t.maxZ))},addCoordinates:function(t,e,i){return this.setMinMax(Math.min(this.minX,t),Math.min(this.minY,e),Math.min(this.minZ,i),Math.max(this.maxX,t),Math.max(this.maxY,e),Math.max(this.maxZ,i))},addPoint:function(t){return this.addCoordinates(t.x,t.y,t.z)},roundOut:function(){return this.setMinMax(Math.floor(this.minX),Math.floor(this.minY),Math.floor(this.minZ),Math.ceil(this.maxX),Math.ceil(this.maxY),Math.ceil(this.maxZ))},roundIn:function(){return this.setMinMax(Math.ceil(this.minX),Math.ceil(this.minY),Math.ceil(this.minZ),Math.floor(this.maxX),Math.floor(this.maxY),Math.floor(this.maxZ))},transform:function(t){function e(t){n=Math.min(n,t.x),s=Math.min(s,t.y),r=Math.min(r,t.z),a=Math.max(a,t.x),o=Math.max(o,t.y),h=Math.max(h,t.z)}if(this.isEmpty())return this;if(t.isIdentity())return this;var n=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY,o=Number.NEGATIVE_INFINITY,h=Number.NEGATIVE_INFINITY,u=new i.Vector3;return e(t.multiplyVector3(u.setXYZ(this.minX,this.minY,this.minZ))),e(t.multiplyVector3(u.setXYZ(this.minX,this.maxY,this.minZ))),e(t.multiplyVector3(u.setXYZ(this.maxX,this.minY,this.minZ))),e(t.multiplyVector3(u.setXYZ(this.maxX,this.maxY,this.minZ))),e(t.multiplyVector3(u.setXYZ(this.minX,this.minY,this.maxZ))),e(t.multiplyVector3(u.setXYZ(this.minX,this.maxY,this.maxZ))),e(t.multiplyVector3(u.setXYZ(this.maxX,this.minY,this.maxZ))),e(t.multiplyVector3(u.setXYZ(this.maxX,this.maxY,this.maxZ))),this.setMinMax(n,s,r,a,o,h)},dilate:function(t){return this.setMinMax(this.minX-t,this.minY-t,this.minZ-t,this.maxX+t,this.maxY+t,this.maxZ+t)},dilateX:function(t){return this.setMinMax(this.minX-t,this.minY,this.minZ,this.maxX+t,this.maxY,this.maxZ)},dilateY:function(t){return this.setMinMax(this.minX,this.minY-t,this.minZ,this.maxX,this.maxY+t,this.maxZ)},dilateZ:function(t){return this.setMinMax(this.minX,this.minY,this.minZ-t,this.maxX,this.maxY,this.maxZ+t)},dilateXYZ:function(t,e,i){return this.setMinMax(this.minX-t,this.minY-e,this.minZ-i,this.maxX+t,this.maxY+e,this.maxZ+i)},erode:function(t){return this.dilate(-t)},erodeX:function(t){return this.dilateX(-t)},erodeY:function(t){return this.dilateY(-t)},erodeZ:function(t){return this.dilateZ(-t)},erodeXYZ:function(t,e,i){return this.dilateXYZ(-t,-e,-i)},shiftX:function(t){return this.setMinMax(this.minX+t,this.minY,this.minZ,this.maxX+t,this.maxY,this.maxZ)},shiftY:function(t){return this.setMinMax(this.minX,this.minY+t,this.minZ,this.maxX,this.maxY+t,this.maxZ)},shiftZ:function(t){return this.setMinMax(this.minX,this.minY,this.minZ+t,this.maxX,this.maxY,this.maxZ+t)},shift:function(t,e,i){return this.setMinMax(this.minX+t,this.minY+e,this.minZ+i,this.maxX+t,this.maxY+e,this.maxZ+i)}},{cuboid:function(t,i,n,s,r,a){return new e(t,i,n,t+s,i+r,n+a)},point:function(t,i,n){return new e(t,i,n,t,i,n)}}),s.mixInto(e,{initialize:e.prototype.setMinMax}),e.NOTHING=new e(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),e.EVERYTHING=new e(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),e}),i("DOT/Complex",["require","DOT/dot","DOT/Util","PHET_CORE/inherit"],function(t){"use strict";function e(t,e){this.real=t,this.imaginary=e}var i=t("DOT/dot");t("DOT/Util");var n=t("PHET_CORE/inherit");return i.register("Complex",e),n(Object,e,{copy:function(t){return t?t.set(this):new e(this.real,this.imaginary)},phase:function(){return Math.atan2(this.imaginary,this.real)},magnitude:function(){return Math.sqrt(this.magnitudeSquared())},magnitudeSquared:function(){return this.real*this.real+this.imaginary*this.imaginary},equals:function(t){return this.real===t.real&&this.imaginary===t.imaginary},equalsEpsilon:function(t,e){return e||(e=0),Math.max(Math.abs(this.real-t.real),Math.abs(this.imaginary-t.imaginary))<=e},plus:function(t){return new e(this.real+t.real,this.imaginary+t.imaginary)},minus:function(t){return new e(this.real-t.real,this.imaginary-t.imaginary)},times:function(t){return new e(this.real*t.real-this.imaginary*t.imaginary,this.real*t.imaginary+this.imaginary*t.real)},dividedBy:function(t){var i=t.magnitudeSquared();return new e((this.real*t.real+this.imaginary*t.imaginary)/i,(this.imaginary*t.real-this.real*t.imaginary)/i)},sqrtOf:function(){var t=this.magnitude();return new e(Math.sqrt((t+this.real)/2),(this.imaginary>=0?1:-1)*Math.sqrt((t-this.real)/2))},sinOf:function(){return new e(Math.sin(this.real)*i.Util.cosh(this.imaginary),Math.cos(this.real)*i.Util.sinh(this.imaginary))},cosOf:function(){return new e(Math.cos(this.real)*i.Util.cosh(this.imaginary),-Math.sin(this.real)*i.Util.sinh(this.imaginary))},squared:function(){return this.times(this)},conjugated:function(){return new e(this.real,-this.imaginary)},exponentiated:function(){return e.createPolar(Math.exp(this.real),this.imaginary)},setRealImaginary:function(t,e){return this.real=t,this.imaginary=e,this},setReal:function(t){return this.real=t,this},setImaginary:function(t){return this.imaginary=t,this},set:function(t){return this.setRealImaginary(t.real,t.imaginary)},setPolar:function(t,e){return this.setRealImaginary(t*Math.cos(e),t*Math.sin(e))},add:function(t){return this.setRealImaginary(this.real+t.real,this.imaginary+t.imaginary)},subtract:function(t){return this.setRealImaginary(this.real-t.real,this.imaginary-t.imaginary)},multiply:function(t){return this.setRealImaginary(this.real*t.real-this.imaginary*t.imaginary,this.real*t.imaginary+this.imaginary*t.real)},divide:function(t){var e=t.magnitudeSquared();return this.setRealImaginary((this.real*t.real+this.imaginary*t.imaginary)/e,(this.imaginary*t.real-this.real*t.imaginary)/e)},exponentiate:function(){return this.setPolar(Math.exp(this.real),this.imaginary)},square:function(){return this.multiply(this)},sqrt:function(){var t=this.magnitude();return this.setRealImaginary(Math.sqrt((t+this.real)/2),(this.imaginary>=0?1:-1)*Math.sqrt((t-this.real)/2))},sin:function(){return this.setRealImaginary(Math.sin(this.real)*i.Util.cosh(this.imaginary),Math.cos(this.real)*i.Util.sinh(this.imaginary))},cos:function(){return this.setRealImaginary(Math.cos(this.real)*i.Util.cosh(this.imaginary),-Math.sin(this.real)*i.Util.sinh(this.imaginary))},conjugate:function(){return this.setRealImaginary(this.real,-this.imaginary)},toString:function(){return"Complex("+this.real+", "+this.imaginary+")"}},{real:function(t){return new e(t,0)},imaginary:function(t){return new e(0,t)},createPolar:function(t,i){return new e(t*Math.cos(i),t*Math.sin(i))}}),e.ZERO=new e(0,0),e.ONE=new e(1,0),e.I=e.imaginary(1),e}),i("DOT/ConvexHull2",["require","DOT/dot"],function(t){"use strict";var e={grahamScan:function(t,e){if(t.length<=2)return t;var i=Number.POSITIVE_INFINITY,n=null;_.each(t,function(t){t.y<=i&&(t.y===i&&n?t.x<n.x&&(n=t):(i=t.y,n=t))}),(t=_.sortBy(t,function(t){return t.minus(n).angle()})).splice(_.indexOf(t,n),1);var s=[n];return _.each(t,function(t){function i(){if(s.length<2)return!1;var i=function(t,e,i){return e.minus(t).crossScalar(i.minus(t))}(s[s.length-2],s[s.length-1],t);return e?i<0:i<=0}if(n.x!==t.x||n.y!==t.y){for(;i();)s.pop();s.push(t)}}),s}};return t("DOT/dot").register("ConvexHull2",e),e}),i("DOT/DampedHarmonic",["require","DOT/dot","PHET_CORE/inherit"],function(t){"use strict";function e(t,i,n,s,r){this.dampingConstant=i/t,this.angularFrequencySquared=n/t,this.discriminant=this.dampingConstant*this.dampingConstant-4*this.angularFrequencySquared,this.solutionType=0,this.c1=0,this.c2=0,Math.abs(this.discriminant)<1e-5?(this.solutionType=e.CRITICALLY_DAMPED,this.angularFrequency=Math.sqrt(this.angularFrequencySquared),this.c1=s,this.c2=r+this.angularFrequency*s):this.discriminant<0?(this.solutionType=e.UNDER_DAMPED,this.frequency=.5*Math.sqrt(-this.discriminant),this.c1=s,this.c2=this.dampingConstant*s/(2*this.frequency)+r/this.frequency):(this.solutionType=e.OVER_DAMPED,this.positiveRoot=.5*(-this.dampingConstant+Math.sqrt(this.discriminant)),this.negativeRoot=.5*(-this.dampingConstant-Math.sqrt(this.discriminant)),this.c2=(this.negativeRoot*s-r)/(this.negativeRoot-this.positiveRoot),this.c1=s-this.c2)}var i=t("DOT/dot"),n=t("PHET_CORE/inherit");return i.register("DampedHarmonic",e),n(Object,e,{getValue:function(t){if(this.solutionType===e.CRITICALLY_DAMPED)return(this.c1+this.c2*t)*Math.exp(-this.angularFrequency*t);if(this.solutionType===e.UNDER_DAMPED){var i=this.frequency*t;return Math.exp(-this.dampingConstant/2*t)*(this.c1*Math.cos(i)+this.c2*Math.sin(i))}if(this.solutionType===e.OVER_DAMPED)return this.c1*Math.exp(this.negativeRoot*t)+this.c2*Math.exp(this.positiveRoot*t);throw new Error("Unknown solution type?")},getDerivative:function(t){if(this.solutionType===e.CRITICALLY_DAMPED)return Math.exp(-this.angularFrequency*t)*(this.c2-this.angularFrequency*(this.c1+this.c2*t));if(this.solutionType===e.UNDER_DAMPED){var i=this.frequency*t,n=Math.cos(i),s=Math.sin(i),r=this.frequency*(this.c2*n-this.c1*s),a=.5*this.dampingConstant*(this.c1*n+this.c2*s);return Math.exp(-.5*this.dampingConstant*t)*(r-a)}if(this.solutionType===e.OVER_DAMPED)return this.c1*this.negativeRoot*Math.exp(this.negativeRoot*t)+this.c2*this.positiveRoot*Math.exp(this.positiveRoot*t);throw new Error("Unknown solution type?")}},{OVER_DAMPED:1,UNDER_DAMPED:2,CRITICALLY_DAMPED:3}),e}),i("PHET_CORE/arrayRemove",["require","PHET_CORE/phetCore"],function(t){"use strict";function e(t,e){var i=_.indexOf(t,e);t.splice(i,1)}return t("PHET_CORE/phetCore").register("arrayRemove",e),e}),i("DOT/DelaunayTriangulation",["require","PHET_CORE/arrayRemove","DOT/Bounds2","DOT/dot","PHET_CORE/inherit","DOT/Util","DOT/Vector2"],function(t){"use strict";function e(t,r,o){o=_.extend({},o);var h;if(this.points=t,this.constraints=r,this.triangles=[],this.edges=[],this.convexHull=[],0!==t.length){for(this.vertices=t.map(function(t,e){return new i(t,e)}),h=0;h<this.constraints.length;h++){var u=this.constraints[h],c=u[0],m=u[1];this.vertices[c].constrainedVertices.push(this.vertices[m])}for(this.vertices.sort(e.vertexComparison),h=0;h<this.vertices.length;h++){var d=this.vertices[h];d.sortedIndex=h;for(var f=d.constrainedVertices.length-1;f>=0;f--){var g=d.constrainedVertices[f];-1===g.sortedIndex&&(g.constrainedVertices.push(d),d.constrainedVertices.splice(f,1))}}this.bottomVertex=this.vertices[0],this.remainingVertices=this.vertices.slice(1);var p=a.NOTHING.copy();for(h=t.length-1;h>=0;h--)p.addPoint(t[h]);this.artificialMinVertex=new i(new l(p.minX-.4*p.width,p.minY-.4*p.height),-1),this.artificialMaxVertex=new i(new l(p.maxX+.4*p.width,p.minY-.4*p.height),-2),this.edges.push(new n(this.artificialMinVertex,this.artificialMaxVertex)),this.edges.push(new n(this.artificialMaxVertex,this.bottomVertex)),this.edges.push(new n(this.bottomVertex,this.artificialMinVertex)),this.triangles.push(new s(this.artificialMinVertex,this.artificialMaxVertex,this.bottomVertex,this.edges[1],this.edges[2],this.edges[0])),this.firstFrontEdge=this.edges[1],this.edges[1].connectAfter(this.edges[2]),this.firstHullEdge=this.edges[0]}}function i(t,e){this.point=t,this.index=e,this.sortedIndex=-1,this.constrainedVertices=[]}function n(t,e){this.startVertex=t,this.endVertex=e,this.triangles=[],this.nextEdge=null,this.previousEdge=null,this.isConstrained=!1}function s(t,e,i,n,s,r){this.aVertex=t,this.bVertex=e,this.cVertex=i,this.aEdge=n,this.bEdge=s,this.cEdge=r,this.aEdge.addTriangle(this),this.bEdge.addTriangle(this),this.cEdge.addTriangle(this)}var r=t("PHET_CORE/arrayRemove"),a=t("DOT/Bounds2"),o=t("DOT/dot"),h=t("PHET_CORE/inherit"),u=t("DOT/Util"),l=t("DOT/Vector2");return o.register("DelaunayTriangulation",e),h(Object,e,{step:function(){for(var t=this.remainingVertices.shift(),e=t.point.x,i=this.firstFrontEdge;i;){if(e>i.endVertex.point.x){var r=new n(i.startVertex,t),a=new n(t,i.endVertex);r.connectAfter(a),this.edges.push(r),this.edges.push(a),this.triangles.push(new s(i.endVertex,i.startVertex,t,r,a,i)),this.reconnectFrontEdges(i,i,r,a),this.legalizeEdge(i),this.addHalfPiHeuristic(r,a),this.constrainEdges(t,r,a);break}if(e===i.endVertex.point.x){var o=i.nextEdge,h=i,u=i.endVertex,l=o.endVertex,c=h.startVertex,m=new n(t,l),d=new n(c,t),f=new n(u,t);d.connectAfter(m),this.edges.push(m),this.edges.push(d),this.edges.push(f),this.triangles.push(new s(l,u,t,f,m,o)),this.triangles.push(new s(u,c,t,d,f,h)),this.reconnectFrontEdges(h,o,d,m),this.legalizeEdge(o),this.legalizeEdge(h),this.legalizeEdge(f),this.addHalfPiHeuristic(d,m),this.constrainEdges(t,d,m);break}i=i.nextEdge}},fillBorderTriangle:function(t,e,i,r,a){var o=new n(i,a);return this.edges.push(o),this.triangles.push(new s(a,r,i,t,o,e)),this.legalizeEdge(t),this.legalizeEdge(e),o},reconnectFrontEdges:function(t,e,i,n){var s=t.previousEdge,r=e.nextEdge;s?(s.disconnectAfter(),s.connectAfter(i)):this.firstFrontEdge=i,r&&(e.disconnectAfter(),n.connectAfter(r))},addHalfPiHeuristic:function(t,e){for(var i=t.endVertex;t.previousEdge&&u.triangleAreaSigned(i.point,t.startVertex.point,t.previousEdge.startVertex.point)>0&&i.point.minus(t.startVertex.point).angleBetween(t.previousEdge.startVertex.point.minus(t.startVertex.point))<Math.PI/2;){var r=t.previousEdge,a=new n(r.startVertex,i);this.edges.push(a),this.triangles.push(new s(i,t.startVertex,r.startVertex,r,a,t)),this.reconnectFrontEdges(r,t,a,a),this.legalizeEdge(r),this.legalizeEdge(t),t=a}for(;e.nextEdge&&u.triangleAreaSigned(i.point,e.nextEdge.endVertex.point,e.endVertex.point)>0&&i.point.minus(e.endVertex.point).angleBetween(e.nextEdge.endVertex.point.minus(e.endVertex.point))<Math.PI/2;){var o=e.nextEdge,h=new n(i,o.endVertex);this.edges.push(h),this.triangles.push(new s(i,e.nextEdge.endVertex,e.endVertex,o,e,h)),this.reconnectFrontEdges(e,o,h,h),this.legalizeEdge(o),this.legalizeEdge(e),e=h}},constrainEdges:function(t,i,s){for(var a=0;a<t.constrainedVertices.length;a++){var o=t.constrainedVertices[a];if(o===i.startVertex||o===s.endVertex)break;var h=[],u=[],l=null,c=null,m=[],d=[],f=e.vertexProduct(t,i.startVertex,o)>0,g=e.vertexProduct(t,s.endVertex,o)<0;if(!f&&!g){var p,v=i.startVertex;for(l=i.triangles[0];e.vertexProduct(t,p=l.getEdgeOppositeFromVertex(t).getOtherVertex(v),o)<0;)l=l.getEdgeOppositeFromVertex(v).getOtherTriangle(l),v=p;if(l.hasVertex(o))break;m.push(l),c=l.getEdgeOppositeFromVertex(t),d.push(c),h.push(l.getEdgeOppositeFromVertex(v)),u.push(l.getEdgeOppositeFromVertex(c.getOtherVertex(v)))}for(;;){if(f)break;if(g)break;if(c.triangles.length>1){var x=c.getOtherTriangle(l);if(x.hasVertex(o)){m.push(x),h.push(x.getNextEdge(c)),u.push(x.getPreviousEdge(c));break}var T;x.aEdge!==c&&x.aEdge.intersectsConstrainedEdge(t,o)?T=x.aEdge:x.bEdge!==c&&x.bEdge.intersectsConstrainedEdge(t,o)?T=x.bEdge:x.cEdge!==c&&x.cEdge.intersectsConstrainedEdge(t,o)&&(T=x.cEdge),x.getNextEdge(T)===c?h.push(x.getPreviousEdge(T)):u.push(x.getNextEdge(T)),c=T,d.push(c),l=x,m.push(l)}else o.point.x<t.point.x?g=!0:f=!0}for(var y=0;y<m.length;y++){var _=m[y];r(this.triangles,_),_.remove()}for(y=0;y<d.length;y++)r(this.edges,d[y]);var E=new n(o,t);E.isConstrained=!0,this.edges.push(E),h.push(E),u.push(E),u.reverse(),window.triDebug&&window.triDebug(this),this.triangulatePolygon(h),this.triangulatePolygon(u)}},triangulatePolygon:function(t){for(;t.length>3;){for(var e=0;e<t.length;e++)t.length;for(var i=0;i<t.length;i++){var r=i<t.length-1?i+1:0,a=t[i],o=t[r],h=a.getSharedVertex(o),l=a.getOtherVertex(h),c=o.getOtherVertex(h);if(!(u.triangleAreaSigned(l.point,h.point,c.point)<=0)){for(var m=c.point.minus(h.point),d=l.point.minus(h.point),f=m.dot(m),g=m.dot(d),p=d.dot(d),v=f*p-g*g,x=t[0].getSharedVertex(t[t.length-1]),T=!1,y=0;y<t.length;y++){var _=t[y].getOtherVertex(x);if(_!==h&&_!==l&&_!==c){var E=_.point.minus(h.point),w=m.dot(E),O=d.dot(E),b=(p*w-g*O)/v,I=(f*O-g*w)/v;if(b>=-1e-10&&I>=-1e-10&&b+I<1+1e-10){T=!0;break}}x=_}if(!T){var A=new n(l,c);this.edges.push(A),this.triangles.push(new s(l,h,c,o,A,a)),r>i?t.splice(i,2,A):(t.splice(i,1,A),t.splice(r,1)),window.triDebug&&window.triDebug(this)}}}}3===t.length&&(this.triangles.push(new s(t[0].getSharedVertex(t[1]),t[1].getSharedVertex(t[2]),t[0].getSharedVertex(t[2]),t[2],t[0],t[1])),window.triDebug&&window.triDebug(this))},finalize:function(){for(var t=[],e=this.firstFrontEdge.nextEdge;e&&e.nextEdge;)t.push(e),e=e.nextEdge;for(var i=this.firstFrontEdge,n=e,s=0;s<t.length-1;s++){var a=t[s],o=t[s+1];if(u.triangleAreaSigned(o.endVertex.point,a.endVertex.point,a.startVertex.point)>1e-10){var h=this.fillBorderTriangle(a,o,a.startVertex,a.endVertex,o.endVertex);t.splice(s,2,h),s=Math.max(s-2,-1),window.triDebug&&window.triDebug(this)}}this.firstFrontEdge=null;for(var l=[],c=[i],m=i;m!==n;){var d=m.triangles[0];d.remove(),r(this.triangles,d);var f=d.getNonArtificialEdge();if(f){l.push(f);var g=f.getSharedVertex(m);m=d.getEdgeOppositeFromVertex(g)}else c.push(d.getEdgeOppositeFromVertex(m.endVertex)),m=d.getEdgeOppositeFromVertex(m.startVertex);c.push(m)}for(s=0;s<c.length;s++)r(this.edges,c[s]);for(window.triDebug&&window.triDebug(this),s=0;s<l.length-1;s++){a=l[s+1],o=l[s],g=a.getSharedVertex(o);var p=a.getOtherVertex(g),v=o.getOtherVertex(g);u.triangleAreaSigned(v.point,g.point,p.point)>1e-10&&(h=this.fillBorderTriangle(a,o,p,g,v),l.splice(s,2,h),s=Math.max(s-2,-1),window.triDebug&&window.triDebug(this))}for(s=0;s<t.length;s++)this.convexHull.push(t[s].startVertex);for(this.convexHull.push(t[t.length-1].endVertex),s=l.length-1;s>=1;s--)this.convexHull.push(l[s].getSharedVertex(l[s-1]))},legalizeEdge:function(t){if(_.includes(this.edges,t)&&2===t.triangles.length&&!t.isConstrained){var e=t.triangles[0],i=t.triangles[1],a=e.getVertexOppositeFromEdge(t),o=i.getVertexOppositeFromEdge(t);if(u.pointInCircleFromPoints(e.aVertex.point,e.bVertex.point,e.cVertex.point,o.point)||u.pointInCircleFromPoints(i.aVertex.point,i.bVertex.point,i.cVertex.point,a.point)){e.remove(),i.remove(),r(this.triangles,e),r(this.triangles,i),r(this.edges,t);var h=new n(a,o);this.edges.push(h);var l=i.getEdgeOppositeFromVertex(i.getVertexBefore(o)),c=e.getEdgeOppositeFromVertex(e.getVertexAfter(a)),m=e.getEdgeOppositeFromVertex(e.getVertexBefore(a)),d=i.getEdgeOppositeFromVertex(i.getVertexAfter(o));this.triangles.push(new s(a,o,e.getVertexBefore(a),l,c,h)),this.triangles.push(new s(o,a,i.getVertexBefore(o),m,d,h)),this.legalizeEdge(l),this.legalizeEdge(c),this.legalizeEdge(m),this.legalizeEdge(d)}}}},{vertexComparison:function(t,e){return t=t.point,e=e.point,t.y<e.y?-1:t.y>e.y?1:t.x<e.x?-1:t.x>e.x?1:0},vertexProduct:function(t,e,i){var n=e.point.minus(t.point),s=i.point.minus(t.point);return n.crossScalar(s)}}),h(Object,i,{isArtificial:function(){return this.index<0}}),h(Object,n,{isArtificial:function(){return this.startVertex.isArtificial()||this.endVertex.isArtificial()},connectAfter:function(t){this.nextEdge=t,t.previousEdge=this},disconnectAfter:function(){this.nextEdge.previousEdge=null,this.nextEdge=null},addTriangle:function(t){this.triangles.push(t)},removeTriangle:function(t){r(this.triangles,t)},getSharedTriangle:function(t){for(var e=0;e<this.triangles.length;e++)for(var i=this.triangles[e],n=0;n<t.triangles.length;n++)if(t.triangles[n]===i)return i;throw new Error("No common triangle")},getSharedVertex:function(t){return this.startVertex===t.startVertex||this.startVertex===t.endVertex?this.startVertex:this.endVertex},getOtherVertex:function(t){return t===this.startVertex?this.endVertex:this.startVertex},getOtherTriangle:function(t){return this.triangles[0]===t?this.triangles[1]:this.triangles[0]},intersectsConstrainedEdge:function(t,e){return u.lineSegmentIntersection(t.point.x,t.point.y,e.point.x,e.point.y,this.startVertex.point.x,this.startVertex.point.y,this.endVertex.point.x,this.endVertex.point.y)}}),h(Object,s,{hasVertex:function(t){return this.aVertex===t||this.bVertex===t||this.cVertex===t},getVertexOppositeFromEdge:function(t){return t===this.aEdge?this.aVertex:t===this.bEdge?this.bVertex:this.cVertex},getEdgeOppositeFromVertex:function(t){return t===this.aVertex?this.aEdge:t===this.bVertex?this.bEdge:this.cEdge},getVertexBefore:function(t){return t===this.aVertex?this.cVertex:t===this.bVertex?this.aVertex:this.bVertex},getVertexAfter:function(t){return t===this.aVertex?this.bVertex:t===this.bVertex?this.cVertex:this.aVertex},getNonArtificialEdge:function(){return this.aEdge.isArtificial()?this.bEdge.isArtificial()?this.cEdge.isArtificial()?null:this.cEdge:this.bEdge:this.aEdge},getNextEdge:function(t){return this.aEdge===t?this.bEdge:this.bEdge===t?this.cEdge:this.cEdge===t?this.aEdge:void 0},getPreviousEdge:function(t){return this.aEdge===t?this.cEdge:this.bEdge===t?this.aEdge:this.cEdge===t?this.bEdge:void 0},isArtificial:function(){return this.aVertex.isArtificial()||this.bVertex.isArtificial()||this.cVertex.isArtificial()},remove:function(){this.aEdge.removeTriangle(this),this.bEdge.removeTriangle(this),this.cEdge.removeTriangle(this)}}),e}),i("DOT/Dimension2",["require","DOT/dot","PHET_CORE/inherit","DOT/Bounds2"],function(t){"use strict";function e(t,e){this.width=t,this.height=e}var i=t("DOT/dot"),n=t("PHET_CORE/inherit");return t("DOT/Bounds2"),i.register("Dimension2",e),n(Object,e,{toString:function(){return"["+this.width+"w, "+this.height+"h]"},set:function(t){return this.width=t.width,this.height=t.height,this},setWidth:function(t){return this.width=t,this},setHeight:function(t){return this.height=t,this},copy:function(t){return t?t.set(this):new e(this.width,this.height)},toBounds:function(t,e){return t=void 0!==t?t:0,e=void 0!==e?e:0,new i.Bounds2(t,e,this.width+t,this.height+e)},equals:function(t){return this.width===t.width&&this.height===t.height}}),e}),i("DOT/EigenvalueDecomposition",["require","DOT/dot"],function(t){"use strict";function e(t){var e,i,s=t.entries;this.n=t.getColumnDimension();var r=this.n;for(this.V=new n(r*r),this.d=new n(r),this.e=new n(r),this.issymmetric=!0,i=0;i<r&&this.issymmetric;i++)for(e=0;e<r&&this.issymmetric;e++)this.issymmetric=s[e*this.n+i]===s[i*this.n+e];if(this.issymmetric){for(e=0;e<r;e++)for(i=0;i<r;i++)this.V[e*this.n+i]=s[e*this.n+i];this.tred2(),this.tql2()}else{for(this.H=new n(r*r),this.ort=new n(r),i=0;i<r;i++)for(e=0;e<r;e++)this.H[e*this.n+i]=s[e*this.n+i];this.orthes(),this.hqr2()}}var i=t("DOT/dot"),n=window.Float64Array||Array;return i.register("EigenvalueDecomposition",e),e.prototype={constructor:e,getV:function(){return this.V.copy()},getRealEigenvalues:function(){return this.d},getImagEigenvalues:function(){return this.e},getD:function(){for(var t=this.n,e=this.d,n=this.e,s=new i.Matrix(t,t),r=s.entries,a=0;a<t;a++){for(var o=0;o<t;o++)r[a*this.n+o]=0;r[a*this.n+a]=e[a],n[a]>0?r[a*this.n+a+1]=n[a]:n[a]<0&&(r[a*this.n+a-1]=n[a])}return s},tred2:function(){var t,e,i,n,s,r,a=this.n,o=this.V,h=this.d,u=this.e;for(e=0;e<a;e++)h[e]=o[(a-1)*a+e];for(t=a-1;t>0;t--){var l=0;for(r=0,i=0;i<t;i++)l+=Math.abs(h[i]);if(0===l)for(u[t]=h[t-1],e=0;e<t;e++)h[e]=o[(t-1)*a+e],o[t*this.n+e]=0,o[e*this.n+t]=0;else{for(i=0;i<t;i++)h[i]/=l,r+=h[i]*h[i];for(n=h[t-1],s=Math.sqrt(r),n>0&&(s=-s),u[t]=l*s,r-=n*s,h[t-1]=n-s,e=0;e<t;e++)u[e]=0;for(e=0;e<t;e++){for(n=h[e],o[e*this.n+t]=n,s=u[e]+o[e*a+e]*n,i=e+1;i<=t-1;i++)s+=o[i*a+e]*h[i],u[i]+=o[i*a+e]*n;u[e]=s}for(n=0,e=0;e<t;e++)u[e]/=r,n+=u[e]*h[e];var c=n/(r+r);for(e=0;e<t;e++)u[e]-=c*h[e];for(e=0;e<t;e++){for(n=h[e],s=u[e],i=e;i<=t-1;i++)o[i*a+e]-=n*u[i]+s*h[i];h[e]=o[(t-1)*a+e],o[t*this.n+e]=0}}h[t]=r}for(t=0;t<a-1;t++){if(o[(a-1)*a+t]=o[t*a+t],o[t*a+t]=1,0!==(r=h[t+1])){for(i=0;i<=t;i++)h[i]=o[i*a+(t+1)]/r;for(e=0;e<=t;e++){for(s=0,i=0;i<=t;i++)s+=o[i*a+(t+1)]*o[i*a+e];for(i=0;i<=t;i++)o[i*a+e]-=s*h[i]}}for(i=0;i<=t;i++)o[i*a+(t+1)]=0}for(e=0;e<a;e++)h[e]=o[(a-1)*a+e],o[(a-1)*a+e]=0;o[(a-1)*a+(a-1)]=1,u[0]=0},tql2:function(){var t,e,n,s,r,a,o=this.n,h=this.V,u=this.d,l=this.e;for(t=1;t<o;t++)l[t-1]=l[t];l[o-1]=0;var c=0,m=0,d=Math.pow(2,-52);for(s=0;s<o;s++){m=Math.max(m,Math.abs(u[s])+Math.abs(l[s]));for(var f=s;f<o&&!(Math.abs(l[f])<=d*m);)f++;if(f>s){0;do{1,r=u[s],a=(u[s+1]-r)/(2*l[s]);var g=i.Matrix.hypot(a,1);a<0&&(g=-g),u[s]=l[s]/(a+g),u[s+1]=l[s]*(a+g);var p=u[s+1],v=r-u[s];for(t=s+2;t<o;t++)u[t]-=v;c+=v,a=u[f];var x=1,T=x,y=x,_=l[s+1],E=0,w=0;for(t=f-1;t>=s;t--)for(y=T,T=x,w=E,r=x*l[t],v=x*a,g=i.Matrix.hypot(a,l[t]),l[t+1]=E*g,E=l[t]/g,a=(x=a/g)*u[t]-E*r,u[t+1]=v+E*(x*r+E*u[t]),n=0;n<o;n++)v=h[n*o+(t+1)],h[n*o+(t+1)]=E*h[n*o+t]+x*v,h[n*o+t]=x*h[n*o+t]-E*v;a=-E*w*y*_*l[s]/p,l[s]=E*a,u[s]=x*a}while(Math.abs(l[s])>d*m)}u[s]=u[s]+c,l[s]=0}for(t=0;t<o-1;t++){for(n=t,a=u[t],e=t+1;e<o;e++)u[e]<a&&(n=e,a=u[e]);if(n!==t)for(u[n]=u[t],u[t]=a,e=0;e<o;e++)a=h[e*this.n+t],h[e*this.n+t]=h[e*o+n],h[e*o+n]=a}},orthes:function(){var t,e,i,n,s,r=this.n,a=this.V,o=this.H,h=this.ort,u=r-1;for(i=1;i<=u-1;i++){var l=0;for(t=i;t<=u;t++)l+=Math.abs(o[t*r+(i-1)]);if(0!==l){var c=0;for(t=u;t>=i;t--)h[t]=o[t*r+(i-1)]/l,c+=h[t]*h[t];for(s=Math.sqrt(c),h[i]>0&&(s=-s),c-=h[i]*s,h[i]=h[i]-s,e=i;e<r;e++){for(n=0,t=u;t>=i;t--)n+=h[t]*o[t*this.n+e];for(n/=c,t=i;t<=u;t++)o[t*this.n+e]-=n*h[t]}for(t=0;t<=u;t++){for(n=0,e=u;e>=i;e--)n+=h[e]*o[t*this.n+e];for(n/=c,e=i;e<=u;e++)o[t*this.n+e]-=n*h[e]}h[i]=l*h[i],o[i*r+(i-1)]=l*s}}for(t=0;t<r;t++)for(e=0;e<r;e++)a[t*this.n+e]=t===e?1:0;for(i=u-1;i>=1;i--)if(0!==o[i*r+(i-1)]){for(t=i+1;t<=u;t++)h[t]=o[t*r+(i-1)];for(e=i;e<=u;e++){for(s=0,t=i;t<=u;t++)s+=h[t]*a[t*this.n+e];for(s=s/h[i]/o[i*r+(i-1)],t=i;t<=u;t++)a[t*this.n+e]+=s*h[t]}}},cdiv:function(t,e,i,n){var s,r;Math.abs(i)>Math.abs(n)?(r=i+(s=n/i)*n,this.cdivr=(t+s*e)/r,this.cdivi=(e-s*t)/r):(r=n+(s=i/n)*i,this.cdivr=(s*t+e)/r,this.cdivi=(s*e-t)/r)},hqr2:function(){var t,e,i,n,s,r,a,o=this.V,h=this.d,u=this.e,l=this.H,c=this.n;t=c-1;var m,d,f,g,p=c-1,v=Math.pow(2,-52),x=0,T=0,y=0,_=0,E=0,w=0,O=0;for(e=0;e<c;e++)for((e<0||e>p)&&(h[e]=l[e*t+e],u[e]=0),i=Math.max(e-1,0);i<c;i++)O+=Math.abs(l[e*this.n+i]);for(a=0;t>=0;){for(s=t;s>0&&(0===(E=Math.abs(l[(s-1)*t+(s-1)])+Math.abs(l[s*t+s]))&&(E=O),!(Math.abs(l[s*t+(s-1)])<v*E));)s--;if(s===t)l[t*t+t]=l[t*t+t]+x,h[t]=l[t*t+t],u[t]=0,t--,a=0;else if(s===t-1){if(d=l[t*t+t-1]*l[(t-1)*t+t],T=(l[(t-1)*t+(t-1)]-l[t*t+t])/2,y=T*T+d,w=Math.sqrt(Math.abs(y)),l[t*t+t]=l[t*t+t]+x,l[(t-1)*t+(t-1)]=l[(t-1)*t+(t-1)]+x,f=l[t*t+t],y>=0){for(w=T>=0?T+w:T-w,h[t-1]=f+w,h[t]=h[t-1],0!==w&&(h[t]=f-d/w),u[t-1]=0,u[t]=0,T=(f=l[t*t+t-1])/(E=Math.abs(f)+Math.abs(w)),y=w/E,T/=_=Math.sqrt(T*T+y*y),y/=_,i=t-1;i<c;i++)w=l[(t-1)*t+i],l[(t-1)*t+i]=y*w+T*l[t*t+i],l[t*t+i]=y*l[t*t+i]-T*w;for(e=0;e<=t;e++)w=l[e*t+t-1],l[e*t+t-1]=y*w+T*l[e*t+t],l[e*t+t]=y*l[e*t+t]-T*w;for(e=0;e<=p;e++)w=o[e*t+t-1],o[e*t+t-1]=y*w+T*o[e*t+t],o[e*t+t]=y*o[e*t+t]-T*w}else h[t-1]=f+T,h[t]=f+T,u[t-1]=w,u[t]=-w;t-=2,a=0}else{if(f=l[t*t+t],g=0,d=0,s<t&&(g=l[(t-1)*t+(t-1)],d=l[t*t+t-1]*l[(t-1)*t+t]),10===a){for(x+=f,e=0;e<=t;e++)l[e*t+e]-=f;f=g=.75*(E=Math.abs(l[t*t+t-1])+Math.abs(l[(t-1)*t+t-2])),d=-.4375*E*E}if(30===a&&(E=(g-f)/2,(E=E*E+d)>0)){for(E=Math.sqrt(E),g<f&&(E=-E),E=f-d/((g-f)/2+E),e=0;e<=t;e++)l[e*t+e]-=E;x+=E,f=g=d=.964}for(a+=1,r=t-2;r>=s&&(w=l[r*t+r],_=f-w,E=g-w,T=(_*E-d)/l[(r+1)*t+r]+l[r*t+r+1],y=l[(r+1)*t+r+1]-w-_-E,_=l[(r+2)*t+r+1],E=Math.abs(T)+Math.abs(y)+Math.abs(_),T/=E,y/=E,_/=E,r!==s)&&!(Math.abs(l[r*t+(r-1)])*(Math.abs(y)+Math.abs(_))<v*(Math.abs(T)*(Math.abs(l[(r-1)*t+r-1])+Math.abs(w)+Math.abs(l[(r+1)*t+r+1]))));)r--;for(e=r+2;e<=t;e++)l[e*t+e-2]=0,e>r+2&&(l[e*t+e-3]=0);for(n=r;n<=t-1;n++){var b=n!==t-1;if(n!==r&&(T=l[n*t+n-1],y=l[(n+1)*t+n-1],_=b?l[(n+2)*t+n-1]:0,0!==(f=Math.abs(T)+Math.abs(y)+Math.abs(_))&&(T/=f,y/=f,_/=f)),0===f)break;if(E=Math.sqrt(T*T+y*y+_*_),T<0&&(E=-E),0!==E){for(n!==r?l[n*t+n-1]=-E*f:s!==r&&(l[n*t+n-1]=-l[n*t+n-1]),f=(T+=E)/E,g=y/E,w=_/E,y/=T,_/=T,i=n;i<c;i++)T=l[n*t+i]+y*l[(n+1)*t+i],b&&(T+=_*l[(n+2)*t+i],l[(n+2)*t+i]=l[(n+2)*t+i]-T*w),l[n*t+i]=l[n*t+i]-T*f,l[(n+1)*t+i]=l[(n+1)*t+i]-T*g;for(e=0;e<=Math.min(t,n+3);e++)T=f*l[e*t+n]+g*l[e*t+n+1],b&&(T+=w*l[e*t+n+2],l[e*t+n+2]=l[e*t+n+2]-T*_),l[e*t+n]=l[e*t+n]-T,l[e*t+n+1]=l[e*t+n+1]-T*y;for(e=0;e<=p;e++)T=f*o[e*t+n]+g*o[e*t+n+1],b&&(T+=w*o[e*t+n+2],o[e*t+n+2]=o[e*t+n+2]-T*_),o[e*t+n]=o[e*t+n]-T,o[e*t+n+1]=o[e*t+n+1]-T*y}}}}if(0!==O){for(t=c-1;t>=0;t--)if(T=h[t],0===(y=u[t]))for(s=t,l[t*t+t]=1,e=t-1;e>=0;e--){for(d=l[e*t+e]-T,_=0,i=s;i<=t;i++)_+=l[e*this.n+i]*l[i*t+t];if(u[e]<0)w=d,E=_;else if(s=e,0===u[e]?l[e*t+t]=0!==d?-_/d:-_/(v*O):(f=l[e*t+e+1],g=l[(e+1)*t+e],m=(f*E-w*_)/(y=(h[e]-T)*(h[e]-T)+u[e]*u[e]),l[e*t+t]=m,Math.abs(f)>Math.abs(w)?l[(e+1)*t+t]=(-_-d*m)/f:l[(e+1)*t+t]=(-E-g*m)/w),m=Math.abs(l[e*t+t]),v*m*m>1)for(i=e;i<=t;i++)l[i*t+t]=l[i*t+t]/m}else if(y<0)for(s=t-1,Math.abs(l[t*t+t-1])>Math.abs(l[(t-1)*t+t])?(l[(t-1)*t+(t-1)]=y/l[t*t+t-1],l[(t-1)*t+t]=-(l[t*t+t]-T)/l[t*t+t-1]):(this.cdiv(0,-l[(t-1)*t+t],l[(t-1)*t+(t-1)]-T,y),l[(t-1)*t+(t-1)]=this.cdivr,l[(t-1)*t+t]=this.cdivi),l[t*t+t-1]=0,l[t*t+t]=1,e=t-2;e>=0;e--){var I,A,M,P;for(I=0,A=0,i=s;i<=t;i++)I+=l[e*this.n+i]*l[i*t+t-1],A+=l[e*this.n+i]*l[i*t+t];if(d=l[e*t+e]-T,u[e]<0)w=d,_=I,E=A;else if(s=e,0===u[e]?(this.cdiv(-I,-A,d,y),l[e*t+t-1]=this.cdivr,l[e*t+t]=this.cdivi):(f=l[e*t+e+1],g=l[(e+1)*t+e],M=(h[e]-T)*(h[e]-T)+u[e]*u[e]-y*y,P=2*(h[e]-T)*y,0===M&&0===P&&(M=v*O*(Math.abs(d)+Math.abs(y)+Math.abs(f)+Math.abs(g)+Math.abs(w))),this.cdiv(f*_-w*I+y*A,f*E-w*A-y*I,M,P),l[e*t+t-1]=this.cdivr,l[e*t+t]=this.cdivi,Math.abs(f)>Math.abs(w)+Math.abs(y)?(l[(e+1)*t+t-1]=(-I-d*l[e*t+t-1]+y*l[e*t+t])/f,l[(e+1)*t+t]=(-A-d*l[e*t+t]-y*l[e*t+t-1])/f):(this.cdiv(-_-g*l[e*t+t-1],-E-g*l[e*t+t],w,y),l[(e+1)*t+t-1]=this.cdivr,l[(e+1)*t+t]=this.cdivi)),m=Math.max(Math.abs(l[e*t+t-1]),Math.abs(l[e*t+t])),v*m*m>1)for(i=e;i<=t;i++)l[i*t+t-1]=l[i*t+t-1]/m,l[i*t+t]=l[i*t+t]/m}for(e=0;e<c;e++)if(e<0||e>p)for(i=e;i<c;i++)o[e*this.n+i]=l[e*this.n+i];for(i=c-1;i>=0;i--)for(e=0;e<=p;e++){for(w=0,n=0;n<=Math.min(i,p);n++)w+=o[e*t+n]*l[n*t+i];o[e*this.n+i]=w}}}},e}),i("DOT/LinearFunction",["require","DOT/dot","DOT/Util"],function(t){"use strict";function e(t,e,n,s,r){r=!_.isUndefined(r)&&r;var a=function(t,e,n,s,r,a){var o=i.Util.linear(t,e,n,s,r);if(a){var h=Math.max(n,s),u=Math.min(n,s);o=i.Util.clamp(o,u,h)}return o},o=function(i){return a(t,e,n,s,i,r)};return o.inverse=function(i){return a(n,s,t,e,i,r)},o}var i=t("DOT/dot");return t("DOT/Util"),i.register("LinearFunction",e),e}),i("DOT/LUDecomposition",["require","DOT/dot"],function(t){"use strict";function e(t){var e,i,s;this.matrix=t,this.LU=t.getArrayCopy();var r=this.LU;this.m=t.getRowDimension();var a=this.m;this.n=t.getColumnDimension();var o=this.n;for(this.piv=new Uint32Array(a),e=0;e<a;e++)this.piv[e]=e;this.pivsign=1;var h=new n(a);for(i=0;i<o;i++){for(e=0;e<a;e++)h[e]=r[t.index(e,i)];for(e=0;e<a;e++){var u=Math.min(e,i),l=0;for(s=0;s<u;s++){l+=r[t.index(e,s)]*h[s]}h[e]-=l,r[t.index(e,i)]=h[e]}var c=i;for(e=i+1;e<a;e++)Math.abs(h[e])>Math.abs(h[c])&&(c=e);if(c!==i){for(s=0;s<o;s++){var m=t.index(c,s),d=t.index(i,s),f=r[m];r[m]=r[d],r[d]=f}s=this.piv[c],this.piv[c]=this.piv[i],this.piv[i]=s,this.pivsign=-this.pivsign}if(i<a&&0!==r[this.matrix.index(i,i)])for(e=i+1;e<a;e++)r[t.index(e,i)]/=r[t.index(i,i)]}}var i=t("DOT/dot"),n=window.Float64Array||Array;return i.register("LUDecomposition",e),e.prototype={constructor:e,isNonsingular:function(){for(var t=0;t<this.n;t++){var e=this.matrix.index(t,t);if(0===this.LU[e])return!1}return!0},getL:function(){for(var t=new i.Matrix(this.m,this.n),e=0;e<this.m;e++)for(var n=0;n<this.n;n++)t.entries[t.index(e,n)]=e>n?this.LU[this.matrix.index(e,n)]:e===n?1:0;return t},getU:function(){for(var t=new i.Matrix(this.n,this.n),e=0;e<this.n;e++)for(var n=0;n<this.n;n++)t.entries[t.index(e,n)]=e<=n?this.LU[this.matrix.index(e,n)]:0;return t},getPivot:function(){for(var t=new Uint32Array(this.m),e=0;e<this.m;e++)t[e]=this.piv[e];return t},getDoublePivot:function(){for(var t=new n(this.m),e=0;e<this.m;e++)t[e]=this.piv[e];return t},det:function(){if(this.m!==this.n)throw new Error("Matrix must be square.");for(var t=this.pivsign,e=0;e<this.n;e++)t*=this.LU[this.matrix.index(e,e)];return t},solve:function(t){var e,i,n;if(t.getRowDimension()!==this.m)throw new Error("Matrix row dimensions must agree.");if(!this.isNonsingular())throw new Error("Matrix is singular.");var s=t.getColumnDimension(),r=t.getArrayRowMatrix(this.piv,0,s-1);for(n=0;n<this.n;n++)for(e=n+1;e<this.n;e++)for(i=0;i<s;i++)r.entries[r.index(e,i)]-=r.entries[r.index(n,i)]*this.LU[this.matrix.index(e,n)];for(n=this.n-1;n>=0;n--){for(i=0;i<s;i++)r.entries[r.index(n,i)]/=this.LU[this.matrix.index(n,n)];for(e=0;e<n;e++)for(i=0;i<s;i++)r.entries[r.index(e,i)]-=r.entries[r.index(n,i)]*this.LU[this.matrix.index(e,n)]}return r}},e}),i("PHET_CORE/isArray",["require","PHET_CORE/phetCore"],function(t){"use strict";function e(t){return"[object Array]"===Object.prototype.toString.call(t)}return t("PHET_CORE/phetCore").register("isArray",e),e}),i("DOT/SingularValueDecomposition",["require","DOT/dot"],function(t){"use strict";function e(t){this.matrix=t;var e=t,s=e.getArrayCopy();this.m=e.getRowDimension(),this.n=e.getColumnDimension();var r=this.m,a=this.n,o=Math.min,h=Math.max,u=Math.pow,l=Math.abs,c=o(r,a);this.s=new n(o(r+1,a));var m=this.s;this.U=new n(r*c);var d=this.U;this.V=new n(a*a);var f,g,p,v,x,T,y,_=this.V,E=new n(a),w=new n(r),O=i.Matrix.hypot,b=o(r-1,a),I=h(0,o(a-2,r));for(p=0;p<h(b,I);p++){if(p<b){for(m[p]=0,f=p;f<r;f++)m[p]=O(m[p],s[f*a+p]);if(0!==m[p]){for(s[p*a+p]<0&&(m[p]=-m[p]),f=p;f<r;f++)s[f*a+p]/=m[p];s[p*a+p]+=1}m[p]=-m[p]}for(g=p+1;g<a;g++){if(p<b&&0!==m[p]){for(v=0,f=p;f<r;f++)v+=s[f*a+p]*s[f*a+g];for(v=-v/s[p*a+p],f=p;f<r;f++)s[f*a+g]+=v*s[f*a+p]}E[g]=s[p*a+g]}if(p<b)for(f=p;f<r;f++)d[f*c+p]=s[f*a+p];if(p<I){for(E[p]=0,f=p+1;f<a;f++)E[p]=O(E[p],E[f]);if(0!==E[p]){for(E[p+1]<0&&(E[p]=-E[p]),f=p+1;f<a;f++)E[f]/=E[p];E[p+1]+=1}if(E[p]=-E[p],p+1<r&&0!==E[p]){for(f=p+1;f<r;f++)w[f]=0;for(g=p+1;g<a;g++)for(f=p+1;f<r;f++)w[f]+=E[g]*s[f*a+g];for(g=p+1;g<a;g++)for(v=-E[g]/E[p+1],f=p+1;f<r;f++)s[f*a+g]+=v*w[f]}for(f=p+1;f<a;f++)_[f*a+p]=E[f]}}var A=o(a,r+1);for(b<a&&(m[b]=s[b*a+b]),r<A&&(m[A-1]=0),I+1<A&&(E[I]=s[I*a+A-1]),E[A-1]=0,g=b;g<c;g++){for(f=0;f<r;f++)d[f*c+g]=0;d[g*c+g]=1}for(p=b-1;p>=0;p--)if(0!==m[p]){for(g=p+1;g<c;g++){for(v=0,f=p;f<r;f++)v+=d[f*c+p]*d[f*c+g];for(v=-v/d[p*c+p],f=p;f<r;f++)d[f*c+g]+=v*d[f*c+p]}for(f=p;f<r;f++)d[f*c+p]=-d[f*c+p];for(d[p*c+p]=1+d[p*c+p],f=0;f<p-1;f++)d[f*c+p]=0}else{for(f=0;f<r;f++)d[f*c+p]=0;d[p*c+p]=1}for(p=a-1;p>=0;p--){if(p<I&&0!==E[p])for(g=p+1;g<c;g++){for(v=0,f=p+1;f<a;f++)v+=_[f*a+p]*_[f*a+g];for(v=-v/_[(p+1)*a+p],f=p+1;f<a;f++)_[f*a+g]+=v*_[f*a+p]}for(f=0;f<a;f++)_[f*a+p]=0;_[p*a+p]=1}for(var M=A-1,P=0,S=u(2,-52),C=u(2,-966);A>0;){var R;if(P>500)break;for(p=A-2;p>=-1&&-1!==p;p--)if(l(E[p])<=C+S*(l(m[p])+l(m[p+1]))){E[p]=0;break}if(p===A-2)R=4;else{var D;for(D=A-1;D>=p&&D!==p;D--)if(v=(D!==A?l(E[D]):0)+(D!==p+1?l(E[D-1]):0),l(m[D])<=C+S*v){m[D]=0;break}D===p?R=3:D===A-1?R=1:(R=2,p=D)}switch(p++,R){case 1:for(x=E[A-2],E[A-2]=0,g=A-2;g>=p;g--)for(v=O(m[g],x),T=m[g]/v,y=x/v,m[g]=v,g!==p&&(x=-y*E[g-1],E[g-1]=T*E[g-1]),f=0;f<a;f++)v=T*_[f*a+g]+y*_[f*a+A-1],_[f*a+A-1]=-y*_[f*a+g]+T*_[f*a+A-1],_[f*a+g]=v;break;case 2:for(x=E[p-1],E[p-1]=0,g=p;g<A;g++)for(v=O(m[g],x),T=m[g]/v,y=x/v,m[g]=v,x=-y*E[g],E[g]=T*E[g],f=0;f<r;f++)v=T*d[f*c+g]+y*d[f*c+p-1],d[f*c+p-1]=-y*d[f*c+g]+T*d[f*c+p-1],d[f*c+g]=v;break;case 3:var V=h(h(h(h(l(m[A-1]),l(m[A-2])),l(E[A-2])),l(m[p])),l(E[p])),X=m[A-1]/V,N=m[A-2]/V,Y=E[A-2]/V,H=m[p]/V,F=E[p]/V,L=((N+X)*(N-X)+Y*Y)/2,z=X*Y*(X*Y),q=0;0===L&&0===z||(q=Math.sqrt(L*L+z),L<0&&(q=-q),q=z/(L+q)),x=(H+X)*(H-X)+q;var k=H*F;for(g=p;g<A-1;g++){for(T=x/(v=O(x,k)),y=k/v,g!==p&&(E[g-1]=v),x=T*m[g]+y*E[g],E[g]=T*E[g]-y*m[g],k=y*m[g+1],m[g+1]=T*m[g+1],f=0;f<a;f++)v=T*_[f*a+g]+y*_[f*a+g+1],_[f*a+g+1]=-y*_[f*a+g]+T*_[f*a+g+1],_[f*a+g]=v;if(v=O(x,k),T=x/v,y=k/v,m[g]=v,x=T*E[g]+y*m[g+1],m[g+1]=-y*E[g]+T*m[g+1],k=y*E[g+1],E[g+1]=T*E[g+1],g<r-1)for(f=0;f<r;f++)v=T*d[f*c+g]+y*d[f*c+g+1],d[f*c+g+1]=-y*d[f*c+g]+T*d[f*c+g+1],d[f*c+g]=v}E[A-2]=x,P+=1;break;case 4:if(m[p]<=0)for(m[p]=m[p]<0?-m[p]:0,f=0;f<=M;f++)_[f*a+p]=-_[f*a+p];for(;p<M&&!(m[p]>=m[p+1]);){if(v=m[p],m[p]=m[p+1],m[p+1]=v,p<a-1)for(f=0;f<a;f++)v=_[f*a+p+1],_[f*a+p+1]=_[f*a+p],_[f*a+p]=v;if(p<r-1)for(f=0;f<r;f++)v=d[f*c+p+1],d[f*c+p+1]=d[f*c+p],d[f*c+p]=v;p++}P=0,A--;break;default:throw new Error("invalid kase: "+R)}}}var i=t("DOT/dot"),n=window.Float64Array||Array;return i.register("SingularValueDecomposition",e),e.prototype={constructor:e,getU:function(){return new i.Matrix(this.m,Math.min(this.m+1,this.n),this.U,!0)},getV:function(){return new i.Matrix(this.n,this.n,this.V,!0)},getSingularValues:function(){return this.s},getS:function(){for(var t=new i.Matrix(this.n,this.n),e=0;e<this.n;e++){for(var n=0;n<this.n;n++)t.entries[t.index(e,n)]=0;t.entries[t.index(e,e)]=this.s[e]}return t},norm2:function(){return this.s[0]},cond:function(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]},rank:function(){for(var t=Math.pow(2,-23),e=Math.max(this.m,this.n)*this.s[0]*t,i=0,n=0;n<this.s.length;n++)this.s[n]>e&&i++;return i}},e.pseudoinverse=function(t){var n=new e(t),s=i.Matrix.diagonalMatrix(n.getSingularValues().map(function(t){return Math.abs(t)<1e-300?0:1/t}));return n.getV().times(s).times(n.getU().transpose())},e}),i("DOT/QRDecomposition",["require","DOT/dot"],function(t){"use strict";var e=t("DOT/dot"),i=window.Float64Array||Array;e.QRDecomposition=function(t){this.matrix=t,this.QR=t.getArrayCopy();var n=this.QR;this.m=t.getRowDimension();var s=this.m;this.n=t.getColumnDimension();var r=this.n;this.Rdiag=new i(r);var a,o,h;for(h=0;h<r;h++){var u=0;for(a=h;a<s;a++)u=e.Matrix.hypot(u,n[this.matrix.index(a,h)]);if(0!==u){for(n[this.matrix.index(h,h)]<0&&(u=-u),a=h;a<s;a++)n[this.matrix.index(a,h)]/=u;for(n[this.matrix.index(h,h)]+=1,o=h+1;o<r;o++){var l=0;for(a=h;a<s;a++)l+=n[this.matrix.index(a,h)]*n[this.matrix.index(a,o)];for(l=-l/n[this.matrix.index(h,h)],a=h;a<s;a++)n[this.matrix.index(a,o)]+=l*n[this.matrix.index(a,h)]}}this.Rdiag[h]=-u}};var n=e.QRDecomposition;return n.prototype={constructor:n,isFullRank:function(){for(var t=0;t<this.n;t++)if(0===this.Rdiag[t])return!1;return!0},getH:function(){for(var t=new e.Matrix(this.m,this.n),i=0;i<this.m;i++)for(var n=0;n<this.n;n++)t.entries[t.index(i,n)]=i>=n?this.QR[this.matrix.index(i,n)]:0;return t},getR:function(){for(var t=new e.Matrix(this.n,this.n),i=0;i<this.n;i++)for(var n=0;n<this.n;n++)t.entries[t.index(i,n)]=i<n?this.QR[this.matrix.index(i,n)]:i===n?this.Rdiag[i]:0;return t},getQ:function(){var t,i,n,s=new e.Matrix(this.m,this.n);for(n=this.n-1;n>=0;n--){for(t=0;t<this.m;t++)s.entries[s.index(t,n)]=0;for(s.entries[s.index(n,n)]=1,i=n;i<this.n;i++)if(0!==this.QR[this.matrix.index(n,n)]){var r=0;for(t=n;t<this.m;t++)r+=this.QR[this.matrix.index(t,n)]*s.entries[s.index(t,i)];for(r=-r/this.QR[this.matrix.index(n,n)],t=n;t<this.m;t++)s.entries[s.index(t,i)]+=r*this.QR[this.matrix.index(t,n)]}}return s},solve:function(t){if(t.getRowDimension()!==this.m)throw new Error("Matrix row dimensions must agree.");if(!this.isFullRank())throw new Error("Matrix is rank deficient.");var i,n,s,r=t.getColumnDimension(),a=t.getArrayCopy();for(s=0;s<this.n;s++)for(n=0;n<r;n++){var o=0;for(i=s;i<this.m;i++)o+=this.QR[this.matrix.index(i,s)]*a[t.index(i,n)];for(o=-o/this.QR[this.matrix.index(s,s)],i=s;i<this.m;i++)a[t.index(i,n)]+=o*this.QR[this.matrix.index(i,s)]}for(s=this.n-1;s>=0;s--){for(n=0;n<r;n++)a[t.index(s,n)]/=this.Rdiag[s];for(i=0;i<s;i++)for(n=0;n<r;n++)a[t.index(i,n)]-=a[t.index(s,n)]*this.QR[this.matrix.index(i,s)]}return new e.Matrix(this.n,r,a,!0).getMatrix(0,this.n-1,0,r-1)}},n}),i("DOT/Matrix",["require","DOT/dot","PHET_CORE/isArray","DOT/SingularValueDecomposition","DOT/LUDecomposition","DOT/QRDecomposition","DOT/EigenvalueDecomposition","DOT/Vector2","DOT/Vector3","DOT/Vector4"],function(t){"use strict";function e(t,e,i,r){this.m=t,this.n=e;var a=t*e;this.size=a;var o;if(r)this.entries=i;else if(i||(i=0),this.entries=new n(a),s(i))for(o=0;o<a;o++)this.entries[o]=i[o];else for(o=0;o<a;o++)this.entries[o]=i}var i=t("DOT/dot"),n=window.Float64Array||Array,s=t("PHET_CORE/isArray");return t("DOT/SingularValueDecomposition"),t("DOT/LUDecomposition"),t("DOT/QRDecomposition"),t("DOT/EigenvalueDecomposition"),t("DOT/Vector2"),t("DOT/Vector3"),t("DOT/Vector4"),i.register("Matrix",e),e.hypot=function(t,e){var i;return Math.abs(t)>Math.abs(e)?(i=e/t,i=Math.abs(t)*Math.sqrt(1+i*i)):0!==e?(i=t/e,i=Math.abs(e)*Math.sqrt(1+i*i)):i=0,i},e.prototype={constructor:e,copy:function(){for(var t=new e(this.m,this.n),i=0;i<this.size;i++)t.entries[i]=this.entries[i];return t},getArray:function(){return this.entries},getArrayCopy:function(){return new n(this.entries)},getRowDimension:function(){return this.m},getColumnDimension:function(){return this.n},index:function(t,e){return t*this.n+e},get:function(t,e){return this.entries[this.index(t,e)]},set:function(t,e,i){this.entries[this.index(t,e)]=i},getMatrix:function(t,i,n,s){for(var r=new e(i-t+1,s-n+1),a=t;a<=i;a++)for(var o=n;o<=s;o++)r.entries[r.index(a-t,o-n)]=this.entries[this.index(a,o)];return r},getArrayRowMatrix:function(t,i,n){for(var s=new e(t.length,n-i+1),r=0;r<t.length;r++)for(var a=i;a<=n;a++)s.entries[s.index(r,a-i)]=this.entries[this.index(t[r],a)];return s},transpose:function(t){t=t||new e(this.n,this.m);for(var i=0;i<this.m;i++)for(var n=0;n<this.n;n++)t.entries[t.index(n,i)]=this.entries[this.index(i,n)];return t},norm1:function(){for(var t=0,e=0;e<this.n;e++){for(var i=0,n=0;n<this.m;n++)i+=Math.abs(this.entries[this.index(n,e)]);t=Math.max(t,i)}return t},norm2:function(){return new i.SingularValueDecomposition(this).norm2()},normInf:function(){for(var t=0,e=0;e<this.m;e++){for(var i=0,n=0;n<this.n;n++)i+=Math.abs(this.entries[this.index(e,n)]);t=Math.max(t,i)}return t},normF:function(){for(var t=0,i=0;i<this.m;i++)for(var n=0;n<this.n;n++)t=e.hypot(t,this.entries[this.index(i,n)]);return t},uminus:function(){for(var t=new e(this.m,this.n),i=0;i<this.m;i++)for(var n=0;n<this.n;n++)t.entries[t.index(i,n)]=-this.entries[this.index(i,n)];return t},plus:function(t){this.checkMatrixDimensions(t);for(var i=new e(this.m,this.n),n=0;n<this.m;n++)for(var s=0;s<this.n;s++){var r=i.index(n,s);i.entries[r]=this.entries[r]+t.entries[r]}return i},plusEquals:function(t){this.checkMatrixDimensions(t);for(var i=new e(this.m,this.n),n=0;n<this.m;n++)for(var s=0;s<this.n;s++){var r=i.index(n,s);this.entries[r]=this.entries[r]+t.entries[r]}return this},minus:function(t){this.checkMatrixDimensions(t);for(var i=new e(this.m,this.n),n=0;n<this.m;n++)for(var s=0;s<this.n;s++){var r=this.index(n,s);i.entries[r]=this.entries[r]-t.entries[r]}return i},minusEquals:function(t){this.checkMatrixDimensions(t);for(var e=0;e<this.m;e++)for(var i=0;i<this.n;i++){var n=this.index(e,i);this.entries[n]=this.entries[n]-t.entries[n]}return this},arrayTimes:function(t){this.checkMatrixDimensions(t);for(var i=new e(this.m,this.n),n=0;n<this.m;n++)for(var s=0;s<this.n;s++){var r=i.index(n,s);i.entries[r]=this.entries[r]*t.entries[r]}return i},arrayTimesEquals:function(t){this.checkMatrixDimensions(t);for(var e=0;e<this.m;e++)for(var i=0;i<this.n;i++){var n=this.index(e,i);this.entries[n]=this.entries[n]*t.entries[n]}return this},arrayRightDivide:function(t){this.checkMatrixDimensions(t);for(var i=new e(this.m,this.n),n=0;n<this.m;n++)for(var s=0;s<this.n;s++){var r=this.index(n,s);i.entries[r]=this.entries[r]/t.entries[r]}return i},arrayRightDivideEquals:function(t){this.checkMatrixDimensions(t);for(var e=0;e<this.m;e++)for(var i=0;i<this.n;i++){var n=this.index(e,i);this.entries[n]=this.entries[n]/t.entries[n]}return this},arrayLeftDivide:function(t){this.checkMatrixDimensions(t);for(var i=new e(this.m,this.n),n=0;n<this.m;n++)for(var s=0;s<this.n;s++){var r=this.index(n,s);i.entries[r]=t.entries[r]/this.entries[r]}return i},arrayLeftDivideEquals:function(t){this.checkMatrixDimensions(t);for(var e=0;e<this.m;e++)for(var i=0;i<this.n;i++){var n=this.index(e,i);this.entries[n]=t.entries[n]/this.entries[n]}return this},times:function(t){var i,s,r,a,o,h;if(t.isMatrix){if((h=t).m!==this.n)throw new Error("Matrix inner dimensions must agree.");i=new e(this.m,h.n);var u=new n(this.n);for(r=0;r<h.n;r++){for(a=0;a<this.n;a++)u[a]=h.entries[h.index(a,r)];for(s=0;s<this.m;s++){for(o=0,a=0;a<this.n;a++)o+=this.entries[this.index(s,a)]*u[a];i.entries[i.index(s,r)]=o}}return i}for(o=t,i=new e(this.m,this.n),s=0;s<this.m;s++)for(r=0;r<this.n;r++)i.entries[i.index(s,r)]=o*this.entries[this.index(s,r)];return i},timesEquals:function(t){for(var e=0;e<this.m;e++)for(var i=0;i<this.n;i++){var n=this.index(e,i);this.entries[n]=t*this.entries[n]}return this},solve:function(t){return this.m===this.n?new i.LUDecomposition(this).solve(t):new i.QRDecomposition(this).solve(t)},solveTranspose:function(t){return this.transpose().solve(t.transpose())},inverse:function(){return this.solve(e.identity(this.m,this.m))},det:function(){return new i.LUDecomposition(this).det()},rank:function(){return new i.SingularValueDecomposition(this).rank()},cond:function(){return new i.SingularValueDecomposition(this).cond()},trace:function(){for(var t=0,e=0;e<Math.min(this.m,this.n);e++)t+=this.entries[this.index(e,e)];return t},checkMatrixDimensions:function(t){if(t.m!==this.m||t.n!==this.n)throw new Error("Matrix dimensions must agree.")},toString:function(){var t="";t+="dim: "+this.getRowDimension()+"x"+this.getColumnDimension()+"\n";for(var e=0;e<this.getRowDimension();e++){for(var i=0;i<this.getColumnDimension();i++)t+=this.get(e,i)+" ";t+="\n"}return t},extractVector2:function(t){return new i.Vector2(this.get(0,t),this.get(1,t))},extractVector3:function(t){return new i.Vector3(this.get(0,t),this.get(1,t),this.get(2,t))},extractVector4:function(t){return new i.Vector4(this.get(0,t),this.get(1,t),this.get(2,t),this.get(3,t))},setVectors3:function(t){for(var e=t.length,i=0;i<e;i++){var n=t[i];this.entries[i]=n.x,this.entries[i+e]=n.y,this.entries[i+2*e]=n.z}return this},isMatrix:!0},e.identity=function(t,i){for(var n=new e(t,i),s=0;s<t;s++)for(var r=0;r<i;r++)n.entries[n.index(s,r)]=s===r?1:0;return n},e.diagonalMatrix=function(t){for(var i=t.length,n=new e(i,i),s=0;s<i;s++)n.entries[n.index(s,s)]=t[s];return n},e.rowVector2=function(t){return new e(1,2,[t.x,t.y])},e.rowVector3=function(t){return new e(1,3,[t.x,t.y,t.z])},e.rowVector4=function(t){return new e(1,4,[t.x,t.y,t.z,t.w])},e.rowVector=function(t){if(t.isVector2)return e.rowVector2(t);if(t.isVector3)return e.rowVector3(t);if(t.isVector4)return e.rowVector4(t);throw new Error("undetected type of vector: "+t.toString())},e.columnVector2=function(t){return new e(2,1,[t.x,t.y])},e.columnVector3=function(t){return new e(3,1,[t.x,t.y,t.z])},e.columnVector4=function(t){return new e(4,1,[t.x,t.y,t.z,t.w])},e.columnVector=function(t){if(t.isVector2)return e.columnVector2(t);if(t.isVector3)return e.columnVector3(t);if(t.isVector4)return e.columnVector4(t);throw new Error("undetected type of vector: "+t.toString())},e.fromVectors2=function(t){for(var i=t.length,s=new n(2*i),r=0;r<i;r++){var a=t[r];s[r]=a.x,s[r+i]=a.y}return new e(2,i,s,!0)},e.fromVectors3=function(t){for(var i=t.length,s=new n(3*i),r=0;r<i;r++){var a=t[r];s[r]=a.x,s[r+i]=a.y,s[r+2*i]=a.z}return new e(3,i,s,!0)},e.fromVectors4=function(t){for(var i=t.length,s=new n(4*i),r=0;r<i;r++){var a=t[r];s[r]=a.x,s[r+i]=a.y,s[r+2*i]=a.z,s[r+3*i]=a.w}return new e(4,i,s,!0)},e}),i("DOT/Matrix4",["require","DOT/dot","DOT/Vector3","DOT/Vector4"],function(t){"use strict";function e(t,e,i,s,r,a,o,h,u,l,c,m,d,f,g,p,v){this.entries=new n(16),this.rowMajor(void 0!==t?t:1,void 0!==e?e:0,void 0!==i?i:0,void 0!==s?s:0,void 0!==r?r:0,void 0!==a?a:1,void 0!==o?o:0,void 0!==h?h:0,void 0!==u?u:0,void 0!==l?l:0,void 0!==c?c:1,void 0!==m?m:0,void 0!==d?d:0,void 0!==f?f:0,void 0!==g?g:0,void 0!==p?p:1,v)}var i=t("DOT/dot");t("DOT/Vector3"),t("DOT/Vector4");var n=window.Float32Array||Array;i.register("Matrix4",e);var s=e.Types={OTHER:0,IDENTITY:1,TRANSLATION_3D:2,SCALING:3,AFFINE:4};return e.identity=function(){return new e(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,s.IDENTITY)},e.translation=function(t,i,n){return new e(1,0,0,t,0,1,0,i,0,0,1,n,0,0,0,1,s.TRANSLATION_3D)},e.translationFromVector=function(t){return e.translation(t.x,t.y,t.z)},e.scaling=function(t,i,n){return i=void 0===i?t:i,n=void 0===n?t:n,new e(t,0,0,0,0,i,0,0,0,0,n,0,0,0,0,1,s.SCALING)},e.rotationAxisAngle=function(t,i){var n=Math.cos(i),r=Math.sin(i),a=1-n;return new e(t.x*t.x*a+n,t.x*t.y*a-t.z*r,t.x*t.z*a+t.y*r,0,t.y*t.x*a+t.z*r,t.y*t.y*a+n,t.y*t.z*a-t.x*r,0,t.z*t.x*a-t.y*r,t.z*t.y*a+t.x*r,t.z*t.z*a+n,0,0,0,0,1,s.AFFINE)},e.rotationX=function(t){var i=Math.cos(t),n=Math.sin(t);return new e(1,0,0,0,0,i,-n,0,0,n,i,0,0,0,0,1,s.AFFINE)},e.rotationY=function(t){var i=Math.cos(t),n=Math.sin(t);return new e(i,0,n,0,0,1,0,0,-n,0,i,0,0,0,0,1,s.AFFINE)},e.rotationZ=function(t){var i=Math.cos(t),n=Math.sin(t);return new e(i,-n,0,0,n,i,0,0,0,0,1,0,0,0,0,1,s.AFFINE)},e.gluPerspective=function(t,i,n,s){var r=Math.cos(t)/Math.sin(t);return new e(r/i,0,0,0,0,r,0,0,0,0,(s+n)/(n-s),2*s*n/(n-s),0,0,-1,0)},e.prototype={constructor:e,rowMajor:function(t,e,i,n,r,a,o,h,u,l,c,m,d,f,g,p,v){return this.entries[0]=t,this.entries[1]=r,this.entries[2]=u,this.entries[3]=d,this.entries[4]=e,this.entries[5]=a,this.entries[6]=l,this.entries[7]=f,this.entries[8]=i,this.entries[9]=o,this.entries[10]=c,this.entries[11]=g,this.entries[12]=n,this.entries[13]=h,this.entries[14]=m,this.entries[15]=p,this.type=void 0===v?0===d&&0===f&&0===g&&1===p?s.AFFINE:s.OTHER:v,this},columnMajor:function(t,e,i,n,s,r,a,o,h,u,l,c,m,d,f,g,p){return this.rowMajor(t,s,h,m,e,r,u,d,i,a,l,f,n,o,c,g,p)},set:function(t){return this.rowMajor(t.m00(),t.m01(),t.m02(),t.m03(),t.m10(),t.m11(),t.m12(),t.m13(),t.m20(),t.m21(),t.m22(),t.m23(),t.m30(),t.m31(),t.m32(),t.m33(),t.type)},m00:function(){return this.entries[0]},m01:function(){return this.entries[4]},m02:function(){return this.entries[8]},m03:function(){return this.entries[12]},m10:function(){return this.entries[1]},m11:function(){return this.entries[5]},m12:function(){return this.entries[9]},m13:function(){return this.entries[13]},m20:function(){return this.entries[2]},m21:function(){return this.entries[6]},m22:function(){return this.entries[10]},m23:function(){return this.entries[14]},m30:function(){return this.entries[3]},m31:function(){return this.entries[7]},m32:function(){return this.entries[11]},m33:function(){return this.entries[15]},isFinite:function(){return isFinite(this.m00())&&isFinite(this.m01())&&isFinite(this.m02())&&isFinite(this.m03())&&isFinite(this.m10())&&isFinite(this.m11())&&isFinite(this.m12())&&isFinite(this.m13())&&isFinite(this.m20())&&isFinite(this.m21())&&isFinite(this.m22())&&isFinite(this.m23())&&isFinite(this.m30())&&isFinite(this.m31())&&isFinite(this.m32())&&isFinite(this.m33())},getTranslation:function(){return new i.Vector3(this.m03(),this.m13(),this.m23())},get translation(){return this.getTranslation()},getScaleVector:function(){var t=this.m00()+this.m03(),e=this.m10()+this.m13(),n=this.m20()+this.m23(),s=this.m30()+this.m33(),r=this.m01()+this.m03(),a=this.m11()+this.m13(),o=this.m21()+this.m23(),h=this.m31()+this.m33(),u=this.m02()+this.m03(),l=this.m12()+this.m13(),c=this.m22()+this.m23(),m=this.m32()+this.m33();return new i.Vector3(Math.sqrt(t*t+e*e+n*n+s*s),Math.sqrt(r*r+a*a+o*o+h*h),Math.sqrt(u*u+l*l+c*c+m*m))},get scaleVector(){return this.getScaleVector()},getCSSTransform:function(){return"matrix3d("+this.entries[0].toFixed(20)+","+this.entries[1].toFixed(20)+","+this.entries[2].toFixed(20)+","+this.entries[3].toFixed(20)+","+this.entries[4].toFixed(20)+","+this.entries[5].toFixed(20)+","+this.entries[6].toFixed(20)+","+this.entries[7].toFixed(20)+","+this.entries[8].toFixed(20)+","+this.entries[9].toFixed(20)+","+this.entries[10].toFixed(20)+","+this.entries[11].toFixed(20)+","+this.entries[12].toFixed(20)+","+this.entries[13].toFixed(20)+","+this.entries[14].toFixed(20)+","+this.entries[15].toFixed(20)+")"},get cssTransform(){return this.getCSSTransform()},equals:function(t){return this.m00()===t.m00()&&this.m01()===t.m01()&&this.m02()===t.m02()&&this.m03()===t.m03()&&this.m10()===t.m10()&&this.m11()===t.m11()&&this.m12()===t.m12()&&this.m13()===t.m13()&&this.m20()===t.m20()&&this.m21()===t.m21()&&this.m22()===t.m22()&&this.m23()===t.m23()&&this.m30()===t.m30()&&this.m31()===t.m31()&&this.m32()===t.m32()&&this.m33()===t.m33()},equalsEpsilon:function(t,e){return Math.abs(this.m00()-t.m00())<e&&Math.abs(this.m01()-t.m01())<e&&Math.abs(this.m02()-t.m02())<e&&Math.abs(this.m03()-t.m03())<e&&Math.abs(this.m10()-t.m10())<e&&Math.abs(this.m11()-t.m11())<e&&Math.abs(this.m12()-t.m12())<e&&Math.abs(this.m13()-t.m13())<e&&Math.abs(this.m20()-t.m20())<e&&Math.abs(this.m21()-t.m21())<e&&Math.abs(this.m22()-t.m22())<e&&Math.abs(this.m23()-t.m23())<e&&Math.abs(this.m30()-t.m30())<e&&Math.abs(this.m31()-t.m31())<e&&Math.abs(this.m32()-t.m32())<e&&Math.abs(this.m33()-t.m33())<e},copy:function(){return new e(this.m00(),this.m01(),this.m02(),this.m03(),this.m10(),this.m11(),this.m12(),this.m13(),this.m20(),this.m21(),this.m22(),this.m23(),this.m30(),this.m31(),this.m32(),this.m33(),this.type)},plus:function(t){return new e(this.m00()+t.m00(),this.m01()+t.m01(),this.m02()+t.m02(),this.m03()+t.m03(),this.m10()+t.m10(),this.m11()+t.m11(),this.m12()+t.m12(),this.m13()+t.m13(),this.m20()+t.m20(),this.m21()+t.m21(),this.m22()+t.m22(),this.m23()+t.m23(),this.m30()+t.m30(),this.m31()+t.m31(),this.m32()+t.m32(),this.m33()+t.m33())},minus:function(t){return new e(this.m00()-t.m00(),this.m01()-t.m01(),this.m02()-t.m02(),this.m03()-t.m03(),this.m10()-t.m10(),this.m11()-t.m11(),this.m12()-t.m12(),this.m13()-t.m13(),this.m20()-t.m20(),this.m21()-t.m21(),this.m22()-t.m22(),this.m23()-t.m23(),this.m30()-t.m30(),this.m31()-t.m31(),this.m32()-t.m32(),this.m33()-t.m33())},transposed:function(){return new e(this.m00(),this.m10(),this.m20(),this.m30(),this.m01(),this.m11(),this.m21(),this.m31(),this.m02(),this.m12(),this.m22(),this.m32(),this.m03(),this.m13(),this.m23(),this.m33())},negated:function(){return new e(-this.m00(),-this.m01(),-this.m02(),-this.m03(),-this.m10(),-this.m11(),-this.m12(),-this.m13(),-this.m20(),-this.m21(),-this.m22(),-this.m23(),-this.m30(),-this.m31(),-this.m32(),-this.m33())},inverted:function(){switch(this.type){case s.IDENTITY:return this;case s.TRANSLATION_3D:return new e(1,0,0,-this.m03(),0,1,0,-this.m13(),0,0,1,-this.m23(),0,0,0,1,s.TRANSLATION_3D);case s.SCALING:return new e(1/this.m00(),0,0,0,0,1/this.m11(),0,0,0,0,1/this.m22(),0,0,0,0,1/this.m33(),s.SCALING);case s.AFFINE:case s.OTHER:var t=this.getDeterminant();if(0!==t)return new e((-this.m31()*this.m22()*this.m13()+this.m21()*this.m32()*this.m13()+this.m31()*this.m12()*this.m23()-this.m11()*this.m32()*this.m23()-this.m21()*this.m12()*this.m33()+this.m11()*this.m22()*this.m33())/t,(this.m31()*this.m22()*this.m03()-this.m21()*this.m32()*this.m03()-this.m31()*this.m02()*this.m23()+this.m01()*this.m32()*this.m23()+this.m21()*this.m02()*this.m33()-this.m01()*this.m22()*this.m33())/t,(-this.m31()*this.m12()*this.m03()+this.m11()*this.m32()*this.m03()+this.m31()*this.m02()*this.m13()-this.m01()*this.m32()*this.m13()-this.m11()*this.m02()*this.m33()+this.m01()*this.m12()*this.m33())/t,(this.m21()*this.m12()*this.m03()-this.m11()*this.m22()*this.m03()-this.m21()*this.m02()*this.m13()+this.m01()*this.m22()*this.m13()+this.m11()*this.m02()*this.m23()-this.m01()*this.m12()*this.m23())/t,(this.m30()*this.m22()*this.m13()-this.m20()*this.m32()*this.m13()-this.m30()*this.m12()*this.m23()+this.m10()*this.m32()*this.m23()+this.m20()*this.m12()*this.m33()-this.m10()*this.m22()*this.m33())/t,(-this.m30()*this.m22()*this.m03()+this.m20()*this.m32()*this.m03()+this.m30()*this.m02()*this.m23()-this.m00()*this.m32()*this.m23()-this.m20()*this.m02()*this.m33()+this.m00()*this.m22()*this.m33())/t,(this.m30()*this.m12()*this.m03()-this.m10()*this.m32()*this.m03()-this.m30()*this.m02()*this.m13()+this.m00()*this.m32()*this.m13()+this.m10()*this.m02()*this.m33()-this.m00()*this.m12()*this.m33())/t,(-this.m20()*this.m12()*this.m03()+this.m10()*this.m22()*this.m03()+this.m20()*this.m02()*this.m13()-this.m00()*this.m22()*this.m13()-this.m10()*this.m02()*this.m23()+this.m00()*this.m12()*this.m23())/t,(-this.m30()*this.m21()*this.m13()+this.m20()*this.m31()*this.m13()+this.m30()*this.m11()*this.m23()-this.m10()*this.m31()*this.m23()-this.m20()*this.m11()*this.m33()+this.m10()*this.m21()*this.m33())/t,(this.m30()*this.m21()*this.m03()-this.m20()*this.m31()*this.m03()-this.m30()*this.m01()*this.m23()+this.m00()*this.m31()*this.m23()+this.m20()*this.m01()*this.m33()-this.m00()*this.m21()*this.m33())/t,(-this.m30()*this.m11()*this.m03()+this.m10()*this.m31()*this.m03()+this.m30()*this.m01()*this.m13()-this.m00()*this.m31()*this.m13()-this.m10()*this.m01()*this.m33()+this.m00()*this.m11()*this.m33())/t,(this.m20()*this.m11()*this.m03()-this.m10()*this.m21()*this.m03()-this.m20()*this.m01()*this.m13()+this.m00()*this.m21()*this.m13()+this.m10()*this.m01()*this.m23()-this.m00()*this.m11()*this.m23())/t,(this.m30()*this.m21()*this.m12()-this.m20()*this.m31()*this.m12()-this.m30()*this.m11()*this.m22()+this.m10()*this.m31()*this.m22()+this.m20()*this.m11()*this.m32()-this.m10()*this.m21()*this.m32())/t,(-this.m30()*this.m21()*this.m02()+this.m20()*this.m31()*this.m02()+this.m30()*this.m01()*this.m22()-this.m00()*this.m31()*this.m22()-this.m20()*this.m01()*this.m32()+this.m00()*this.m21()*this.m32())/t,(this.m30()*this.m11()*this.m02()-this.m10()*this.m31()*this.m02()-this.m30()*this.m01()*this.m12()+this.m00()*this.m31()*this.m12()+this.m10()*this.m01()*this.m32()-this.m00()*this.m11()*this.m32())/t,(-this.m20()*this.m11()*this.m02()+this.m10()*this.m21()*this.m02()+this.m20()*this.m01()*this.m12()-this.m00()*this.m21()*this.m12()-this.m10()*this.m01()*this.m22()+this.m00()*this.m11()*this.m22())/t);throw new Error("Matrix could not be inverted, determinant === 0");default:throw new Error("Matrix3.inverted with unknown type: "+this.type)}},timesMatrix:function(t){if(this.type===s.IDENTITY||t.type===s.IDENTITY)return this.type===s.IDENTITY?t:this;if(this.type===t.type){if(this.type===s.TRANSLATION_3D)return new e(1,0,0,this.m03()+t.m02(),0,1,0,this.m13()+t.m12(),0,0,1,this.m23()+t.m23(),0,0,0,1,s.TRANSLATION_3D);if(this.type===s.SCALING)return new e(this.m00()*t.m00(),0,0,0,0,this.m11()*t.m11(),0,0,0,0,this.m22()*t.m22(),0,0,0,0,1,s.SCALING)}return this.type!==s.OTHER&&t.type!==s.OTHER?new e(this.m00()*t.m00()+this.m01()*t.m10()+this.m02()*t.m20(),this.m00()*t.m01()+this.m01()*t.m11()+this.m02()*t.m21(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02()*t.m22(),this.m00()*t.m03()+this.m01()*t.m13()+this.m02()*t.m23()+this.m03(),this.m10()*t.m00()+this.m11()*t.m10()+this.m12()*t.m20(),this.m10()*t.m01()+this.m11()*t.m11()+this.m12()*t.m21(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12()*t.m22(),this.m10()*t.m03()+this.m11()*t.m13()+this.m12()*t.m23()+this.m13(),this.m20()*t.m00()+this.m21()*t.m10()+this.m22()*t.m20(),this.m20()*t.m01()+this.m21()*t.m11()+this.m22()*t.m21(),this.m20()*t.m02()+this.m21()*t.m12()+this.m22()*t.m22(),this.m20()*t.m03()+this.m21()*t.m13()+this.m22()*t.m23()+this.m23(),0,0,0,1,s.AFFINE):new e(this.m00()*t.m00()+this.m01()*t.m10()+this.m02()*t.m20()+this.m03()*t.m30(),this.m00()*t.m01()+this.m01()*t.m11()+this.m02()*t.m21()+this.m03()*t.m31(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02()*t.m22()+this.m03()*t.m32(),this.m00()*t.m03()+this.m01()*t.m13()+this.m02()*t.m23()+this.m03()*t.m33(),this.m10()*t.m00()+this.m11()*t.m10()+this.m12()*t.m20()+this.m13()*t.m30(),this.m10()*t.m01()+this.m11()*t.m11()+this.m12()*t.m21()+this.m13()*t.m31(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12()*t.m22()+this.m13()*t.m32(),this.m10()*t.m03()+this.m11()*t.m13()+this.m12()*t.m23()+this.m13()*t.m33(),this.m20()*t.m00()+this.m21()*t.m10()+this.m22()*t.m20()+this.m23()*t.m30(),this.m20()*t.m01()+this.m21()*t.m11()+this.m22()*t.m21()+this.m23()*t.m31(),this.m20()*t.m02()+this.m21()*t.m12()+this.m22()*t.m22()+this.m23()*t.m32(),this.m20()*t.m03()+this.m21()*t.m13()+this.m22()*t.m23()+this.m23()*t.m33(),this.m30()*t.m00()+this.m31()*t.m10()+this.m32()*t.m20()+this.m33()*t.m30(),this.m30()*t.m01()+this.m31()*t.m11()+this.m32()*t.m21()+this.m33()*t.m31(),this.m30()*t.m02()+this.m31()*t.m12()+this.m32()*t.m22()+this.m33()*t.m32(),this.m30()*t.m03()+this.m31()*t.m13()+this.m32()*t.m23()+this.m33()*t.m33())},timesVector4:function(t){var e=this.m00()*t.x+this.m01()*t.y+this.m02()*t.z+this.m03()*t.w,n=this.m10()*t.x+this.m11()*t.y+this.m12()*t.z+this.m13()*t.w,s=this.m20()*t.x+this.m21()*t.y+this.m22()*t.z+this.m23()*t.w,r=this.m30()*t.x+this.m31()*t.y+this.m32()*t.z+this.m33()*t.w;return new i.Vector4(e,n,s,r)},timesVector3:function(t){return this.timesVector4(t.toVector4()).toVector3()},timesTransposeVector4:function(t){var e=this.m00()*t.x+this.m10()*t.y+this.m20()*t.z+this.m30()*t.w,n=this.m01()*t.x+this.m11()*t.y+this.m21()*t.z+this.m31()*t.w,s=this.m02()*t.x+this.m12()*t.y+this.m22()*t.z+this.m32()*t.w,r=this.m03()*t.x+this.m13()*t.y+this.m23()*t.z+this.m33()*t.w;return new i.Vector4(e,n,s,r)},timesTransposeVector3:function(t){return this.timesTransposeVector4(t.toVector4()).toVector3()},timesRelativeVector3:function(t){var e=this.m00()*t.x+this.m10()*t.y+this.m20()*t.z,n=this.m01()*t.y+this.m11()*t.y+this.m21()*t.z,s=this.m02()*t.z+this.m12()*t.y+this.m22()*t.z;return new i.Vector3(e,n,s)},getDeterminant:function(){return this.m03()*this.m12()*this.m21()*this.m30()-this.m02()*this.m13()*this.m21()*this.m30()-this.m03()*this.m11()*this.m22()*this.m30()+this.m01()*this.m13()*this.m22()*this.m30()+this.m02()*this.m11()*this.m23()*this.m30()-this.m01()*this.m12()*this.m23()*this.m30()-this.m03()*this.m12()*this.m20()*this.m31()+this.m02()*this.m13()*this.m20()*this.m31()+this.m03()*this.m10()*this.m22()*this.m31()-this.m00()*this.m13()*this.m22()*this.m31()-this.m02()*this.m10()*this.m23()*this.m31()+this.m00()*this.m12()*this.m23()*this.m31()+this.m03()*this.m11()*this.m20()*this.m32()-this.m01()*this.m13()*this.m20()*this.m32()-this.m03()*this.m10()*this.m21()*this.m32()+this.m00()*this.m13()*this.m21()*this.m32()+this.m01()*this.m10()*this.m23()*this.m32()-this.m00()*this.m11()*this.m23()*this.m32()-this.m02()*this.m11()*this.m20()*this.m33()+this.m01()*this.m12()*this.m20()*this.m33()+this.m02()*this.m10()*this.m21()*this.m33()-this.m00()*this.m12()*this.m21()*this.m33()-this.m01()*this.m10()*this.m22()*this.m33()+this.m00()*this.m11()*this.m22()*this.m33()},get determinant(){return this.getDeterminant()},toString:function(){return this.m00()+" "+this.m01()+" "+this.m02()+" "+this.m03()+"\n"+this.m10()+" "+this.m11()+" "+this.m12()+" "+this.m13()+"\n"+this.m20()+" "+this.m21()+" "+this.m22()+" "+this.m23()+"\n"+this.m30()+" "+this.m31()+" "+this.m32()+" "+this.m33()},makeImmutable:function(){this.rowMajor=function(){throw new Error("Cannot modify immutable matrix")}}},(e.IDENTITY=new e).makeImmutable(),e}),i("DOT/Matrix3",["require","DOT/dot","PHET_CORE/Poolable","DOT/Vector2","DOT/Vector3","DOT/Matrix4"],function(t){"use strict";function e(t){this.entries=a(),this.type=o.IDENTITY}var i=t("DOT/dot"),n=t("PHET_CORE/Poolable"),s=i.FastArray;t("DOT/Vector2"),t("DOT/Vector3"),t("DOT/Matrix4");var r=new s(9);r[0]=1,r[4]=1,r[8]=1;var a=s===Array?function(){return[1,0,0,0,1,0,0,0,1]}:function(){return new s(r)};i.register("Matrix3",e);var o=e.Types={OTHER:0,IDENTITY:1,TRANSLATION_2D:2,SCALING:3,AFFINE:4};return e.identity=function(){return e.dirtyFromPool().setToIdentity()},e.translation=function(t,i){return e.dirtyFromPool().setToTranslation(t,i)},e.translationFromVector=function(t){return e.translation(t.x,t.y)},e.scaling=function(t,i){return e.dirtyFromPool().setToScale(t,i)},e.scale=e.scaling,e.affine=function(t,i,n,s,r,a){return e.dirtyFromPool().setToAffine(t,i,n,s,r,a)},e.rowMajor=function(t,i,n,s,r,a,o,h,u,l){return e.dirtyFromPool().rowMajor(t,i,n,s,r,a,o,h,u,l)},e.rotationAxisAngle=function(t,i){return e.dirtyFromPool().setToRotationAxisAngle(t,i)},e.rotationX=function(t){return e.dirtyFromPool().setToRotationX(t)},e.rotationY=function(t){return e.dirtyFromPool().setToRotationY(t)},e.rotationZ=function(t){return e.dirtyFromPool().setToRotationZ(t)},e.translationRotation=function(t,i,n){return e.dirtyFromPool().setToTranslationRotation(t,i,n)},e.rotation2=e.rotationZ,e.rotationAround=function(t,i,n){return e.translation(i,n).timesMatrix(e.rotation2(t)).timesMatrix(e.translation(-i,-n))},e.rotationAroundPoint=function(t,i){return e.rotationAround(t,i.x,i.y)},e.fromSVGMatrix=function(t){return e.dirtyFromPool().setToSVGMatrix(t)},e.rotateAToB=function(t,i){return e.dirtyFromPool().setRotationAToB(t,i)},e.prototype={constructor:e,m00:function(){return this.entries[0]},m01:function(){return this.entries[3]},m02:function(){return this.entries[6]},m10:function(){return this.entries[1]},m11:function(){return this.entries[4]},m12:function(){return this.entries[7]},m20:function(){return this.entries[2]},m21:function(){return this.entries[5]},m22:function(){return this.entries[8]},isIdentity:function(){return this.type===o.IDENTITY||this.equals(e.IDENTITY)},isFastIdentity:function(){return this.type===o.IDENTITY},isAffine:function(){return this.type===o.AFFINE||0===this.m20()&&0===this.m21()&&1===this.m22()},isAligned:function(){return this.isAffine()&&0===this.m01()&&0===this.m10()},isAxisAligned:function(){return this.isAffine()&&(0===this.m01()&&0===this.m10()||0===this.m00()&&0===this.m11())},isFinite:function(){return isFinite(this.m00())&&isFinite(this.m01())&&isFinite(this.m02())&&isFinite(this.m10())&&isFinite(this.m11())&&isFinite(this.m12())&&isFinite(this.m20())&&isFinite(this.m21())&&isFinite(this.m22())},getDeterminant:function(){return this.m00()*this.m11()*this.m22()+this.m01()*this.m12()*this.m20()+this.m02()*this.m10()*this.m21()-this.m02()*this.m11()*this.m20()-this.m01()*this.m10()*this.m22()-this.m00()*this.m12()*this.m21()},get determinant(){return this.getDeterminant()},getTranslation:function(){return new i.Vector2(this.m02(),this.m12())},get translation(){return this.getTranslation()},getScaleVector:function(){return new i.Vector2(Math.sqrt(this.m00()*this.m00()+this.m10()*this.m10()),Math.sqrt(this.m01()*this.m01()+this.m11()*this.m11()))},get scaleVector(){return this.getScaleVector()},getRotation:function(){return Math.atan2(this.m10(),this.m00())},get rotation(){return this.getRotation()},toMatrix4:function(){return new i.Matrix4(this.m00(),this.m01(),this.m02(),0,this.m10(),this.m11(),this.m12(),0,this.m20(),this.m21(),this.m22(),0,0,0,0,1)},toAffineMatrix4:function(){return new i.Matrix4(this.m00(),this.m01(),0,this.m02(),this.m10(),this.m11(),0,this.m12(),0,0,1,0,0,0,0,1)},toString:function(){return this.m00()+" "+this.m01()+" "+this.m02()+"\n"+this.m10()+" "+this.m11()+" "+this.m12()+"\n"+this.m20()+" "+this.m21()+" "+this.m22()},toSVGMatrix:function(){var t=document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix();return t.a=this.m00(),t.b=this.m10(),t.c=this.m01(),t.d=this.m11(),t.e=this.m02(),t.f=this.m12(),t},getCSSTransform:function(){return"matrix("+this.entries[0].toFixed(20)+","+this.entries[1].toFixed(20)+","+this.entries[3].toFixed(20)+","+this.entries[4].toFixed(20)+","+this.entries[6].toFixed(20)+","+this.entries[7].toFixed(20)+")"},get cssTransform(){return this.getCSSTransform()},getSVGTransform:function(){function t(t){return t.toFixed(20)}switch(this.type){case o.IDENTITY:return"";case o.TRANSLATION_2D:return"translate("+t(this.entries[6])+","+t(this.entries[7])+")";case o.SCALING:return"scale("+t(this.entries[0])+(this.entries[0]===this.entries[4]?"":","+t(this.entries[4]))+")";default:return"matrix("+t(this.entries[0])+","+t(this.entries[1])+","+t(this.entries[3])+","+t(this.entries[4])+","+t(this.entries[6])+","+t(this.entries[7])+")"}},get svgTransform(){return this.getSVGTransform()},getCSSTransformStyles:function(){var t=this.getCSSTransform();return{"-webkit-perspective":1e3,"-webkit-backface-visibility":"hidden","-webkit-transform":t+" translateZ(0)","-moz-transform":t+" translateZ(0)","-ms-transform":t,"-o-transform":t,transform:t,"transform-origin":"top left","-ms-transform-origin":"top left"}},get cssTransformStyles(){return this.getCSSTransformStyles()},equals:function(t){return this.m00()===t.m00()&&this.m01()===t.m01()&&this.m02()===t.m02()&&this.m10()===t.m10()&&this.m11()===t.m11()&&this.m12()===t.m12()&&this.m20()===t.m20()&&this.m21()===t.m21()&&this.m22()===t.m22()},equalsEpsilon:function(t,e){return Math.abs(this.m00()-t.m00())<e&&Math.abs(this.m01()-t.m01())<e&&Math.abs(this.m02()-t.m02())<e&&Math.abs(this.m10()-t.m10())<e&&Math.abs(this.m11()-t.m11())<e&&Math.abs(this.m12()-t.m12())<e&&Math.abs(this.m20()-t.m20())<e&&Math.abs(this.m21()-t.m21())<e&&Math.abs(this.m22()-t.m22())<e},copy:function(){return e.createFromPool(this.m00(),this.m01(),this.m02(),this.m10(),this.m11(),this.m12(),this.m20(),this.m21(),this.m22(),this.type)},plus:function(t){return e.createFromPool(this.m00()+t.m00(),this.m01()+t.m01(),this.m02()+t.m02(),this.m10()+t.m10(),this.m11()+t.m11(),this.m12()+t.m12(),this.m20()+t.m20(),this.m21()+t.m21(),this.m22()+t.m22())},minus:function(t){return e.createFromPool(this.m00()-t.m00(),this.m01()-t.m01(),this.m02()-t.m02(),this.m10()-t.m10(),this.m11()-t.m11(),this.m12()-t.m12(),this.m20()-t.m20(),this.m21()-t.m21(),this.m22()-t.m22())},transposed:function(){return e.createFromPool(this.m00(),this.m10(),this.m20(),this.m01(),this.m11(),this.m21(),this.m02(),this.m12(),this.m22(),this.type===o.IDENTITY||this.type===o.SCALING?this.type:void 0)},negated:function(){return e.createFromPool(-this.m00(),-this.m01(),-this.m02(),-this.m10(),-this.m11(),-this.m12(),-this.m20(),-this.m21(),-this.m22())},inverted:function(){var t;switch(this.type){case o.IDENTITY:return this;case o.TRANSLATION_2D:return e.createFromPool(1,0,-this.m02(),0,1,-this.m12(),0,0,1,o.TRANSLATION_2D);case o.SCALING:return e.createFromPool(1/this.m00(),0,0,0,1/this.m11(),0,0,0,1/this.m22(),o.SCALING);case o.AFFINE:if(0!==(t=this.getDeterminant()))return e.createFromPool((-this.m12()*this.m21()+this.m11()*this.m22())/t,(this.m02()*this.m21()-this.m01()*this.m22())/t,(-this.m02()*this.m11()+this.m01()*this.m12())/t,(this.m12()*this.m20()-this.m10()*this.m22())/t,(-this.m02()*this.m20()+this.m00()*this.m22())/t,(this.m02()*this.m10()-this.m00()*this.m12())/t,0,0,1,o.AFFINE);throw new Error("Matrix could not be inverted, determinant === 0");case o.OTHER:if(0!==(t=this.getDeterminant()))return e.createFromPool((-this.m12()*this.m21()+this.m11()*this.m22())/t,(this.m02()*this.m21()-this.m01()*this.m22())/t,(-this.m02()*this.m11()+this.m01()*this.m12())/t,(this.m12()*this.m20()-this.m10()*this.m22())/t,(-this.m02()*this.m20()+this.m00()*this.m22())/t,(this.m02()*this.m10()-this.m00()*this.m12())/t,(-this.m11()*this.m20()+this.m10()*this.m21())/t,(this.m01()*this.m20()-this.m00()*this.m21())/t,(-this.m01()*this.m10()+this.m00()*this.m11())/t,o.OTHER);throw new Error("Matrix could not be inverted, determinant === 0");default:throw new Error("Matrix3.inverted with unknown type: "+this.type)}},timesMatrix:function(t){if(this.type===o.IDENTITY||t.type===o.IDENTITY)return this.type===o.IDENTITY?t:this;if(this.type===t.type){if(this.type===o.TRANSLATION_2D)return e.createFromPool(1,0,this.m02()+t.m02(),0,1,this.m12()+t.m12(),0,0,1,o.TRANSLATION_2D);if(this.type===o.SCALING)return e.createFromPool(this.m00()*t.m00(),0,0,0,this.m11()*t.m11(),0,0,0,1,o.SCALING)}return this.type!==o.OTHER&&t.type!==o.OTHER?e.createFromPool(this.m00()*t.m00()+this.m01()*t.m10(),this.m00()*t.m01()+this.m01()*t.m11(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02(),this.m10()*t.m00()+this.m11()*t.m10(),this.m10()*t.m01()+this.m11()*t.m11(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12(),0,0,1,o.AFFINE):e.createFromPool(this.m00()*t.m00()+this.m01()*t.m10()+this.m02()*t.m20(),this.m00()*t.m01()+this.m01()*t.m11()+this.m02()*t.m21(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02()*t.m22(),this.m10()*t.m00()+this.m11()*t.m10()+this.m12()*t.m20(),this.m10()*t.m01()+this.m11()*t.m11()+this.m12()*t.m21(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12()*t.m22(),this.m20()*t.m00()+this.m21()*t.m10()+this.m22()*t.m20(),this.m20()*t.m01()+this.m21()*t.m11()+this.m22()*t.m21(),this.m20()*t.m02()+this.m21()*t.m12()+this.m22()*t.m22())},timesVector2:function(t){var e=this.m00()*t.x+this.m01()*t.y+this.m02(),n=this.m10()*t.x+this.m11()*t.y+this.m12();return new i.Vector2(e,n)},timesVector3:function(t){var e=this.m00()*t.x+this.m01()*t.y+this.m02()*t.z,n=this.m10()*t.x+this.m11()*t.y+this.m12()*t.z,s=this.m20()*t.x+this.m21()*t.y+this.m22()*t.z;return new i.Vector3(e,n,s)},timesTransposeVector2:function(t){var e=this.m00()*t.x+this.m10()*t.y,n=this.m01()*t.x+this.m11()*t.y;return new i.Vector2(e,n)},timesRelativeVector2:function(t){var e=this.m00()*t.x+this.m01()*t.y,n=this.m10()*t.y+this.m11()*t.y;return new i.Vector2(e,n)},rowMajor:function(t,e,i,n,s,r,a,h,u,l){return this.entries[0]=t,this.entries[1]=n,this.entries[2]=a,this.entries[3]=e,this.entries[4]=s,this.entries[5]=h,this.entries[6]=i,this.entries[7]=r,this.entries[8]=u,this.type=void 0===l?0===a&&0===h&&1===u?o.AFFINE:o.OTHER:l,this},set:function(t){return this.rowMajor(t.m00(),t.m01(),t.m02(),t.m10(),t.m11(),t.m12(),t.m20(),t.m21(),t.m22(),t.type)},setArray:function(t){return this.rowMajor(t[0],t[3],t[6],t[1],t[4],t[7],t[2],t[5],t[8])},set00:function(t){return this.entries[0]=t,this},set01:function(t){return this.entries[3]=t,this},set02:function(t){return this.entries[6]=t,this},set10:function(t){return this.entries[1]=t,this},set11:function(t){return this.entries[4]=t,this},set12:function(t){return this.entries[7]=t,this},set20:function(t){return this.entries[2]=t,this},set21:function(t){return this.entries[5]=t,this},set22:function(t){return this.entries[8]=t,this},makeImmutable:function(){return this.rowMajor=function(){throw new Error("Cannot modify immutable matrix")},this},columnMajor:function(t,e,i,n,s,r,a,o,h,u){return this.rowMajor(t,n,a,e,s,o,i,r,h,u)},add:function(t){return this.rowMajor(this.m00()+t.m00(),this.m01()+t.m01(),this.m02()+t.m02(),this.m10()+t.m10(),this.m11()+t.m11(),this.m12()+t.m12(),this.m20()+t.m20(),this.m21()+t.m21(),this.m22()+t.m22())},subtract:function(t){return this.rowMajor(this.m00()-t.m00(),this.m01()-t.m01(),this.m02()-t.m02(),this.m10()-t.m10(),this.m11()-t.m11(),this.m12()-t.m12(),this.m20()-t.m20(),this.m21()-t.m21(),this.m22()-t.m22())},transpose:function(){return this.rowMajor(this.m00(),this.m10(),this.m20(),this.m01(),this.m11(),this.m21(),this.m02(),this.m12(),this.m22(),this.type===o.IDENTITY||this.type===o.SCALING?this.type:void 0)},negate:function(){return this.rowMajor(-this.m00(),-this.m01(),-this.m02(),-this.m10(),-this.m11(),-this.m12(),-this.m20(),-this.m21(),-this.m22())},invert:function(){var t;switch(this.type){case o.IDENTITY:return this;case o.TRANSLATION_2D:return this.rowMajor(1,0,-this.m02(),0,1,-this.m12(),0,0,1,o.TRANSLATION_2D);case o.SCALING:return this.rowMajor(1/this.m00(),0,0,0,1/this.m11(),0,0,0,1/this.m22(),o.SCALING);case o.AFFINE:if(0!==(t=this.getDeterminant()))return this.rowMajor((-this.m12()*this.m21()+this.m11()*this.m22())/t,(this.m02()*this.m21()-this.m01()*this.m22())/t,(-this.m02()*this.m11()+this.m01()*this.m12())/t,(this.m12()*this.m20()-this.m10()*this.m22())/t,(-this.m02()*this.m20()+this.m00()*this.m22())/t,(this.m02()*this.m10()-this.m00()*this.m12())/t,0,0,1,o.AFFINE);throw new Error("Matrix could not be inverted, determinant === 0");case o.OTHER:if(0!==(t=this.getDeterminant()))return this.rowMajor((-this.m12()*this.m21()+this.m11()*this.m22())/t,(this.m02()*this.m21()-this.m01()*this.m22())/t,(-this.m02()*this.m11()+this.m01()*this.m12())/t,(this.m12()*this.m20()-this.m10()*this.m22())/t,(-this.m02()*this.m20()+this.m00()*this.m22())/t,(this.m02()*this.m10()-this.m00()*this.m12())/t,(-this.m11()*this.m20()+this.m10()*this.m21())/t,(this.m01()*this.m20()-this.m00()*this.m21())/t,(-this.m01()*this.m10()+this.m00()*this.m11())/t,o.OTHER);throw new Error("Matrix could not be inverted, determinant === 0");default:throw new Error("Matrix3.inverted with unknown type: "+this.type)}},multiplyMatrix:function(t){if(t.type===o.IDENTITY)return this;if(this.type===o.IDENTITY)return this.set(t);if(this.type===t.type){if(this.type===o.TRANSLATION_2D)return this.rowMajor(1,0,this.m02()+t.m02(),0,1,this.m12()+t.m12(),0,0,1,o.TRANSLATION_2D);if(this.type===o.SCALING)return this.rowMajor(this.m00()*t.m00(),0,0,0,this.m11()*t.m11(),0,0,0,1,o.SCALING)}return this.type!==o.OTHER&&t.type!==o.OTHER?this.rowMajor(this.m00()*t.m00()+this.m01()*t.m10(),this.m00()*t.m01()+this.m01()*t.m11(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02(),this.m10()*t.m00()+this.m11()*t.m10(),this.m10()*t.m01()+this.m11()*t.m11(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12(),0,0,1,o.AFFINE):this.rowMajor(this.m00()*t.m00()+this.m01()*t.m10()+this.m02()*t.m20(),this.m00()*t.m01()+this.m01()*t.m11()+this.m02()*t.m21(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02()*t.m22(),this.m10()*t.m00()+this.m11()*t.m10()+this.m12()*t.m20(),this.m10()*t.m01()+this.m11()*t.m11()+this.m12()*t.m21(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12()*t.m22(),this.m20()*t.m00()+this.m21()*t.m10()+this.m22()*t.m20(),this.m20()*t.m01()+this.m21()*t.m11()+this.m22()*t.m21(),this.m20()*t.m02()+this.m21()*t.m12()+this.m22()*t.m22())},prependTranslation:function(t,e){return this.set02(this.m02()+t),this.set12(this.m12()+e),this.type===o.IDENTITY||this.type===o.TRANSLATION_2D?this.type=o.TRANSLATION_2D:this.type===o.OTHER?this.type=o.OTHER:this.type=o.AFFINE,this},setToIdentity:function(){return this.rowMajor(1,0,0,0,1,0,0,0,1,o.IDENTITY)},setToTranslation:function(t,e){return this.rowMajor(1,0,t,0,1,e,0,0,1,o.TRANSLATION_2D)},setToScale:function(t,e){return e=void 0===e?t:e,this.rowMajor(t,0,0,0,e,0,0,0,1,o.SCALING)},setToAffine:function(t,e,i,n,s,r){return this.rowMajor(t,e,i,n,s,r,0,0,1,o.AFFINE)},setToRotationAxisAngle:function(t,e){var i=Math.cos(e),n=Math.sin(e),s=1-i;return this.rowMajor(t.x*t.x*s+i,t.x*t.y*s-t.z*n,t.x*t.z*s+t.y*n,t.y*t.x*s+t.z*n,t.y*t.y*s+i,t.y*t.z*s-t.x*n,t.z*t.x*s-t.y*n,t.z*t.y*s+t.x*n,t.z*t.z*s+i,o.OTHER)},setToRotationX:function(t){var e=Math.cos(t),i=Math.sin(t);return this.rowMajor(1,0,0,0,e,-i,0,i,e,o.OTHER)},setToRotationY:function(t){var e=Math.cos(t),i=Math.sin(t);return this.rowMajor(e,0,i,0,1,0,-i,0,e,o.OTHER)},setToRotationZ:function(t){var e=Math.cos(t),i=Math.sin(t);return this.rowMajor(e,-i,0,i,e,0,0,0,1,o.AFFINE)},setToTranslationRotation:function(t,e,i){var n=Math.cos(i),s=Math.sin(i);return this.rowMajor(n,-s,t,s,n,e,0,0,1,o.AFFINE)},setToTranslationRotationPoint:function(t,e){return this.setToTranslationRotation(t.x,t.y,e)},setToSVGMatrix:function(t){return this.rowMajor(t.a,t.c,t.e,t.b,t.d,t.f,0,0,1,o.AFFINE)},setRotationAToB:function(t,e){var n,s,r=t,a=e,o=r.cross(a);if(n=r.dot(a),(n<0?-n:n)>.9999){var h,u,l,c=new i.Vector3(r.x>0?r.x:-r.x,r.y>0?r.y:-r.y,r.z>0?r.z:-r.z),m=(c=c.x<c.y?c.x<c.z?i.Vector3.X_UNIT:i.Vector3.Z_UNIT:c.y<c.z?i.Vector3.Y_UNIT:i.Vector3.Z_UNIT).minus(r);return o=c.minus(a),h=2/m.dot(m),u=2/o.dot(o),l=h*u*m.dot(o),this.rowMajor(-h*m.x*m.x-u*o.x*o.x+l*o.x*m.x+1,-h*m.x*m.y-u*o.x*o.y+l*o.x*m.y,-h*m.x*m.z-u*o.x*o.z+l*o.x*m.z,-h*m.y*m.x-u*o.y*o.x+l*o.y*m.x,-h*m.y*m.y-u*o.y*o.y+l*o.y*m.y+1,-h*m.y*m.z-u*o.y*o.z+l*o.y*m.z,-h*m.z*m.x-u*o.z*o.x+l*o.z*m.x,-h*m.z*m.y-u*o.z*o.y+l*o.z*m.y,-h*m.z*m.z-u*o.z*o.z+l*o.z*m.z+1)}var d,f,g,p,v;return s=1/(1+n),d=s*o.x,f=s*o.z,g=d*o.y,p=d*o.z,v=f*o.y,this.rowMajor(n+d*o.x,g-o.z,p+o.y,g+o.z,n+s*o.y*o.y,v-o.x,p-o.y,v+o.x,n+f*o.z)},setTo32Bit:function(){return window.Float32Array&&(this.entries=new window.Float32Array(this.entries)),this},setTo64Bit:function(){return window.Float64Array&&(this.entries=new window.Float64Array(this.entries)),this},multiplyVector2:function(t){return t.setXY(this.m00()*t.x+this.m01()*t.y+this.m02(),this.m10()*t.x+this.m11()*t.y+this.m12())},multiplyVector3:function(t){return t.setXYZ(this.m00()*t.x+this.m01()*t.y+this.m02()*t.z,this.m10()*t.x+this.m11()*t.y+this.m12()*t.z,this.m20()*t.x+this.m21()*t.y+this.m22()*t.z)},multiplyTransposeVector2:function(t){return t.setXY(this.m00()*t.x+this.m10()*t.y,this.m01()*t.x+this.m11()*t.y)},multiplyRelativeVector2:function(t){return t.setXY(this.m00()*t.x+this.m01()*t.y,this.m10()*t.y+this.m11()*t.y)},canvasSetTransform:function(t){t.setTransform(this.entries[0],this.entries[1],this.entries[3],this.entries[4],this.entries[6],this.entries[7])},canvasAppendTransform:function(t){this.type!==o.IDENTITY&&t.transform(this.entries[0],this.entries[1],this.entries[3],this.entries[4],this.entries[6],this.entries[7])}},n.mixInto(e,{initialize:e.prototype.rowMajor,useDefaultConstruction:!0,maxSize:300}),(e.IDENTITY=e.identity()).makeImmutable(),(e.X_REFLECTION=e.createFromPool(-1,0,0,0,1,0,0,0,1,o.AFFINE)).makeImmutable(),(e.Y_REFLECTION=e.createFromPool(1,0,0,0,-1,0,0,0,1,o.AFFINE)).makeImmutable(),e.translationTimesMatrix=function(t,i,n){var s;return n.type===o.IDENTITY||n.type===o.TRANSLATION_2D?e.createFromPool(1,0,n.m02()+t,0,1,n.m12()+i,0,0,1,o.TRANSLATION_2D):(s=n.type===o.OTHER?o.OTHER:o.AFFINE,e.createFromPool(n.m00(),n.m01(),n.m02()+t,n.m10(),n.m11(),n.m12()+i,n.m20(),n.m21(),n.m22(),s))},e.printer={print:function(t){console.log(t.toString())}},e}),i("DOT/MatrixOps3",["require","DOT/dot"],function(t){"use strict";var e=t("DOT/dot"),i=Math.sqrt(.5),n={Array:e.FastArray,index3:function(t,e){return 3*t+e},set3:function(t,e){e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8]},transpose3:function(t,e){var i=t[3],n=t[6],s=t[1],r=t[7],a=t[2],o=t[5];e[0]=t[0],e[1]=i,e[2]=n,e[3]=s,e[4]=t[4],e[5]=r,e[6]=a,e[7]=o,e[8]=t[8]},det3:function(t){return t[0]*t[4]*t[8]+t[1]*t[5]*t[6]+t[2]*t[3]*t[7]-t[2]*t[4]*t[6]-t[1]*t[3]*t[8]-t[0]*t[5]*t[7]},mult3:function(t,e,i){var n=t[0]*e[0]+t[1]*e[3]+t[2]*e[6],s=t[0]*e[1]+t[1]*e[4]+t[2]*e[7],r=t[0]*e[2]+t[1]*e[5]+t[2]*e[8],a=t[3]*e[0]+t[4]*e[3]+t[5]*e[6],o=t[3]*e[1]+t[4]*e[4]+t[5]*e[7],h=t[3]*e[2]+t[4]*e[5]+t[5]*e[8],u=t[6]*e[0]+t[7]*e[3]+t[8]*e[6],l=t[6]*e[1]+t[7]*e[4]+t[8]*e[7],c=t[6]*e[2]+t[7]*e[5]+t[8]*e[8];i[0]=n,i[1]=s,i[2]=r,i[3]=a,i[4]=o,i[5]=h,i[6]=u,i[7]=l,i[8]=c},mult3LeftTranspose:function(t,e,i){var n=t[0]*e[0]+t[3]*e[3]+t[6]*e[6],s=t[0]*e[1]+t[3]*e[4]+t[6]*e[7],r=t[0]*e[2]+t[3]*e[5]+t[6]*e[8],a=t[1]*e[0]+t[4]*e[3]+t[7]*e[6],o=t[1]*e[1]+t[4]*e[4]+t[7]*e[7],h=t[1]*e[2]+t[4]*e[5]+t[7]*e[8],u=t[2]*e[0]+t[5]*e[3]+t[8]*e[6],l=t[2]*e[1]+t[5]*e[4]+t[8]*e[7],c=t[2]*e[2]+t[5]*e[5]+t[8]*e[8];i[0]=n,i[1]=s,i[2]=r,i[3]=a,i[4]=o,i[5]=h,i[6]=u,i[7]=l,i[8]=c},mult3RightTranspose:function(t,e,i){var n=t[0]*e[0]+t[1]*e[1]+t[2]*e[2],s=t[0]*e[3]+t[1]*e[4]+t[2]*e[5],r=t[0]*e[6]+t[1]*e[7]+t[2]*e[8],a=t[3]*e[0]+t[4]*e[1]+t[5]*e[2],o=t[3]*e[3]+t[4]*e[4]+t[5]*e[5],h=t[3]*e[6]+t[4]*e[7]+t[5]*e[8],u=t[6]*e[0]+t[7]*e[1]+t[8]*e[2],l=t[6]*e[3]+t[7]*e[4]+t[8]*e[5],c=t[6]*e[6]+t[7]*e[7]+t[8]*e[8];i[0]=n,i[1]=s,i[2]=r,i[3]=a,i[4]=o,i[5]=h,i[6]=u,i[7]=l,i[8]=c},mult3BothTranspose:function(t,e,i){var n=t[0]*e[0]+t[3]*e[1]+t[6]*e[2],s=t[0]*e[3]+t[3]*e[4]+t[6]*e[5],r=t[0]*e[6]+t[3]*e[7]+t[6]*e[8],a=t[1]*e[0]+t[4]*e[1]+t[7]*e[2],o=t[1]*e[3]+t[4]*e[4]+t[7]*e[5],h=t[1]*e[6]+t[4]*e[7]+t[7]*e[8],u=t[2]*e[0]+t[5]*e[1]+t[8]*e[2],l=t[2]*e[3]+t[5]*e[4]+t[8]*e[5],c=t[2]*e[6]+t[5]*e[7]+t[8]*e[8];i[0]=n,i[1]=s,i[2]=r,i[3]=a,i[4]=o,i[5]=h,i[6]=u,i[7]=l,i[8]=c},mult3Vector3:function(t,e,i){var n=t[0]*e.x+t[1]*e.y+t[2]*e.z,s=t[3]*e.x+t[4]*e.y+t[5]*e.z,r=t[6]*e.x+t[7]*e.y+t[8]*e.z;i.x=n,i.y=s,i.z=r},swapNegateColumn:function(t,e,i){var n=t[e],s=t[e+3],r=t[e+6];t[e]=t[i],t[e+3]=t[i+3],t[e+6]=t[i+6],t[i]=-n,t[i+3]=-s,t[i+6]=-r},setIdentity3:function(t){t[0]=t[4]=t[8]=1,t[1]=t[2]=t[3]=t[5]=t[6]=t[7]=0},setGivens3:function(t,e,i,n,s){this.setIdentity3(t),t[this.index3(n,n)]=e,t[this.index3(s,s)]=e,t[this.index3(n,s)]=i,t[this.index3(s,n)]=-i},preMult3Givens:function(t,e,i,n,s){var r=3*n,a=3*s,o=e*t[r+0]+i*t[a+0],h=e*t[a+0]-i*t[r+0],u=e*t[r+1]+i*t[a+1],l=e*t[a+1]-i*t[r+1],c=e*t[r+2]+i*t[a+2],m=e*t[a+2]-i*t[r+2];t[r+0]=o,t[a+0]=h,t[r+1]=u,t[a+1]=l,t[r+2]=c,t[a+2]=m},postMult3Givens:function(t,e,i,n,s){var r=e*t[n+0]+i*t[s+0],a=e*t[s+0]-i*t[n+0],o=e*t[n+3]+i*t[s+3],h=e*t[s+3]-i*t[n+3],u=e*t[n+6]+i*t[s+6],l=e*t[s+6]-i*t[n+6];t[n+0]=r,t[s+0]=a,t[n+3]=o,t[s+3]=h,t[n+6]=u,t[s+6]=l},applyJacobi3:function(t,e,n,s){var r=t[3*n+n],a=t[3*n+s],o=t[3*s+s],h=a*a,u=r-o,l=h<(u*=u),c=1/Math.sqrt(h+u),m=l?c*(r-o):i,d=l?c*a:i;this.preMult3Givens(t,m,d,n,s),this.postMult3Givens(t,m,d,n,s),this.preMult3Givens(e,m,d,n,s)},jacobiIteration3:function(t,e,i){for(var n=0;n<i;n++)this.applyJacobi3(t,e,0,1),this.applyJacobi3(t,e,0,2),this.applyJacobi3(t,e,1,2)},qrAnnihilate3:function(t,e,i,n){var s,r,a=e[this.index3(n,n)],o=e[this.index3(i,n)],h=a*a,u=o*o;if(h+u<1e-10)s=a>0?1:0,r=0;else{var l=1/Math.sqrt(h+u);s=l*a,r=l*o}this.preMult3Givens(e,s,r,n,i),this.postMult3Givens(t,s,r,n,i)},svd3:function(t,e,i,n,s){var r=i,a=s,o=n;this.mult3LeftTranspose(t,t,o),this.setIdentity3(r),this.jacobiIteration3(o,r,e),this.transpose3(r,a),this.mult3(t,a,o);var h,u=o[0]*o[0]+o[3]*o[3]+o[6]*o[6],l=o[1]*o[1]+o[4]*o[4]+o[7]*o[7],c=o[2]*o[2]+o[5]*o[5]+o[8]*o[8];u<l&&(h=u,u=l,l=h,this.swapNegateColumn(o,0,1),this.swapNegateColumn(a,0,1)),u<c&&(h=u,u=c,c=h,this.swapNegateColumn(o,0,2),this.swapNegateColumn(a,0,2)),l<c&&(this.swapNegateColumn(o,1,2),this.swapNegateColumn(a,1,2)),this.setIdentity3(r),this.qrAnnihilate3(r,o,1,0),this.qrAnnihilate3(r,o,2,0),this.qrAnnihilate3(r,o,2,1);r[0]*r[0]+r[1]*r[1]+r[2]*r[2]<.001&&(r[0]=1),r[3]*r[3]+r[4]*r[4]+r[5]*r[5]<.001&&(r[4]=1),r[6]*r[6]+r[7]*r[7]+r[8]*r[8]<.001&&(r[8]=1)},setVectors3:function(t,e){for(var i=t.length,n=0;n<i;n++){var s=t[n];e[n]=s.x,e[n+i]=s.y,e[n+2*i]=s.z}},getColumnVector3:function(t,e,i,n,s){s.x=i[n],s.y=i[n+e],s.z=i[n+2*e]},index:function(t,e,i,n){return e*i+n},transpose:function(t,e,i,n){for(var s=0;s<t;s++)for(var r=0;r<e;r++)n[t*r+s]=i[e*s+r]},mult:function(t,e,i,n,s,r){for(var a=0;a<t;a++)for(var o=0;o<i;o++){for(var h=0,u=0;u<e;u++)h+=n[this.index(t,e,a,u)]*s[this.index(e,i,u,o)];r[this.index(t,i,a,o)]=h}},multRightTranspose:function(t,e,i,n,s,r){for(var a=0;a<t;a++)for(var o=0;o<i;o++){for(var h=0,u=0;u<e;u++)h+=n[this.index(t,e,a,u)]*s[this.index(i,e,o,u)];r[this.index(t,i,a,o)]=h}},permuteColumns:function(t,e,i,n,s){for(var r=0;r<e;r++)for(var a=n.indices[r],o=0;o<t;o++)s[this.index(t,e,o,r)]=i[this.index(t,e,o,a)]}};return e.register("MatrixOps3",n),n}),i("DOT/Permutation",["require","DOT/dot","PHET_CORE/isArray","DOT/Util"],function(t){"use strict";function e(t){this.indices=t}function i(t,e,n){if(0===t.length)n(e);else for(var s=0;s<t.length;s++){var r=t[s],a=t.slice(0);a.splice(s,1);var o=e.slice(0);o.push(r),i(a,o,n)}}var n=t("DOT/dot"),s=t("PHET_CORE/isArray");return t("DOT/Util"),n.register("Permutation",e),e.identity=function(t){for(var i=new Array(t),n=0;n<t;n++)i[n]=n;return new e(i)},e.permutations=function(t){var i=[];return e.forEachPermutation(n.rangeInclusive(0,t-1),function(t){i.push(new e(t))}),i},e.forEachPermutation=function(t,e){i(t,[],e)},e.prototype={constructor:e,size:function(){return this.indices.length},apply:function(t){if(s(t)){if(t.length!==this.size())throw new Error("Permutation length "+this.size()+" not equal to list length "+t.length);for(var e=new Array(t.length),i=0;i<t.length;i++)e[i]=t[this.indices[i]];return e}return this.indices[t]},inverted:function(){for(var t=new Array(this.size()),i=0;i<this.size();i++)t[this.indices[i]]=i;return new e(t)},withIndicesPermuted:function(t){var i=[],n=this;return e.forEachPermutation(t,function(s){for(var r=n.indices,a=r.slice(0),o=0;o<t.length;o++)a[t[o]]=r[s[o]];i.push(new e(a))}),i},toString:function(){return"P["+this.indices.join(", ")+"]"}},e.testMe=function(t){var i=new e([1,4,3,2,0]);t.log(i.toString());var n=i.inverted();t.log(n.toString()),t.log(n.withIndicesPermuted([0,3,4]).toString()),t.log(e.permutations(4).toString())},e}),i("DOT/Plane3",["require","DOT/dot","DOT/Vector3"],function(t){"use strict";function e(t,e){this.normal=t,this.distance=e}var i=t("DOT/dot"),n=t("DOT/Vector3");return i.register("Plane3",e),e.prototype={constructor:e,intersectWithRay:function(t){return t.pointAtDistance(t.distanceToPlane(this))}},e.XY=new e(new n(0,0,1),0),e.XZ=new e(new n(0,1,0),0),e.YZ=new e(new n(1,0,0),0),e.fromTriangle=function(t,i,n){var s=n.minus(t).cross(i.minus(t));return 0===s.magnitude()?null:(s.normalize(),new e(s,s.dot(t)))},e}),i("DOT/Quaternion",["require","DOT/dot","PHET_CORE/Poolable","DOT/Vector3","DOT/Matrix3","DOT/Util"],function(t){"use strict";function e(t,e,i,n){this.setXYZW(t,e,i,n)}var i=t("DOT/dot"),n=t("PHET_CORE/Poolable");return t("DOT/Vector3"),t("DOT/Matrix3"),t("DOT/Util"),i.register("Quaternion",e),e.prototype={constructor:e,isQuaternion:!0,setXYZW:function(t,e,i,n){this.x=void 0!==t?t:0,this.y=void 0!==e?e:0,this.z=void 0!==i?i:0,this.w=void 0!==n?n:1},plus:function(t){return new e(this.x+t.x,this.y+t.y,this.z+t.z,this.w+t.w)},timesScalar:function(t){return new e(this.x*t,this.y*t,this.z*t,this.w*t)},timesQuaternion:function(t){return new e(this.x*t.w-this.z*t.y+this.y*t.z+this.w*t.x,-this.x*t.z+this.y*t.w+this.z*t.x+this.w*t.y,this.x*t.y-this.y*t.x+this.z*t.w+this.w*t.z,-this.x*t.x-this.y*t.y-this.z*t.z+this.w*t.w)},timesVector3:function(t){return 0===t.magnitude()?new i.Vector3:new i.Vector3(this.w*this.w*t.x+2*this.y*this.w*t.z-2*this.z*this.w*t.y+this.x*this.x*t.x+2*this.y*this.x*t.y+2*this.z*this.x*t.z-this.z*this.z*t.x-this.y*this.y*t.x,2*this.x*this.y*t.x+this.y*this.y*t.y+2*this.z*this.y*t.z+2*this.w*this.z*t.x-this.z*this.z*t.y+this.w*this.w*t.y-2*this.x*this.w*t.z-this.x*this.x*t.y,2*this.x*this.z*t.x+2*this.y*this.z*t.y+this.z*this.z*t.z-2*this.w*this.y*t.x-this.y*this.y*t.z+2*this.w*this.x*t.y-this.x*this.x*t.z+this.w*this.w*t.z)},magnitude:function(){return Math.sqrt(this.magnitudeSquared())},magnitudeSquared:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},normalized:function(){var t=this.magnitude();return this.timesScalar(1/t)},negated:function(){return new e(-this.x,-this.y,-this.z,-this.w)},toRotationMatrix:function(){var t=this.magnitudeSquared(),e=1===t?2:t>0?2/t:0,n=this.x*this.x*e,s=this.x*this.y*e,r=this.x*this.z*e,a=this.w*this.x*e,o=this.y*this.y*e,h=this.y*this.z*e,u=this.w*this.y*e,l=this.z*this.z*e,c=this.w*this.z*e;return i.Matrix3.dirtyFromPool().columnMajor(1-(o+l),s+c,r-u,s-c,1-(n+l),h+a,r+u,h-a,1-(n+o))}},e.fromEulerAngles=function(t,i,n){var s=Math.sin(.5*n),r=Math.cos(.5*n),a=Math.sin(.5*i),o=Math.cos(.5*i),h=Math.sin(.5*t),u=Math.cos(.5*t),l=o*r,c=a*s,m=o*s,d=a*r;return new e(l*h+c*u,d*u+m*h,m*u-d*h,l*u-c*h)},e.fromRotationMatrix=function(t){var i,n=t.m00(),s=t.m01(),r=t.m02(),a=t.m10(),o=t.m11(),h=t.m12(),u=t.m20(),l=t.m21(),c=t.m22(),m=n+o+c;return m>=0?(i=Math.sqrt(m+1),new e(.5*(l-h)/i,.5*(r-u)/i,.5*(a-s)/i,.5*i)):n>o&&n>c?(i=Math.sqrt(1+n-o-c),new e(.5*i,.5*(a+s)/i,.5*(r+u)/i,.5*(l-h)/i)):o>c?(i=Math.sqrt(1+o-n-c),new e(.5*(a+s)/i,.5*i,.5*(l+h)/i,.5*(r-u)/i)):(i=Math.sqrt(1+c-n-o),new e(.5*(r+u)/i,.5*(l+h)/i,.5*i,.5*(a-s)/i))},e.getRotationQuaternion=function(t,n){return e.fromRotationMatrix(i.Matrix3.rotateAToB(t,n))},e.slerp=function(t,i,n){if(t.x===i.x&&t.y===i.y&&t.z===i.z&&t.w===i.w)return t;var s=t.x*i.x+t.y*i.y+t.z*i.z+t.w*i.w;s<0&&(i=i.negated(),s=-s);var r=1-n,a=n;if(1-s>.1){var o=Math.acos(s),h=1/Math.sin(o);r=Math.sin((1-n)*o)*h,a=Math.sin(n*o)*h}return new e(r*t.x+a*i.x,r*t.y+a*i.y,r*t.z+a*i.z,r*t.w+a*i.w)},n.mixInto(e,{initialize:e.prototype.setXYZW}),e}),i("DOT/Random",["require","DOT/dot","PHET_CORE/inherit","DOT/Util"],function(t){"use strict";function e(t){null!==(t=_.extend({seed:null,staticSeed:!1},t)).seed&&t.staticSeed;var e=t.staticSeed?window.phet.chipper.randomSeed:t.seed;this.setSeed(e)}var i=t("DOT/dot"),n=t("PHET_CORE/inherit"),s=t("DOT/Util");return n(Object,e,{setSeed:function(t){this.seed=t,this.seedrandom=null!==this.seed?new Math.seedrandom(this.seed+""):null},nextBoolean:function(){return this.nextDouble()>=.5},nextInt:function(t){return 0|this.nextDouble()*t},nextIntBetween:function(t,e){var i=e-t;return this.nextInt(i+1)+t},sample:function(t){return t[this.nextIntBetween(0,t.length-1)]},shuffle:function(t){var e=this,i=-1,n=new Array(t.length);return _.forEach(t,function(t){var s=e.nextIntBetween(0,++i);n[i]=n[s],n[s]=t}),n},nextDouble:function(){return null===this.seed?Math.random():this.seedrandom()},nextGaussian:function(){return s.boxMullerTransform(0,1,this)}}),i.register("Random",e),e}),i("DOT/Range",["require","DOT/dot"],function(t){"use strict";function e(t,e){this.min=t,this.max=e}return t("DOT/dot").register("Range",e),e.prototype={constructor:e,copy:function(){return new e(this.min,this.max)},getLength:function(){return this.max-this.min},getCenter:function(){return(this.max+this.min)/2},contains:function(t){return t>=this.min&&t<=this.max},containsRange:function(t){return this.min<=t.min&&this.max>=t.max},intersects:function(t){return this.max>=t.min&&t.max>=this.min},intersectsExclusive:function(t){return this.max>t.min&&t.max>this.min},toString:function(){return"[Range (min:"+this.min+" max:"+this.max+")]"},constrainValue:function(t){return Math.min(Math.max(t,this.min),this.max)},equals:function(t){return this.min===t.min&&this.max===t.max}},e}),i("DOT/Ray2",["require","DOT/dot"],function(t){"use strict";function e(t,e){this.position=t,this.direction=e}return t("DOT/dot").register("Ray2",e),e.prototype={constructor:e,shifted:function(t){return new e(this.pointAtDistance(t),this.direction)},pointAtDistance:function(t){return this.position.plus(this.direction.timesScalar(t))},toString:function(){return this.position.toString()+" => "+this.direction.toString()}},e}),i("DOT/Ray3",["require","DOT/dot"],function(t){"use strict";function e(t,e){this.position=t,this.direction=e}return t("DOT/dot").register("Ray3",e),e.prototype={constructor:e,shifted:function(t){return new e(this.pointAtDistance(t),this.direction)},pointAtDistance:function(t){return this.position.plus(this.direction.timesScalar(t))},distanceToPlane:function(t){return(t.distance-this.position.dot(t.normal))/this.direction.dot(t.normal)},toString:function(){return this.position.toString()+" => "+this.direction.toString()}},e}),i("DOT/Rectangle",["require","DOT/Bounds2","DOT/dot","PHET_CORE/inherit"],function(t){"use strict";function e(t,e,n,s){i.call(this,t,e,t+n,e+s)}var i=t("DOT/Bounds2"),n=t("DOT/dot"),s=t("PHET_CORE/inherit");return n.register("Rectangle",e),s(i,e),e}),i("DOT/Sphere3",["require","DOT/dot","PHET_CORE/inherit"],function(t){"use strict";function e(t,e){this.center=t,this.radius=e}var i=t("DOT/dot"),n=t("PHET_CORE/inherit");return i.register("Sphere3",e),n(Object,e,{intersect:function(t,e){var i=t.direction,n=t.position,s=n.minus(this.center),r=i.dot(s),a=4*r*r-4*(s.magnitudeSquared()-this.radius*this.radius);if(a<e)return null;var o=i.dot(this.center)-i.dot(n),h=Math.sqrt(a)/2,u=o-h,l=o+h;if(l<e)return null;var c=t.pointAtDistance(l),m=c.minus(this.center).normalized();if(u<e)return{distance:l,hitPoint:c,normal:m.negated(),fromOutside:!1};var d=t.pointAtDistance(u);return{distance:u,hitPoint:d,normal:d.minus(this.center).normalized(),fromOutside:!0}},intersections:function(t,e){var i=t.direction,n=t.position,s=n.minus(this.center),r=i.dot(s),a=4*r*r-4*(s.magnitudeSquared()-this.radius*this.radius);if(a<e)return[];var o=i.dot(this.center)-i.dot(n),h=Math.sqrt(a)/2,u=o-h,l=o+h;if(l<e)return[];var c=t.pointAtDistance(l),m=c.minus(this.center).normalized(),d=t.pointAtDistance(u),f=d.minus(this.center).normalized(),g={distance:l,hitPoint:c,normal:m.negated(),fromOutside:!1},p={distance:u,hitPoint:d,normal:f,fromOutside:!0};return u<e?[g,p]:[p,g]}}),e}),i("DOT/Transform3",["require","DOT/dot","AXON/Events","PHET_CORE/inherit","DOT/Matrix3","DOT/Vector2","DOT/Ray2"],function(t){"use strict";function e(t){n.call(this),this.matrix=i.Matrix3.IDENTITY.copy(),this.inverse=i.Matrix3.IDENTITY.copy(),this.matrixTransposed=i.Matrix3.IDENTITY.copy(),this.inverseTransposed=i.Matrix3.IDENTITY.copy(),this.inverseValid=!0,this.transposeValid=!0,this.inverseTransposeValid=!0,t&&this.setMatrix(t)}var i=t("DOT/dot"),n=t("AXON/Events"),s=t("PHET_CORE/inherit");t("DOT/Matrix3"),t("DOT/Vector2"),t("DOT/Ray2");var r=new i.Matrix3;return i.register("Transform3",e),s(n,e,{setMatrix:function(t){this.matrix.set(t),this.invalidate()},invalidate:function(){this.inverseValid=!1,this.transposeValid=!1,this.inverseTransposeValid=!1,this.trigger0("change")},prepend:function(t){r.set(this.matrix),this.matrix.set(t),this.matrix.multiplyMatrix(r),this.invalidate()},prependTranslation:function(t,e){this.matrix.prependTranslation(t,e),this.invalidate()},append:function(t){this.matrix.multiplyMatrix(t),this.invalidate()},prependTransform:function(t){this.prepend(t.matrix)},appendTransform:function(t){this.append(t.matrix)},applyToCanvasContext:function(t){t.setTransform(this.matrix.m00(),this.matrix.m10(),this.matrix.m01(),this.matrix.m11(),this.matrix.m02(),this.matrix.m12())},copy:function(){var t=new e(this.matrix);t.inverse=this.inverse,t.matrixTransposed=this.matrixTransposed,t.inverseTransposed=this.inverseTransposed,t.inverseValid=this.inverseValid,t.transposeValid=this.transposeValid,t.inverseTransposeValid=this.inverseTransposeValid},getMatrix:function(){return this.matrix},getInverse:function(){return this.inverseValid||(this.inverseValid=!0,this.inverse.set(this.matrix),this.inverse.invert()),this.inverse},getMatrixTransposed:function(){return this.transposeValid||(this.transposeValid=!0,this.matrixTransposed.set(this.matrix),this.matrixTransposed.transpose()),this.matrixTransposed},getInverseTransposed:function(){return this.inverseTransposeValid||(this.inverseTransposeValid=!0,this.inverseTransposed.set(this.getInverse()),this.inverseTransposed.transpose()),this.inverseTransposed},isIdentity:function(){return this.matrix.type===i.Matrix3.Types.IDENTITY},isFinite:function(){return this.matrix.isFinite()},transformPosition2:function(t){return this.matrix.timesVector2(t)},transformDelta2:function(t){var e=this.getMatrix();return new i.Vector2(e.m00()*t.x+e.m01()*t.y,e.m10()*t.x+e.m11()*t.y)},transformNormal2:function(t){return this.getInverse().timesTransposeVector2(t).normalize()},transformX:function(t){var e=this.getMatrix();return e.m00()*t+e.m02()},transformY:function(t){var e=this.getMatrix();return e.m11()*t+e.m12()},transformDeltaX:function(t){return this.getMatrix().m00()*t},transformDeltaY:function(t){return this.getMatrix().m11()*t},transformBounds2:function(t){return t.transformed(this.matrix)},transformShape:function(t){return t.transformed(this.matrix)},transformRay2:function(t){return new i.Ray2(this.transformPosition2(t.position),this.transformDelta2(t.direction).normalized())},inversePosition2:function(t){return this.getInverse().timesVector2(t)},inverseDelta2:function(t){var e=this.getInverse();return new i.Vector2(e.m00()*t.x+e.m01()*t.y,e.m10()*t.x+e.m11()*t.y)},inverseNormal2:function(t){return this.matrix.timesTransposeVector2(t).normalize()},inverseX:function(t){var e=this.getInverse();return e.m00()*t+e.m02()},inverseY:function(t){var e=this.getInverse();return e.m11()*t+e.m12()},inverseDeltaX:function(t){var e=this.getInverse();return e.m00()*t},inverseDeltaY:function(t){var e=this.getInverse();return e.m11()*t},inverseBounds2:function(t){return t.transformed(this.getInverse())},inverseShape:function(t){return t.transformed(this.getInverse())},inverseRay2:function(t){return new i.Ray2(this.inversePosition2(t.position),this.inverseDelta2(t.direction).normalized())}}),e}),i("DOT/Transform4",["require","DOT/dot","AXON/Events","PHET_CORE/inherit","DOT/Matrix4","DOT/Vector3","DOT/Ray3"],function(t){"use strict";function e(t){n.call(this),this.matrix=i.Matrix4.IDENTITY.copy(),this.inverse=i.Matrix4.IDENTITY.copy(),this.matrixTransposed=i.Matrix4.IDENTITY.copy(),this.inverseTransposed=i.Matrix4.IDENTITY.copy(),this.inverseValid=!0,this.transposeValid=!0,this.inverseTransposeValid=!0,t&&this.setMatrix(t)}var i=t("DOT/dot"),n=t("AXON/Events"),s=t("PHET_CORE/inherit");t("DOT/Matrix4"),t("DOT/Vector3"),t("DOT/Ray3");var r=new i.Matrix4;return i.register("Transform4",e),s(n,e,{setMatrix:function(t){this.matrix.set(t),this.invalidate()},invalidate:function(){this.inverseValid=!1,this.transposeValid=!1,this.inverseTransposeValid=!1,this.trigger0("change")},prepend:function(t){r.set(this.matrix),this.matrix.set(t),this.matrix.multiplyMatrix(r),this.invalidate()},append:function(t){this.matrix.multiplyMatrix(t),this.invalidate()},prependTransform:function(t){this.prepend(t.matrix)},appendTransform:function(t){this.append(t.matrix)},applyToCanvasContext:function(t){t.setTransform(this.matrix.m00(),this.matrix.m10(),this.matrix.m01(),this.matrix.m11(),this.matrix.m03(),this.matrix.m13())},copy:function(){var t=new e(this.matrix);t.inverse=this.inverse,t.matrixTransposed=this.matrixTransposed,t.inverseTransposed=this.inverseTransposed,t.inverseValid=this.inverseValid,t.transposeValid=this.transposeValid,t.inverseTransposeValid=this.inverseTransposeValid},getMatrix:function(){return this.matrix},getInverse:function(){return this.inverseValid||(this.inverseValid=!0,this.inverse.set(this.matrix),this.inverse.invert()),this.inverse},getMatrixTransposed:function(){return this.transposeValid||(this.transposeValid=!0,this.matrixTransposed.set(this.matrix),this.matrixTransposed.transpose()),this.matrixTransposed},getInverseTransposed:function(){return this.inverseTransposeValid||(this.inverseTransposeValid=!0,this.inverseTransposed.set(this.getInverse()),this.inverseTransposed.transpose()),this.inverseTransposed},isIdentity:function(){return this.matrix.type===i.Matrix4.Types.IDENTITY},isFinite:function(){return this.matrix.isFinite()},transformPosition3:function(t){return this.matrix.timesVector3(t)},transformDelta3:function(t){return this.matrix.timesRelativeVector3(t)},transformNormal3:function(t){return this.getInverse().timesTransposeVector3(t)},transformDeltaX:function(t){return this.transformDelta3(new i.Vector3(t,0,0)).x},transformDeltaY:function(t){return this.transformDelta3(new i.Vector3(0,t,0)).y},transformDeltaZ:function(t){return this.transformDelta3(new i.Vector3(0,0,t)).z},transformRay:function(t){return new i.Ray3(this.transformPosition3(t.position),this.transformPosition3(t.position.plus(t.direction)).minus(this.transformPosition3(t.position)))},inversePosition3:function(t){return this.getInverse().timesVector3(t)},inverseDelta3:function(t){return this.inversePosition3(t).minus(this.inversePosition3(i.Vector3.ZERO))},inverseNormal3:function(t){return this.matrix.timesTransposeVector3(t)},inverseDeltaX:function(t){return this.inverseDelta3(new i.Vector3(t,0,0)).x},inverseDeltaY:function(t){return this.inverseDelta3(new i.Vector3(0,t,0)).y},inverseDeltaZ:function(t){return this.inverseDelta3(new i.Vector3(0,0,t)).z},inverseRay:function(t){return new i.Ray3(this.inversePosition3(t.position),this.inversePosition3(t.position.plus(t.direction)).minus(this.inversePosition3(t.position)))}}),e}),i("DOT/main",["DOT/dot","DOT/BinPacker","DOT/Bounds2","DOT/Bounds3","DOT/Complex","DOT/ConvexHull2","DOT/DampedHarmonic","DOT/DelaunayTriangulation","DOT/Dimension2","DOT/EigenvalueDecomposition","DOT/LinearFunction","DOT/LUDecomposition","DOT/Matrix","DOT/Matrix3","DOT/Matrix4","DOT/MatrixOps3","DOT/Permutation","DOT/Plane3","DOT/QRDecomposition","DOT/Quaternion","DOT/Random","DOT/Range","DOT/Ray2","DOT/Ray3","DOT/Rectangle","DOT/SingularValueDecomposition","DOT/Sphere3","DOT/Transform3","DOT/Transform4","DOT/Util","DOT/Vector2","DOT/Vector3","DOT/Vector4"],function(t){"use strict";return t}),i("KITE/kite",["require","PHET_CORE/Namespace"],function(t){"use strict";var e=new(t("PHET_CORE/Namespace"))("kite");return e.register("svgNumber",function(t){return t.toFixed(20)}),e}),i("KITE/util/Overlap",["require","PHET_CORE/inherit","KITE/kite"],function(t){"use strict";function e(t,e){this.a=t,this.b=e;var i=0,n=1,s=this.apply(i),r=this.apply(n);s>1&&(s=1,i=this.applyInverse(s)),s<0&&(s=0,i=this.applyInverse(s)),r>1&&(r=1,n=this.applyInverse(r)),r<0&&(r=0,n=this.applyInverse(r)),this.t0=i,this.t1=n,t>0?(this.qt0=s,this.qt1=r):(this.qt0=r,this.qt1=s),this.t0<0&&this.t0>-1e-8&&(this.t0=0),this.t0>1&&this.t0<1+1e-8&&(this.t0=1),this.t1<0&&this.t1>-1e-8&&(this.t1=0),this.t1>1&&this.t1<1+1e-8&&(this.t1=1),this.qt0<0&&this.qt0>-1e-8&&(this.qt0=0),this.qt0>1&&this.qt0<1+1e-8&&(this.qt0=1),this.qt1<0&&this.qt1>-1e-8&&(this.qt1=0),this.qt1>1&&this.qt1<1+1e-8&&(this.qt1=1)}var i=t("PHET_CORE/inherit"),n=t("KITE/kite");return n.register("Overlap",e),i(Object,e,{apply:function(t){return this.a*t+this.b},applyInverse:function(t){return(t-this.b)/this.a}},{createLinear:function(t,i,n,s){var r=(s-i)/(n-t);return new e(r,i-t*r)}}),n.Overlap}),i("KITE/util/RayIntersection",["require","PHET_CORE/inherit","KITE/kite","DOT/Util","DOT/Vector2"],function(t){"use strict";function e(t,e,i,n,r){this.point=e,this.normal=i,this.distance=t,this.wind=n,this.t=s.clamp(r,0,1)}var i=t("PHET_CORE/inherit"),n=t("KITE/kite"),s=t("DOT/Util");t("DOT/Vector2");return n.register("RayIntersection",e),i(Object,e),e}),i("KITE/util/SegmentIntersection",["require","PHET_CORE/inherit","KITE/kite","DOT/Util","DOT/Vector2"],function(t){"use strict";function e(t,e,i){this.point=t,this.aT=s.clamp(e,0,1),this.bT=s.clamp(i,0,1)}var i=t("PHET_CORE/inherit"),n=t("KITE/kite"),s=t("DOT/Util");t("DOT/Vector2");return n.register("SegmentIntersection",e),i(Object,e,{getSwapped:function(){return new e(this.point,this.bT,this.aT)}}),e}),i("KITE/ops/BoundsIntersection",["require","PHET_CORE/inherit","KITE/kite","PHET_CORE/Poolable","KITE/util/SegmentIntersection","DOT/Vector2"],function(t){"use strict";function e(t,e,i,n,s,r,a,o,h,u){this.initialize(t,e,i,n,s,r,a,o,h,u)}var i=t("PHET_CORE/inherit"),n=t("KITE/kite"),s=t("PHET_CORE/Poolable"),r=t("KITE/util/SegmentIntersection");t("DOT/Vector2");return n.register("BoundsIntersection",e),i(Object,e,{initialize:function(t,e,i,n,s,r,a,o,h,u){return this.a=t,this.b=e,this.atMin=i,this.atMax=n,this.btMin=s,this.btMax=r,this.aMin=a,this.aMax=o,this.bMin=h,this.bMax=u,this},pushSubdivisions:function(t){var i=(this.atMax+this.atMin)/2,n=(this.btMax+this.btMin)/2;if(i!==this.atMin&&i!==this.atMax&&n!==this.btMin&&n!==this.btMax){var s=this.a.positionAt(i),r=this.b.positionAt(n);e.boxIntersects(this.aMin,s,this.bMin,r)&&t.push(e.createFromPool(this.a,this.b,this.atMin,i,this.btMin,n,this.aMin,s,this.bMin,r)),e.boxIntersects(s,this.aMax,this.bMin,r)&&t.push(e.createFromPool(this.a,this.b,i,this.atMax,this.btMin,n,s,this.aMax,this.bMin,r)),e.boxIntersects(this.aMin,s,r,this.bMax)&&t.push(e.createFromPool(this.a,this.b,this.atMin,i,n,this.btMax,this.aMin,s,r,this.bMax)),e.boxIntersects(s,this.aMax,r,this.bMax)&&t.push(e.createFromPool(this.a,this.b,i,this.atMax,n,this.btMax,s,this.aMax,r,this.bMax)),this.freeToPool()}else t.push(this)},distance:function(t){var e=this.atMin-t.atMin,i=this.atMax-t.atMax,n=this.btMin-t.btMin,s=this.btMax-t.btMax;return e*e+i*i+n*n+s*s},clean:function(){this.a=null,this.b=null,this.aMin=null,this.aMax=null,this.bMin=null,this.bMax=null}},{intersect:function(t,i){if(!t.bounds.intersectsBounds(i.bounds))return[];for(var n=e.getIntersectionRanges(t,i),s=[],a=0;a<n.length;a++){var o=n[a],h=!1;t:for(var u=0;u<s.length;u++)for(var l=s[u],c=0;c<l.length;c++){var m=l[c];if(o.distance(m)<1e-13){l.push(o),h=!0;break t}}h||s.push([o])}var d=[];for(a=0;a<s.length;a++){l=s[a];var f=0,g=0;for(u=0;u<l.length;u++)f+=l[u].atMin+l[u].atMax,g+=l[u].btMin+l[u].btMax;f/=2*l.length,g/=2*l.length;var p=t.positionAt(f),v=i.positionAt(g);d.push(new r(p.average(v),f,g))}for(a=0;a<n.length;a++)n[a].freeToPool();return e.cleanPool(),d},getIntersectionRanges:function(t,i){for(var n=t.getInteriorExtremaTs(),s=i.getInteriorExtremaTs(),r=_.zip([0].concat(n),n.concat([1])),a=_.zip([0].concat(s),s.concat([1])),o=[],h=0;h<r.length;h++)for(var u=0;u<a.length;u++){var l=r[h][0],c=r[h][1],m=a[u][0],d=a[u][1],f=t.positionAt(l),g=t.positionAt(c),p=i.positionAt(m),v=i.positionAt(d);e.boxIntersects(f,g,p,v)&&o.push(e.createFromPool(t,i,l,c,m,d,f,g,p,v))}for(h=0;h<50;h++){var x=[];for(u=o.length-1;u>=0;u--)o[u].pushSubdivisions(x);o=x}return o},boxIntersects:function(t,e,i,n){var s=Math.max(Math.min(t.x,e.x),Math.min(i.x,n.x)),r=Math.max(Math.min(t.y,e.y),Math.min(i.y,n.y)),a=Math.min(Math.max(t.x,e.x),Math.max(i.x,n.x)),o=Math.min(Math.max(t.y,e.y),Math.max(i.y,n.y));return a-s>=0&&o-r>=0},cleanPool:function(){for(var t=0;t<e.pool.length;t++)e.pool[t].clean()}}),s.mixInto(e,{initialize:e.prototype.initialize}),e}),i("KITE/segments/Segment",["require","DOT/Bounds2","KITE/ops/BoundsIntersection","AXON/Events","PHET_CORE/inherit","KITE/kite","DOT/Util"],function(t){"use strict";function e(){r.call(this)}function i(t){return t.getSwapped()}var n=t("DOT/Bounds2"),s=t("KITE/ops/BoundsIntersection"),r=t("AXON/Events"),a=t("PHET_CORE/inherit"),o=t("KITE/kite"),h=t("DOT/Util");o.register("Segment",e);return a(r,e,{areStrokedBoundsDilated:function(){return Math.abs(this.startTangent.x*this.startTangent.y)<1e-7&&Math.abs(this.endTangent.x*this.endTangent.y)<1e-7},getBoundsWithTransform:function(t){return this.transformed(t).getBounds()},slice:function(t,e){var i=this;return e<1&&(i=i.subdivided(e)[0]),t>0&&(i=i.subdivided(h.linear(0,e,0,1,t))[1]),i},subdivisions:function(t){for(var e=this,i=[],n=0;n<t.length;n++){var s=t[n],r=e.subdivided(s);i.push(r[0]),e=r[1];for(var a=n+1;a<t.length;a++)t[a]=h.linear(s,1,0,1,t[a])}return i.push(e),i},subdividedIntoMonotone:function(){return this.subdivisions(this.getInteriorExtremaTs())},isSufficientlyFlat:function(t,i){var n=this.start,s=this.positionAt(.5),r=this.end;return e.isSufficientlyFlat(t,i,n,s,r)},getArcLength:function(t,e,i){if(t=void 0===t?1e-10:t,e=void 0===e?1e-8:e,(i=void 0===i?15:i)<=0||this.isSufficientlyFlat(t,e))return this.start.distance(this.end);var n=this.subdivided(.5);return n[0].getArcLength(t,e,i-1)+n[1].getArcLength(t,e,i-1)},getDashValues:function(t,i,n,s){function r(){c=(c+1)%t.length,d=!d}var a=this,o=[],u=0,l=_.sum(t);(i%=l)<0&&(i+=l);for(var c=0,m=0,d=!0;i>0;)i>=t[c]?(i-=t[c],r()):(m=i,i=0);var f=d;return function i(l,d,f,g,p){var v=(l+d)/2,x=a.positionAt(v);if(p>14||e.isSufficientlyFlat(n,s,f,x,g)){var T=f.distance(x)+x.distance(g);u+=T;for(var y=T;m+y>=t[c];){var _=h.linear(0,T,l,d,T-y+t[c]-m);o.push(_),y-=t[c]-m,m=0,r()}m+=y}else i(l,v,f,x,p+1),i(v,d,x,g,p+1)}(0,1,this.start,this.end,0),{values:o,arcLength:u,initiallyInside:f}},toPiecewiseLinearSegments:function(t,e,i,n,s,r){e=void 0===e?t.minLevels:e,i=void 0===i?t.maxLevels:i,n=n||[];var a=t.pointMap||function(t){return t};s=s||a(this.start),r=r||a(this.end);var h=a(this.positionAt(.5)),u=0===i;if(!u&&e<=0&&(u=this.isSufficientlyFlat(null===t.distanceEpsilon?Number.POSITIVE_INFINITY:t.distanceEpsilon,null===t.curveEpsilon?Number.POSITIVE_INFINITY:t.curveEpsilon)),u)n.push(new o.Line(s,r));else{var l=this.subdivided(.5);l[0].toPiecewiseLinearSegments(t,e-1,i-1,n,s,h),l[1].toPiecewiseLinearSegments(t,e-1,i-1,n,h,r)}return n},toPiecewiseLinearOrArcSegments:function(t){t=_.extend({minLevels:2,maxLevels:7,curvatureThreshold:.02,errorThreshold:10,errorPoints:[.25,.75]},t);var e=[];return this.toPiecewiseLinearOrArcRecursion(t,t.minLevels,t.maxLevels,e,0,1,this.positionAt(0),this.positionAt(1),this.curvatureAt(0),this.curvatureAt(1)),e},toPiecewiseLinearOrArcRecursion:function(t,e,i,n,s,r,a,h,u,l){var c=(s+r)/2,m=this.positionAt(c),d=this.curvatureAt(c);if(i<=0||e<=0&&Math.abs(u-d)+Math.abs(d-l)<2*t.curvatureThreshold){var f=o.Arc.createFromPoints(a,m,h),g=!1;if(f instanceof o.Arc)for(var p=f.radius*f.radius,v=0;v<t.errorPoints.length;v++){var x=t.errorPoints[v],T=this.positionAt(s*(1-x)+r*x);if(Math.abs(T.distanceSquared(f.center)-p)>t.errorThreshold){g=!0;break}}if(!g)return void n.push(f)}this.toPiecewiseLinearOrArcRecursion(t,e-1,i-1,n,s,c,a,m,u,d),this.toPiecewiseLinearOrArcRecursion(t,e-1,i-1,n,c,r,m,h,d,l)},toShape:function(){return new o.Shape([new o.Subpath([this])])}}),e.closestToPoint=function(t,e,i){var s=i*i,r=[],a=[],o=Number.POSITIVE_INFINITY,h=!1;for(_.each(t,function(t){if(t.explicitClosestToPoint){var i=t.explicitClosestToPoint(e);_.each(i,function(t){t.distanceSquared<o?(a=[t],o=t.distanceSquared):t.distanceSquared===o&&a.push(t)})}else for(var s=[0].concat(t.getInteriorExtremaTs()).concat([1]),h=0;h<s.length-1;h++){var u=s[h],l=s[h+1],c=t.positionAt(u),m=t.positionAt(l),d=n.point(c).addPoint(m),f=d.minimumDistanceToPointSquared(e);if(f<=o){var g=d.maximumDistanceToPointSquared(e);g<o&&(o=g,a=[]),r.push({ta:u,tb:l,pa:c,pb:m,segment:t,bounds:d,min:f,max:g})}}});r.length&&!h;){var u=r;r=[],h=!0,_.each(u,function(t){if(!(t.minDistanceSquared>o)){h&&t.pa.distanceSquared(t.pb)>s&&(h=!1);var i=(t.ta+t.tb)/2,u=t.segment.positionAt(i),l=n.point(t.pa).addPoint(u),c=n.point(t.pb).addPoint(u),m=l.minimumDistanceToPointSquared(e),d=c.minimumDistanceToPointSquared(e);if(m<=o){var f=l.maximumDistanceToPointSquared(e);f<o&&(o=f,a=[]),r.push({ta:t.ta,tb:i,pa:t.pa,pb:u,segment:t.segment,bounds:l,min:m,max:f})}if(d<=o){var g=c.maximumDistanceToPointSquared(e);g<o&&(o=g,a=[]),r.push({ta:i,tb:t.tb,pa:u,pb:t.pb,segment:t.segment,bounds:c,min:d,max:g})}}})}return _.each(r,function(t){var i=(t.ta+t.tb)/2,n=t.segment.positionAt(i);a.push({segment:t.segment,t:i,closestPoint:n,distanceSquared:e.distanceSquared(n)})}),a},e.polynomialGetOverlapCubic=function(t,i,n,s,r,a,o,u){if(0===u)return e.polynomialGetOverlapQuadratic(t,i,n,r,a,o);var l=h.sign(s/u)*Math.pow(Math.abs(s/u),1/3);if(0===l)return null;return{a:l,b:(n-l*l*o)/(3*l*l*u)}},e.polynomialGetOverlapQuadratic=function(t,i,n,s,r,a){if(0===a)return e.polynomialGetOverlapLinear(t,i,s,r);if(n/a<0)return null;var o=Math.sqrt(n/a);if(0===o)return null;return{a:o,b:(i-o*r)/(2*o*a)}},e.polynomialGetOverlapLinear=function(t,e,i,n){if(0===n)return t===i||null;var s=e/n;if(0===s)return null;return{a:s,b:(t-i)/n}},e.clipOverlap=function(t){},e.intersect=function(t,e){return o.Line&&t instanceof o.Line&&e instanceof o.Line?o.Line.intersect(t,e):o.Line&&t instanceof o.Line?o.Line.intersectOther(t,e):o.Line&&e instanceof o.Line?o.Line.intersectOther(e,t).map(i):o.Arc&&t instanceof o.Arc&&e instanceof o.Arc?o.Arc.intersect(t,e):s.intersect(t,e)},e.deserialize=function(t){return o[t.type].deserialize(t)},e.isSufficientlyFlat=function(t,e,i,n,s){return!(h.distToSegmentSquared(n,i,s)/i.distanceSquared(s)>e)&&!(h.distToSegmentSquared(n,i,s)>t)},e}),i("KITE/segments/Line",["require","DOT/Bounds2","PHET_CORE/inherit","KITE/kite","KITE/util/Overlap","DOT/Ray2","KITE/util/RayIntersection","KITE/segments/Segment","KITE/util/SegmentIntersection","DOT/Util","DOT/Vector2"],function(t){"use strict";function e(t,e){h.call(this),this._start=t,this._end=e,this.invalidate()}var i=t("DOT/Bounds2"),n=t("PHET_CORE/inherit"),s=t("KITE/kite"),r=t("KITE/util/Overlap"),a=t("DOT/Ray2"),o=t("KITE/util/RayIntersection"),h=t("KITE/segments/Segment"),u=t("KITE/util/SegmentIntersection"),l=t("DOT/Util"),c=t("DOT/Vector2"),m=new c;return s.register("Line",e),n(h,e,{setStart:function(t){return this._start.equals(t)||(this._start=t,this.invalidate()),this},set start(t){this.setStart(t)},getStart:function(){return this._start},get start(){return this.getStart()},setEnd:function(t){return this._end.equals(t)||(this._end=t,this.invalidate()),this},set end(t){this.setEnd(t)},getEnd:function(){return this._end},get end(){return this.getEnd()},positionAt:function(t){return this._start.plus(this._end.minus(this._start).times(t))},tangentAt:function(t){return this.getStartTangent()},curvatureAt:function(t){return 0},subdivided:function(t){if(0===t||1===t)return[this];var e=this.positionAt(t);return[new s.Line(this._start,e),new s.Line(e,this._end)]},invalidate:function(){this._tangent=null,this._bounds=null,this._svgPathFragment=null,this.trigger0("invalidated")},getStartTangent:function(){return null===this._tangent&&(this._tangent=this._end.minus(this._start).normalized()),this._tangent},get startTangent(){return this.getStartTangent()},getEndTangent:function(){return this.getStartTangent()},get endTangent(){return this.getEndTangent()},getBounds:function(){return null===this._bounds&&(this._bounds=i.NOTHING.copy().addPoint(this._start).addPoint(this._end)),this._bounds},get bounds(){return this.getBounds()},getBoundsWithTransform:function(t){var e=i.NOTHING.copy();return e.addPoint(t.multiplyVector2(m.set(this._start))),e.addPoint(t.multiplyVector2(m.set(this._end))),e},getNondegenerateSegments:function(){return this._start.equals(this._end)?[]:[this]},getSVGPathFragment:function(){return this._svgPathFragment||(this._svgPathFragment="L "+s.svgNumber(this._end.x)+" "+s.svgNumber(this._end.y)),this._svgPathFragment},strokeLeft:function(t){var e=this.getEndTangent().perpendicular().negated().times(t/2);return[new s.Line(this._start.plus(e),this._end.plus(e))]},strokeRight:function(t){var e=this.getStartTangent().perpendicular().times(t/2);return[new s.Line(this._end.plus(e),this._start.plus(e))]},getInteriorExtremaTs:function(){return[]},intersection:function(t){var e=[],i=this._start,n=this._end.minus(i);if(0===n.magnitudeSquared())return e;var s=t.direction.y*n.x-t.direction.x*n.y;if(0===s)return e;var r=(t.direction.x*(i.y-t.position.y)-t.direction.y*(i.x-t.position.x))/s;if(r<0||r>=1)return e;var a=(n.x*(i.y-t.position.y)-n.y*(i.x-t.position.x))/s;if(a<1e-8)return e;var h=n.perpendicular(),u=i.plus(n.times(r)),l=(h.dot(t.direction)>0?h.negated():h).normalized(),c=t.direction.perpendicular().dot(n)<0?1:-1;return e.push(new o(a,u,l,c,r)),e},windingIntersection:function(t){var e=this.intersection(t);return e.length?e[0].wind:0},writeToContext:function(t){t.lineTo(this._end.x,this._end.y)},transformed:function(t){return new s.Line(t.timesVector2(this._start),t.timesVector2(this._end))},explicitClosestToPoint:function(t){var e=this._end.minus(this._start),i=t.minus(this._start).dot(e)/e.magnitudeSquared();i=l.clamp(i,0,1);var n=this.positionAt(i);return[{segment:this,t:i,closestPoint:n,distanceSquared:t.distanceSquared(n)}]},getSignedAreaFragment:function(){return.5*(this._start.x*this._end.y-this._start.y*this._end.x)},reparameterized:function(t,e){return new s.Line(this.positionAt(e),this.positionAt(t+e))},reversed:function(){return new s.Line(this._end,this._start)},polarToCartesian:function(t){return this._start.x===this._end.x?[new s.Line(c.createPolar(this._start.y,this._start.x),c.createPolar(this._end.y,this._end.x))]:this._start.y===this._end.y?[new s.Arc(c.ZERO,this._start.y,this._start.x,this._end.x,this._start.x>this._end.x)]:this.toPiecewiseLinearSegments(t)},getArcLength:function(){return this.start.distance(this.end)},toPiecewiseLinearOrArcSegments:function(){return[this]},serialize:function(){return{type:"Line",startX:this._start.x,startY:this._start.y,endX:this._end.x,endY:this._end.y}}}),e.deserialize=function(t){return new e(new c(t.startX,t.startY),new c(t.endX,t.endY))},e.getOverlaps=function(t,e){var i,n=[],s=t._start.x,a=-1*t._start.x+t._end.x,o=t._start.y,u=-1*t._start.y+t._end.y,l=e._start.x,c=-1*e._start.x+e._end.x,m=e._start.y,d=-1*e._start.y+e._end.y,f=Math.abs(Math.max(t._start.x,t._end.x,e._start.x,e._end.x)-Math.min(t._start.x,t._end.x,e._start.x,e._end.x)),g=Math.abs(Math.max(t._start.y,t._end.y,e._start.y,e._end.y)-Math.min(t._start.y,t._end.y,e._start.y,e._end.y)),p=h.polynomialGetOverlapLinear(s,a,l,c),v=h.polynomialGetOverlapLinear(o,u,m,d);if(null===(i=f>g?null===p||!0===p?v:p:null===v||!0===v?p:v)||!0===i)return n;var x=1e-6*(Math.abs(s)+Math.abs(a)+Math.abs(o)+Math.abs(u)+Math.abs(l)+Math.abs(c)+Math.abs(m)+Math.abs(d)),T=i.a,y=i.b;if(Math.abs(l+y*c-s)>x)return n;if(Math.abs(T*c-a)>x)return n;if(Math.abs(m+y*d-o)>x)return n;if(Math.abs(T*d-u)>x)return n;var _=T+y;return y>1&&_>1||y<0&&_<0?n:[new r(T,y)]},e.intersect=function(t,e){var i=l.lineSegmentIntersection(t.start.x,t.start.y,t.end.x,t.end.y,e.start.x,e.start.y,e.end.x,e.end.y);if(null!==i){var n=t.explicitClosestToPoint(i)[0].t,s=e.explicitClosestToPoint(i)[0].t;return[new u(i,n,s)]}return[]},e.intersectOther=function(t,e){for(var i=t.end.minus(t.start),n=i.magnitude(),s=new a(t.start,i.normalize()),r=e.intersection(s),o=[],h=0;h<r.length;h++){var l=r[h],c=l.distance/n;c>1e-8&&c<1-1e-8&&o.push(new u(l.point,c,l.t))}return o},e}),i("KITE/segments/Arc",["require","DOT/Bounds2","PHET_CORE/inherit","KITE/kite","KITE/segments/Line","KITE/util/Overlap","KITE/util/RayIntersection","KITE/segments/Segment","KITE/util/SegmentIntersection","DOT/Util","DOT/Vector2"],function(t){"use strict";function e(t,e,i,n,s){h.call(this),this._center=t,this._radius=e,this._startAngle=i,this._endAngle=n,this._anticlockwise=s,this.invalidate()}var i=t("DOT/Bounds2"),n=t("PHET_CORE/inherit"),s=t("KITE/kite"),r=t("KITE/segments/Line"),a=t("KITE/util/Overlap"),o=t("KITE/util/RayIntersection"),h=t("KITE/segments/Segment"),u=t("KITE/util/SegmentIntersection"),l=t("DOT/Util"),c=t("DOT/Vector2"),m=2*Math.PI;return s.register("Arc",e),n(h,e,{setCenter:function(t){return this._center.equals(t)||(this._center=t,this.invalidate()),this},set center(t){this.setCenter(t)},getCenter:function(){return this._center},get center(){return this.getCenter()},setRadius:function(t){return this._radius!==t&&(this._radius=t,this.invalidate()),this},set radius(t){this.setRadius(t)},getRadius:function(){return this._radius},get radius(){return this.getRadius()},setStartAngle:function(t){return this._startAngle!==t&&(this._startAngle=t,this.invalidate()),this},set startAngle(t){this.setStartAngle(t)},getStartAngle:function(){return this._startAngle},get startAngle(){return this.getStartAngle()},setEndAngle:function(t){return this._endAngle!==t&&(this._endAngle=t,this.invalidate()),this},set endAngle(t){this.setEndAngle(t)},getEndAngle:function(){return this._endAngle},get endAngle(){return this.getEndAngle()},setAnticlockwise:function(t){return this._anticlockwise!==t&&(this._anticlockwise=t,this.invalidate()),this},set anticlockwise(t){this.setAnticlockwise(t)},getAnticlockwise:function(){return this._anticlockwise},get anticlockwise(){return this.getAnticlockwise()},positionAt:function(t){return this.positionAtAngle(this.angleAt(t))},tangentAt:function(t){return this.tangentAtAngle(this.angleAt(t))},curvatureAt:function(t){return(this._anticlockwise?-1:1)/this._radius},subdivided:function(t){if(0===t||1===t)return[this];var e=this.angleAt(0),i=this.angleAt(t),n=this.angleAt(1);return[new s.Arc(this._center,this._radius,e,i,this._anticlockwise),new s.Arc(this._center,this._radius,i,n,this._anticlockwise)]},invalidate:function(){this._start=null,this._end=null,this._startTangent=null,this._endTangent=null,this._actualEndAngle=null,this._isFullPerimeter=null,this._angleDifference=null,this._bounds=null,this._svgPathFragment=null,this._radius<0&&(this._radius=-this._radius,this._startAngle+=Math.PI,this._endAngle+=Math.PI),this.trigger0("invalidated")},getStart:function(){return null===this._start&&(this._start=this.positionAtAngle(this._startAngle)),this._start},get start(){return this.getStart()},getEnd:function(){return null===this._end&&(this._end=this.positionAtAngle(this._endAngle)),this._end},get end(){return this.getEnd()},getStartTangent:function(){return null===this._startTangent&&(this._startTangent=this.tangentAtAngle(this._startAngle)),this._startTangent},get startTangent(){return this.getStartTangent()},getEndTangent:function(){return null===this._endTangent&&(this._endTangent=this.tangentAtAngle(this._endAngle)),this._endTangent},get endTangent(){return this.getEndTangent()},getActualEndAngle:function(){return null===this._actualEndAngle&&(this._actualEndAngle=e.computeActualEndAngle(this._startAngle,this._endAngle,this._anticlockwise)),this._actualEndAngle},get actualEndAngle(){return this.getActualEndAngle()},getIsFullPerimeter:function(){return null===this._isFullPerimeter&&(this._isFullPerimeter=!this._anticlockwise&&this._endAngle-this._startAngle>=2*Math.PI||this._anticlockwise&&this._startAngle-this._endAngle>=2*Math.PI),this._isFullPerimeter},get isFullPerimeter(){return this.getIsFullPerimeter()},getAngleDifference:function(){return null===this._angleDifference&&(this._angleDifference=this._anticlockwise?this._startAngle-this._endAngle:this._endAngle-this._startAngle,this._angleDifference<0&&(this._angleDifference+=2*Math.PI)),this._angleDifference},get angleDifference(){return this.getAngleDifference()},getBounds:function(){return null===this._bounds&&(this._bounds=i.NOTHING.copy().withPoint(this.getStart()).withPoint(this.getEnd()),this._startAngle!==this._endAngle&&(this.includeBoundsAtAngle(0),this.includeBoundsAtAngle(Math.PI/2),this.includeBoundsAtAngle(Math.PI),this.includeBoundsAtAngle(3*Math.PI/2))),this._bounds},get bounds(){return this.getBounds()},getNondegenerateSegments:function(){return this._radius<=0||this._startAngle===this._endAngle?[]:[this]},includeBoundsAtAngle:function(t){this.containsAngle(t)&&(this._bounds=this._bounds.withPoint(this._center.plus(c.createPolar(this._radius,t))))},mapAngle:function(t){return Math.abs(l.moduloBetweenDown(t-this._startAngle,-Math.PI,Math.PI))<1e-8?this._startAngle:Math.abs(l.moduloBetweenDown(t-this.getActualEndAngle(),-Math.PI,Math.PI))<1e-8?this.getActualEndAngle():this._startAngle>this.getActualEndAngle()?l.moduloBetweenUp(t,this._startAngle-2*Math.PI,this._startAngle):l.moduloBetweenDown(t,this._startAngle,this._startAngle+2*Math.PI)},tAtAngle:function(t){var e=(this.mapAngle(t)-this._startAngle)/(this.getActualEndAngle()-this._startAngle);return e},angleAt:function(t){return this._startAngle+(this.getActualEndAngle()-this._startAngle)*t},positionAtAngle:function(t){return this._center.plus(c.createPolar(this._radius,t))},tangentAtAngle:function(t){var e=c.createPolar(1,t);return this._anticlockwise?e.perpendicular():e.perpendicular().negated()},containsAngle:function(t){var e=this._anticlockwise?t-this._endAngle:t-this._startAngle;return l.moduloBetweenDown(e,0,2*Math.PI)<=this.angleDifference},getSVGPathFragment:function(){if(!this._svgPathFragment){var t,e=this._anticlockwise?"0":"1";if(this.angleDifference<2*Math.PI-.01)t=this.angleDifference<Math.PI?"0":"1",this._svgPathFragment="A "+s.svgNumber(this._radius)+" "+s.svgNumber(this._radius)+" 0 "+t+" "+e+" "+s.svgNumber(this.end.x)+" "+s.svgNumber(this.end.y);else{var i=(this._startAngle+this._endAngle)/2,n=this._center.plus(c.createPolar(this._radius,i));t="0";var r="A "+s.svgNumber(this._radius)+" "+s.svgNumber(this._radius)+" 0 "+t+" "+e+" "+s.svgNumber(n.x)+" "+s.svgNumber(n.y),a="A "+s.svgNumber(this._radius)+" "+s.svgNumber(this._radius)+" 0 "+t+" "+e+" "+s.svgNumber(this.end.x)+" "+s.svgNumber(this.end.y);this._svgPathFragment=r+" "+a}}return this._svgPathFragment},strokeLeft:function(t){return[new s.Arc(this._center,this._radius+(this._anticlockwise?1:-1)*t/2,this._startAngle,this._endAngle,this._anticlockwise)]},strokeRight:function(t){return[new s.Arc(this._center,this._radius+(this._anticlockwise?-1:1)*t/2,this._endAngle,this._startAngle,!this._anticlockwise)]},getInteriorExtremaTs:function(){var t=this,e=[];return _.each([0,Math.PI/2,Math.PI,3*Math.PI/2],function(i){if(t.containsAngle(i)){var n=t.tAtAngle(i);n>1e-10&&n<1-1e-10&&e.push(n)}}),e.sort()},intersection:function(t){var e=[],i=t.position.minus(this._center),n=t.direction.dot(i),s=4*n*n-4*(i.magnitudeSquared()-this._radius*this._radius);if(s<0)return e;var r=t.direction.dot(this._center)-t.direction.dot(t.position),a=Math.sqrt(s)/2,h=r-a,u=r+a;if(u<0)return e;var l=t.pointAtDistance(u),c=l.minus(this._center).normalized(),m=c.angle();if(h<0)this.containsAngle(m)&&e.push(new o(u,l,c.negated(),this._anticlockwise?-1:1,this.tAtAngle(m)));else{var d=t.pointAtDistance(h),f=d.minus(this._center).normalized(),g=f.angle();this.containsAngle(g)&&e.push(new o(h,d,f,this._anticlockwise?1:-1,this.tAtAngle(g))),this.containsAngle(m)&&e.push(new o(u,l,c.negated(),this._anticlockwise?-1:1,this.tAtAngle(m)))}return e},windingIntersection:function(t){var e=0,i=this.intersection(t);return _.each(i,function(t){e+=t.wind}),e},writeToContext:function(t){t.arc(this._center.x,this._center.y,this._radius,this._startAngle,this._endAngle,this._anticlockwise)},transformed:function(t){var e=t.timesVector2(c.createPolar(1,this._startAngle)).minus(t.timesVector2(c.ZERO)).angle(),i=t.timesVector2(c.createPolar(1,this._endAngle)).minus(t.timesVector2(c.ZERO)).angle(),n=t.getDeterminant()>=0?this._anticlockwise:!this._anticlockwise;Math.abs(this._endAngle-this._startAngle)===2*Math.PI&&(i=n?e-2*Math.PI:e+2*Math.PI);var r=t.getScaleVector();if(r.x!==r.y){var a=r.x*this._radius,o=r.y*this._radius;return new s.EllipticalArc(t.timesVector2(this._center),a,o,0,e,i,n)}var h=r.x*this._radius;return new s.Arc(t.timesVector2(this._center),h,e,i,n)},getSignedAreaFragment:function(){var t=this._startAngle,e=this.getActualEndAngle();return.5*this._radius*(this._radius*(e-t)+this._center.x*(Math.sin(e)-Math.sin(t))-this._center.y*(Math.cos(e)-Math.cos(t)))},reversed:function(){return new s.Arc(this._center,this._radius,this._endAngle,this._startAngle,!this._anticlockwise)},getArcLength:function(){return this.getAngleDifference()*this._radius},toPiecewiseLinearOrArcSegments:function(){return[this]},serialize:function(){return{type:"Arc",centerX:this._center.x,centerY:this._center.y,radius:this._radius,startAngle:this._startAngle,endAngle:this._endAngle,anticlockwise:this._anticlockwise}}}),e.deserialize=function(t){return new e(new c(t.centerX,t.centerY),t.radius,t.startAngle,t.endAngle,t.anticlockwise)},e.computeActualEndAngle=function(t,e,i){return i?t>e?e:t<e?e-2*Math.PI:t:t<e?e:t>e?e+2*Math.PI:t},e.getPartialOverlap=function(t,e,i,n,s){var r=i<e,o=r?e:i,h=r?i:e,u=Math.min(t,o);return u<h+1e-8?[]:[a.createLinear(l.clamp(l.linear(0,t,0,1,h),0,1),l.clamp(l.linear(e,i,n,s,h),0,1),l.clamp(l.linear(0,t,0,1,u),0,1),l.clamp(l.linear(e,i,n,s,u),0,1))]},e.getAngularOverlaps=function(t,i,n,s){var r=i-t,a=r<0?-1:1;r*=a;var o,h=l.moduloBetweenDown(a*(n-t),0,m),u=a*(s-n)+h;return u<-1e-10?(o=-h/(u-h),e.getPartialOverlap(r,h,0,0,o).concat(e.getPartialOverlap(r,m,u+m,o,1))):u>m+1e-10?(o=(m-h)/(u-h),e.getPartialOverlap(r,h,m,0,o).concat(e.getPartialOverlap(r,0,u-m,o,1))):e.getPartialOverlap(r,h,u,0,1)},e.getOverlaps=function(t,i){return t._center.distance(i._center)>1e-8||Math.abs(t._radius-i._radius)>1e-8?[]:e.getAngularOverlaps(t._startAngle,t.getActualEndAngle(),i._startAngle,i.getActualEndAngle())},e.getCircleIntersectionPoint=function(t,e,i,n){var s=i.minus(t),r=s.magnitude(),a=[];if(r<1e-10||r>e+n+1e-10);else if(r>e+n-1e-10)a=[t.blend(i,e/r)];else{var o=.5*(r*r-n*n+e*e)/r,h=r*r-n*n+e*e,u=4*r*r*e*e-h*h,l=t.blend(i,o/r);if(u>=1e-10){var c=Math.sqrt(u)/r/2,m=s.perpendicular().setMagnitude(c);a=[l.plus(m),l.minus(m)]}else u>-1e-10&&(a=[l])}return a},e.intersect=function(t,i){for(var n=e.getCircleIntersectionPoint(t._center,t._radius,i._center,i._radius),s=[],r=0;r<n.length;r++){var a=n[r],o=a.minus(t._center).angle(),h=a.minus(i._center).angle();t.containsAngle(o)&&i.containsAngle(h)&&s.push(new u(a,t.tAtAngle(o),i.tAtAngle(h)))}return s},e.createFromPoints=function(t,i,n){var s=l.circleCenterFromPoints(t,i,n);if(null===s)return new r(t,n);var a=t.minus(s),o=i.minus(s),h=n.minus(s),u=a.angle(),c=o.angle(),m=h.angle(),d=(a.magnitude()+o.magnitude()+h.magnitude())/3,f=new e(s,d,u,m,!1);return f.containsAngle(c)?f:new e(s,d,u,m,!0)},e}),i("KITE/segments/Quadratic",["require","DOT/Bounds2","PHET_CORE/inherit","KITE/kite","DOT/Matrix3","KITE/util/Overlap","KITE/util/RayIntersection","KITE/segments/Segment","DOT/Util","DOT/Vector2"],function(t){"use strict";function e(t,e,i){h.call(this),this._start=t,this._control=e,this._end=i,this.invalidate()}var i=t("DOT/Bounds2"),n=t("PHET_CORE/inherit"),s=t("KITE/kite"),r=t("DOT/Matrix3"),a=t("KITE/util/Overlap"),o=t("KITE/util/RayIntersection"),h=t("KITE/segments/Segment"),u=t("DOT/Util"),l=t("DOT/Vector2"),c=u.solveQuadraticRootsReal,m=u.arePointsCollinear;return s.register("Quadratic",e),n(h,e,{degree:2,setStart:function(t){return this._start.equals(t)||(this._start=t,this.invalidate()),this},set start(t){this.setStart(t)},getStart:function(){return this._start},get start(){return this.getStart()},setControl:function(t){return this._control.equals(t)||(this._control=t,this.invalidate()),this},set control(t){this.setControl(t)},getControl:function(){return this._control},get control(){return this.getControl()},setEnd:function(t){return this._end.equals(t)||(this._end=t,this.invalidate()),this},set end(t){this.setEnd(t)},getEnd:function(){return this._end},get end(){return this.getEnd()},positionAt:function(t){var e=1-t;return this._start.times(e*e).plus(this._control.times(2*e*t)).plus(this._end.times(t*t))},tangentAt:function(t){return this._control.minus(this._start).times(2*(1-t)).plus(this._end.minus(this._control).times(2*t))},curvatureAt:function(t){if(Math.abs(t-.5)>.5-1e-7){var e=t<.5,i=e?this._start:this._end,n=this._control,s=e?this._end:this._start,r=n.minus(i),a=r.magnitude();return(e?-1:1)*r.perpendicular().normalized().dot(s.minus(n))*(this.degree-1)/(this.degree*a*a)}return this.subdivided(t,!0)[0].curvatureAt(1)},subdivided:function(t){if(0===t||1===t)return[this];var e=this._start.blend(this._control,t),i=this._control.blend(this._end,t),n=e.blend(i,t);return[new s.Quadratic(this._start,e,n),new s.Quadratic(n,i,this._end)]},invalidate:function(){this._startTangent=null,this._endTangent=null,this._tCriticalX=null,this._tCriticalY=null,this._bounds=null,this._svgPathFragment=null,this.trigger0("invalidated")},getStartTangent:function(){if(null===this._startTangent){var t=this._start.equals(this._control);this._startTangent=t?this._end.minus(this._start).normalized():this._control.minus(this._start).normalized()}return this._startTangent},get startTangent(){return this.getStartTangent()},getEndTangent:function(){if(null===this._endTangent){var t=this._end.equals(this._control);this._endTangent=t?this._end.minus(this._start).normalized():this._end.minus(this._control).normalized()}return this._endTangent},get endTangent(){return this.getEndTangent()},getTCriticalX:function(){return null===this._tCriticalX&&(this._tCriticalX=e.extremaT(this._start.x,this._control.x,this._end.x)),this._tCriticalX},get tCriticalX(){return this.getTCriticalX()},getTCriticalY:function(){return null===this._tCriticalY&&(this._tCriticalY=e.extremaT(this._start.y,this._control.y,this._end.y)),this._tCriticalY},get tCriticalY(){return this.getTCriticalY()},getNondegenerateSegments:function(){var t=this._start,i=this._control,n=this._end,r=t.equals(n),a=t.equals(i),o=t.equals(i);if(r&&a)return[];if(r){var h=this.positionAt(.5);return[new s.Line(t,h),new s.Line(h,n)]}if(m(t,i,n)){if(a||o)return[new s.Line(t,n)];var u=n.minus(t),l=i.minus(t).dot(u.normalized)/u.magnitude(),c=e.extremaT(0,l,1);if(!isNaN(c)&&c>0&&c<1){var d=this.positionAt(c);return _.flatten([new s.Line(t,d).getNondegenerateSegments(),new s.Line(d,n).getNondegenerateSegments()])}return[new s.Line(t,n)]}return[this]},getBounds:function(){if(null===this._bounds){this._bounds=new i(Math.min(this._start.x,this._end.x),Math.min(this._start.y,this._end.y),Math.max(this._start.x,this._end.x),Math.max(this._start.y,this._end.y));var t=this.getTCriticalX(),e=this.getTCriticalY();!isNaN(t)&&t>0&&t<1&&(this._bounds=this._bounds.withPoint(this.positionAt(t))),!isNaN(e)&&e>0&&e<1&&(this._bounds=this._bounds.withPoint(this.positionAt(e)))}return this._bounds},get bounds(){return this.getBounds()},offsetTo:function(t,e){for(var i=[this],n=0;n<5;n++)i=_.flatten(_.map(i,function(t){return t.subdivided(.5,!0)}));var s=_.map(i,function(e){return e.approximateOffset(t)});return e&&(s.reverse(),s=_.map(s,function(t){return t.reversed(!0)})),s},degreeElevated:function(){return new s.Cubic(this._start,this._start.plus(this._control.timesScalar(2)).dividedScalar(3),this._end.plus(this._control.timesScalar(2)).dividedScalar(3),this._end)},approximateOffset:function(t){return new s.Quadratic(this._start.plus((this._start.equals(this._control)?this._end.minus(this._start):this._control.minus(this._start)).perpendicular().normalized().times(t)),this._control.plus(this._end.minus(this._start).perpendicular().normalized().times(t)),this._end.plus((this._end.equals(this._control)?this._end.minus(this._start):this._end.minus(this._control)).perpendicular().normalized().times(t)))},getSVGPathFragment:function(){return this._svgPathFragment||(this._svgPathFragment="Q "+s.svgNumber(this._control.x)+" "+s.svgNumber(this._control.y)+" "+s.svgNumber(this._end.x)+" "+s.svgNumber(this._end.y)),this._svgPathFragment},strokeLeft:function(t){return this.offsetTo(-t/2,!1)},strokeRight:function(t){return this.offsetTo(t/2,!0)},getInteriorExtremaTs:function(){var t=[],e=this.getTCriticalX(),i=this.getTCriticalY();return!isNaN(e)&&e>1e-10&&e<1-1e-10&&t.push(this.tCriticalX),!isNaN(i)&&i>1e-10&&i<1-1e-10&&t.push(this.tCriticalY),t.sort()},intersection:function(t){var e=this,i=[],n=r.rotation2(-t.direction.angle()).timesMatrix(r.translation(-t.position.x,-t.position.y)),s=n.timesVector2(this._start),a=n.timesVector2(this._control),h=n.timesVector2(this._end),u=s.y-2*a.y+h.y,l=-2*s.y+2*a.y,m=s.y,d=c(u,l,m);return _.each(d,function(n){if(n>=0&&n<=1){var s=e.positionAt(n),r=e.tangentAt(n).normalized(),a=r.perpendicular(),h=s.minus(t.position);if(h.dot(t.direction)>0){var u=a.dot(t.direction)>0?a.negated():a,l=t.direction.perpendicular().dot(r)<0?1:-1;i.push(new o(h.magnitude(),s,u,l,n))}}}),i},windingIntersection:function(t){var e=0,i=this.intersection(t);return _.each(i,function(t){e+=t.wind}),e},writeToContext:function(t){t.quadraticCurveTo(this._control.x,this._control.y,this._end.x,this._end.y)},transformed:function(t){return new s.Quadratic(t.timesVector2(this._start),t.timesVector2(this._control),t.timesVector2(this._end))},getSignedAreaFragment:function(){return 1/6*(this._start.x*(2*this._control.y+this._end.y)+this._control.x*(-2*this._start.y+2*this._end.y)+this._end.x*(-this._start.y-2*this._control.y))},reparameterized:function(t,e){var i=this._start.plus(this._end.plus(this._control.timesScalar(-2))),n=this._control.minus(this._start).timesScalar(2),r=this._start,a=i.timesScalar(t*t),o=i.timesScalar(t*e).timesScalar(2).plus(n.timesScalar(t)),h=i.timesScalar(e*e).plus(n.timesScalar(e)).plus(r);return new s.Quadratic(h,o.timesScalar(.5).plus(h),a.plus(o).plus(h))},reversed:function(){return new s.Quadratic(this._end,this._control,this._start)},serialize:function(){return{type:"Quadratic",startX:this._start.x,startY:this._start.y,controlX:this._control.x,controlY:this._control.y,endX:this._end.x,endY:this._end.y}}}),e.deserialize=function(t){return new e(new l(t.startX,t.startY),new l(t.controlX,t.controlY),new l(t.endX,t.endY))},e.extremaT=function(t,e,i){var n=2*(i-2*e+t);return 0!==n?-2*(e-t)/n:NaN},e.getOverlaps=function(t,e){var i,n=[],s=t._start.x,r=-2*t._start.x+2*t._control.x,o=t._start.x-2*t._control.x+t._end.x,u=t._start.y,l=-2*t._start.y+2*t._control.y,c=t._start.y-2*t._control.y+t._end.y,m=e._start.x,d=-2*e._start.x+2*e._control.x,f=e._start.x-2*e._control.x+e._end.x,g=e._start.y,p=-2*e._start.y+2*e._control.y,v=e._start.y-2*e._control.y+e._end.y,x=Math.abs(Math.max(t._start.x,t._control.x,t._end.x,e._start.x,e._control.x,e._end.x)-Math.min(t._start.x,t._control.x,t._end.x,e._start.x,e._control.x,e._end.x)),T=Math.abs(Math.max(t._start.y,t._control.y,t._end.y,e._start.y,e._control.y,e._end.y)-Math.min(t._start.y,t._control.y,t._end.y,e._start.y,e._control.y,e._end.y)),y=h.polynomialGetOverlapQuadratic(s,r,o,m,d,f),_=h.polynomialGetOverlapQuadratic(u,l,c,g,p,v);if(null===(i=x>T?null===y||!0===y?_:y:null===_||!0===_?y:_)||!0===i)return n;var E=1e-6*(Math.abs(s)+Math.abs(r)+Math.abs(o)+Math.abs(u)+Math.abs(l)+Math.abs(c)+Math.abs(m)+Math.abs(d)+Math.abs(f)+Math.abs(g)+Math.abs(p)+Math.abs(v)),w=i.a,O=i.b,b=w*w,I=O*O,A=2*w*O;if(Math.abs(m+O*d+I*f-s)>E)return n;if(Math.abs(w*d+A*f-r)>E)return n;if(Math.abs(b*f-o)>E)return n;if(Math.abs(g+O*p+I*v-u)>E)return n;if(Math.abs(w*p+A*v-l)>E)return n;if(Math.abs(b*v-c)>E)return n;var M=w+O;return O>1&&M>1||O<0&&M<0?n:[new a(w,O)]},e}),i("KITE/segments/Cubic",["require","DOT/Bounds2","KITE/ops/BoundsIntersection","PHET_CORE/inherit","KITE/kite","DOT/Matrix3","KITE/util/Overlap","KITE/segments/Quadratic","KITE/util/RayIntersection","KITE/segments/Segment","KITE/util/SegmentIntersection","DOT/Util","DOT/Vector2"],function(t){"use strict";function e(t){return t>=0&&t<=1}function i(t,e,i,n){c.call(this),this._start=t,this._control1=e,this._control2=i,this._end=n,this.invalidate()}var n=t("DOT/Bounds2"),s=t("KITE/ops/BoundsIntersection"),r=t("PHET_CORE/inherit"),a=t("KITE/kite"),o=t("DOT/Matrix3"),h=t("KITE/util/Overlap"),u=t("KITE/segments/Quadratic"),l=t("KITE/util/RayIntersection"),c=t("KITE/segments/Segment"),m=t("KITE/util/SegmentIntersection"),d=t("DOT/Util"),f=t("DOT/Vector2"),g=d.solveQuadraticRootsReal,p=d.solveCubicRootsReal,v=d.arePointsCollinear,x=new f,T=new f,y=new f;return a.register("Cubic",i),r(c,i,{degree:3,setStart:function(t){return this._start.equals(t)||(this._start=t,this.invalidate()),this},set start(t){this.setStart(t)},getStart:function(){return this._start},get start(){return this.getStart()},setControl1:function(t){return this._control1.equals(t)||(this._control1=t,this.invalidate()),this},set control1(t){this.setControl1(t)},getControl1:function(){return this._control1},get control1(){return this.getControl1()},setControl2:function(t){return this._control2.equals(t)||(this._control2=t,this.invalidate()),this},set control2(t){this.setControl2(t)},getControl2:function(){return this._control2},get control2(){return this.getControl2()},setEnd:function(t){return this._end.equals(t)||(this._end=t,this.invalidate()),this},set end(t){this.setEnd(t)},getEnd:function(){return this._end},get end(){return this.getEnd()},positionAt:function(t){var e=1-t,i=e*e*e,n=3*e*e*t,s=3*e*t*t,r=t*t*t;return new f(this._start.x*i+this._control1.x*n+this._control2.x*s+this._end.x*r,this._start.y*i+this._control1.y*n+this._control2.y*s+this._end.y*r)},tangentAt:function(t){var e=1-t;return(new f).set(this._start).multiplyScalar(-3*e*e).add(x.set(this._control1).multiplyScalar(3*e*e-6*e*t)).add(x.set(this._control2).multiplyScalar(6*e*t-3*t*t)).add(x.set(this._end).multiplyScalar(3*t*t))},curvatureAt:function(t){if(Math.abs(t-.5)>.5-1e-7){var e=t<.5,i=e?this._start:this._end,n=e?this._control1:this._control2,s=e?this._control2:this._control1,r=n.minus(i),a=r.magnitude();return(e?-1:1)*r.perpendicular().normalized().dot(s.minus(n))*(this.degree-1)/(this.degree*a*a)}return this.subdivided(t)[0].curvatureAt(1)},subdivided:function(t){if(0===t||1===t)return[this];var e=this._start.blend(this._control1,t),i=this._control2.blend(this._end,t),n=this._control1.blend(this._control2,t),s=e.blend(n,t),r=n.blend(i,t),o=s.blend(r,t);return[new a.Cubic(this._start,e,s,o),new a.Cubic(o,r,i,this._end)]},invalidate:function(){this._startTangent=null,this._endTangent=null,this._r=null,this._s=null,this._tCusp=null,this._tDeterminant=null,this._tInflection1=null,this._tInflection2=null,this._quadratics=null,this._xExtremaT=null,this._yExtremaT=null,this._bounds=null,this._svgPathFragment=null,this.trigger0("invalidated")},getStartTangent:function(){return null===this._startTangent&&(this._startTangent=this.tangentAt(0).normalized()),this._startTangent},get startTangent(){return this.getStartTangent()},getEndTangent:function(){return null===this._endTangent&&(this._endTangent=this.tangentAt(1).normalized()),this._endTangent},get endTangent(){return this.getEndTangent()},getR:function(){return null===this._r&&(this._r=this._control1.minus(this._start).normalized()),this._r},get r(){return this.getR()},getS:function(){return null===this._s&&(this._s=this.getR().perpendicular()),this._s},get s(){return this.getS()},getTCusp:function(){return null===this._tCusp&&this.computeCuspInfo(),this._tCusp},get tCusp(){return this.getTCusp()},getTDeterminant:function(){return null===this._tDeterminant&&this.computeCuspInfo(),this._tDeterminant},get tDeterminant(){return this.getTDeterminant()},getTInflection1:function(){return null===this._tInflection1&&this.computeCuspInfo(),this._tInflection1},get tInflection1(){return this.getTInflection1()},getTInflection2:function(){return null===this._tInflection2&&this.computeCuspInfo(),this._tInflection2},get tInflection2(){return this.getTInflection2()},getQuadratics:function(){return null===this._quadratics&&this.computeCuspSegments(),this._quadratics},getXExtremaT:function(){return null===this._xExtremaT&&(this._xExtremaT=i.extremaT(this._start.x,this._control1.x,this._control2.x,this._end.x)),this._xExtremaT},get xExtremaT(){return this.getXExtremaT()},getYExtremaT:function(){return null===this._yExtremaT&&(this._yExtremaT=i.extremaT(this._start.y,this._control1.y,this._control2.y,this._end.y)),this._yExtremaT},get yExtremaT(){return this.getYExtremaT()},getBounds:function(){if(null===this._bounds){this._bounds=n.NOTHING,this._bounds=this._bounds.withPoint(this._start),this._bounds=this._bounds.withPoint(this._end);var t=this;_.each(this.getXExtremaT(),function(e){e>=0&&e<=1&&(t._bounds=t._bounds.withPoint(t.positionAt(e)))}),_.each(this.getYExtremaT(),function(e){e>=0&&e<=1&&(t._bounds=t._bounds.withPoint(t.positionAt(e)))}),this.hasCusp()&&(this._bounds=this._bounds.withPoint(this.positionAt(this.getTCusp())))}return this._bounds},get bounds(){return this.getBounds()},computeCuspInfo:function(){var t=this._start.times(-1).plus(this._control1.times(3)).plus(this._control2.times(-3)).plus(this._end),e=this._start.times(3).plus(this._control1.times(-6)).plus(this._control2.times(3)),i=this._start.times(-3).plus(this._control1.times(3)),n=t.perpendicular(),s=e.perpendicular(),r=n.dot(e);if(this._tCusp=n.dot(i)/r*-.5,this._tDeterminant=this._tCusp*this._tCusp-1/3*(s.dot(i)/r),this._tDeterminant>=0){var a=Math.sqrt(this._tDeterminant);this._tInflection1=this._tCusp-a,this._tInflection2=this._tCusp+a}else this._tInflection1=NaN,this._tInflection2=NaN},computeCuspSegments:function(){if(this.hasCusp()){this._quadratics=[];var t=this.getTCusp();if(0===t)this._quadratics.push(new u(this.start,this.control2,this.end,!1));else if(1===t)this._quadratics.push(new u(this.start,this.control1,this.end,!1));else{var e=this.subdivided(t);this._quadratics.push(new u(e[0].start,e[0].control1,e[0].end,!1)),this._quadratics.push(new u(e[1].start,e[1].control2,e[1].end,!1))}}else this._quadratics=null},getNondegenerateSegments:function(){var t=this,e=this._start,i=this._control1,n=this._control2,s=this._end,r=this.degreeReduced(1e-9);if(e.equals(s)&&e.equals(i)&&e.equals(n))return[];if(this.hasCusp())return _.flatten(this.getQuadratics().map(function(t){return t.getNondegenerateSegments()}));if(r)return r.getNondegenerateSegments();if(v(e,i,s)&&v(e,n,s)){var o=this.getXExtremaT().concat(this.getYExtremaT()).sort().map(function(e){return t.positionAt(e)}),h=[],u=e;o.length&&(h.push(new a.Line(e,o[0])),u=o[0]);for(var l=1;l<o.length;l++)h.push(new a.Line(o[l-1],o[l])),u=o[l];return h.push(new a.Line(u,s)),_.flatten(h.map(function(t){return t.getNondegenerateSegments()}),!0)}return[this]},hasCusp:function(){var t=this.getTCusp();return t>=0&&t<=1&&this.tangentAt(t).magnitude()<1e-7},toRS:function(t){var e=t.minus(this._start);return new f(e.dot(this.getR()),e.dot(this.getS()))},offsetTo:function(t,e){for(var i=[],n=[],s=0;s<32;s++){var r=s/31;e&&(r=1-r),i.push(this.positionAt(r).plus(this.tangentAt(r).perpendicular().normalized().times(t))),s>0&&n.push(new a.Line(i[s-1],i[s]))}return n},getSVGPathFragment:function(){return this._svgPathFragment||(this._svgPathFragment="C "+a.svgNumber(this._control1.x)+" "+a.svgNumber(this._control1.y)+" "+a.svgNumber(this._control2.x)+" "+a.svgNumber(this._control2.y)+" "+a.svgNumber(this._end.x)+" "+a.svgNumber(this._end.y)),this._svgPathFragment},strokeLeft:function(t){return this.offsetTo(-t/2,!1)},strokeRight:function(t){return this.offsetTo(t/2,!0)},getInteriorExtremaTs:function(){var t=this.getXExtremaT().concat(this.getYExtremaT()),e=[];return _.each(t,function(t){t>1e-10&&t<1-1e-10&&_.every(e,function(e){return Math.abs(t-e)>1e-10})&&e.push(t)}),e.sort()},intersection:function(t){var e=this,i=[],n=o.rotation2(-t.direction.angle()).timesMatrix(o.translation(-t.position.x,-t.position.y)),s=n.timesVector2(this._start),r=n.timesVector2(this._control1),a=n.timesVector2(this._control2),h=n.timesVector2(this._end),u=-s.y+3*r.y-3*a.y+h.y,c=3*s.y-6*r.y+3*a.y,m=-3*s.y+3*r.y,d=s.y,f=p(u,c,m,d);return _.each(f,function(n){if(n>=0&&n<=1){var s=e.positionAt(n),r=e.tangentAt(n).normalized(),a=r.perpendicular(),o=s.minus(t.position);if(o.dot(t.direction)>0){var h=a.dot(t.direction)>0?a.negated():a,u=t.direction.perpendicular().dot(r)<0?1:-1;i.push(new l(o.magnitude(),s,h,u,n))}}}),i},windingIntersection:function(t){var e=0,i=this.intersection(t);return _.each(i,function(t){e+=t.wind}),e},writeToContext:function(t){t.bezierCurveTo(this._control1.x,this._control1.y,this._control2.x,this._control2.y,this._end.x,this._end.y)},transformed:function(t){return new a.Cubic(t.timesVector2(this._start),t.timesVector2(this._control1),t.timesVector2(this._control2),t.timesVector2(this._end))},degreeReduced:function(t){t=t||0;var e=x.set(this._control1).multiplyScalar(3).subtract(this._start).divideScalar(2),i=T.set(this._control2).multiplyScalar(3).subtract(this._end).divideScalar(2);return y.set(e).subtract(i).magnitude()<=t?new u(this._start,e.average(i),this._end):null},getSignedAreaFragment:function(){return.05*(this._start.x*(6*this._control1.y+3*this._control2.y+this._end.y)+this._control1.x*(-6*this._start.y+3*this._control2.y+3*this._end.y)+this._control2.x*(-3*this._start.y-3*this._control1.y+6*this._end.y)+this._end.x*(-this._start.y-3*this._control1.y-6*this._control2.y))},reversed:function(){return new a.Cubic(this._end,this._control2,this._control1,this._start)},getSelfIntersection:function(){var t=this.getInteriorExtremaTs(),e=[0].concat(t).concat([1]),i=this.subdivisions(t);if(i.length<3)return null;for(var n=0;n<i.length;n++)for(var r=i[n],a=n+1;a<i.length;a++){var o=i[a],h=s.intersect(r,o);if(h.length){var u=h[0];if(u.aT>1e-7&&u.aT<1-1e-7&&u.bT>1e-7&&u.bT<1-1e-7){var l=e[n]+u.aT*(e[n+1]-e[n]),c=e[a]+u.bT*(e[a+1]-e[a]);return new m(u.point,l,c)}}}return null},serialize:function(){return{type:"Cubic",startX:this._start.x,startY:this._start.y,control1X:this._control1.x,control1Y:this._control1.y,control2X:this._control2.x,control2Y:this._control2.y,endX:this._end.x,endY:this._end.y}}}),i.deserialize=function(t){return new i(new f(t.startX,t.startY),new f(t.control1X,t.control1Y),new f(t.control2X,t.control2Y),new f(t.endX,t.endY))},i.extremaT=function(t,i,n,s){if(t===i&&t===n&&t===s)return[];var r=-3*t+9*i-9*n+3*s,a=6*t-12*i+6*n,o=-3*t+3*i;return _.filter(g(r,a,o),e)},i.getOverlaps=function(t,e){var i,n=[],s=t._start.x,r=-3*t._start.x+3*t._control1.x,a=3*t._start.x-6*t._control1.x+3*t._control2.x,o=-1*t._start.x+3*t._control1.x-3*t._control2.x+t._end.x,u=t._start.y,l=-3*t._start.y+3*t._control1.y,m=3*t._start.y-6*t._control1.y+3*t._control2.y,d=-1*t._start.y+3*t._control1.y-3*t._control2.y+t._end.y,f=e._start.x,g=-3*e._start.x+3*e._control1.x,p=3*e._start.x-6*e._control1.x+3*e._control2.x,v=-1*e._start.x+3*e._control1.x-3*e._control2.x+e._end.x,x=e._start.y,T=-3*e._start.y+3*e._control1.y,y=3*e._start.y-6*e._control1.y+3*e._control2.y,_=-1*e._start.y+3*e._control1.y-3*e._control2.y+e._end.y,E=Math.abs(Math.max(t._start.x,t._control1.x,t._control2.x,t._end.x,t._start.x,t._control1.x,t._control2.x,t._end.x)-Math.min(t._start.x,t._control1.x,t._control2.x,t._end.x,t._start.x,t._control1.x,t._control2.x,t._end.x)),w=Math.abs(Math.max(t._start.y,t._control1.y,t._control2.y,t._end.y,t._start.y,t._control1.y,t._control2.y,t._end.y)-Math.min(t._start.y,t._control1.y,t._control2.y,t._end.y,t._start.y,t._control1.y,t._control2.y,t._end.y)),O=c.polynomialGetOverlapCubic(s,r,a,o,f,g,p,v),b=c.polynomialGetOverlapCubic(u,l,m,d,x,T,y,_);if(null===(i=E>w?null===O||!0===O?b:O:null===b||!0===b?O:b)||!0===i)return n;var I=1e-6*(Math.abs(s)+Math.abs(r)+Math.abs(a)+Math.abs(o)+Math.abs(u)+Math.abs(l)+Math.abs(m)+Math.abs(d)+Math.abs(f)+Math.abs(g)+Math.abs(p)+Math.abs(v)+Math.abs(x)+Math.abs(T)+Math.abs(y)+Math.abs(_)),A=i.a,M=i.b,P=A*A,S=A*A*A,C=M*M,R=M*M*M,D=2*A*M,V=3*A*C,X=3*P*M;if(Math.abs(f+M*g+C*p+R*v-s)>I)return n;if(Math.abs(A*g+D*p+V*v-r)>I)return n;if(Math.abs(P*p+X*v-a)>I)return n;if(Math.abs(S*v-o)>I)return n;if(Math.abs(x+M*T+C*y+R*_-u)>I)return n;if(Math.abs(A*T+D*y+V*_-l)>I)return n;if(Math.abs(P*y+X*_-m)>I)return n;if(Math.abs(S*_-d)>I)return n;var N=A+M;return M>1&&N>1||M<0&&N<0?n:[new h(A,M)]},i}),i("KITE/segments/EllipticalArc",["require","KITE/segments/Arc","DOT/Bounds2","PHET_CORE/inherit","KITE/kite","DOT/Matrix3","KITE/util/RayIntersection","KITE/segments/Segment","DOT/Transform3","DOT/Util","DOT/Vector2"],function(t){"use strict";function e(t,e,i,n,s,r,a){h.call(this),this._center=t,this._radiusX=e,this._radiusY=i,this._rotation=n,this._startAngle=s,this._endAngle=r,this._anticlockwise=a,this.invalidate()}var i=t("KITE/segments/Arc"),n=t("DOT/Bounds2"),s=t("PHET_CORE/inherit"),r=t("KITE/kite"),a=t("DOT/Matrix3"),o=t("KITE/util/RayIntersection"),h=t("KITE/segments/Segment"),u=t("DOT/Transform3"),l=t("DOT/Util"),c=t("DOT/Vector2"),m=l.toDegrees;return r.register("EllipticalArc",e),s(h,e,{setCenter:function(t){return this._center.equals(t)||(this._center=t,this.invalidate()),this},set center(t){this.setCenter(t)},getCenter:function(){return this._center},get center(){return this.getCenter()},setRadiusX:function(t){return this._radiusX!==t&&(this._radiusX=t,this.invalidate()),this},set radiusX(t){this.setRadiusX(t)},getRadiusX:function(){return this._radiusX},get radiusX(){return this.getRadiusX()},setRadiusY:function(t){return this._radiusY!==t&&(this._radiusY=t,this.invalidate()),this},set radiusY(t){this.setRadiusY(t)},getRadiusY:function(){return this._radiusY},get radiusY(){return this.getRadiusY()},setRotation:function(t){return this._rotation!==t&&(this._rotation=t,this.invalidate()),this},set rotation(t){this.setRotation(t)},getRotation:function(){return this._rotation},get rotation(){return this.getRotation()},setStartAngle:function(t){return this._startAngle!==t&&(this._startAngle=t,this.invalidate()),this},set startAngle(t){this.setStartAngle(t)},getStartAngle:function(){return this._startAngle},get startAngle(){return this.getStartAngle()},setEndAngle:function(t){return this._endAngle!==t&&(this._endAngle=t,this.invalidate()),this},set endAngle(t){this.setEndAngle(t)},getEndAngle:function(){return this._endAngle},get endAngle(){return this.getEndAngle()},setAnticlockwise:function(t){return this._anticlockwise!==t&&(this._anticlockwise=t,this.invalidate()),this},set anticlockwise(t){this.setAnticlockwise(t)},getAnticlockwise:function(){return this._anticlockwise},get anticlockwise(){return this.getAnticlockwise()},positionAt:function(t){return this.positionAtAngle(this.angleAt(t))},tangentAt:function(t){return this.tangentAtAngle(this.angleAt(t))},curvatureAt:function(t){var e=this.angleAt(t),i=this._radiusX*Math.sin(e),n=this._radiusY*Math.cos(e),s=Math.pow(n*n+i*i,1.5);return(this._anticlockwise?-1:1)*this._radiusX*this._radiusY/s},subdivided:function(t){if(0===t||1===t)return[this];var e=this.angleAt(0),i=this.angleAt(t),n=this.angleAt(1);return[new r.EllipticalArc(this._center,this._radiusX,this._radiusY,this._rotation,e,i,this._anticlockwise),new r.EllipticalArc(this._center,this._radiusX,this._radiusY,this._rotation,i,n,this._anticlockwise)]},invalidate:function(){if(this._unitTransform=null,this._start=null,this._end=null,this._startTangent=null,this._endTangent=null,this._actualEndAngle=null,this._isFullPerimeter=null,this._angleDifference=null,this._unitArcSegment=null,this._bounds=null,this._svgPathFragment=null,this._radiusX<0&&(this._radiusX=-this._radiusX,this._startAngle=Math.PI-this._startAngle,this._endAngle=Math.PI-this._endAngle,this._anticlockwise=!this._anticlockwise),this._radiusY<0&&(this._radiusY=-this._radiusY,this._startAngle=-this._startAngle,this._endAngle=-this._endAngle,this._anticlockwise=!this._anticlockwise),this._radiusX<this._radiusY){this._rotation+=Math.PI/2,this._startAngle-=Math.PI/2,this._endAngle-=Math.PI/2;var t=this._radiusX;this._radiusX=this._radiusY,this._radiusY=t}if(this._radiusX<this._radiusY)throw new Error("Not verified to work if radiusX < radiusY");this.trigger0("invalidated")},getUnitTransform:function(){return null===this._unitTransform&&(this._unitTransform=e.computeUnitTransform(this._center,this._radiusX,this._radiusY,this._rotation)),this._unitTransform},get unitTransform(){return this.getUnitTransform()},getStart:function(){return null===this._start&&(this._start=this.positionAtAngle(this._startAngle)),this._start},get start(){return this.getStart()},getEnd:function(){return null===this._end&&(this._end=this.positionAtAngle(this._endAngle)),this._end},get end(){return this.getEnd()},getStartTangent:function(){return null===this._startTangent&&(this._startTangent=this.tangentAtAngle(this._startAngle)),this._startTangent},get startTangent(){return this.getStartTangent()},getEndTangent:function(){return null===this._endTangent&&(this._endTangent=this.tangentAtAngle(this._endAngle)),this._endTangent},get endTangent(){return this.getEndTangent()},getActualEndAngle:function(){return null===this._actualEndAngle&&(this._actualEndAngle=i.computeActualEndAngle(this._startAngle,this._endAngle,this._anticlockwise)),this._actualEndAngle},get actualEndAngle(){return this.getActualEndAngle()},getIsFullPerimeter:function(){return null===this._isFullPerimeter&&(this._isFullPerimeter=!this._anticlockwise&&this._endAngle-this._startAngle>=2*Math.PI||this._anticlockwise&&this._startAngle-this._endAngle>=2*Math.PI),this._isFullPerimeter},get isFullPerimeter(){return this.getIsFullPerimeter()},getAngleDifference:function(){return null===this._angleDifference&&(this._angleDifference=this._anticlockwise?this._startAngle-this._endAngle:this._endAngle-this._startAngle,this._angleDifference<0&&(this._angleDifference+=2*Math.PI)),this._angleDifference},get angleDifference(){return this.getAngleDifference()},getUnitArcSegment:function(){return null===this._unitArcSegment&&(this._unitArcSegment=new r.Arc(c.ZERO,1,this._startAngle,this._endAngle,this._anticlockwise)),this._unitArcSegment},get unitArcSegment(){return this.getUnitArcSegment()},getBounds:function(){if(null===this._bounds&&(this._bounds=n.NOTHING.withPoint(this.getStart()).withPoint(this.getEnd()),this._startAngle!==this._endAngle)){var t=Math.atan(-this._radiusY/this._radiusX*Math.tan(this._rotation)),e=Math.atan(this._radiusY/this._radiusX/Math.tan(this._rotation));this.possibleExtremaAngles=[t,t+Math.PI,e,e+Math.PI],_.each(this.possibleExtremaAngles,this.includeBoundsAtAngle.bind(this))}return this._bounds},get bounds(){return this.getBounds()},getNondegenerateSegments:function(){if(this._radiusX<=0||this._radiusY<=0||this._startAngle===this._endAngle)return[];if(this._radiusX===this._radiusY){var t=this._startAngle-this._rotation,e=this._endAngle-this._rotation;return Math.abs(this._endAngle-this._startAngle)===2*Math.PI&&(e=this._anticlockwise?t-2*Math.PI:t+2*Math.PI),[new r.Arc(this._center,this._radiusX,t,e,this._anticlockwise)]}return[this]},includeBoundsAtAngle:function(t){this.unitArcSegment.containsAngle(t)&&(this._bounds=this._bounds.withPoint(this.positionAtAngle(t)))},mapAngle:function(t){return Math.abs(l.moduloBetweenDown(t-this._startAngle,-Math.PI,Math.PI))<1e-8?this._startAngle:Math.abs(l.moduloBetweenDown(t-this.getActualEndAngle(),-Math.PI,Math.PI))<1e-8?this.getActualEndAngle():this._startAngle>this.getActualEndAngle()?l.moduloBetweenUp(t,this._startAngle-2*Math.PI,this._startAngle):l.moduloBetweenDown(t,this._startAngle,this._startAngle+2*Math.PI)},tAtAngle:function(t){return(this.mapAngle(t)-this._startAngle)/(this.getActualEndAngle()-this._startAngle)},angleAt:function(t){return this._startAngle+(this.getActualEndAngle()-this._startAngle)*t},positionAtAngle:function(t){return this.getUnitTransform().transformPosition2(c.createPolar(1,t))},tangentAtAngle:function(t){var e=this.getUnitTransform().transformNormal2(c.createPolar(1,t));return this._anticlockwise?e.perpendicular():e.perpendicular().negated()},offsetTo:function(t,e){for(var i=[],n=[],s=0;s<32;s++){var a=s/31;e&&(a=1-a);var o=this.angleAt(a);i.push(this.positionAtAngle(o).plus(this.tangentAtAngle(o).perpendicular().normalized().times(t))),s>0&&n.push(new r.Line(i[s-1],i[s]))}return n},getSVGPathFragment:function(){if(!this._svgPathFragment){var t,e=this._anticlockwise?"0":"1",i=m(this._rotation);if(this.getAngleDifference()<2*Math.PI-.01)t=this.getAngleDifference()<Math.PI?"0":"1",this._svgPathFragment="A "+r.svgNumber(this._radiusX)+" "+r.svgNumber(this._radiusY)+" "+i+" "+t+" "+e+" "+r.svgNumber(this.getEnd().x)+" "+r.svgNumber(this.getEnd().y);else{var n=(this._startAngle+this._endAngle)/2,s=this.positionAtAngle(n);t="0";var a="A "+r.svgNumber(this._radiusX)+" "+r.svgNumber(this._radiusY)+" "+i+" "+t+" "+e+" "+r.svgNumber(s.x)+" "+r.svgNumber(s.y),o="A "+r.svgNumber(this._radiusX)+" "+r.svgNumber(this._radiusY)+" "+i+" "+t+" "+e+" "+r.svgNumber(this.getEnd().x)+" "+r.svgNumber(this.getEnd().y);this._svgPathFragment=a+" "+o}}return this._svgPathFragment},strokeLeft:function(t){return this.offsetTo(-t/2,!1)},strokeRight:function(t){return this.offsetTo(t/2,!0)},getInteriorExtremaTs:function(){var t=this,e=[];return _.each(this.possibleExtremaAngles,function(i){if(t.unitArcSegment.containsAngle(i)){var n=t.tAtAngle(i);n>1e-10&&n<1-1e-10&&e.push(n)}}),e.sort()},intersection:function(t){var e=this.getUnitTransform(),i=e.inverseRay2(t),n=this.getUnitArcSegment().intersection(i);return _.map(n,function(i){var n=e.transformPosition2(i.point),s=t.position.distance(n),r=e.inverseNormal2(i.normal);return new o(s,n,r,i.wind,i.t)})},windingIntersection:function(t){var e=this.getUnitTransform().inverseRay2(t);return this.getUnitArcSegment().windingIntersection(e)},writeToContext:function(t){t.ellipse?t.ellipse(this._center.x,this._center.y,this._radiusX,this._radiusY,this._rotation,this._startAngle,this._endAngle,this._anticlockwise):(this.getUnitTransform().getMatrix().canvasAppendTransform(t),t.arc(0,0,1,this._startAngle,this._endAngle,this._anticlockwise),this.getUnitTransform().getInverse().canvasAppendTransform(t))},transformed:function(t){var e=t.timesVector2(c.createPolar(this._radiusX,this._rotation)).minus(t.timesVector2(c.ZERO)),i=t.timesVector2(c.createPolar(this._radiusY,this._rotation+Math.PI/2)).minus(t.timesVector2(c.ZERO)),n=e.angle(),s=e.magnitude(),a=i.magnitude(),o=t.getDeterminant()<0,h=o?!this._anticlockwise:this._anticlockwise,u=o?-this._startAngle:this._startAngle,l=o?-this._endAngle:this._endAngle;return Math.abs(this._endAngle-this._startAngle)===2*Math.PI&&(l=h?u-2*Math.PI:u+2*Math.PI),new r.EllipticalArc(t.timesVector2(this._center),s,a,n,u,l,h)},getSignedAreaFragment:function(){var t=this._startAngle,e=this.getActualEndAngle(),i=Math.sin(t),n=Math.sin(e),s=Math.cos(t),r=Math.cos(e);return.5*(this._radiusX*this._radiusY*(e-t)+Math.cos(this._rotation)*(this._radiusX*this._center.y*(s-r)+this._radiusY*this._center.x*(n-i))+Math.sin(this._rotation)*(this._radiusX*this._center.x*(r-s)+this._radiusY*this._center.y*(n-i)))},reversed:function(){return new r.EllipticalArc(this._center,this._radiusX,this._radiusY,this._rotation,this._endAngle,this._startAngle,!this._anticlockwise)},serialize:function(){return{type:"EllipticalArc",centerX:this._center.x,centerY:this._center.y,radiusX:this._radiusX,radiusY:this._radiusY,rotation:this._rotation,startAngle:this._startAngle,endAngle:this._endAngle,anticlockwise:this._anticlockwise}}}),e.deserialize=function(t){return new e(new c(t.centerX,t.centerY),t.radiusX,t.radiusY,t.rotation,t.startAngle,t.endAngle,t.anticlockwise)},e.getOverlaps=function(t,e){return t._center.distance(e._center)>1e-8?[]:Math.abs(t._radiusX-e._radiusX)>1e-8||Math.abs(t._radiusY-e._radiusY)>1e-8||Math.abs(l.moduloBetweenDown(t._rotation-e._rotation+Math.PI/2,0,Math.PI)-Math.PI/2)>1e-10?[]:i.getAngularOverlaps(t._startAngle+t._rotation,t.getActualEndAngle()+t._rotation,e._startAngle+e._rotation,e.getActualEndAngle()+e._rotation)},e.computeUnitTransform=function(t,e,i,n){return new u(a.translation(t.x,t.y).timesMatrix(a.rotation2(n)).timesMatrix(a.scaling(e,i)))},e}),i("KITE/util/LineStyles",["require","KITE/segments/Arc","PHET_CORE/inherit","KITE/kite","KITE/segments/Line","DOT/Util"],function(t){"use strict";function e(t){t=_.extend({},o,t),this.lineWidth=t.lineWidth,this.lineCap=t.lineCap,this.lineJoin=t.lineJoin,this.lineDash=t.lineDash,this.lineDashOffset=t.lineDashOffset,this.miterLimit=t.miterLimit}var i=t("KITE/segments/Arc"),n=t("PHET_CORE/inherit"),s=t("KITE/kite"),r=t("KITE/segments/Line"),a=t("DOT/Util").lineLineIntersection,o={lineWidth:1,lineCap:"butt",lineJoin:"miter",lineDash:[],lineDashOffset:0,miterLimit:10};return s.register("LineStyles",e),n(Object,e,{equals:function(t){if(!(this.lineWidth===t.lineWidth&&this.lineCap===t.lineCap&&this.lineJoin===t.lineJoin&&this.miterLimit===t.miterLimit&&this.lineDashOffset===t.lineDashOffset))return!1;if(this.lineDash.length!==t.lineDash.length)return!1;for(var e=0;e<this.lineDash.length;e++)if(this.lineDash[e]!==t.lineDash[e])return!1;return!0},leftJoin:function(t,e,n){e=e.normalized(),n=n.normalized();var s=t.plus(e.perpendicular().negated().times(this.lineWidth/2)),o=t.plus(n.perpendicular().negated().times(this.lineWidth/2)),h=s.equals(o)?[]:[new r(s,o)];if(!(e.perpendicular().dot(n)>0))return h;switch(this.lineJoin){case"round":var u=e.angle()+Math.PI/2,l=n.angle()+Math.PI/2;return[new i(t,this.lineWidth/2,u,l,!0)];case"miter":var c=e.angleBetween(n.negated());if(1/Math.sin(c/2)<=this.miterLimit&&c<Math.PI-1e-5){var m=a(s,s.plus(e),o,o.plus(n));return[new r(s,m),new r(m,o)]}return h;case"bevel":return h;default:throw new Error("invalid lineJoin: "+this.lineJoin)}},rightJoin:function(t,e,i){return this.leftJoin(t,i.negated(),e.negated())},cap:function(t,e){e=e.normalized();var n=t.plus(e.perpendicular().times(-this.lineWidth/2)),s=t.plus(e.perpendicular().times(this.lineWidth/2));switch(this.lineCap){case"butt":return[new r(n,s)];case"round":var a=e.angle();return[new i(t,this.lineWidth/2,a+Math.PI/2,a-Math.PI/2,!0)];case"square":var o=e.perpendicular().negated().times(this.lineWidth/2),h=e.perpendicular().times(this.lineWidth/2),u=e.times(this.lineWidth/2),l=t.plus(o).plus(u),c=t.plus(h).plus(u);return[new r(n,l),new r(l,c),new r(c,s)];default:throw new Error("invalid lineCap: "+this.lineCap)}}}),e.DEFAULT_OPTIONS=o,s.LineStyles}),i("KITE/util/Subpath",["require","KITE/segments/Arc","DOT/Bounds2","AXON/Events","PHET_CORE/inherit","KITE/kite","KITE/segments/Line","KITE/util/LineStyles","KITE/segments/Segment","DOT/Vector2"],function(t){"use strict";function e(t,e,i){s.call(this);var n=this;if(this.segments=[],this.points=e||(t&&t.length?_.map(t,function(t){return t.start}).concat(t[t.length-1].end):[]),this.closed=!!i,this._strokedSubpaths=null,this._strokedSubpathsComputed=!1,this._strokedStyles=null,this._bounds=null,this._invalidateListener=this.invalidate.bind(this),this._invalidatingPoints=!1,t)for(var r=0;r<t.length;r++)_.each(t[r].getNondegenerateSegments(),function(t){n.addSegmentDirectly(t)})}var i=t("KITE/segments/Arc"),n=t("DOT/Bounds2"),s=t("AXON/Events"),r=t("PHET_CORE/inherit"),a=t("KITE/kite"),o=t("KITE/segments/Line"),h=t("KITE/util/LineStyles"),u=t("KITE/segments/Segment"),l=t("DOT/Vector2");return a.register("Subpath",e),r(s,e,{getBounds:function(){if(null===this._bounds){var t=n.NOTHING.copy();_.each(this.segments,function(e){t.includeBounds(e.getBounds())}),this._bounds=t}return this._bounds},get bounds(){return this.getBounds()},getArcLength:function(t,e,i){for(var n=0,s=0;s<this.segments.length;s++)n+=this.segments[s].getArcLength(t,e,i);return n},copy:function(){return new e(this.segments.slice(0),this.points.slice(0),this.closed)},invalidatePoints:function(){this._invalidatingPoints=!0;for(var t=this.segments.length,e=0;e<t;e++)this.segments[e].invalidate();this._invalidatingPoints=!1,this.invalidate()},invalidate:function(){this._invalidatingPoints||(this._bounds=null,this._strokedSubpathsComputed=!1,this.trigger0("invalidated"))},addPoint:function(t){return this.points.push(t),this},addSegmentDirectly:function(t){return this.segments.push(t),t.onStatic("invalidated",this._invalidateListener),this},addSegment:function(t){for(var e=t.getNondegenerateSegments().length,i=0;i<e;i++)this.addSegmentDirectly(t);return this.invalidate(),this},addClosingSegment:function(){if(this.hasClosingSegment()){var t=this.getClosingSegment();this.addSegmentDirectly(t),this.invalidate(),this.addPoint(this.getFirstPoint()),this.closed=!0}},close:function(){this.closed=!0,this.addClosingSegment()},getLength:function(){return this.points.length},getFirstPoint:function(){return _.first(this.points)},getLastPoint:function(){return _.last(this.points)},getFirstSegment:function(){return _.first(this.segments)},getLastSegment:function(){return _.last(this.segments)},getFillSegments:function(){var t=this.segments.slice();return this.hasClosingSegment()&&t.push(this.getClosingSegment()),t},isDrawable:function(){return this.segments.length>0},isClosed:function(){return this.closed},hasClosingSegment:function(){return!this.getFirstPoint().equalsEpsilon(this.getLastPoint(),1e-9)},getClosingSegment:function(){return new o(this.getLastPoint(),this.getFirstPoint())},writeToContext:function(t){if(this.isDrawable()){var e=this.getFirstSegment().start;t.moveTo(e.x,e.y);for(var i=this.segments.length,n=0;n<i;n++)this.segments[n].writeToContext(t);this.closed&&t.closePath()}},toPiecewiseLinear:function(t){return new e(_.flatten(_.map(this.segments,function(e){return e.toPiecewiseLinearSegments(t)})),null,this.closed)},transformed:function(t){return new e(_.map(this.segments,function(e){return e.transformed(t)}),_.map(this.points,function(e){return t.timesVector2(e)}),this.closed)},nonlinearTransformed:function(t){return new e(_.flatten(_.map(this.segments,function(e){return t.methodName&&e[t.methodName]?e[t.methodName](t):e.toPiecewiseLinearSegments(t)})),null,this.closed)},getBoundsWithTransform:function(t){for(var e=n.NOTHING.copy(),i=this.segments.length,s=0;s<i;s++)e.includeBounds(this.segments[s].getBoundsWithTransform(t));return e},offset:function(t){if(!this.isDrawable())return new e([],null,this.closed);if(0===t)return new e(this.segments.slice(),null,this.closed);var n,s=this.segments.slice(),r=[];for(n=0;n<s.length;n++)r.push(s[n].strokeLeft(2*t));var a=[];for(n=0;n<s.length;n++){if(this.closed||n>0){var o=(n>0?n:s.length)-1,h=s[n].start,u=s[o].endTangent,l=s[n].startTangent,c=u.perpendicular().negated().times(t).angle(),m=l.perpendicular().negated().times(t).angle(),d=u.perpendicular().dot(l)>0;a.push(new i(h,Math.abs(t),c,m,d))}a=a.concat(r[n])}return new e(a,null,this.closed)},stroked:function(t){function i(t){a=a.concat(t)}function n(t){u=u.concat(t)}if(!this.isDrawable())return[];if(void 0===t&&(t=new h),this._strokedSubpathsComputed&&this._strokedStyles.equals(t))return this._strokedSubpaths;var s,r=t.lineWidth,a=[],u=[],l=this.getFirstSegment(),c=this.getLastSegment(),m=c.end.equals(l.start),d=m?null:new o(this.segments[this.segments.length-1].end,this.segments[0].start);for(s=0;s<this.segments.length;s++)s>0&&i(t.leftJoin(this.segments[s].start,this.segments[s-1].endTangent,this.segments[s].startTangent)),i(this.segments[s].strokeLeft(r));for(s=this.segments.length-1;s>=0;s--)s<this.segments.length-1&&n(t.rightJoin(this.segments[s].end,this.segments[s].endTangent,this.segments[s+1].startTangent)),n(this.segments[s].strokeRight(r));var f;return this.closed?(m?(i(t.leftJoin(c.end,c.endTangent,l.startTangent)),n(t.rightJoin(c.end,c.endTangent,l.startTangent))):(i(t.leftJoin(d.start,c.endTangent,d.startTangent)),i(d.strokeLeft(r)),i(t.leftJoin(d.end,d.endTangent,l.startTangent)),n(t.rightJoin(d.end,d.endTangent,l.startTangent)),n(d.strokeRight(r)),n(t.rightJoin(d.start,c.endTangent,d.startTangent))),f=[new e(a,null,!0),new e(u,null,!0)]):f=[new e(a.concat(t.cap(c.end,c.endTangent)).concat(u).concat(t.cap(l.start,l.startTangent.negated())),null,!0)],this._strokedSubpaths=f,this._strokedSubpathsComputed=!0,this._strokedStyles=new h(t),f},dashed:function(t,i,n,s){function r(t,e){var i=t[t.length-1].concat(e[0]),n=t.slice(0,t.length-1).concat([i]).concat(e.slice(1));return n}function a(t,e){if(!t.hasRightFilled||!e.hasLeftFilled)return!1;var i=_.last(_.last(t.segmentArrays)),n=e.segmentArrays[0][0];return i.end.distance(n.start)<1e-5}for(var o=[],h=0;h<this.segments.length;h++){var u=this.segments[h],l=u.getDashValues(t,i,n,s);o.push(l),i+=l.arcLength;var c=[0].concat(l.values).concat([1]),m=l.initiallyInside;l.hasLeftFilled=m,l.hasRightFilled=c.length%2==0?m:!m,l.segmentArrays=[];for(var d=m?0:1;d<c.length-1;d+=2)c[d]!==c[d+1]&&l.segmentArrays.push([u.slice(c[d],c[d+1])])}for(h=o.length-1;h>=1;h--){var f=o[h-1],g=o[h];a(f,g)&&o.splice(h-1,2,{segmentArrays:r(f.segmentArrays,g.segmentArrays),hasLeftFilled:f.hasLeftFilled,hasRightFilled:g.hasRightFilled})}return o.length>1&&a(o[o.length-1],o[0])&&(f=o.pop(),g=o.shift(),o.push({segmentArrays:r(f.segmentArrays,g.segmentArrays),hasLeftFilled:f.hasLeftFilled,hasRightFilled:g.hasRightFilled})),this.closed&&1===o.length&&1===o[0].segmentArrays.length&&o[0].hasLeftFilled&&o[0].hasRightFilled?[new e(o[0].segmentArrays[0],null,!0)]:_.flatten(o.map(function(t){return t.segmentArrays})).map(function(t){return new e(t)})},serialize:function(){return{type:"Subpath",segments:this.segments.map(function(t){return t.serialize()}),points:this.points.map(function(t){return{x:t.x,y:t.y}}),closed:this.closed}}}),e.deserialize=function(t){return new e(t.segments.map(u.deserialize),t.points.map(function(t){return new l(t.x,t.y)}),t.closed)},e}),i("KITE/ops/Boundary",["require","DOT/Bounds2","PHET_CORE/cleanArray","PHET_CORE/inherit","KITE/kite","PHET_CORE/Poolable","DOT/Ray2","KITE/util/Subpath","DOT/Vector2"],function(t){"use strict";function e(t){this.id=++l,this.initialize(t)}var i=t("DOT/Bounds2"),n=t("PHET_CORE/cleanArray"),s=t("PHET_CORE/inherit"),r=t("KITE/kite"),a=t("PHET_CORE/Poolable"),o=t("DOT/Ray2"),h=t("KITE/util/Subpath"),u=t("DOT/Vector2"),l=0;return r.register("Boundary",e),s(Object,e,{initialize:function(t){return this.halfEdges=t,this.signedArea=this.computeSignedArea(),this.bounds=this.computeBounds(),this.childBoundaries=n(this.childBoundaries),this},dispose:function(){this.halfEdges=[],n(this.childBoundaries),this.freeToPool()},isInner:function(){return this.signedArea>0},computeSignedArea:function(){for(var t=0,e=0;e<this.halfEdges.length;e++)t+=this.halfEdges[e].signedAreaFragment;return t},computeBounds:function(){for(var t=i.NOTHING.copy(),e=0;e<this.halfEdges.length;e++)t.includeBounds(this.halfEdges[e].edge.segment.getBounds());return t},computeExtremePoint:function(t){for(var e=[],n=0;n<this.halfEdges.length;n++)e.push(this.halfEdges[n].edge.segment.transformed(t.getMatrix()));var s=i.NOTHING.copy();for(n=0;n<e.length;n++)s.includeBounds(e[n].getBounds());for(n=0;n<e.length;n++){var r=e[n];if(r.getBounds().top===s.top){for(var a=new u(0,Number.POSITIVE_INFINITY),o=[0,1].concat(r.getInteriorExtremaTs()),h=0;h<o.length;h++){var l=r.positionAt(o[h]);l.y<a.y&&(a=l)}return t.inversePosition2(a)}}throw new Error("Should not reach here if we have segments")},computeExtremeRay:function(t){var e=this.computeExtremePoint(t),i=t.inverseDelta2(new u(0,-1)).normalized();return new o(e.plus(i.timesScalar(1e-4)),i)},hasHalfEdge:function(t){for(var e=0;e<this.halfEdges.length;e++)if(this.halfEdges[e]===t)return!0;return!1},toSubpath:function(){for(var t=[],e=0;e<this.halfEdges.length;e++)t.push(this.halfEdges[e].getDirectionalSegment());return new h(t,null,!0)}}),a.mixInto(e,{initialize:e.prototype.initialize}),r.Boundary}),i("KITE/ops/HalfEdge",["require","PHET_CORE/inherit","KITE/kite","PHET_CORE/Poolable","DOT/Vector2"],function(t){"use strict";function e(t,e){this.initialize(t,e)}var i=t("PHET_CORE/inherit"),n=t("KITE/kite"),s=t("PHET_CORE/Poolable"),r=t("DOT/Vector2");return n.register("HalfEdge",e),i(Object,e,{initialize:function(t,e){return this.edge=t,this.face=null,this.isReversed=e,this.signedAreaFragment=t.signedAreaFragment*(e?-1:1),this.startVertex=null,this.endVertex=null,this.sortVector=this.sortVector||new r(0,0),this.updateReferences(),this},dispose:function(){this.edge=null,this.face=null,this.startVertex=null,this.endVertex=null,this.freeToPool()},getNext:function(t){for(var e=1;;e++){var i=this.endVertex.incidentHalfEdges.indexOf(this)-e;i<0&&(i+=this.endVertex.incidentHalfEdges.length);var n=this.endVertex.incidentHalfEdges[i].getReversed();if(!t||t(n.edge))return n}},updateReferences:function(){this.startVertex=this.isReversed?this.edge.endVertex:this.edge.startVertex,this.endVertex=this.isReversed?this.edge.startVertex:this.edge.endVertex},getEndTangent:function(){return this.isReversed?this.edge.segment.startTangent:this.edge.segment.endTangent.negated()},getEndCurvature:function(){return this.isReversed?-this.edge.segment.curvatureAt(0):this.edge.segment.curvatureAt(1)},getReversed:function(){return this.isReversed?this.edge.forwardHalf:this.edge.reversedHalf},getDirectionalSegment:function(){return this.isReversed?this.edge.segment.reversed():this.edge.segment}}),s.mixInto(e,{initialize:e.prototype.initialize}),n.HalfEdge}),i("KITE/ops/Vertex",["require","PHET_CORE/cleanArray","PHET_CORE/inherit","KITE/kite","PHET_CORE/Poolable","DOT/Vector2"],function(t){"use strict";function e(t){this.id=++o,this.initialize(t)}var i=t("PHET_CORE/cleanArray"),n=t("PHET_CORE/inherit"),s=t("KITE/kite"),r=t("PHET_CORE/Poolable"),a=t("DOT/Vector2"),o=0;return s.register("Vertex",e),n(Object,e,{initialize:function(t){return this.point=t,this.incidentHalfEdges=i(this.incidentHalfEdges),this.visited=!1,this.visitIndex=0,this.lowIndex=0,this},dispose:function(){this.point=a.ZERO,i(this.incidentHalfEdges),this.freeToPool()},sortEdges:function(){for(var t=[],i=0;i<this.incidentHalfEdges.length;i++){var n=this.incidentHalfEdges[i];t.push(n.sortVector.setXY(n.getEndTangent().angle(),n.getEndCurvature()))}for(var s=1e-4-Math.PI,r=!1;!r;){for(r=!0,i=0;i<t.length;i++)t[i].x<s&&(r=!1);if(!r)for(i=0;i<t.length;i++){var a=t[i];a.x-=1.62594024516,a.x<-Math.PI-1e-4&&(a.x+=2*Math.PI)}}this.incidentHalfEdges.sort(e.edgeComparison)}},{edgeComparison:function(t,e){var i=t.sortVector.x,n=e.sortVector.x;if(Math.abs(i-n)>1e-4)return i<n?-1:1;var s=t.sortVector.y,r=e.sortVector.y;if(Math.abs(s-r)>1e-4)return s<r?1:-1;throw new Error("TODO: Need to implement more advanced disambiguation ")}}),r.mixInto(e,{initialize:e.prototype.initialize}),s.Vertex}),i("KITE/ops/Edge",["require","KITE/ops/HalfEdge","PHET_CORE/inherit","KITE/kite","KITE/segments/Line","PHET_CORE/Poolable","KITE/segments/Segment","KITE/ops/Vertex"],function(t){"use strict";function e(t,e,i){this.id=++a,this.initialize(t,e,i)}var i=t("KITE/ops/HalfEdge"),n=t("PHET_CORE/inherit"),s=t("KITE/kite"),r=(t("KITE/segments/Line"),t("PHET_CORE/Poolable")),a=(t("KITE/segments/Segment"),t("KITE/ops/Vertex"),0);return s.register("Edge",e),n(Object,e,{initialize:function(t,e,n){return this.segment=t,this.startVertex=e,this.endVertex=n,this.signedAreaFragment=t.getSignedAreaFragment(),this.forwardHalf=i.createFromPool(this,!1),this.reversedHalf=i.createFromPool(this,!0),this.visited=!1,this},dispose:function(){this.segment=null,this.startVertex=null,this.endVertex=null,this.forwardHalf.dispose(),this.reversedHalf.dispose(),this.forwardHalf=null,this.reversedHalf=null,this.freeToPool()},getOtherVertex:function(t){return this.startVertex===t?this.endVertex:this.startVertex},updateReferences:function(){this.forwardHalf.updateReferences(),this.reversedHalf.updateReferences()}}),r.mixInto(e,{initialize:e.prototype.initialize}),s.Edge}),i("KITE/ops/Face",["require","PHET_CORE/cleanArray","PHET_CORE/inherit","KITE/kite","PHET_CORE/Poolable"],function(t){"use strict";function e(t){this.id=++a,this.initialize(t)}var i=t("PHET_CORE/cleanArray"),n=t("PHET_CORE/inherit"),s=t("KITE/kite"),r=t("PHET_CORE/Poolable"),a=0;return s.register("Face",e),n(Object,e,{initialize:function(t){return this.boundary=t,this.holes=i(this.holes),this.windingMap=null,this.filled=null,t&&this.addBoundaryFaceReferences(t),this},dispose:function(){this.boundary=null,i(this.holes),this.windingMap=null,this.filled=null,this.freeToPool()},addBoundaryFaceReferences:function(t){for(var e=0;e<t.halfEdges.length;e++)t.halfEdges[e].face=this},recursivelyAddHoles:function(t){this.holes.push(t),this.addBoundaryFaceReferences(t);for(var e=0;e<t.childBoundaries.length;e++)this.recursivelyAddHoles(t.childBoundaries[e])}}),r.mixInto(e,{initialize:e.prototype.initialize}),s.Face}),i("KITE/ops/Loop",["require","PHET_CORE/cleanArray","PHET_CORE/inherit","KITE/kite","PHET_CORE/Poolable"],function(t){"use strict";function e(t){this.id=++a,this.initialize(t)}var i=t("PHET_CORE/cleanArray"),n=t("PHET_CORE/inherit"),s=t("KITE/kite"),r=t("PHET_CORE/Poolable"),a=0;return s.register("Loop",e),n(Object,e,{initialize:function(t){return this.shapeId=t,this.halfEdges=i(this.halfEdges),this},dispose:function(){i(this.halfEdges),this.freeToPool()}}),r.mixInto(e,{initialize:e.prototype.initialize}),s.Loop}),i("KITE/ops/Graph",["require","KITE/segments/Arc","PHET_CORE/arrayRemove","KITE/ops/Boundary","PHET_CORE/cleanArray","KITE/segments/Cubic","KITE/ops/Edge","KITE/segments/EllipticalArc","KITE/ops/Face","PHET_CORE/inherit","KITE/kite","KITE/segments/Line","KITE/ops/Loop","DOT/Matrix3","KITE/segments/Quadratic","KITE/segments/Segment","KITE/util/Subpath","DOT/Transform3","DOT/Util","KITE/ops/Vertex"],function(t){"use strict";function e(){this.vertices=[],this.edges=[],this.innerBoundaries=[],this.outerBoundaries=[],this.boundaries=[],this.shapeIds=[],this.loops=[],this.unboundedFace=u.createFromPool(null),this.faces=[this.unboundedFace]}var i=t("KITE/segments/Arc"),n=t("PHET_CORE/arrayRemove"),s=t("KITE/ops/Boundary"),r=t("PHET_CORE/cleanArray"),a=t("KITE/segments/Cubic"),o=t("KITE/ops/Edge"),h=t("KITE/segments/EllipticalArc"),u=t("KITE/ops/Face"),l=t("PHET_CORE/inherit"),c=t("KITE/kite"),m=t("KITE/segments/Line"),d=t("KITE/ops/Loop"),f=t("DOT/Matrix3"),g=t("KITE/segments/Quadratic"),p=t("KITE/segments/Segment"),v=(t("KITE/util/Subpath"),t("DOT/Transform3")),x=t("DOT/Util"),T=t("KITE/ops/Vertex"),y=0;return c.register("Graph",e),l(Object,e,{addShape:function(t,e){for(var i=0;i<e.subpaths.length;i++)this.addSubpath(t,e.subpaths[i])},addSubpath:function(t,e){if(this.shapeIds.indexOf(t)<0&&this.shapeIds.push(t),0!==e.segments.length){var i,n=e.getFillSegments(),s=[];for(i=0;i<n.length;i++){var r=i-1;r<0&&(r=n.length-1);var a=n[r].end,h=n[i].start;h.equals(a)?s.push(T.createFromPool(h)):s.push(T.createFromPool(h.average(a)))}var u=d.createFromPool(t);for(i=0;i<n.length;i++){var l=i+1;l===n.length&&(l=0);var c=o.createFromPool(n[i],s[i],s[l]);u.halfEdges.push(c.forwardHalf),this.addEdge(c)}this.loops.push(u),this.vertices.push.apply(this.vertices,s)}},computeSimplifiedFaces:function(){this.eliminateOverlap(),this.eliminateSelfIntersection(),this.eliminateIntersection(),this.collapseVertices(),this.removeBridges(),this.removeLowOrderVertices(),this.orderVertexEdges(),this.extractFaces(),this.computeBoundaryTree(),this.computeWindingMap()},computeFaceInclusion:function(t){for(var e=0;e<this.faces.length;e++){var i=this.faces[e];i.filled=t(i.windingMap)}},createFilledSubGraph:function(){for(var t=new e,i={},n=0;n<this.edges.length;n++){var s=this.edges[n];if(s.forwardHalf.face.filled!==s.reversedHalf.face.filled){if(!i[s.startVertex.id]){var r=T.createFromPool(s.startVertex.point);t.vertices.push(r),i[s.startVertex.id]=r}if(!i[s.endVertex.id]){var a=T.createFromPool(s.endVertex.point);t.vertices.push(a),i[s.endVertex.id]=a}var h=i[s.startVertex.id],u=i[s.endVertex.id];t.addEdge(o.createFromPool(s.segment,h,u))}}return t.collapseAdjacentEdges(),t.orderVertexEdges(),t.extractFaces(),t.computeBoundaryTree(),t.fillAlternatingFaces(),t},facesToShape:function(){for(var t=[],e=0;e<this.faces.length;e++){var i=this.faces[e];if(i.filled){t.push(i.boundary.toSubpath());for(var n=0;n<i.holes.length;n++)t.push(i.holes[n].toSubpath())}}return new c.Shape(t)},dispose:function(){for(;this.boundaries.length;)this.boundaries.pop().dispose();for(r(this.innerBoundaries),r(this.outerBoundaries);this.loops.length;)this.loops.pop().dispose();for(;this.faces.length;)this.faces.pop().dispose();for(;this.vertices.length;)this.vertices.pop().dispose();for(;this.edges.length;)this.edges.pop().dispose()},addEdge:function(t){this.edges.push(t),t.startVertex.incidentHalfEdges.push(t.reversedHalf),t.endVertex.incidentHalfEdges.push(t.forwardHalf)},removeEdge:function(t){n(this.edges,t),n(t.startVertex.incidentHalfEdges,t.reversedHalf),n(t.endVertex.incidentHalfEdges,t.forwardHalf)},replaceEdgeInLoops:function(t,e){for(var i=[],n=0;n<e.length;n++)i.push(e[e.length-1-n].getReversed());for(n=0;n<this.loops.length;n++)for(var s=this.loops[n],r=s.halfEdges.length-1;r>=0;r--){var a=s.halfEdges[r];if(a.edge===t){var o=a===t.forwardHalf?e:i;Array.prototype.splice.apply(s.halfEdges,[r,1].concat(o))}}},collapseAdjacentEdges:function(){for(var t=!0;t;){t=!1;t:for(var e=0;e<this.vertices.length;e++){var i=this.vertices[e];if(2===i.incidentHalfEdges.length){var s=i.incidentHalfEdges[0].edge,r=i.incidentHalfEdges[1].edge,a=s.segment,h=r.segment,u=s.getOtherVertex(i),l=r.getOtherVertex(i);if(s.startVertex===i&&(a=a.reversed()),r.endVertex===i&&(h=h.reversed()),a instanceof m&&h instanceof m&&a.tangentAt(0).normalized().distance(h.tangentAt(0).normalized())<1e-6){this.removeEdge(s),this.removeEdge(r),s.dispose(),r.dispose(),n(this.vertices,i),i.dispose();var c=new m(u.point,l.point);this.addEdge(new o(c,u,l)),t=!0;break t}}}}},eliminateOverlap:function(){for(var t=!0;t;){t=!1;t:for(var e=0;e<this.edges.length;e++)for(var n=this.edges[e],s=n.segment,r=e+1;r<this.edges.length;r++){var o=this.edges[r],u=o.segment,l=null;if(s instanceof m&&u instanceof m&&(l=m.getOverlaps),s instanceof g&&u instanceof g&&(l=g.getOverlaps),s instanceof a&&u instanceof a&&(l=a.getOverlaps),s instanceof i&&u instanceof i&&(l=i.getOverlaps),s instanceof h&&u instanceof h&&(l=h.getOverlaps),l){var c=l(s,u);if(c.length)for(var d=0;d<c.length;d++){var f=c[d];if(Math.abs(f.t1-f.t0)>1e-5&&Math.abs(f.qt1-f.qt0)>1e-5){this.splitOverlap(n,o,f),t=!0;break t}}}}}},splitOverlap:function(t,e,i){var n=t.segment,s=e.segment;this.removeEdge(t),this.removeEdge(e);var r=i.t0,a=i.t1,h=i.qt0,u=i.qt1;r<1e-5&&(r=0),a>.99999&&(a=1),h<1e-5&&(h=0),u>.99999&&(u=1);var l=r>0?n.subdivided(r)[0]:null,c=h>0?s.subdivided(h)[0]:null,m=a<1?n.subdivided(a)[1]:null,d=u<1?s.subdivided(u)[1]:null,f=n;r>0&&(f=f.subdivided(r)[1]),a<1&&(f=f.subdivided(x.linear(r,1,0,1,a))[0]);var g;l&&c?(g=T.createFromPool(f.start),this.vertices.push(g)):g=l?i.a>0?e.startVertex:e.endVertex:t.startVertex;var p;m&&d?(p=T.createFromPool(f.end),this.vertices.push(p)):p=m?i.a>0?e.endVertex:e.startVertex:t.endVertex;var v=o.createFromPool(f,g,p);this.addEdge(v);var y,_,E,w;l&&(y=o.createFromPool(l,t.startVertex,g),this.addEdge(y)),m&&(_=o.createFromPool(m,p,t.endVertex),this.addEdge(_)),c&&(E=o.createFromPool(c,e.startVertex,i.a>0?g:p),this.addEdge(E)),d&&(w=o.createFromPool(d,i.a>0?p:g,e.endVertex),this.addEdge(w));for(var O=(l?[y]:[]).concat([v]).concat(m?[_]:[]),b=(c?[E]:[]).concat([v]).concat(d?[w]:[]),I=[],A=[],M=0;M<O.length;M++)I.push(O[M].forwardHalf);for(M=0;M<b.length;M++){var P=b[M]!==v||i.a>0;A.push(P?b[M].forwardHalf:b[M].reversedHalf)}this.replaceEdgeInLoops(t,I),this.replaceEdgeInLoops(e,A),t.dispose(),e.dispose()},eliminateSelfIntersection:function(){for(var t=this.edges.length-1;t>=0;t--){var e=this.edges[t],i=e.segment;if(i instanceof a){var n=i.getSelfIntersection();if(n){var s=i.subdivisions([n.aT,n.bT]),r=T.createFromPool(n.point);this.vertices.push(r);var h=o.createFromPool(s[0],e.startVertex,r),u=o.createFromPool(s[1],r,r),l=o.createFromPool(s[2],r,e.endVertex);this.removeEdge(e),this.addEdge(h),this.addEdge(u),this.addEdge(l),this.replaceEdgeInLoops(e,[h.forwardHalf,u.forwardHalf,l.forwardHalf]),e.dispose()}}}},eliminateIntersection:function(){for(var t=!0;t;){t=!1;t:for(var e=0;e<this.edges.length;e++)for(var i=this.edges[e],n=i.segment,s=e+1;s<this.edges.length;s++){var r=this.edges[s],a=r.segment,o=p.intersect(n,a);if((o=o.filter(function(t){var e=t.aT,i=t.bT;return e>1e-5&&e<.99999||i>1e-5&&i<.99999})).length){var h=o[0];t=this.simpleSplit(i,r,h.aT,h.bT,h.point);break t}}}},simpleSplit:function(t,e,i,n,s){var r=!1,a=i>1e-5&&i<.99999,o=n>1e-5&&n<.99999,h=null;return a?o?(h=T.createFromPool(s),this.vertices.push(h)):h=n<.5?e.startVertex:e.endVertex:h=i<.5?t.startVertex:t.endVertex,a&&h!==t.startVertex&&h!==t.endVertex&&(this.splitEdge(t,i,h),r=!0),o&&h!==e.startVertex&&h!==e.endVertex&&(this.splitEdge(e,n,h),r=!0),r},splitEdge:function(t,e,i){var n=t.segment.subdivided(e),s=o.createFromPool(n[0],t.startVertex,i),r=o.createFromPool(n[1],i,t.endVertex);this.removeEdge(t),this.addEdge(s),this.addEdge(r),this.replaceEdgeInLoops(t,[s.forwardHalf,r.forwardHalf]),t.dispose()},collapseVertices:function(){for(var t=!0;t;){t=!1;t:for(var e=0;e<this.vertices.length;e++)for(var s=this.vertices[e],r=e+1;r<this.vertices.length;r++){var u=this.vertices[r],l=s.point.distance(u.point);if(l<1e-5){var c=T.createFromPool(0===l?s.point:s.point.average(u.point));this.vertices.push(c),n(this.vertices,s),n(this.vertices,u);for(var m=this.edges.length-1;m>=0;m--){var d=this.edges[m],f=d.startVertex===s||d.startVertex===u,g=d.endVertex===s||d.endVertex===u;if(f&&g){if((d.segment.bounds.width>1e-5||d.segment.bounds.height>1e-5)&&(d.segment instanceof a||d.segment instanceof i||d.segment instanceof h)){var p=o.createFromPool(d.segment,c,c);this.addEdge(p),this.replaceEdgeInLoops(d,[p.forwardHalf])}else this.replaceEdgeInLoops(d,[]);this.removeEdge(d),d.dispose()}else f?(d.startVertex=c,c.incidentHalfEdges.push(d.reversedHalf),d.updateReferences()):g&&(d.endVertex=c,c.incidentHalfEdges.push(d.forwardHalf),d.updateReferences())}s.dispose(),u.dispose(),t=!0;break t}}}},markBridges:function(t,e){e.visited=!0,e.visitIndex=e.lowIndex=y++;for(var i=0;i<e.incidentHalfEdges.length;i++){var n=e.incidentHalfEdges[i].edge,s=e.incidentHalfEdges[i].startVertex;s.visited?n.visited||(e.lowIndex=Math.min(e.lowIndex,s.visitIndex)):(n.visited=!0,s.parent=e,this.markBridges(t,s),e.lowIndex=Math.min(e.lowIndex,s.lowIndex),s.lowIndex>e.visitIndex&&t.push(n))}},removeBridges:function(){for(var t=[],e=0;e<this.vertices.length;e++){var i=this.vertices[e];i.visited||this.markBridges(t,i)}for(e=0;e<t.length;e++){var n=t[e];this.removeEdge(n),this.replaceEdgeInLoops(n,[]),n.dispose()}},removeLowOrderVertices:function(){for(var t=!0;t;){t=!1;t:for(var e=this.vertices.length-1;e>=0;e--){var i=this.vertices[e];if(i.incidentHalfEdges.length<2){for(var n=0;n<i.incidentHalfEdges.length;n++){var s=i.incidentHalfEdges[n].edge;this.removeEdge(s),this.replaceEdgeInLoops(s,[]),s.dispose()}this.vertices.splice(e,1),i.dispose(),t=!0;break t}}}},orderVertexEdges:function(){for(var t=0;t<this.vertices.length;t++)this.vertices[t].sortEdges()},extractFaces:function(){for(var t=[],e=0;e<this.edges.length;e++)t.push(this.edges[e].forwardHalf),t.push(this.edges[e].reversedHalf);for(;t.length;){for(var i=[],r=t[0],a=r;r&&(n(t,r),i.push(r),(r=r.getNext())!==a););var o=s.createFromPool(i);(o.signedArea>0?this.innerBoundaries:this.outerBoundaries).push(o),this.boundaries.push(o)}for(e=0;e<this.innerBoundaries.length;e++)this.faces.push(u.createFromPool(this.innerBoundaries[e]))},computeBoundaryTree:function(){for(var t=[],e=new v(f.rotation2(1.5729657)),i=0;i<this.outerBoundaries.length;i++){for(var n=this.outerBoundaries[i],s=n.computeExtremeRay(e),r=null,a=Number.POSITIVE_INFINITY,o=!1,h=0;h<this.edges.length;h++)for(var u=this.edges[h],l=u.segment.intersection(s),c=0;c<l.length;c++){var m=l[c];m.distance<a&&(r=u,a=m.distance,o=m.wind)}if(null===r)t.push(n);else{var d=o<0?r.reversedHalf:r.forwardHalf;this.getBoundaryOfHalfEdge(d).childBoundaries.push(n)}}for(t.forEach(this.unboundedFace.recursivelyAddHoles.bind(this.unboundedFace)),i=0;i<this.faces.length;i++){var g=this.faces[i];null!==g.boundary&&g.boundary.childBoundaries.forEach(g.recursivelyAddHoles.bind(g))}},computeWindingMap:function(){for(var t=this.edges.slice(),e={},i=0;i<this.shapeIds.length;i++)e[this.shapeIds[i]]=0;for(this.unboundedFace.windingMap=e;t.length;)for(var n=t.length-1;n>=0;n--){var s=t[n],r=s.forwardHalf,a=s.reversedHalf,o=r.face,h=a.face,u=null!==o.windingMap,l=null!==h.windingMap;if(u&&l){t.splice(n,1)}else{if(!u&&!l)continue;for(var c=u?o:h,m=u?h:o,d={},f=0;f<this.shapeIds.length;f++){var g=this.shapeIds[f],p=this.computeDifferential(s,g);d[g]=c.windingMap[g]+p*(u?-1:1)}m.windingMap=d}}},computeDifferential:function(t,e){for(var i=0,n=0;n<this.loops.length;n++){var s=this.loops[n];if(s.shapeId===e)for(var r=0;r<s.halfEdges.length;r++){var a=s.halfEdges[r];a===t.forwardHalf?i++:a===t.reversedHalf&&i--}}return i},fillAlternatingFaces:function(){for(var t=0,e=0;e<this.faces.length;e++)this.faces[e].filled=null,t++;for(this.unboundedFace.filled=!1,t--;t;)for(e=0;e<this.edges.length;e++){var i=this.edges[e],n=i.forwardHalf.face,s=i.reversedHalf.face,r=null===n.filled,a=null===s.filled;r&&!a?(n.filled=!s.filled,t--):!r&&a&&(s.filled=!n.filled,t--)}},getBoundaryOfHalfEdge:function(t){for(var e=0;e<this.boundaries.length;e++){var i=this.boundaries[e];if(i.hasHalfEdge(t))return i}throw new Error("Could not find boundary")}}),e.BINARY_NONZERO_UNION=function(t){return 0!==t[0]||0!==t[1]},e.BINARY_NONZERO_INTERSECTION=function(t){return 0!==t[0]&&0!==t[1]},e.BINARY_NONZERO_DIFFERENCE=function(t){return 0!==t[0]&&0===t[1]},e.BINARY_NONZERO_XOR=function(t){return 1==(0!==t[0]^0!==t[1])},e.binaryResult=function(t,i,n){var s=new e;s.addShape(0,t),s.addShape(1,i),s.computeSimplifiedFaces(),s.computeFaceInclusion(n);var r=s.createFilledSubGraph(),a=r.facesToShape();return s.dispose(),r.dispose(),a},e.unionNonZero=function(t){for(var i=new e,n=0;n<t.length;n++)i.addShape(n,t[n]);i.computeSimplifiedFaces(),i.computeFaceInclusion(function(e){for(var i=0;i<t.length;i++)if(0!==e[i])return!0;return!1});var s=i.createFilledSubGraph(),r=s.facesToShape();return i.dispose(),s.dispose(),r},e.intersectionNonZero=function(t){for(var i=new e,n=0;n<t.length;n++)i.addShape(n,t[n]);i.computeSimplifiedFaces(),i.computeFaceInclusion(function(e){for(var i=0;i<t.length;i++)if(0===e[i])return!1;return!0});var s=i.createFilledSubGraph(),r=s.facesToShape();return i.dispose(),s.dispose(),r},e.xorNonZero=function(t){for(var i=new e,n=0;n<t.length;n++)i.addShape(n,t[n]);i.computeSimplifiedFaces(),i.computeFaceInclusion(function(e){for(var i=!1,n=0;n<t.length;n++)0!==e[n]&&(i=!i);return i});var s=i.createFilledSubGraph(),r=s.facesToShape();return i.dispose(),s.dispose(),r},e.simplifyNonZero=function(t){var i=new e;i.addShape(0,t),i.computeSimplifiedFaces(),i.computeFaceInclusion(function(t){return 0!==t[0]});var n=i.createFilledSubGraph(),s=n.facesToShape();return i.dispose(),n.dispose(),s},c.Graph}),i("KITE/parser/svgPath",["require","KITE/kite"],function(t){function e(t){return'"'+t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E-\x1F\x80-\uFFFF]/g,escape)+'"'}var i=t("KITE/kite"),n={parse:function(t,i){function n(t){K<U||(K>U&&(U=K,G=[]),G.push(t))}function s(){var t,e,i,n,a;if(n=K,a=K,null!==(t=r())){for(e=[],i=k();null!==i;)e.push(i),i=k();null!==e&&null!==(i=s())?t=[t,e,i]:(t=null,K=a)}else t=null,K=a;return null!==t&&(t=function(t,e,i){return e.concat(i)}(0,t[0],t[2])),null===t&&(K=n),null===t&&(n=K,null!==(t=r())&&(t=t),null===t&&(K=n)),t}function r(){var t,e,i,n,s;if(n=K,s=K,null!==(t=h())){for(e=[],i=k();null!==i;)e.push(i),i=k();null!==e&&null!==(i=null!==(i=a())?i:"")?t=[t,e,i]:(t=null,K=s)}else t=null,K=s;return null!==t&&(t=function(t,e,i){return i.length?e.concat(i):e}(0,t[0],t[2])),null===t&&(K=n),t}function a(){var t,e,i,n,s;if(n=K,s=K,null!==(t=o())){for(e=[],i=k();null!==i;)e.push(i),i=k();null!==e&&null!==(i=a())?t=[t,e,i]:(t=null,K=s)}else t=null,K=s;return null!==t&&(t=function(t,e,i){return e.concat(i)}(0,t[0],t[2])),null===t&&(K=n),null===t&&(n=K,null!==(t=o())&&(t=t),null===t&&(K=n)),t}function o(){var t;return null===(t=l())&&null===(t=c())&&null===(t=d())&&null===(t=g())&&null===(t=v())&&null===(t=y())&&null===(t=w())&&null===(t=I())&&(t=M()),t}function h(){var e,i,s,r,a;if(r=K,a=K,77===t.charCodeAt(K)?(e="M",K++):(e=null,0===j&&n('"M"')),null!==e){for(i=[],s=k();null!==s;)i.push(s),s=k();null!==i&&null!==(s=u())?e=[e,i,s]:(e=null,K=a)}else e=null,K=a;if(null!==e&&(e=B(e[2],!1)),null===e&&(K=r),null===e){if(r=K,a=K,109===t.charCodeAt(K)?(e="m",K++):(e=null,0===j&&n('"m"')),null!==e){for(i=[],s=k();null!==s;)i.push(s),s=k();null!==i&&null!==(s=u())?e=[e,i,s]:(e=null,K=a)}else e=null,K=a;null!==e&&(e=B(e[2],!0)),null===e&&(K=r)}return e}function u(){var t,e,i,n,s;return n=K,s=K,null!==(t=C())&&null!==(e=null!==(e=X())?e:"")&&null!==(i=m())?t=[t,e,i]:(t=null,K=s),null!==t&&(t=function(t,e,i){return[e].concat(i)}(0,t[0],t[2])),null===t&&(K=n),null===t&&(n=K,null!==(t=C())&&(t=[t]),null===t&&(K=n)),t}function l(){var e,i;return i=K,90===t.charCodeAt(K)?(e="Z",K++):(e=null,0===j&&n('"Z"')),null===e&&(122===t.charCodeAt(K)?(e="z",K++):(e=null,0===j&&n('"z"'))),null!==e&&(e={cmd:"close"}),null===e&&(K=i),e}function c(){var e,i,s,r,a;if(r=K,a=K,76===t.charCodeAt(K)?(e="L",K++):(e=null,0===j&&n('"L"')),null!==e){for(i=[],s=k();null!==s;)i.push(s),s=k();null!==i&&null!==(s=m())?e=[e,i,s]:(e=null,K=a)}else e=null,K=a;if(null!==e&&(e=e[2].map(function(t){return{cmd:"lineTo",args:[t.x,t.y]}})),null===e&&(K=r),null===e){if(r=K,a=K,108===t.charCodeAt(K)?(e="l",K++):(e=null,0===j&&n('"l"')),null!==e){for(i=[],s=k();null!==s;)i.push(s),s=k();null!==i&&null!==(s=m())?e=[e,i,s]:(e=null,K=a)}else e=null,K=a;null!==e&&(e=e[2].map(function(t){return{cmd:"lineToRelative",args:[t.x,t.y]}})),null===e&&(K=r)}return e}function m(){var t,e,i,n,s;return n=K,s=K,null!==(t=C())&&null!==(e=null!==(e=X())?e:"")&&null!==(i=m())?t=[t,e,i]:(t=null,K=s),null!==t&&(t=function(t,e,i){return[e].concat(i)}(0,t[0],t[2])),null===t&&(K=n),null===t&&(n=K,null!==(t=C())&&(t=[t]),null===t&&(K=n)),t}function d(){var e,i,s,r,a;if(r=K,a=K,72===t.charCodeAt(K)?(e="H",K++):(e=null,0===j&&n('"H"')),null!==e){for(i=[],s=k();null!==s;)i.push(s),s=k();null!==i&&null!==(s=f())?e=[e,i,s]:(e=null,K=a)}else e=null,K=a;if(null!==e&&(e=e[2].map(function(t){return{cmd:"horizontalLineTo",args:[t]}})),null===e&&(K=r),null===e){if(r=K,a=K,104===t.charCodeAt(K)?(e="h",K++):(e=null,0===j&&n('"h"')),null!==e){for(i=[],s=k();null!==s;)i.push(s),s=k();null!==i&&null!==(s=f())?e=[e,i,s]:(e=null,K=a)}else e=null,K=a;null!==e&&(e=e[2].map(function(t){return{cmd:"horizontalLineToRelative",args:[t]}})),null===e&&(K=r)}return e}function f(){var t,e,i,n,s;return n=K,s=K,null!==(t=D())&&null!==(e=null!==(e=X())?e:"")&&null!==(i=f())?t=[t,e,i]:(t=null,K=s),null!==t&&(t=function(t,e,i){return[e].concat(i)}(0,t[0],t[2])),null===t&&(K=n),null===t&&(n=K,null!==(t=D())&&(t=[t]),null===t&&(K=n)),t}function g(){var e,i,s,r,a;if(r=K,a=K,86===t.charCodeAt(K)?(e="V",K++):(e=null,0===j&&n('"V"')),null!==e){for(i=[],s=k();null!==s;)i.push(s),s=k();null!==i&&null!==(s=p())?e=[e,i,s]:(e=null,K=a)}else e=null,K=a;if(null!==e&&(e=e[2].map(function(t){return{cmd:"verticalLineTo",args:[t]}})),null===e&&(K=r),null===e){if(r=K,a=K,118===t.charCodeAt(K)?(e="v",K++):(e=null,0===j&&n('"v"')),null!==e){for(i=[],s=k();null!==s;)i.push(s),s=k();null!==i&&null!==(s=p())?e=[e,i,s]:(e=null,K=a)}else e=null,K=a;null!==e&&(e=e[2].map(function(t){return{cmd:"verticalLineToRelative",args:[t]}})),null===e&&(K=r)}return e}function p(){var t,e,i,n,s;return n=K,s=K,null!==(t=D())&&null!==(e=null!==(e=X())?e:"")&&null!==(i=p())?t=[t,e,i]:(t=null,K=s),null!==t&&(t=function(t,e,i){return[e].concat(i)}(0,t[0],t[2])),null===t&&(K=n),null===t&&(n=K,null!==(t=D())&&(t=[t]),null===t&&(K=n)),t}function v(){var e,i,s,r,a;if(r=K,a=K,67===t.charCodeAt(K)?(e="C",K++):(e=null,0===j&&n('"C"')),null!==e){for(i=[],s=k();null!==s;)i.push(s),s=k();null!==i&&null!==(s=x())?e=[e,i,s]:(e=null,K=a)}else e=null,K=a;if(null!==e&&(e=e[2].map(function(t){return{cmd:"cubicCurveTo",args:t}})),null===e&&(K=r),null===e){if(r=K,a=K,99===t.charCodeAt(K)?(e="c",K++):(e=null,0===j&&n('"c"')),null!==e){for(i=[],s=k();null!==s;)i.push(s),s=k();null!==i&&null!==(s=x())?e=[e,i,s]:(e=null,K=a)}else e=null,K=a;null!==e&&(e=e[2].map(function(t){return{cmd:"cubicCurveToRelative",args:t}})),null===e&&(K=r)}return e}function x(){var t,e,i,n,s;return n=K,s=K,null!==(t=T())&&null!==(e=null!==(e=X())?e:"")&&null!==(i=x())?t=[t,e,i]:(t=null,K=s),null!==t&&(t=function(t,e,i){return[e].concat(i)}(0,t[0],t[2])),null===t&&(K=n),null===t&&(n=K,null!==(t=T())&&(t=[t]),null===t&&(K=n)),t}function T(){var t,e,i,n,s,r,a;return r=K,a=K,null!==(t=C())&&null!==(e=null!==(e=X())?e:"")&&null!==(i=C())&&null!==(n=null!==(n=X())?n:"")&&null!==(s=C())?t=[t,e,i,n,s]:(t=null,K=a),null!==t&&(t=function(t,e,i,n){return[e.x,e.y,i.x,i.y,n.x,n.y]}(0,t[0],t[2],t[4])),null===t&&(K=r),t}function y(){var e,i,s,r,a;if(r=K,a=K,83===t.charCodeAt(K)?(e="S",K++):(e=null,0===j&&n('"S"')),null!==e){for(i=[],s=k();null!==s;)i.push(s),s=k();null!==i&&null!==(s=_())?e=[e,i,s]:(e=null,K=a)}else e=null,K=a;if(null!==e&&(e=e[2].map(function(t){return{cmd:"smoothCubicCurveTo",args:t}})),null===e&&(K=r),null===e){if(r=K,a=K,115===t.charCodeAt(K)?(e="s",K++):(e=null,0===j&&n('"s"')),null!==e){for(i=[],s=k();null!==s;)i.push(s),s=k();null!==i&&null!==(s=_())?e=[e,i,s]:(e=null,K=a)}else e=null,K=a;null!==e&&(e=e[2].map(function(t){return{cmd:"smoothCubicCurveToRelative",args:t}})),null===e&&(K=r)}return e}function _(){var t,e,i,n,s;return n=K,s=K,null!==(t=E())&&null!==(e=null!==(e=X())?e:"")&&null!==(i=_())?t=[t,e,i]:(t=null,K=s),null!==t&&(t=function(t,e,i){return[e].concat(i)}(0,t[0],t[2])),null===t&&(K=n),null===t&&(n=K,null!==(t=E())&&(t=[t]),null===t&&(K=n)),t}function E(){var t,e,i,n,s;return n=K,s=K,null!==(t=C())&&null!==(e=null!==(e=X())?e:"")&&null!==(i=C())?t=[t,e,i]:(t=null,K=s),null!==t&&(t=function(t,e,i){return[e.x,e.y,i.x,i.y]}(0,t[0],t[2])),null===t&&(K=n),t}function w(){var e,i,s,r,a;if(r=K,a=K,81===t.charCodeAt(K)?(e="Q",K++):(e=null,0===j&&n('"Q"')),null!==e){for(i=[],s=k();null!==s;)i.push(s),s=k();null!==i&&null!==(s=O())?e=[e,i,s]:(e=null,K=a)}else e=null,K=a;if(null!==e&&(e=e[2].map(function(t){return{cmd:"quadraticCurveTo",args:t}})),null===e&&(K=r),null===e){if(r=K,a=K,113===t.charCodeAt(K)?(e="q",K++):(e=null,0===j&&n('"q"')),null!==e){for(i=[],s=k();null!==s;)i.push(s),s=k();null!==i&&null!==(s=O())?e=[e,i,s]:(e=null,K=a)}else e=null,K=a;null!==e&&(e=e[2].map(function(t){return{cmd:"quadraticCurveToRelative",args:t}})),null===e&&(K=r)}return e}function O(){var t,e,i,n,s;return n=K,s=K,null!==(t=b())&&null!==(e=null!==(e=X())?e:"")&&null!==(i=O())?t=[t,e,i]:(t=null,K=s),null!==t&&(t=function(t,e,i){return[e].concat(i)}(0,t[0],t[2])),null===t&&(K=n),null===t&&(n=K,null!==(t=b())&&(t=[t]),null===t&&(K=n)),t}function b(){var t,e,i,n,s;return n=K,s=K,null!==(t=C())&&null!==(e=null!==(e=X())?e:"")&&null!==(i=C())?t=[t,e,i]:(t=null,K=s),null!==t&&(t=function(t,e,i){return[e.x,e.y,i.x,i.y]}(0,t[0],t[2])),null===t&&(K=n),t}function I(){var e,i,s,r,a;if(r=K,a=K,84===t.charCodeAt(K)?(e="T",K++):(e=null,0===j&&n('"T"')),null!==e){for(i=[],s=k();null!==s;)i.push(s),s=k();null!==i&&null!==(s=A())?e=[e,i,s]:(e=null,K=a)}else e=null,K=a;if(null!==e&&(e=e[2].map(function(t){return{cmd:"smoothQuadraticCurveTo",args:[t.x,t.y]}})),null===e&&(K=r),null===e){if(r=K,a=K,116===t.charCodeAt(K)?(e="t",K++):(e=null,0===j&&n('"t"')),null!==e){for(i=[],s=k();null!==s;)i.push(s),s=k();null!==i&&null!==(s=A())?e=[e,i,s]:(e=null,K=a)}else e=null,K=a;null!==e&&(e=e[2].map(function(t){return{cmd:"smoothQuadraticCurveToRelative",args:[t.x,t.y]}})),null===e&&(K=r)}return e}function A(){var t,e,i,n,s;return n=K,s=K,null!==(t=C())&&null!==(e=null!==(e=X())?e:"")&&null!==(i=A())?t=[t,e,i]:(t=null,K=s),null!==t&&(t=function(t,e,i){return[e].concat(i)}(0,t[0],t[2])),null===t&&(K=n),null===t&&(n=K,null!==(t=C())&&(t=[t]),null===t&&(K=n)),t}function M(){var e,i,s,r,a;if(r=K,a=K,65===t.charCodeAt(K)?(e="A",K++):(e=null,0===j&&n('"A"')),null!==e){for(i=[],s=k();null!==s;)i.push(s),s=k();null!==i&&null!==(s=P())?e=[e,i,s]:(e=null,K=a)}else e=null,K=a;if(null!==e&&(e=e[2].map(function(t){return t[2]*=Math.PI/180,{cmd:"ellipticalArcTo",args:t}})),null===e&&(K=r),null===e){if(r=K,a=K,97===t.charCodeAt(K)?(e="a",K++):(e=null,0===j&&n('"a"')),null!==e){for(i=[],s=k();null!==s;)i.push(s),s=k();null!==i&&null!==(s=P())?e=[e,i,s]:(e=null,K=a)}else e=null,K=a;null!==e&&(e=e[2].map(function(t){return t[2]*=Math.PI/180,{cmd:"ellipticalArcToRelative",args:t}})),null===e&&(K=r)}return e}function P(){var t,e,i,n,s;return n=K,s=K,null!==(t=S())&&null!==(e=null!==(e=X())?e:"")&&null!==(i=P())?t=[t,e,i]:(t=null,K=s),null!==t&&(t=function(t,e,i){return[e].concat(i)}(0,t[0],t[2])),null===t&&(K=n),null===t&&(n=K,null!==(t=S())&&(t=[t]),null===t&&(K=n)),t}function S(){var t,e,i,n,s,r,a,o,h,u,l,c,m;return c=K,m=K,null!==(t=R())&&null!==(e=null!==(e=X())?e:"")&&null!==(i=R())&&null!==(n=null!==(n=X())?n:"")&&null!==(s=D())&&null!==(r=X())&&null!==(a=V())&&null!==(o=null!==(o=X())?o:"")&&null!==(h=V())&&null!==(u=null!==(u=X())?u:"")&&null!==(l=C())?t=[t,e,i,n,s,r,a,o,h,u,l]:(t=null,K=m),null!==t&&(t=function(t,e,i,n,s,r,a){return[e,i,n,s,r,a.x,a.y]}(0,t[0],t[2],t[4],t[6],t[8],t[10])),null===t&&(K=c),t}function C(){var t,e,i,n,s;return n=K,s=K,null!==(t=D())&&null!==(e=null!==(e=X())?e:"")&&null!==(i=D())?t=[t,e,i]:(t=null,K=s),null!==t&&(t={x:t[0],y:t[2]}),null===t&&(K=n),t}function R(){var t,e;return e=K,null!==(t=Y())&&(t=function(t,e){return parseFloat(e)}(0,t)),null===t&&(K=e),null===t&&(e=K,null!==(t=z())&&(t=function(t,e){return parseInt(e,10)}(0,t)),null===t&&(K=e)),t}function D(){var t,e,i,n;return i=K,n=K,t=L(),null!==(t=null!==t?t:"")&&null!==(e=Y())?t=[t,e]:(t=null,K=n),null!==t&&(t=function(t,e,i){return parseFloat(e+i)}(0,t[0],t[1])),null===t&&(K=i),null===t&&(i=K,n=K,null!==(t=null!==(t=L())?t:"")&&null!==(e=z())?t=[t,e]:(t=null,K=n),null!==t&&(t=function(t,e,i){return parseInt(e+i,10)}(0,t[0],t[1])),null===t&&(K=i)),t}function V(){var e,i;return i=K,48===t.charCodeAt(K)?(e="0",K++):(e=null,0===j&&n('"0"')),null!==e&&(e=!1),null===e&&(K=i),null===e&&(i=K,49===t.charCodeAt(K)?(e="1",K++):(e=null,0===j&&n('"1"')),null!==e&&(e=!0),null===e&&(K=i)),e}function X(){var t,e,i,n,s;if(s=K,null!==(e=k()))for(t=[];null!==e;)t.push(e),e=k();else t=null;if(null!==t)if(e=N(),null!==(e=null!==e?e:"")){for(i=[],n=k();null!==n;)i.push(n),n=k();null!==i?t=[t,e,i]:(t=null,K=s)}else t=null,K=s;else t=null,K=s;if(null===t)if(s=K,null!==(t=N())){for(e=[],i=k();null!==i;)e.push(i),i=k();null!==e?t=[t,e]:(t=null,K=s)}else t=null,K=s;return t}function N(){var e;return 44===t.charCodeAt(K)?(e=",",K++):(e=null,0===j&&n('","')),e}function Y(){var t,e,i,n;return i=K,n=K,null!==(t=H())&&null!==(e=null!==(e=F())?e:"")?t=[t,e]:(t=null,K=n),null!==t&&(t=t[0]+t[1]),null===t&&(K=i),null===t&&(i=K,n=K,null!==(t=z())&&null!==(e=F())?t=[t,e]:(t=null,K=n),null!==t&&(t=t[0]+t[1]),null===t&&(K=i)),t}function H(){var e,i,s,r,a;return r=K,a=K,e=z(),null!==(e=null!==e?e:"")?(46===t.charCodeAt(K)?(i=".",K++):(i=null,0===j&&n('"."')),null!==i&&null!==(s=z())?e=[e,i,s]:(e=null,K=a)):(e=null,K=a),null!==e&&(e=e[0]+"."+e[2]),null===e&&(K=r),null===e&&(r=K,a=K,null!==(e=z())?(46===t.charCodeAt(K)?(i=".",K++):(i=null,0===j&&n('"."')),null!==i?e=[e,i]:(e=null,K=a)):(e=null,K=a),null!==e&&(e=e[0]),null===e&&(K=r)),e}function F(){var e,i,s,r,a;return r=K,a=K,101===t.charCodeAt(K)?(e="e",K++):(e=null,0===j&&n('"e"')),null===e&&(69===t.charCodeAt(K)?(e="E",K++):(e=null,0===j&&n('"E"'))),null!==e&&null!==(i=null!==(i=L())?i:"")&&null!==(s=z())?e=[e,i,s]:(e=null,K=a),null!==e&&(e=e[0]+e[1]+e[2]),null===e&&(K=r),e}function L(){var e;return 43===t.charCodeAt(K)?(e="+",K++):(e=null,0===j&&n('"+"')),null===e&&(45===t.charCodeAt(K)?(e="-",K++):(e=null,0===j&&n('"-"'))),e}function z(){var t,e,i,n;return i=K,n=K,null!==(t=q())&&null!==(e=z())?t=[t,e]:(t=null,K=n),null!==t&&(t=t[0]+t[1]),null===t&&(K=i),null===t&&(t=q()),t}function q(){var e;return/^[0-9]/.test(t.charAt(K))?(e=t.charAt(K),K++):(e=null,0===j&&n("[0-9]")),e}function k(){var e;return 32===t.charCodeAt(K)?(e=" ",K++):(e=null,0===j&&n('" "')),null===e&&(9===t.charCodeAt(K)?(e="\t",K++):(e=null,0===j&&n('"\\t"')),null===e&&(13===t.charCodeAt(K)?(e="\r",K++):(e=null,0===j&&n('"\\r"')),null===e&&(10===t.charCodeAt(K)?(e="\n",K++):(e=null,0===j&&n('"\\n"'))))),e}function B(t,e){var i=[{cmd:e?"moveToRelative":"moveTo",args:[t[0].x,t[0].y]}];if(t.length>1)for(var n=1;n<t.length;n++)i.push({cmd:e?"lineToRelative":"lineTo",args:[t[n].x,t[n].y]});return i}var Z={svgPath:function(){var t,e,i,n,r,a;for(r=K,a=K,t=[],e=k();null!==e;)t.push(e),e=k();if(null!==t)if(e=s(),null!==(e=null!==e?e:"")){for(i=[],n=k();null!==n;)i.push(n),n=k();null!==i?t=[t,e,i]:(t=null,K=a)}else t=null,K=a;else t=null,K=a;return null!==t&&(t=function(t,e){return e||[]}(0,t[1])),null===t&&(K=r),t},movetoDrawtoCommandGroups:s,movetoDrawtoCommandGroup:r,drawtoCommands:a,drawtoCommand:o,moveto:h,movetoArgumentSequence:u,closepath:l,lineto:c,linetoArgumentSequence:m,horizontalLineto:d,horizontalLinetoArgumentSequence:f,verticalLineto:g,verticalLinetoArgumentSequence:p,curveto:v,curvetoArgumentSequence:x,curvetoArgument:T,smoothCurveto:y,smoothCurvetoArgumentSequence:_,smoothCurvetoArgument:E,quadraticBezierCurveto:w,quadraticBezierCurvetoArgumentSequence:O,quadraticBezierCurvetoArgument:b,smoothQuadraticBezierCurveto:I,smoothQuadraticBezierCurvetoArgumentSequence:A,ellipticalArc:M,ellipticalArcArgumentSequence:P,ellipticalArcArgument:S,coordinatePair:C,nonnegativeNumber:R,number:D,flag:V,commaWsp:X,comma:N,floatingPointConstant:Y,fractionalConstant:H,exponent:F,sign:L,digitSequence:z,digit:q,wsp:k};if(void 0!==i){if(void 0===Z[i])throw new Error("Invalid rule name: "+e(i)+".")}else i="svgPath";var K=0,j=0,U=0,G=[],W=Z[i]();if(null===W||K!==t.length){var Q=Math.max(K,U),J=Q<t.length?t.charAt(Q):null,$=function(){for(var e=1,i=1,n=!1,s=0;s<Math.max(K,U);s++){var r=t.charAt(s);"\n"===r?(n||e++,i=1,n=!1):"\r"===r||"\u2028"===r||"\u2029"===r?(e++,i=1,n=!0):(i++,n=!1)}return{line:e,column:i}}();throw new this.SyntaxError(function(t){t.sort();for(var e=null,i=[],n=0;n<t.length;n++)t[n]!==e&&(i.push(t[n]),e=t[n]);return i}(G),J,Q,$.line,$.column)}return W},toSource:function(){return this._source}};return n.SyntaxError=function(t,i,n,s,r){this.name="SyntaxError",this.expected=t,this.found=i,this.message=function(t,i){var n,s;switch(t.length){case 0:n="end of input";break;case 1:n=t[0];break;default:n=t.slice(0,t.length-1).join(", ")+" or "+t[t.length-1]}return s=i?e(i):"end of input","Expected "+n+" but "+s+" found."}(t,i),this.offset=n,this.line=s,this.column=r},n.SyntaxError.prototype=Error.prototype,i.register("svgPath",n),i.svgPath}),i("KITE/Shape",["require","KITE/segments/Arc","DOT/Bounds2","KITE/segments/Cubic","KITE/segments/EllipticalArc","AXON/Events","KITE/ops/Graph","PHET_CORE/inherit","KITE/kite","KITE/segments/Line","KITE/util/LineStyles","KITE/segments/Quadratic","DOT/Ray2","KITE/util/Subpath","KITE/parser/svgPath","DOT/Vector2"],function(t){"use strict";function e(t,e){return new v(t,e)}function i(t,e,i,n){return i.copy().subtract(t).multiplyScalar((1-n)/6).add(e)}function n(t,e){var i=this;if(h.call(this),this.subpaths=[],this._bounds=e?e.copy():null,this.resetControlPoints(),this._invalidateListener=this.invalidate.bind(this),this._invalidatingPoints=!1,this._immutable=!1,"object"==typeof t)for(var n=0;n<t.length;n++)this.addSubpath(t[n]);t&&"object"!=typeof t&&_.each(p.parse(t),function(t){i[t.cmd].apply(i,t.args)}),this.invalidate()}var s=t("KITE/segments/Arc"),r=t("DOT/Bounds2"),a=t("KITE/segments/Cubic"),o=t("KITE/segments/EllipticalArc"),h=t("AXON/Events"),u=t("KITE/ops/Graph"),l=t("PHET_CORE/inherit"),c=t("KITE/kite"),m=t("KITE/segments/Line"),d=(t("KITE/util/LineStyles"),t("KITE/segments/Quadratic")),f=t("DOT/Ray2"),g=t("KITE/util/Subpath"),p=t("KITE/parser/svgPath"),v=t("DOT/Vector2");return c.register("Shape",n),l(h,n,{resetControlPoints:function(){this.lastQuadraticControlPoint=null,this.lastCubicControlPoint=null},setQuadraticControlPoint:function(t){this.lastQuadraticControlPoint=t,this.lastCubicControlPoint=null},setCubicControlPoint:function(t){this.lastQuadraticControlPoint=null,this.lastCubicControlPoint=t},moveTo:function(t,i){return this.moveToPoint(e(t,i))},moveToRelative:function(t,i){return this.moveToPointRelative(e(t,i))},moveToPointRelative:function(t){return this.moveToPoint(this.getRelativePoint().plus(t))},moveToPoint:function(t){return this.addSubpath((new g).addPoint(t)),this.resetControlPoints(),this},lineTo:function(t,i){return this.lineToPoint(e(t,i))},lineToRelative:function(t,i){return this.lineToPointRelative(e(t,i))},lineToPointRelative:function(t){return this.lineToPoint(this.getRelativePoint().plus(t))},lineToPoint:function(t){if(this.hasSubpaths()){var e=this.getLastSubpath().getLastPoint(),i=t,n=new m(e,i);this.getLastSubpath().addPoint(i),this.addSegmentAndBounds(n)}else this.ensure(t);return this.resetControlPoints(),this},horizontalLineTo:function(t){return this.lineTo(t,this.getRelativePoint().y)},horizontalLineToRelative:function(t){return this.lineToRelative(t,0)},verticalLineTo:function(t){return this.lineTo(this.getRelativePoint().x,t)},verticalLineToRelative:function(t){return this.lineToRelative(0,t)},quadraticCurveTo:function(t,i,n,s){return this.quadraticCurveToPoint(e(t,i),e(n,s))},quadraticCurveToRelative:function(t,i,n,s){return this.quadraticCurveToPointRelative(e(t,i),e(n,s))},quadraticCurveToPointRelative:function(t,e){var i=this.getRelativePoint();return this.quadraticCurveToPoint(i.plus(t),i.plus(e))},smoothQuadraticCurveTo:function(t,i){return this.quadraticCurveToPoint(this.getSmoothQuadraticControlPoint(),e(t,i))},smoothQuadraticCurveToRelative:function(t,i){return this.quadraticCurveToPoint(this.getSmoothQuadraticControlPoint(),e(t,i).plus(this.getRelativePoint()))},quadraticCurveToPoint:function(t,e){var i=this;this.ensure(t);var n=this.getLastSubpath().getLastPoint(),s=new d(n,t,e);this.getLastSubpath().addPoint(e);var r=s.getNondegenerateSegments();return _.each(r,function(t){i.addSegmentAndBounds(t)}),this.setQuadraticControlPoint(t),this},cubicCurveTo:function(t,i,n,s,r,a){return this.cubicCurveToPoint(e(t,i),e(n,s),e(r,a))},cubicCurveToRelative:function(t,i,n,s,r,a){return this.cubicCurveToPointRelative(e(t,i),e(n,s),e(r,a))},cubicCurveToPointRelative:function(t,e,i){var n=this.getRelativePoint();return this.cubicCurveToPoint(n.plus(t),n.plus(e),n.plus(i))},smoothCubicCurveTo:function(t,i,n,s){return this.cubicCurveToPoint(this.getSmoothCubicControlPoint(),e(t,i),e(n,s))},smoothCubicCurveToRelative:function(t,i,n,s){return this.cubicCurveToPoint(this.getSmoothCubicControlPoint(),e(t,i).plus(this.getRelativePoint()),e(n,s).plus(this.getRelativePoint()))},cubicCurveToPoint:function(t,e,i){var n=this;this.ensure(t);var s=this.getLastSubpath().getLastPoint(),r=new a(s,t,e,i).getNondegenerateSegments();return _.each(r,function(t){n.addSegmentAndBounds(t)}),this.getLastSubpath().addPoint(i),this.setCubicControlPoint(e),this},arc:function(t,i,n,s,r,a){return this.arcPoint(e(t,i),n,s,r,a)},arcPoint:function(t,e,i,n,r){void 0===r&&(r=!1);var a=new s(t,e,i,n,r),o=a.getStart(),h=a.getEnd();return this.hasSubpaths()&&this.getLastSubpath().getLength()>0&&!o.equals(this.getLastSubpath().getLastPoint(),0)&&this.addSegmentAndBounds(new m(this.getLastSubpath().getLastPoint(),o)),this.hasSubpaths()||this.addSubpath(new g),this.getLastSubpath().addPoint(o),this.getLastSubpath().addPoint(h),this.addSegmentAndBounds(a),this.resetControlPoints(),this},ellipticalArc:function(t,i,n,s,r,a,o,h){return this.ellipticalArcPoint(e(t,i),n,s,r,a,o,h)},ellipticalArcPoint:function(t,e,i,n,s,r,a){void 0===a&&(a=!1);var h=new o(t,e,i,n,s,r,a),u=h.start,l=h.end;return this.hasSubpaths()&&this.getLastSubpath().getLength()>0&&!u.equals(this.getLastSubpath().getLastPoint(),0)&&this.addSegmentAndBounds(new m(this.getLastSubpath().getLastPoint(),u)),this.hasSubpaths()||this.addSubpath(new g),this.getLastSubpath().addPoint(u),this.getLastSubpath().addPoint(l),this.addSegmentAndBounds(h),this.resetControlPoints(),this},close:function(){if(this.hasSubpaths()){var t=this.getLastSubpath(),e=new g;t.close(),this.addSubpath(e),e.addPoint(t.getFirstPoint())}return this.resetControlPoints(),this},newSubpath:function(){return this.addSubpath(new g),this.resetControlPoints(),this},makeImmutable:function(){return this._immutable=!0,this.notifyInvalidationListeners(),this},isImmutable:function(){return this._immutable},ellipticalArcToRelative:function(t,e,i,n,s,r,a){var o=this.getRelativePoint();return this.ellipticalArcTo(t,e,i,n,s,r+o.x,a+o.y)},ellipticalArcTo:function(t,e,i,n,s,r,a){function h(t,e){return(t.x*e.y-t.y*e.x>0?1:-1)*t.angleBetween(e)}var u=this,l=new v(r,a);this.ensure(l);var c=this.getLastSubpath().getLastPoint();this.getLastSubpath().addPoint(l),t<0&&(t*=-1),e<0&&(e*=-1);var m=t*t,d=e*e,f=c.minus(l).dividedScalar(2).rotated(-i),g=f.x*f.x,p=f.y*f.y,x=new v(t*f.y/e,-e*f.x/t),T=g/m+p/d;T>1&&(m=(t*=Math.sqrt(T))*t,d=(e*=Math.sqrt(T))*e,x=new v(t*f.y/e,-e*f.x/t)),x.multiplyScalar(Math.sqrt(Math.max(0,(m*d-m*p-d*g)/(m*p+d*g)))),n===s&&x.multiplyScalar(-1);var y=c.blend(l,.5).plus(x.rotated(i)),E=new v((f.x-x.x)/t,(f.y-x.y)/e),w=new v((-f.x-x.x)/t,(-f.y-x.y)/e),O=h(v.X_UNIT,E),b=h(E,w)%(2*Math.PI);!s&&b>0&&(b-=2*Math.PI),s&&b<0&&(b+=2*Math.PI);var I=new o(y,t,e,i,O,O+b,!s).getNondegenerateSegments();return _.each(I,function(t){u.addSegmentAndBounds(t)}),this},circle:function(t,i,n){if("object"==typeof t){var s=t;return n=i,this.arcPoint(s,n,0,2*Math.PI,!1).close()}return this.arcPoint(e(t,i),n,0,2*Math.PI,!1).close()},ellipse:function(t,i,n,s,r){if("object"==typeof t){var a=t;return r=s,s=n,n=i,this.ellipticalArcPoint(a,n,s,r||0,0,2*Math.PI,!1).close()}return this.ellipticalArcPoint(e(t,i),n,s,r||0,0,2*Math.PI,!1).close()},rect:function(t,i,n,s){var r=new g;return this.addSubpath(r),r.addPoint(e(t,i)),r.addPoint(e(t+n,i)),r.addPoint(e(t+n,i+s)),r.addPoint(e(t,i+s)),this.addSegmentAndBounds(new m(r.points[0],r.points[1])),this.addSegmentAndBounds(new m(r.points[1],r.points[2])),this.addSegmentAndBounds(new m(r.points[2],r.points[3])),r.close(),this.addSubpath(new g),this.getLastSubpath().addPoint(e(t,i)),this.resetControlPoints(),this},roundRect:function(t,e,i,n,s,r){var a=t+s,o=t+i-s,h=e+r,u=e+n-r;return s===r?this.arc(o,h,s,-Math.PI/2,0,!1).arc(o,u,s,0,Math.PI/2,!1).arc(a,u,s,Math.PI/2,Math.PI,!1).arc(a,h,s,Math.PI,3*Math.PI/2,!1).close():this.ellipticalArc(o,h,s,r,0,-Math.PI/2,0,!1).ellipticalArc(o,u,s,r,0,0,Math.PI/2,!1).ellipticalArc(a,u,s,r,0,Math.PI/2,Math.PI,!1).ellipticalArc(a,h,s,r,0,Math.PI,3*Math.PI/2,!1).close(),this},polygon:function(t){var e=t.length;if(e>0){this.moveToPoint(t[0]);for(var i=1;i<e;i++)this.lineToPoint(t[i])}return this.close()},cardinalSpline:function(t,e){e=_.extend({tension:0,isClosedLineSegments:!1},e);for(var n=t.length,s=e.isClosedLineSegments?n:n-1,r=0;r<s;r++){var a,o=[(a=0!==r||e.isClosedLineSegments?r!==s-1||e.isClosedLineSegments?[t[(r-1+n)%n],t[r%n],t[(r+1)%n],t[(r+2)%n]]:[t[r-1],t[r],t[r+1],t[r+1]]:[t[0],t[0],t[1],t[2]])[1],i(a[0],a[1],a[2],e.tension),i(a[3],a[2],a[1],e.tension),a[2]];0===r&&(this.ensure(o[0]),this.getLastSubpath().addPoint(o[0])),this.cubicCurveToPoint(o[1],o[2],o[3])}return this},copy:function(){return new n(_.map(this.subpaths,function(t){return t.copy()}),this.bounds)},writeToContext:function(t){for(var e=this.subpaths.length,i=0;i<e;i++)this.subpaths[i].writeToContext(t)},getSVGPath:function(){for(var t="",e=this.subpaths.length,i=0;i<e;i++){var n=this.subpaths[i];if(n.isDrawable()){var s=n.segments[0].start;t+="M "+c.svgNumber(s.x)+" "+c.svgNumber(s.y)+" ";for(var r=0;r<n.segments.length;r++)t+=n.segments[r].getSVGPathFragment()+" ";n.isClosed()&&(t+="Z ")}}return t},transformed:function(t){var e=_.map(this.subpaths,function(e){return e.transformed(t)});return new n(e,_.reduce(e,function(t,e){return t.union(e.bounds)},r.NOTHING))},nonlinearTransformed:function(t){t=_.extend({minLevels:0,maxLevels:7,distanceEpsilon:.16,curveEpsilon:t&&t.includeCurvature?.002:null},t);var e=_.map(this.subpaths,function(e){return e.nonlinearTransformed(t)});return new n(e,_.reduce(e,function(t,e){return t.union(e.bounds)},r.NOTHING))},polarToCartesian:function(t){return this.nonlinearTransformed(_.extend({pointMap:function(t){return v.createPolar(t.y,t.x)},methodName:"polarToCartesian"},t))},toPiecewiseLinear:function(t){return this.nonlinearTransformed(t)},containsPoint:function(t){var e=new f(t,v.X_UNIT);return 0!==this.windingIntersection(e)},intersection:function(t){for(var e=[],i=this.subpaths.length,n=0;n<i;n++){var s=this.subpaths[n];if(s.isDrawable()){for(var r=s.segments.length,a=0;a<r;a++){var o=s.segments[a];e=e.concat(o.intersection(t))}s.hasClosingSegment()&&(e=e.concat(s.getClosingSegment().intersection(t)))}}return _.sortBy(e,function(t){return t.distance})},interiorIntersectsLineSegment:function(t,e){var i=t.blend(e,.5);if(this.containsPoint(i))return!0;var n=e.minus(t),s=n.magnitude();if(0===s)return!1;n.normalize();for(var r=this.intersection(new f(t,n)),a=0;a<r.length;a++)if(r[a].distance<=s)return!0;return!1},windingIntersection:function(t){for(var e=0,i=this.subpaths.length,n=0;n<i;n++){var s=this.subpaths[n];if(s.isDrawable()){for(var r=s.segments.length,a=0;a<r;a++)e+=s.segments[a].windingIntersection(t);s.hasClosingSegment()&&(e+=s.getClosingSegment().windingIntersection(t))}}return e},intersectsBounds:function(t){if(this.bounds.intersection(t).equals(this.bounds))return!0;var e,i,n=new f(new v(t.minX,t.minY),new v(1,0)),s=new f(new v(t.minX,t.minY),new v(0,1)),r=new f(new v(t.maxX,t.maxY),new v(-1,0)),a=new f(new v(t.maxX,t.maxY),new v(0,-1)),o=this.intersection(n).concat(this.intersection(r));for(i=0;i<o.length;i++)if((e=o[i].point).x>=t.minX&&e.x<=t.maxX)return!0;var h=this.intersection(s).concat(this.intersection(a));for(i=0;i<h.length;i++)if((e=h[i].point).y>=t.minY&&e.y<=t.maxY)return!0;return!1},getStrokedShape:function(t){for(var e=[],i=r.NOTHING.copy(),s=this.subpaths.length,a=0;a<s;a++){var o=this.subpaths[a].stroked(t);e=e.concat(o)}for(s=e.length,a=0;a<s;a++)i.includeBounds(e[a].bounds);return new n(e,i)},getOffsetShape:function(t){for(var e=[],i=r.NOTHING.copy(),s=this.subpaths.length,a=0;a<s;a++)e.push(this.subpaths[a].offset(t));for(s=e.length,a=0;a<s;a++)i.includeBounds(e[a].bounds);return new n(e,i)},getDashedShape:function(t,e,i){return i=_.extend({distanceEpsilon:1e-10,curveEpsilon:1e-8},i),new n(_.flatten(this.subpaths.map(function(n){return n.dashed(t,e,i.distanceEpsilon,i.curveEpsilon)})))},getBounds:function(){if(null===this._bounds){var t=r.NOTHING.copy();_.each(this.subpaths,function(e){t.includeBounds(e.getBounds())}),this._bounds=t}return this._bounds},get bounds(){return this.getBounds()},getStrokedBounds:function(t){for(var e=!0,i=0;i<this.subpaths.length;i++){var n=this.subpaths[i];if(n.isDrawable()&&!n.isClosed()){e=!1;break}for(var s=0;s<n.segments.length;s++){if(!n.segments[s].areStrokedBoundsDilated()){e=!1;break}}}if(e)return this.bounds.dilated(t.lineWidth/2);var r=this.bounds.copy();for(i=0;i<this.subpaths.length;i++){var a=this.subpaths[i].stroked(t);for(s=0;s<a.length;s++)r.includeBounds(a[s].bounds)}return r},getSimplifiedAreaShape:function(){return u.simplifyNonZero(this)},getBoundsWithTransform:function(t,e){for(var i=r.NOTHING.copy(),n=this.subpaths.length,s=0;s<n;s++){var a=this.subpaths[s];i.includeBounds(a.getBoundsWithTransform(t))}return e&&i.includeBounds(this.getStrokedShape(e).getBoundsWithTransform(t)),i},getApproximateArea:function(t){for(var e=this.bounds.minX,i=this.bounds.minY,n=this.bounds.width,s=this.bounds.height,r=n*s,a=0,o=new v,h=0;h<t;h++)o.x=e+Math.random()*n,o.y=i+Math.random()*s,this.containsPoint(o)&&a++;return r*a/t},getNonoverlappingArea:function(){return Math.abs(_.sum(this.subpaths.map(function(t){return _.sum(t.getFillSegments().map(function(t){return t.getSignedAreaFragment()}))})))},getArea:function(){return this.getSimplifiedAreaShape().getNonoverlappingArea()},getApproximateCentroid:function(t){for(var e=this.bounds.minX,i=this.bounds.minY,n=this.bounds.width,s=this.bounds.height,r=0,a=new v,o=new v,h=0;h<t;h++)o.x=e+Math.random()*n,o.y=i+Math.random()*s,this.containsPoint(o)&&(a.add(o),r++);return a.dividedScalar(r)},invalidatePoints:function(){this._invalidatingPoints=!0;for(var t=this.subpaths.length,e=0;e<t;e++)this.subpaths[e].invalidatePoints();this._invalidatingPoints=!1,this.invalidate()},toString:function(){return"new kite.Shape( '"+this.getSVGPath()+"' )"},invalidate:function(){this._invalidatingPoints||(this._bounds=null,this.notifyInvalidationListeners())},notifyInvalidationListeners:function(){this.trigger0("invalidated")},addSegmentAndBounds:function(t){this.getLastSubpath().addSegment(t),this.invalidate()},ensure:function(t){this.hasSubpaths()||(this.addSubpath(new g),this.getLastSubpath().addPoint(t))},addSubpath:function(t){return this.subpaths.push(t),t.onStatic("invalidated",this._invalidateListener),this.invalidate(),this},hasSubpaths:function(){return this.subpaths.length>0},getLastSubpath:function(){return _.last(this.subpaths)},getLastPoint:function(){return this.hasSubpaths()?this.getLastSubpath().getLastPoint():null},getLastSegment:function(){if(!this.hasSubpaths())return null;var t=this.getLastSubpath();return t.isDrawable()?t.getLastSegment():null},getSmoothQuadraticControlPoint:function(){var t=this.getLastPoint();return this.lastQuadraticControlPoint?t.plus(t.minus(this.lastQuadraticControlPoint)):t},getSmoothCubicControlPoint:function(){var t=this.getLastPoint();return this.lastCubicControlPoint?t.plus(t.minus(this.lastCubicControlPoint)):t},getRelativePoint:function(){var t=this.getLastPoint();return t||v.ZERO},shapeUnion:function(t){return u.binaryResult(this,t,u.BINARY_NONZERO_UNION)},shapeIntersection:function(t){return u.binaryResult(this,t,u.BINARY_NONZERO_INTERSECTION)},shapeDifference:function(t){return u.binaryResult(this,t,u.BINARY_NONZERO_DIFFERENCE)},shapeXor:function(t){return u.binaryResult(this,t,u.BINARY_NONZERO_XOR)},getArcLength:function(t,e,i){for(var n=0,s=0;s<this.subpaths.length;s++)n+=this.subpaths[s].getArcLength(t,e,i);return n},serialize:function(){return{type:"Shape",subpaths:this.subpaths.map(function(t){return t.serialize()})}}}),n.deserialize=function(t){return new n(t.subpaths.map(g.deserialize))},n.rectangle=function(t,e,i,s){return(new n).rect(t,e,i,s)},n.rect=n.rectangle,n.roundRect=function(t,e,i,s,r,a){return(new n).roundRect(t,e,i,s,r,a)},n.roundRectangle=n.roundRect,n.roundedRectangleWithRadii=function(t,e,i,n,s){var r=s&&s.topLeft||0,a=s&&s.topRight||0,o=s&&s.bottomLeft||0,h=s&&s.bottomRight||0,u=new c.Shape,l=t+i,m=e+n;return h>0?u.arc(l-h,m-h,h,0,Math.PI/2,!1):u.moveTo(l,m),o>0?u.arc(t+o,m-o,o,Math.PI/2,Math.PI,!1):u.lineTo(t,m),r>0?u.arc(t+r,e+r,r,Math.PI,3*Math.PI/2,!1):u.lineTo(t,e),a>0?u.arc(l-a,e+a,a,3*Math.PI/2,2*Math.PI,!1):u.lineTo(l,e),u.close(),u},n.polygon=function(t){return(new n).polygon(t)},n.bounds=function(t){return(new n).rect(t.minX,t.minY,t.maxX-t.minX,t.maxY-t.minY)},n.lineSegment=function(t,e,i,s){return"number"==typeof t?(new n).moveTo(t,e).lineTo(i,s):(new n).moveToPoint(t).lineToPoint(e)},n.regularPolygon=function(t,e){var i=new n;return _.each(_.range(t),function(n){var s=v.createPolar(e,2*Math.PI*n/t);0===n?i.moveToPoint(s):i.lineToPoint(s)}),i.close()},n.circle=function(t,e,i){return void 0===e?(new n).circle(0,0,t):(new n).circle(t,e,i)},n.ellipse=function(t,e,i,s,r){return void 0===s?(new n).ellipse(0,0,t,e,i):(new n).ellipse(t,e,i,s,r)},n.arc=function(t,e,i,s,r,a){return(new n).arc(t,e,i,s,r,a)},n.union=function(t){return u.unionNonZero(t)},n.intersection=function(t){return u.intersectionNonZero(t)},n.xor=function(t){return u.xorNonZero(t)},n}),i("KITE/main",["KITE/kite","KITE/Shape","KITE/ops/Boundary","KITE/ops/BoundsIntersection","KITE/ops/Edge","KITE/ops/Face","KITE/ops/Graph","KITE/ops/HalfEdge","KITE/ops/Loop","KITE/ops/Vertex","KITE/segments/Arc","KITE/segments/Cubic","KITE/segments/EllipticalArc","KITE/segments/Line","KITE/segments/Quadratic","KITE/segments/Segment","KITE/util/LineStyles","KITE/util/Overlap","KITE/util/SegmentIntersection","KITE/util/Subpath","KITE/parser/svgPath"],function(t){"use strict";return t}),i("PHET_CORE/arrayDifference",["require","PHET_CORE/phetCore"],function(t){"use strict";function e(t,e,i,n,s){i=i||[],n=n||[],s=s||[],Array.prototype.push.apply(i,t),Array.prototype.push.apply(n,e);t:for(var r=0;r<i.length;r++)for(var a=i[r],o=0;o<n.length;o++){if(a===n[o]){if(s.push(a),i.splice(r,1),n.splice(o,1),o=0,r===i.length)break t;r-=1}}return i}return t("PHET_CORE/phetCore").register("arrayDifference",e),e}),i("PHET_CORE/collect",["require","PHET_CORE/phetCore"],function(t){"use strict";function e(t){var e=[];return t(function(t){e.push(t)}),e}return t("PHET_CORE/phetCore").register("collect",e),e}),i("PHET_CORE/detectPrefix",["require","PHET_CORE/phetCore"],function(t){"use strict";function e(t,e){return void 0!==t[e]?e:(e=e.charAt(0).toUpperCase()+e.slice(1),void 0!==t["moz"+e]?"moz"+e:void 0!==t["Moz"+e]?"Moz"+e:void 0!==t["webkit"+e]?"webkit"+e:void 0!==t["ms"+e]?"ms"+e:void 0!==t["o"+e]?"o"+e:void 0)}return t("PHET_CORE/phetCore").register("detectPrefix",e),e}),i("PHET_CORE/detectPrefixEvent",["require","PHET_CORE/phetCore"],function(t){"use strict";function e(t,e,i){return void 0!==t["on"+e]?e:void 0!==t["onmoz"+e]?"moz"+e:void 0!==t["onMoz"+e]?"Moz"+e:void 0!==t["onwebkit"+e]?"webkit"+e:void 0!==t["onms"+e]?"ms"+e:void 0!==t["ono"+e]?"o"+e:void 0}return t("PHET_CORE/phetCore").register("detectPrefixEvent",e),e}),i("PHET_CORE/dimensionForEach",["require","PHET_CORE/phetCore"],function(t){"use strict";function e(t,e,i){function n(t,e){return e.forEach(function(e,r){s.push(r),1===t?i.apply(null,[e].concat(s)):n(t-1,e),s.pop()})}var s=[];return n(t,e)}return t("PHET_CORE/phetCore").register("dimensionForEach",e),e}),i("PHET_CORE/dimensionMap",["require","PHET_CORE/phetCore"],function(t){"use strict";function e(t,e,i){function n(t,e){return e.map(function(e,r){s.push(r);var a=1===t?i.apply(null,[e].concat(s)):n(t-1,e);return s.pop(),a})}var s=[];return n(t,e)}return t("PHET_CORE/phetCore").register("dimensionMap",e),e}),i("PHET_CORE/escapeHTML",["require","PHET_CORE/phetCore"],function(t){"use strict";function e(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;").replace(/\'/g,"&#x27;").replace(/\//g,"&#x2F;")}return t("PHET_CORE/phetCore").register("escapeHTML",e),e}),i("PHET_CORE/EventTimer",["require","PHET_CORE/inherit","PHET_CORE/phetCore"],function(t){"use strict";function e(t,e){this.eventModel=t,this.eventCallback=e,this.period=this.eventModel.getPeriodBeforeNextEvent(),this.timeBeforeNextEvent=this.period}var i=t("PHET_CORE/inherit");return t("PHET_CORE/phetCore").register("EventTimer",e),i(Object,e,{step:function(t){for(;t>=this.timeBeforeNextEvent;)t-=this.timeBeforeNextEvent,this.period=this.eventModel.getPeriodBeforeNextEvent(),this.timeBeforeNextEvent=this.period,this.eventCallback(t);this.timeBeforeNextEvent-=t},getRatio:function(){return(this.period-this.timeBeforeNextEvent)/this.period}}),e.ConstantEventModel=i(Object,function(t){this.rate=t},{getPeriodBeforeNextEvent:function(){return 1/this.rate}}),e.UniformEventModel=i(Object,function(t,e){this.rate=t,this.pseudoRandomNumberSource=e},{getPeriodBeforeNextEvent:function(){var t=this.pseudoRandomNumberSource();return 2*t/this.rate}}),e.PoissonEventModel=i(Object,function(t,e){this.rate=t,this.pseudoRandomNumberSource=e},{getPeriodBeforeNextEvent:function(){var t=this.pseudoRandomNumberSource();return-Math.log(t)/this.rate}}),e}),i("PHET_CORE/extendDefined",["require","PHET_CORE/phetCore"],function(t){"use strict";function e(t){return _.each(Array.prototype.slice.call(arguments,1),function(e){if(e)for(var i in e){var n=Object.getOwnPropertyDescriptor(e,i);!n||"function"!=typeof n.get&&void 0===e[i]||Object.defineProperty(t,i,n)}}),t}return t("PHET_CORE/phetCore").register("extendDefined",e),e}),i("PHET_CORE/inheritance",["require","PHET_CORE/phetCore"],function(t){"use strict";function e(t){for(var e=[t],i=t.prototype;i&&(i=Object.getPrototypeOf(i));)i.constructor&&e.push(i.constructor);return e}return t("PHET_CORE/phetCore").register("inheritance",e),e}),i("PHET_CORE/interleave",["require","PHET_CORE/phetCore"],function(t){"use strict";function e(t,e){for(var i=[],n=2*t.length-1,s=0;s<n;s++)s%2==0?i.push(t[s/2]):i.push(e((s-1)/2));return i}return t("PHET_CORE/phetCore").register("interleave",e),e}),i("PHET_CORE/loadScript",["require","PHET_CORE/phetCore"],function(t){"use strict";function e(t){"string"==typeof t&&(t={src:t});var e=t.src,i=t.callback,n=void 0===t.async||t.async,s=void 0!==t.cacheBuster&&t.cacheBuster,r=!1,a=document.createElement("script");a.type="text/javascript",a.async=n,a.onload=a.onreadystatechange=function(){var t=this.readyState;t&&"complete"!==t&&"loaded"!==t||r||(r=!0,i&&i())},a.src=e+(s?"?random="+Math.random().toFixed(10):"");var o=document.getElementsByTagName("script")[0];o.parentNode.insertBefore(a,o)}return t("PHET_CORE/phetCore").register("loadScript",e),e}),i("PHET_CORE/mixedWith",["require","PHET_CORE/inherit","PHET_CORE/phetCore"],function(t){"use strict";function e(t,e){e=Array.prototype.slice.call(arguments,1);var n=t.name;e.forEach(function(t){n=n+"_"+t.name.replace(/bound /g,"_")});var s=[],r=new Function("return function( suptype, inits ) {  return function "+n+"() {    var self = this;    var args = Array.prototype.slice.call( arguments );    suptype.apply( this, args );    inits.forEach( function( init ) { init.apply( self, args ); } );  };};")()(t,s);return i(t,r),e.forEach(function(t){var e=t(r);"function"==typeof e&&s.push(e)}),r}var i=t("PHET_CORE/inherit");return t("PHET_CORE/phetCore").register("mixedWith",e),e}),i("PHET_CORE/pairs",["require","PHET_CORE/phetCore"],function(t){"use strict";function e(t){var e=[],i=t.length;if(i>1)for(var n=0;n<i-1;n++)for(var s=t[n],r=n+1;r<i;r++)e.push([s,t[r]]);return e}return t("PHET_CORE/phetCore").register("pairs",e),e}),i("PHET_CORE/partition",["require","PHET_CORE/phetCore"],function(t){"use strict";function e(t,e){for(var i=[],n=[],s=t.length,r=0;r<s;r++)e(t[r])?i.push(t[r]):n.push(t[r]);return[i,n]}return t("PHET_CORE/phetCore").register("partition",e),e}),i("PHET_CORE/platform",["require","PHET_CORE/phetCore"],function(t){"use strict";function e(t){return n()===t}function i(){return!(!r.match(/(iPod|iPhone|iPad)/)||!r.match(/AppleWebKit/))}function n(){var t=-1;return"Microsoft Internet Explorer"===navigator.appName?null!==new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(r)&&(t=parseFloat(RegExp.$1)):"Netscape"===navigator.appName&&null!==new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})").exec(r)&&(t=parseFloat(RegExp.$1)),t}var s=t("PHET_CORE/phetCore"),r=navigator.userAgent,a={firefox:r.toLowerCase().indexOf("firefox")>-1,mobileSafari:i(),safari5:!!(r.match(/Version\/5\./)&&r.match(/Safari\//)&&r.match(/AppleWebKit/)),safari6:!!(r.match(/Version\/6\./)&&r.match(/Safari\//)&&r.match(/AppleWebKit/)),safari7:!!(r.match(/Version\/7\./)&&r.match(/Safari\//)&&r.match(/AppleWebKit/)),safari10:!!(r.match(/Version\/10\./)&&r.match(/Safari\//)&&r.match(/AppleWebKit/)),safari11:!!(r.match(/Version\/11\./)&&r.match(/Safari\//)&&r.match(/AppleWebKit/)),safari9:!!(r.match(/Version\/9\./)&&r.match(/Safari\//)&&r.match(/AppleWebKit/)),safari:i()||!!(r.match(/Version\//)&&r.match(/Safari\//)&&r.match(/AppleWebKit/)),ie:-1!==n(),ie9:e(9),ie10:e(10),ie11:e(11),android:r.indexOf("Android")>0,edge:!!r.match(/Edge\//),chromium:/chrom(e|ium)/.test(r.toLowerCase())&&!r.match(/Edge\//)};return s.register("platform",a),a}),i("PHET_CORE/timer",["require","AXON/Emitter","PHET_CORE/phetCore"],t=>{"use strict";const e=t("AXON/Emitter");class i extends e{setTimeout(t,e){let i=0;const n=s=>{1e3*(i+=s)>=e&&(t(),this.removeListener(n))};return this.addListener(n),n}clearTimeout(t){this.hasListener(t)&&this.removeListener(t)}setInterval(t,e){let i=0;const n=s=>{for(i+=s;1e3*i>=e&&-1!==this.hasListener(n);)t(),i-=e/1e3};return this.addListener(n),n}clearInterval(t){this.hasListener(t)&&this.removeListener(t)}}return t("PHET_CORE/phetCore").register("timer",new i)}),i("PHET_CORE/main",["PHET_CORE/phetCore","PHET_CORE/arrayDifference","PHET_CORE/arrayRemove","PHET_CORE/cleanArray","PHET_CORE/collect","PHET_CORE/detectPrefix","PHET_CORE/detectPrefixEvent","PHET_CORE/dimensionForEach","PHET_CORE/dimensionMap","PHET_CORE/escapeHTML","PHET_CORE/EventTimer","PHET_CORE/extend","PHET_CORE/extendDefined","PHET_CORE/inherit","PHET_CORE/inheritance","PHET_CORE/interleave","PHET_CORE/isArray","PHET_CORE/loadScript","PHET_CORE/mixedWith","PHET_CORE/Namespace","PHET_CORE/pairs","PHET_CORE/partition","PHET_CORE/platform","PHET_CORE/Poolable","PHET_CORE/timer"],function(t){"use strict";return t}),function(){"use strict";if(!window.hasOwnProperty("_"))throw new Error("Underscore/Lodash not found: _");i("kite-main",["require","AXON/main","DOT/main","KITE/main","PHET_CORE/main"],function(t){window.axon=t("AXON/main"),window.dot=t("DOT/main"),window.kite=t("KITE/main"),window.phetCore=t("PHET_CORE/main")})}(),window.axon=e("AXON/main"),window.dot=e("DOT/main"),window.kite=e("KITE/main"),window.phetCore=e("PHET_CORE/main")}();