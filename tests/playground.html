<!DOCTYPE html>
<html>
<!-- When run in the browser, this will load code into the global namespace so that it can be tested via the developer console -->
<head>
  <meta charset="utf-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
  <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <meta name="apple-mobile-web-app-capable" content="yes">

  <title>Kite Playground</title>

  <script src="../../assert/js/assert.js"></script>
  <script src="../../sherpa/lib/lodash-4.17.4.min.js"></script>

  <script data-main="../js/kite-config.js" src="../../sherpa/lib/require-2.1.11.js"></script>

</head>
<body>
<script>
  window.assertions.enableAssert();
  window.assertions.enableAssertSlow();

  require( [ 'kite-config' ], function() {
    require( [ 'main', 'AXON/main', 'DOT/main', 'PHET_CORE/main' ], function( kite, axon, dot, phetCore ) {
      window.kite = kite;
      window.axon = axon;
      window.dot = dot;
      window.phetCore = phetCore;

      console.log( 'loaded' );

      window.initTest = function() {
        // window.shape = new kite.Shape().moveTo( 0, 0 ).lineTo( 10, 10 ).lineTo( 20, 0 ).close().moveTo( 4, 2 ).lineTo( 16, 2 ).lineTo( 10, 6 ).close();

        // window.shape.moveTo( 0, 0 ).lineTo( 10, 10 ).lineTo( 20, 0 ).close().moveTo( 4, 2 ).lineTo( 16, 2 ).lineTo( 10, 6 ).close().moveTo( 0, 8 ).lineTo( 10, 18 ).lineTo( 20, 8 ).close();
        // window.shape.moveTo( 0, 20 ).lineTo( 20, 25 ).lineTo( 20, 20 ).lineTo( 0, 25 ).close();
        // window.shape.moveTo( 0, 25 ).lineTo( 20, 30 ).lineTo( 20, 25 ).lineTo( 0, 30 ).close();

        // window.shape = new kite.Shape();
        // shape.moveTo( 0, 0 ).lineTo( 10, 0 ).lineTo( 10, 10 ).lineTo( 0, 10 ).close();
        // shape.moveTo( 5, 10 ).lineTo( 15, 10 ).lineTo( 15, 20 ).lineTo( 5, 20 ).close();
        // shape.moveTo( 10, 0 ).lineTo( 20, 0 ).lineTo( 20, 10 ).lineTo( 10, 10 ).close();
        // shape.moveTo( 20, 0 ).lineTo( 20, 10 ).lineTo( 30, 10 ).lineTo( 30, 0 ).close();

        window.shape = new kite.Shape( 'M 33.13235561715559640561 99.06303272191520647993 L 54.70988872976145955818 89.05802571383350141332 L 24.35794375684046286779 59.86799308836629762709 L 93.64228353946219840509 79.92519628373639761776 L 98.12849931649626000763 13.06556532802607506483 L 72.64129095582021022892 18.36651972385274689259 L 29.93303011306560534877 57.17248290978773894722 L 95.26429400111069867307 15.14343311102377498401 L 30.35326155315436480464 16.69400908470202082867 L 89.96204100680746762464 97.03505337951492037973 L 0.41513691195353974450 47.02904919412871720397 L 84.65230013837204126048 99.10655738539253434283 L 57.35327655997739526583 95.76799102542750574685 L 72.63249845872800847246 57.52421104077569680157 L 26.58133917757572461937 78.07111595915050372696 L 54.53299163839502483597 99.92509674124090679470 L 22.90120388928069772305 72.12319991745172842457 L 2.69174030902290528644 0.28384116264712488942 L 90.26200872809442898870 87.02691786965326059544 L 49.22062719081450410386 99.53410156683023046753 L 50.17573822976923736405 75.22010498226343599981 L 2.18969240258783948150 76.01653934817549895797 L 15.94945990100449151328 55.04324652784345062173 L 54.47687991273517837953 88.74832537709262680892 L 53.22348864524683875743 30.39618340746306301980 L 5.40317731064721140655 34.98241478944868276812 L 20.02290363982410781318 95.72657514548768631357 L 84.85317961646330786607 80.19577088851532664648 L 25.44563771559753462270 38.77848464171314191162 L 91.98547297695202473733 18.11769481095157985351 L 65.50950341685657463131 57.33848758966036029960 L 6.61173896313640430122 79.62666511947675473948 L 80.70364122353375080365 50.01476453224751139714 L 32.09212281480584749715 15.67340234948768618040 L 91.01219374209732393410 46.99591177090880478318 L 44.98870511431054808327 2.76734782761189901379 L 74.82168453138855568341 76.63679111108281460929 L 43.48907970546625278985 58.09836307675985977994 L 86.55559678947891200096 0.17978295640643793263 L 29.23143916684423260222 30.71159138009647193712 L 34.40789261432122003725 42.44747615271946727944 L 2.69508285988429019397 76.83680298616179982218 L 22.87223956215296283290 0.47551335893734059113 L 52.58356645771846871185 58.32083170378121650401 L 69.57799609781206129355 49.00583456473845700430 L 94.93011063406453331481 51.56445441195056389461 L 20.43383318893410205419 54.38033513295172838298 L 16.91074247168704403066 6.04479816026692873265 L 30.05705287139550563325 76.04427820470947096965 L 75.06149078116430928276 75.02294466494008418067 L 37.27820035624105088345 69.54368280541530111805 L 94.55064115394100099365 31.33311365116700031308 L 58.81506543675554610218 97.58698455791181913810 L 92.45718083570366729873 41.61729258033579981202 L 31.55830923017301969935 15.50650905998112172313 L 64.53939289736905493555 88.75092678208777385862 L 99.89005623618372453620 32.51522578056103185418 L 55.22277562038466669492 47.24061195817890279613 L 63.95722003812198863670 64.89430197615222084551 L 11.81017308861886938587 49.96066050882787834553 L 23.92156292066731637647 1.51027220833221953455 L 94.48853096461284906127 64.03419122198693003156 L 98.84285241979020497638 18.11866975110834232510 L 60.74072387635050063182 39.36091788416520387273 L 72.07876525216522622941 12.01187117550528427046 L 63.47693556999152519893 31.34294693766051054240 L 4.90544287651064614408 78.16541161032375839568 L 31.63469872761834977837 38.28340920338355601871 L 60.22381210294219044954 80.42199203278721597599 L 60.78425018081543385051 4.16443636098413616509 L 9.11789096872876925204 52.91837994504118114492 L 22.75929794500757452624 78.77898026465443592770 L 5.44262532998542880591 96.77374894823935846944 L 2.80023967808180618277 23.75769401510530087762 L 30.51597953739444335497 92.66765854787182377095 L 45.53769710027999195745 32.77100533210488464420 L 72.12452110803158689123 54.11757635800928767367 L 23.57388084371216763202 70.47741388859054723071 L 88.11842707332411350762 98.72236486104296204758 L 40.41920532119009834560 94.79375541330784926686 L 24.89413402276172604388 37.37450707433118424206 L 96.61850807814786890049 47.22944659901400399349 L 82.60839722809154750394 20.61397846908965547641 L 48.93191893722781316001 12.09266382605103018477 L 54.94114288524147582393 62.81255737503164482405 L 42.91124226924853957144 52.74935721256173337679 L 1.91136830869247376086 8.78618179580665881190 L 61.78006464766958316659 96.54713634987275838739 L 5.19752138311775357948 56.12217949568037056451 L 51.37295736598967721420 62.55271809359346235624 L 72.79681421997534584989 59.96627183386988946268 L 10.56061934132903701311 64.23030454315717463487 L 99.21026752104585000325 7.96941833202684524196 L 73.84332618648797108563 31.52254034115557956852 L 27.39468393919772637446 66.47666374507711850583 L 92.20866523979918838450 36.82300585042131046976 L 70.15682145817179105052 47.58075887734798214979 L 27.07913528545216053089 90.59301572223921539262 L 20.49424271145376863501 65.68699027200237594570 L 28.68681660704524105654 3.60110349764124482164 Z ' );


        window.graph = new kite.Graph();
        shape.subpaths.forEach( function( subpath ) {
          graph.addSubpath( 0, subpath );
        } );
        graph.eliminateOverlap();
        graph.eliminateIntersection();
        graph.collapseVertices();
        graph.removeSingleEdgeVertices();
        graph.orderVertexEdges();
        graph.extractFaces();
        graph.computeBoundaryGraph();
        graph.computeWindingMap();
        graph.computeFaceInclusion( function( windingMap ) {
          return windingMap[ '0' ] !== 0; // non-zero for first entry
        } );
        graph.debug();
        window.subgraph = graph.createFilledSubGraph();
        subgraph.fillAlternatingFaces();
        subgraph.debug();
        window.shape = subgraph.facesToShape();
        console.log( shape.getSVGPath() );

        // window.cubic = new kite.Cubic( dot.v2( 0 ,0 ), dot.v2( 0, 3 ), dot.v2( 10, 7 ), dot.v3( 10, 9 ) );
        // return kite.Cubic.getOverlaps( cubic.subdivided( 0.7 )[ 0 ], cubic.subdivided( 0.3 )[ 1 ] );
      };

      window.initLineTest = function() {
        // intersection with one ray returns a different result than another. need to add indeterminate intersection handling
        window.shape = new kite.Shape( 'M -100 -100 L -50 50 L 50 50 L 30 0' );
        window.ray1 = new dot.Ray2( dot.v2( 50, 267 ), dot.v2( 0, -1 ) );
        window.ray2 = new dot.Ray2( dot.v2( 50, 267 ), dot.v2( 1, 0 ) );
        console.log( 'ray1: ' + shape.windingIntersection( ray1 ) );
        console.log( 'ray2: ' + shape.windingIntersection( ray2 ) );
      }
    } );
  } );
</script>
</body>
</html>
